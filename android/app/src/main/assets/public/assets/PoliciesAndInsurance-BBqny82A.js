import{m as b,j as e,T as G,B as y,c as le,o as ne,d as ie,I as A,C as ce,e as I}from"./index-D5q3SS3D.js";import{u as de,b as a}from"./react-vendor-BUaIliXj.js";import{A as T}from"./AdminPageHeader-wINx_pXe.js";import{M as V}from"./Modal-CR2aBU6L.js";import{ao as R,as as O,w as U,X as oe,b8 as me,$,aj as xe,bB as pe,M as he,bC as _,U as ue,f as z,i as fe,j as je,A as ge,at as ye,F as Ne,u as be,p as ve}from"./ui-vendor-B8EvWqdc.js";import{S as we}from"./Select-Dz12MdxG.js";import{D as Se}from"./DatePicker-D2ulOwJx.js";import{a as Ce}from"./excelExport-B_NduTpG.js";import{a as ke}from"./html2pdf-DgNOHyuA.js";import{f as D,G as Me}from"./utils-vendor-DmorxLnX.js";import"./pdf-vendor-CB_F1AVu.js";import"./capacitor-vendor-CqiIOUn1.js";import"./supabase-7WG3J4rU.js";import"./FileSaver.min-C7cHFFkD.js";const Ae=({isOpen:t,onSave:m,onClose:h,initialData:l})=>{const[u,x]=a.useState(l?.name||""),[d,p]=a.useState(l?.description||""),[c,r]=a.useState(!1);a.useEffect(()=>{t&&(x(l?.name||""),p(l?.description||""),r(!1))},[t,l]);const i=async n=>{if(n&&n.preventDefault(),!!u.trim()){r(!0);try{await m({name:u.trim(),description:d.trim()})}catch(o){console.error("Error saving policy:",o),r(!1)}}};return e.jsx(V,{isOpen:t,onClose:h,onConfirm:i,title:`${l?"Edit":"Add"} Policy`,confirmButtonText:"Save Policy",isLoading:c,children:e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"policy-name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"policy-name",value:u,onChange:n=>x(n.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:c})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"policy-description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),e.jsx("textarea",{id:"policy-description",value:d,onChange:n=>p(n.target.value),placeholder:"Description",className:"form-input",rows:3,disabled:c})]})]})})},De=()=>{const t=de(),[m,h]=a.useState([]),[l,u]=a.useState(!0),[x,d]=a.useState(!1),[p,c]=a.useState(null),[r,i]=a.useState(null),n=a.useRef(!0);a.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]);const o=a.useCallback(async()=>{u(!0);try{const g=await b.getPolicies();n.current&&h(g)}catch(g){console.error("Error fetching policies:",g),n.current&&i({message:"Failed to fetch policies.",type:"error"})}finally{n.current&&u(!1)}},[]);a.useEffect(()=>{o()},[o]);const j=async g=>{try{p?i({message:"Policy updated.",type:"success"}):(await b.createPolicy(g),n.current&&i({message:"Policy created successfully!",type:"success"})),n.current&&(d(!1),c(null),o())}catch(w){throw console.error("Error saving policy:",w),n.current&&i({message:"Failed to save policy. Please try again.",type:"error"}),w}},f=()=>{t("/hr/policies/add")},v=g=>{c(g),d(!0)};return e.jsxs("div",{children:[r&&e.jsx(G,{message:r.message,type:r.type,onDismiss:()=>i(null)}),e.jsx(Ae,{isOpen:x,onSave:j,onClose:()=>{d(!1),c(null)},initialData:p}),e.jsx(T,{title:"Policy Management",children:e.jsxs(y,{onClick:f,children:[e.jsx(R,{className:"mr-2 h-4 w-4"})," Add Policy"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full responsive-table",children:[e.jsx("thead",{className:"bg-page",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:'No policies found. Click "Add Policy" to create one.'})}):m.map(g=>e.jsxs("tr",{children:[e.jsx("td",{"data-label":"Policy Name",className:"px-6 py-4 font-medium",children:g.name}),e.jsx("td",{"data-label":"Description",className:"px-6 py-4 text-sm text-muted",children:g.description||"—"}),e.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:e.jsx(y,{variant:"icon",size:"sm",onClick:()=>v(g),children:e.jsx(O,{className:"h-4 w-4"})})})})]},g.id))})]})})]})},Pe=ie({type:I().oneOf(["GMC","GPA","WCA","Other"]).required("Type is required"),provider:I().required("Provider is required"),policyNumber:I().required("Policy number is required"),validTill:I().required("Valid till date is required")}).defined(),Ie=({onSave:t,onClose:m,initialData:h})=>{const{register:l,handleSubmit:u,control:x,formState:{errors:d},reset:p}=le({resolver:ne(Pe)});a.useEffect(()=>{p(h||{type:"GMC",provider:"",policyNumber:"",validTill:""})},[h,p]);const c=r=>{t(r)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:m,children:e.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4",onClick:r=>r.stopPropagation(),children:e.jsxs("form",{onSubmit:u(c),children:[e.jsxs("h3",{className:"text-lg font-bold mb-4",children:[h?"Edit":"Add"," Insurance"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(we,{label:"Insurance Type",id:"type",registration:l("type"),error:d.type?.message,children:[e.jsx("option",{children:"GMC"}),e.jsx("option",{children:"GPA"}),e.jsx("option",{children:"WCA"}),e.jsx("option",{children:"Other"})]}),e.jsx(A,{label:"Provider",id:"provider",registration:l("provider"),error:d.provider?.message}),e.jsx(A,{label:"Policy Number",id:"policyNumber",registration:l("policyNumber"),error:d.policyNumber?.message}),e.jsx(ce,{name:"validTill",control:x,render:({field:r})=>e.jsx(Se,{label:"Valid Till",id:"validTill",value:r.value,onChange:r.onChange,error:d.validTill?.message})})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:m,children:"Cancel"}),e.jsx(y,{type:"submit",children:"Save Insurance"})]})]})})})},H=()=>{const[t,m]=a.useState([]),[h,l]=a.useState(!0),[u,x]=a.useState(!1),[d,p]=a.useState(null),[c,r]=a.useState(null),i=a.useCallback(async()=>{l(!0);try{const o=await b.getInsurances();m(o)}catch{r({message:"Failed to fetch insurance policies.",type:"error"})}finally{l(!1)}},[]);a.useEffect(()=>{i()},[i]);const n=async o=>{try{d||(await b.createInsurance(o),r({message:"Insurance created.",type:"success"})),x(!1),i()}catch{r({message:"Failed to save insurance.",type:"error"})}};return e.jsxs("div",{children:[c&&e.jsx(G,{message:c.message,type:c.type,onDismiss:()=>r(null)}),u&&e.jsx(Ie,{onSave:n,onClose:()=>x(!1),initialData:d}),e.jsx(T,{title:"Insurance Management",children:e.jsxs(y,{onClick:()=>{p(null),x(!0)},children:[e.jsx(R,{className:"mr-2 h-4 w-4"})," Add Insurance"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full responsive-table",children:[e.jsx("thead",{className:"bg-page",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Provider"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Number"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Valid Till"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:h?e.jsx("tr",{children:e.jsx("td",{colSpan:5,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):t.map(o=>e.jsxs("tr",{children:[e.jsx("td",{"data-label":"Type",className:"px-6 py-4 font-medium",children:o.type}),e.jsx("td",{"data-label":"Provider",className:"px-6 py-4 text-sm text-muted",children:o.provider}),e.jsx("td",{"data-label":"Policy Number",className:"px-6 py-4 text-sm text-muted",children:o.policyNumber}),e.jsx("td",{"data-label":"Valid Till",className:"px-6 py-4 text-sm text-muted",children:o.validTill}),e.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:e.jsx(y,{variant:"icon",size:"sm",onClick:()=>{p(o),x(!0)},children:e.jsx(O,{className:"h-4 w-4"})})})})]},o.id))})]})})]})},Ee=({sub:t})=>{const m=t.dob?Me(new Date,new Date(t.dob)):"N/A";return e.jsxs("div",{id:`gmc-pdf-template-${t.id}`,className:"p-10 bg-white text-[#041b0f] font-sans",style:{width:"210mm",minHeight:"297mm"},children:[e.jsxs("div",{className:"flex justify-between items-center border-b-2 border-accent pb-6 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black uppercase tracking-tighter text-accent",children:"GMC Enrollment Receipt"}),e.jsx("p",{className:"text-xs font-bold text-muted",children:"PARADIGM SERVICES - SECURE SUBMISSION"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs font-bold text-muted uppercase",children:"Submission ID"}),e.jsxs("p",{className:"font-mono text-sm leading-none",children:["#",t.id.substring(0,8).toUpperCase()]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-10 mb-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-[10px] font-black uppercase tracking-widest text-accent/60 mb-2",children:"Member Identity"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase",children:"Full Name"}),e.jsx("p",{className:"font-black text-lg leading-tight",children:t.employeeName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase",children:"Employee ID"}),e.jsx("p",{className:"font-bold",children:t.employeeId})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase",children:"Designation"}),e.jsx("p",{className:"font-bold",children:t.designation})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase",children:"Joining Date"}),e.jsx("p",{className:"font-bold",children:t.dateOfJoining})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase",children:"Date of Birth"}),e.jsx("p",{className:"font-bold",children:t.dob})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase",children:"Gender"}),e.jsx("p",{className:"font-bold",children:t.gender})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-[10px] font-black uppercase tracking-widest text-accent/60 mb-2",children:"Assignment Details"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase",children:"Company/Org"}),e.jsx("p",{className:"font-bold text-lg",children:t.companyName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase",children:"Primary Site"}),e.jsx("p",{className:"font-bold text-lg",children:t.siteName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase",children:"Marital Status"}),e.jsx("p",{className:"font-bold",children:t.maritalStatus})]})]})]}),e.jsxs("div",{className:"bg-accent/5 rounded-3xl p-8 border border-accent/10 mb-10 relative overflow-hidden",children:[e.jsx("div",{className:"absolute right-[-20px] bottom-[-20px] opacity-[0.03] transform rotate-12",children:e.jsx(_,{size:200,fill:"currentColor"})}),e.jsx("h3",{className:"text-[10px] font-black uppercase tracking-widest text-accent mb-6",children:"Selected Insurance Plan"}),e.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase mb-1",children:"Coverage Tier"}),e.jsx("p",{className:"text-2xl font-black text-accent",children:t.planName})]}),e.jsxs("div",{className:"border-l border-accent/20 pl-8",children:[e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase mb-1",children:"Verified Age"}),e.jsxs("p",{className:"text-2xl font-black",children:[m," Years"]})]}),e.jsxs("div",{className:"border-l border-accent/20 pl-8",children:[e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase mb-1",children:"Monthly Premium"}),e.jsxs("p",{className:"text-2xl font-black",children:["₹",t.premiumAmount]})]})]})]}),(t.maritalStatus==="Married"||t.children&&t.children.length>0)&&e.jsxs("div",{className:"mb-10",children:[e.jsx("h3",{className:"text-[10px] font-black uppercase tracking-widest text-accent/60 mb-4",children:"Family Declarations"}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-muted/20",children:[e.jsx("th",{className:"text-left py-2 text-[10px] font-bold text-muted uppercase",children:"Relation"}),e.jsx("th",{className:"text-left py-2 text-[10px] font-bold text-muted uppercase",children:"Name"}),e.jsx("th",{className:"text-left py-2 text-[10px] font-bold text-muted uppercase",children:"DOB"})]})}),e.jsxs("tbody",{className:"divide-y divide-muted/10",children:[t.maritalStatus==="Married"&&t.spouseName&&e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 font-bold text-accent",children:"Spouse"}),e.jsxs("td",{className:"py-3 font-medium",children:[t.spouseName," (",t.spouseGender,")"]}),e.jsx("td",{className:"py-3 font-medium",children:t.spouseDob}),e.jsx("td",{className:"py-3",children:t.spouseContact||"—"})]}),t.children?.map((h,l)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"py-3 font-bold text-accent",children:["Child ",l+1]}),e.jsxs("td",{className:"py-3 font-medium",children:[h.name," (",h.gender,")"]}),e.jsx("td",{className:"py-3 font-medium",children:h.dob}),e.jsx("td",{className:"py-3",children:"—"})]},l))]})]})]}),(t.fatherName||t.motherName)&&e.jsxs("div",{className:"mb-10",children:[e.jsx("h3",{className:"text-[10px] font-black uppercase tracking-widest text-accent/60 mb-4",children:"Parental Declarations"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.maritalStatus==="Single"&&t.fatherName&&e.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl",children:[e.jsxs("p",{className:"text-[10px] font-bold text-muted uppercase",children:["Father's Name (",t.fatherGender,")"]}),e.jsx("p",{className:"font-bold",children:t.fatherName}),e.jsxs("p",{className:"text-xs text-muted",children:["DOB: ",t.fatherDob||"—"]})]}),t.maritalStatus==="Single"&&t.motherName&&e.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl",children:[e.jsxs("p",{className:"text-[10px] font-bold text-muted uppercase",children:["Mother's Name (",t.motherGender,")"]}),e.jsx("p",{className:"font-bold",children:t.motherName}),e.jsxs("p",{className:"text-xs text-muted",children:["DOB: ",t.motherDob||"—"]})]})]})]}),e.jsxs("div",{className:"mt-auto pt-10 border-t border-muted/20 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-accent/5 text-accent rounded-full text-[10px] font-black uppercase tracking-widest mb-4",children:[e.jsx(ge,{size:14})," Digitally Verified Enrollment"]}),e.jsxs("p",{className:"text-[10px] text-muted leading-relaxed max-w-lg mx-auto",children:["This document is a computer generated enrollment record and does not require a physical signature. Verified on ",D(new Date(t.updatedAt),"dd MMMM yyyy")," at ",D(new Date(t.updatedAt),"HH:mm:ss"),"."]})]})]})},Fe=()=>{const[t,m]=a.useState([]),[h,l]=a.useState(0),[u,x]=a.useState(!0),[d,p]=a.useState(!1),[c,r]=a.useState(1),[i]=a.useState(10),[n,o]=a.useState(""),[j,f]=a.useState(""),[v,g]=a.useState(""),[w,J]=a.useState(""),[S,W]=a.useState(""),[C,Y]=a.useState(""),[k,X]=a.useState(""),[M,K]=a.useState(""),[P,Q]=a.useState(!1),[Z,ee]=a.useState([]),[te,se]=a.useState([]),B=a.useCallback(async()=>{try{const[s,N]=await Promise.all([b.getEntities(),b.getGroups()]);ee(s),se(N)}catch(s){console.error("Failed to fetch filter data:",s)}},[]),L=a.useCallback(async()=>{x(!0);try{const{data:s,total:N}=await b.getGmcSubmissions({name:n,site:j,company:v,maritalStatus:w,minAge:S?parseInt(S):void 0,maxAge:C?parseInt(C):void 0,startDate:k||void 0,endDate:M||void 0,page:c,limit:i});m(s),l(N)}catch(s){console.error("Failed to fetch GMC submissions:",s)}finally{x(!1)}},[n,j,v,w,S,C,k,M,c,i]);a.useEffect(()=>{B()},[B]),a.useEffect(()=>{L()},[L]);const ae=async()=>{p(!0);try{const{data:s}=await b.getGmcSubmissions({name:n,site:j,company:v,maritalStatus:w,minAge:S?parseInt(S):void 0,maxAge:C?parseInt(C):void 0,startDate:k||void 0,endDate:M||void 0,limit:-1}),N=[{header:"Employee Name",key:"employeeName",width:25},{header:"Employee ID",key:"employeeId",width:15},{header:"DOJ",key:"dateOfJoining",width:15},{header:"Designation",key:"designation",width:20},{header:"DOB",key:"dob",width:15},{header:"Gender",key:"gender",width:10},{header:"Contact",key:"contactNumber",width:15},{header:"Marital Status",key:"maritalStatus",width:15},{header:"Company",key:"companyName",width:20},{header:"Site",key:"siteName",width:20},{header:"Plan Name",key:"planName",width:15},{header:"Premium",key:"premiumAmount",width:10},{header:"Father Name",key:"fatherName",width:20},{header:"Father Gender",key:"fatherGender",width:10},{header:"Father DOB",key:"fatherDob",width:15},{header:"Mother Name",key:"motherName",width:20},{header:"Mother Gender",key:"motherGender",width:10},{header:"Mother DOB",key:"motherDob",width:15},{header:"Spouse Name",key:"spouseName",width:20},{header:"Spouse Gender",key:"spouseGender",width:10},{header:"Spouse DOB",key:"spouseDob",width:15},{header:"Submission Date",key:"createdAtFormatted",width:20}],F=s.map(q=>({...q,createdAtFormatted:D(new Date(q.updatedAt),"MMM dd, yyyy HH:mm")}));await Ce(F,N,"GMC Form Submissions Report",{startDate:k?new Date(k):new Date(0),endDate:M?new Date(M):new Date},"GMC_Report",void 0,"HR/Admin System")}catch(s){console.error("Export failed:",s)}finally{p(!1)}},re=s=>{const N=document.getElementById(`gmc-pdf-template-${s.id}`);if(!N)return;const F={margin:0,filename:`GMC_Record_${s.employeeName}_${s.id.substring(0,8)}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};ke().set(F).from(N).save()},E=Math.ceil(h/i);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"hidden",children:t.map(s=>e.jsx(Ee,{sub:s},s.id))}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-bold text-primary-text flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-accent"}),"GMC Submissions"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>Q(!P),children:[P?e.jsx(oe,{className:"h-4 w-4 mr-1"}):e.jsx(me,{className:"h-4 w-4 mr-1"}),P?"Hide Filters":"More Filters"]}),e.jsxs(y,{onClick:ae,isLoading:d,size:"sm",children:[e.jsx($,{className:"h-4 w-4 mr-1"})," Download Excel"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center bg-white p-4 rounded-2xl border border-border shadow-sm",children:[e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted"}),e.jsx("input",{type:"text",placeholder:"Search by name...",value:n,onChange:s=>{o(s.target.value),r(1)},className:"form-input !pl-10 w-full"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 w-full lg:w-auto",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted"}),e.jsxs("select",{value:v,onChange:s=>{g(s.target.value),r(1)},className:"form-input !pl-10 w-full",children:[e.jsx("option",{value:"",children:"All Companies"}),te.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]})]}),e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(he,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted"}),e.jsxs("select",{value:j,onChange:s=>{f(s.target.value),r(1)},className:"form-input !pl-10 w-full",children:[e.jsx("option",{value:"",children:"All Sites"}),Z.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]})]})]})]}),P&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 bg-gray-50/50 p-6 rounded-2xl border border-border border-dashed shadow-inner animate-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase tracking-widest font-black text-muted flex items-center gap-1.5",children:[e.jsx(_,{className:"h-3 w-3"})," Marital Status"]}),e.jsxs("select",{value:w,onChange:s=>{J(s.target.value),r(1)},className:"form-input w-full",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"Single",children:"Single"}),e.jsx("option",{value:"Married",children:"Married"}),e.jsx("option",{value:"Divorced",children:"Divorced"}),e.jsx("option",{value:"Widowed",children:"Widowed"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase tracking-widest font-black text-muted flex items-center gap-1.5",children:[e.jsx(ue,{className:"h-3 w-3"})," Age Range"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",placeholder:"Min",value:S,onChange:s=>{W(s.target.value),r(1)},className:"form-input w-full"}),e.jsx("span",{className:"text-muted",children:"–"}),e.jsx("input",{type:"number",placeholder:"Max",value:C,onChange:s=>{Y(s.target.value),r(1)},className:"form-input w-full"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase tracking-widest font-black text-muted flex items-center gap-1.5",children:[e.jsx(z,{className:"h-3 w-3"})," Submitted From"]}),e.jsx("input",{type:"date",value:k,onChange:s=>{X(s.target.value),r(1)},className:"form-input w-full"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase tracking-widest font-black text-muted flex items-center gap-1.5",children:[e.jsx(z,{className:"h-3 w-3"})," Submitted To"]}),e.jsx("input",{type:"date",value:M,onChange:s=>{K(s.target.value),r(1)},className:"form-input w-full"})]})]})]}),e.jsx("div",{className:"bg-white rounded-2xl border border-border shadow-sm overflow-hidden overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-border",children:[e.jsx("thead",{className:"bg-page",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-muted uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-muted uppercase tracking-wider",children:"Company"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-muted uppercase tracking-wider",children:"Site"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-muted uppercase tracking-wider",children:"Insurance Plan"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-muted uppercase tracking-wider",children:"Submission Date"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-muted uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:u?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-muted",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-accent border-t-transparent rounded-full"}),e.jsx("span",{children:"Loading submissions..."})]})})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-muted italic",children:"No GMC submissions found matching your criteria."})}):t.map(s=>e.jsxs("tr",{className:"hover:bg-page/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-xl bg-accent-light flex items-center justify-center text-accent font-black text-lg",children:s.employeeName.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-black text-primary-text leading-tight",children:s.employeeName}),e.jsxs("p",{className:"text-[10px] font-bold text-muted uppercase tracking-tight mt-0.5",children:["ID: ",s.employeeId," • ",s.designation]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("p",{className:"text-sm font-bold text-primary-text",children:s.companyName})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("p",{className:"text-sm font-bold text-primary-text",children:s.siteName})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-[10px] font-black uppercase tracking-widest bg-emerald-50 text-emerald-700 border border-emerald-100",children:s.planName})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("p",{className:"text-sm font-bold text-muted",children:D(new Date(s.updatedAt),"MMM dd, yyyy")}),e.jsx("p",{className:"text-[10px] text-muted tracking-tight font-medium uppercase mt-0.5",children:D(new Date(s.updatedAt),"hh:mm a")})]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs(y,{variant:"secondary",size:"sm",className:"!rounded-xl group shadow-none",onClick:()=>re(s),children:[e.jsx($,{className:"h-4 w-4 mr-2 text-accent group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"font-bold",children:"PDF"})]})})]},s.id))})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 p-4 bg-white rounded-2xl border border-border shadow-sm",children:[e.jsxs("p",{className:"text-xs text-muted font-bold uppercase tracking-widest",children:["Showing ",e.jsx("span",{className:"text-primary-text",children:t.length>0?(c-1)*i+1:0})," to ",e.jsx("span",{className:"text-primary-text",children:Math.min(c*i,h)})," of ",e.jsx("span",{className:"text-primary-text",children:h})," entries"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{variant:"secondary",size:"sm",onClick:()=>r(s=>Math.max(1,s-1)),disabled:c===1||u,className:"!p-2 shadow-none !rounded-xl",children:e.jsx(fe,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex items-center gap-1",children:[...Array(E)].map((s,N)=>e.jsx("button",{onClick:()=>r(N+1),className:`h-9 w-9 rounded-xl text-sm font-black transition-all ${c===N+1?"bg-accent text-white shadow-lg shadow-accent/20":"text-muted hover:bg-page hover:text-primary-text"}`,disabled:u,children:N+1},N))}),e.jsx(y,{variant:"secondary",size:"sm",onClick:()=>r(s=>Math.min(E,s+1)),disabled:c===E||u,className:"!p-2 shadow-none !rounded-xl",children:e.jsx(je,{className:"h-5 w-5"})})]})]})]})},Ge=({isOpen:t,onSave:m,onClose:h,initialData:l})=>{const[u,x]=a.useState(l?.minAge?.toString()||""),[d,p]=a.useState(l?.maxAge?.toString()||""),[c,r]=a.useState(l?.rate?.toString()||""),[i,n]=a.useState(!1);a.useEffect(()=>{t&&(x(l?.minAge?.toString()||""),p(l?.maxAge?.toString()||""),r(l?.rate?.toString()||""),n(!1))},[t,l]);const o=async j=>{if(j&&j.preventDefault(),!(!u||!d||!c)){n(!0);try{await m({minAge:parseInt(u),maxAge:parseInt(d),rate:parseFloat(c)})}catch(f){console.error("Error saving rate:",f),n(!1)}}};return e.jsx(V,{isOpen:t,onClose:h,onConfirm:o,title:`${l?"Edit":"Add"} GMC Rate`,confirmButtonText:"Save Rate",isLoading:i,children:e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(A,{label:"Min Age",type:"number",value:u,onChange:j=>x(j.target.value),required:!0,disabled:i}),e.jsx(A,{label:"Max Age",type:"number",value:d,onChange:j=>p(j.target.value),required:!0,disabled:i})]}),e.jsx(A,{label:"Monthly Premium (₹)",type:"number",value:c,onChange:j=>r(j.target.value),required:!0,disabled:i})]})})},Te=()=>{const[t,m]=a.useState([]),[h,l]=a.useState(!0),[u,x]=a.useState(!1),[d,p]=a.useState(null),[c,r]=a.useState(null),i=a.useRef(!0);a.useEffect(()=>(i.current=!0,()=>{i.current=!1}),[]);const n=a.useCallback(async()=>{l(!0);try{const f=await b.getGMCRates();i.current&&m(f)}catch(f){console.error("Error fetching rates:",f),i.current&&r({message:"Failed to fetch rates.",type:"error"})}finally{i.current&&l(!1)}},[]);a.useEffect(()=>{n()},[n]);const o=async f=>{try{d?(await b.updateGMCRate(d.id,f),r({message:"Rate updated successfully.",type:"success"})):(await b.addGMCRate(f),r({message:"New rate slab added.",type:"success"})),i.current&&(x(!1),p(null),n())}catch(v){throw r({message:"Failed to save rate.",type:"error"}),v}},j=async f=>{if(window.confirm("Are you sure you want to delete this rate slab?"))try{await b.deleteGMCRate(f),r({message:"Rate deleted.",type:"success"}),n()}catch(v){console.error("Error deleting rate:",v),r({message:"Failed to delete rate.",type:"error"})}};return e.jsxs("div",{children:[c&&e.jsx(G,{message:c.message,type:c.type,onDismiss:()=>r(null)}),e.jsx(Ge,{isOpen:u,onSave:o,onClose:()=>{x(!1),p(null)},initialData:d}),e.jsx(T,{title:"GMC Premium Configuration",children:e.jsxs(y,{onClick:()=>{p(null),x(!0)},children:[e.jsx(R,{className:"mr-2 h-4 w-4"})," Add New Slab"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full responsive-table",children:[e.jsx("thead",{className:"bg-page",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Age Bracket"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Monthly Premium"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:h?e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"text-center py-10 text-muted",children:"Loading..."})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"text-center py-10 text-muted",children:"No rates configured."})}):t.map(f=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 font-medium",children:[f.minAge," - ",f.maxAge," Years"]}),e.jsxs("td",{className:"px-6 py-4 font-bold text-accent",children:["₹",f.rate]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[e.jsx(y,{variant:"icon",size:"sm",onClick:()=>{p(f),x(!0)},children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx(y,{variant:"icon",size:"sm",onClick:()=>j(f.id),className:"text-red-500 hover:text-red-700",children:e.jsx(ye,{className:"h-4 w-4"})})]})})]},f.id))})]})})]})},Xe=()=>{const[t,m]=a.useState("policies");return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:e.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Policies & Insurance"})}),e.jsx("div",{children:e.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[e.jsxs("button",{onClick:()=>m("policies"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${t==="policies"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[e.jsx(Ne,{className:"h-5 w-5"}),e.jsx("span",{children:"Company Policies"})]}),e.jsxs("button",{onClick:()=>m("insurance"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${t==="insurance"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[e.jsx(be,{className:"h-5 w-5"}),e.jsx("span",{children:"Insurance Plans"})]}),e.jsxs("button",{onClick:()=>m("gmc"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${t==="gmc"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[e.jsx(U,{className:"h-5 w-5"}),e.jsx("span",{children:"Forms GMC"})]}),e.jsxs("button",{onClick:()=>m("config"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${t==="config"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[e.jsx(ve,{className:"h-5 w-5"}),e.jsx("span",{children:"Configuration"})]})]})}),e.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[t==="policies"&&e.jsx(De,{}),t==="insurance"&&e.jsx(H,{}),t==="insurance"&&e.jsx(H,{}),t==="gmc"&&e.jsx(Fe,{}),t==="config"&&e.jsx(Te,{})]})]})};export{Xe as default};
