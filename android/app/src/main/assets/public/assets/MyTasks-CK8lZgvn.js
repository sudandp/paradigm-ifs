import{u as b,j as s,m as d}from"./index-D5q3SS3D.js";import{b as n}from"./react-vendor-BUaIliXj.js";import{a2 as g,E as v,B as m}from"./ui-vendor-B8EvWqdc.js";import{f as k,m as y}from"./utils-vendor-DmorxLnX.js";import"./pdf-vendor-CB_F1AVu.js";import"./capacitor-vendor-CqiIOUn1.js";import"./supabase-7WG3J4rU.js";const T=({status:t})=>{const i={"To Do":"bg-gray-500","In Progress":"bg-blue-500",Done:"bg-green-600"};return s.jsx("span",{className:`fo-status-badge ${i[t]}`,children:t})},L=()=>{const{user:t}=b(),[i,r]=n.useState("tasks"),[c,x]=n.useState([]),[o,h]=n.useState([]),[f,l]=n.useState(!0);n.useEffect(()=>{if(!t)return;(async()=>{l(!0);try{const[a,j]=await Promise.all([d.getTasks(),d.getNotifications(t.id)]),p=a.filter(N=>N.assignedToId===t.id);x(p),h(j)}catch(a){console.error("Failed to load data for tasks page",a)}finally{l(!1)}})()},[t]);const u=e=>{const a=["HR","Admin","Ops Manager","Site Manager"];return a[e.charCodeAt(e.length-1)%a.length]};return s.jsxs("div",{children:[s.jsx("header",{className:"p-4 flex-shrink-0 text-center fo-mobile-header sticky top-0 bg-[#041b0f]/80 backdrop-blur-sm z-10 border-b border-[#374151]",children:s.jsx("h1",{children:"Tasks"})}),s.jsx("div",{className:"flex-shrink-0 p-4",children:s.jsxs("div",{className:"fo-tabs-container",children:[s.jsx("button",{onClick:()=>r("tasks"),className:`fo-tab-button ${i==="tasks"?"active":""}`,children:"Tasks"}),s.jsx("button",{onClick:()=>r("notifications"),className:`fo-tab-button ${i==="notifications"?"active":""}`,children:"Notifications"})]})}),s.jsx("main",{className:"p-4",children:f?s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx(g,{className:"h-8 w-8 animate-spin text-muted"})}):i==="tasks"?c.length>0?s.jsx("div",{className:"space-y-4",children:c.map(e=>s.jsxs("div",{className:"fo-task-card",children:[s.jsxs("div",{className:"fo-task-header",children:[s.jsx("p",{className:"fo-task-title",children:e.name}),s.jsx(T,{status:e.status})]}),s.jsx("p",{className:"text-sm text-gray-400 mb-2",children:e.description}),s.jsxs("div",{className:"fo-task-meta flex justify-between items-center",children:[s.jsxs("span",{children:["Due: ",e.dueDate?k(new Date(e.dueDate),"dd MMM, yyyy"):"N/A"]}),s.jsxs("span",{children:["Assigned by: ",u(e.id)]})]})]},e.id))}):s.jsxs("div",{className:"text-center text-muted pt-16",children:[s.jsx(v,{className:"h-12 w-12 mx-auto mb-4"}),s.jsx("p",{children:"You have no assigned tasks."})]}):o.length>0?s.jsx("div",{className:"divide-y divide-border",children:o.map(e=>s.jsxs("div",{className:"fo-notification-item",children:[s.jsx(m,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-grow",children:[s.jsx("p",{className:"text-sm text-gray-300",children:e.message}),s.jsx("p",{className:"text-xs text-muted mt-1",children:y(new Date(e.createdAt),{addSuffix:!0})})]})]},e.id))}):s.jsxs("div",{className:"text-center text-muted pt-16",children:[s.jsx(m,{className:"h-12 w-12 mx-auto mb-4"}),s.jsx("p",{children:"You have no notifications."})]})})]})};export{L as default};
