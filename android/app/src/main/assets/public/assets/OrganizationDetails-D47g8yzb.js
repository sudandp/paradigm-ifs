import{d as T,Q as k,e as r,u as v,h as I,k as q,c as C,o as M,m as b,j as e,C as y,I as p}from"./index-D5q3SS3D.js";import{m as E,b as n}from"./react-vendor-BUaIliXj.js";import{S as D}from"./Select-Dz12MdxG.js";import{F}from"./FormHeader-CSy2Sh-o.js";import{D as P}from"./DatePicker-D2ulOwJx.js";import"./ui-vendor-B8EvWqdc.js";import"./pdf-vendor-CB_F1AVu.js";import"./capacitor-vendor-CqiIOUn1.js";import"./utils-vendor-DmorxLnX.js";import"./supabase-7WG3J4rU.js";const V=T({designation:r().required("Designation is required"),department:r().required("Department is required"),reportingManager:r().optional(),organizationId:r().required("Organization is required"),organizationName:r().required(),joiningDate:r().required("Joining date is required"),workType:r().oneOf(["Full-time","Part-time","Contract",""]).required("Work type is required"),site:r().optional(),defaultSalary:k().nullable().optional()}).defined(),L=()=>{const{onValidated:w}=E(),{user:W}=v(),{data:o,updateOrganization:m}=I(),[s,N]=n.useState([]),S=q("(max-width: 767px)"),{register:a,handleSubmit:u,formState:{errors:i},control:x,watch:l,setValue:d,reset:h}=C({resolver:M(V),defaultValues:o.organization}),j=l("organizationId"),c=l("designation"),f=!!o.organization.organizationId;n.useEffect(()=>{b.getOrganizations().then(N)},[]),n.useEffect(()=>{h(o.organization)},[o.organization,h]),n.useEffect(()=>{let t;const g=l(O=>{clearTimeout(t),t=window.setTimeout(()=>{m(O)},500)});return()=>{g.unsubscribe(),clearTimeout(t)}},[l,m]),n.useEffect(()=>{const t=s.find(g=>g.id===j);t&&d("organizationName",t.shortName)},[j,s,d]),n.useEffect(()=>{c&&b.suggestDepartmentForDesignation(c).then(t=>{t&&d("department",t,{shouldValidate:!0})})},[c,d]);const z=async t=>{m(t),await w()};return S?e.jsx("form",{onSubmit:u(z),id:"organization-form",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Provide the employment details for the new employee within the organization."}),e.jsxs("select",{...a("organizationId"),className:"pro-select pro-select-arrow",disabled:f,children:[e.jsx("option",{value:"",children:"Select Organization"}),s.map(t=>e.jsx("option",{value:t.id,children:t.shortName},t.id))]}),i.organizationId&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:i.organizationId.message}),e.jsx("input",{placeholder:"Designation",...a("designation"),className:"form-input"}),e.jsx("input",{placeholder:"Department",...a("department"),className:"form-input"}),e.jsx("input",{placeholder:"Reporting Manager",...a("reportingManager"),className:"form-input"}),e.jsx(y,{name:"joiningDate",control:x,render:({field:t})=>e.jsx("input",{type:"date",...t,className:"form-input"})}),i.joiningDate&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:i.joiningDate.message}),e.jsxs("select",{...a("workType"),className:"pro-select pro-select-arrow",children:[e.jsx("option",{value:"",children:"Select Work Type"}),e.jsx("option",{children:"Full-time"}),e.jsx("option",{children:"Part-time"}),e.jsx("option",{children:"Contract"})]}),i.workType&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:i.workType.message})]})}):e.jsxs("form",{onSubmit:u(z),id:"organization-form",children:[e.jsx(F,{title:"Organization Details",subtitle:"Your employment details within the organization."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs(D,{label:"Organization / Client",id:"organizationId",error:i.organizationId?.message,registration:a("organizationId"),disabled:f,children:[e.jsx("option",{value:"",children:"Select Organization"}),s.map(t=>e.jsx("option",{value:t.id,children:t.shortName},t.id))]}),e.jsx(p,{label:"Designation",id:"designation",error:i.designation?.message,registration:a("designation")}),e.jsx(p,{label:"Department",id:"department",error:i.department?.message,registration:a("department")}),e.jsx(p,{label:"Reporting Manager",id:"reportingManager",error:i.reportingManager?.message,registration:a("reportingManager")}),e.jsx(y,{name:"joiningDate",control:x,render:({field:t})=>e.jsx(P,{label:"Joining Date",id:"joiningDate",error:i.joiningDate?.message,value:t.value,onChange:t.onChange})}),e.jsxs(D,{label:"Work Type",id:"workType",error:i.workType?.message,registration:a("workType"),children:[e.jsx("option",{value:"",children:"Select Work Type"}),e.jsx("option",{children:"Full-time"}),e.jsx("option",{children:"Part-time"}),e.jsx("option",{children:"Contract"})]})]})]})};export{L as default,V as organizationDetailsSchema};
