const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/html2pdf-DgNOHyuA.js","assets/react-vendor-BUaIliXj.js","assets/pdf-vendor-CB_F1AVu.js","assets/web-DIl_6ofK.js","assets/capacitor-vendor-CqiIOUn1.js","assets/web-DFsgDsj2.js","assets/web-DdzKuLpu.js","assets/web-DfiROD5f.js","assets/MobileHome-DvMZzb9m.js","assets/ui-vendor-B8EvWqdc.js","assets/utils-vendor-DmorxLnX.js","assets/supabase-7WG3J4rU.js","assets/SignUp-CgZH6UIl.js","assets/ForgotPassword-Be8dX0RA.js","assets/UpdatePassword-Dk-UEwrl.js","assets/LogoutPage-BL3YsEgz.js","assets/PendingApproval-BVzQNmOI.js","assets/Forbidden-CqfDhHrT.js","assets/OnboardingHome-7uXPC3j8.js","assets/SelectOrganization-BS1Rh8HL.js","assets/Select-Dz12MdxG.js","assets/AddEmployee-v9HI4aFl.js","assets/Modal-CR2aBU6L.js","assets/VerificationDashboard-CgoPTSYF.js","assets/StatusChip-B0urzFi1.js","assets/TableSkeleton-Bf5l1KHK.js","assets/Skeleton-D0WWmlnq.js","assets/UserManagement-B9oVnu4b.js","assets/AdminPageHeader-wINx_pXe.js","assets/Pagination-DXf7cs0z.js","assets/BulkEarnedLeavePage-CcmILS5W.js","assets/FileSaver.min-C7cHFFkD.js","assets/OrganizationManagement-DMlLuMJl.js","assets/SiteConfigurationForm-2Dtz1cgY.js","assets/UploadDocument-BAL6UInC.js","assets/CameraCaptureModal-DQDGRnEP.js","assets/DatePicker-D2ulOwJx.js","assets/RoleManagement-BD-VJiFD.js","assets/ModuleManagement-DeA2MKCR.js","assets/ManageDevices-BlLwMg2X.js","assets/DeviceApprovals-DVSyEptN.js","assets/date-D8dFQo9a.js","assets/ApiSettings-CCwevO3t.js","assets/OperationsDashboard-CurlJHLt.js","assets/index-BKlf32TQ.js","assets/FormHeader-CSy2Sh-o.js","assets/StatCard-Dc05kpHM.js","assets/TeamActivity-BciyKPV0.js","assets/OrganizationDashboard-CRIPAPIE.js","assets/ProfilePage-B-Pi3AuQ.js","assets/AvatarUpload-DpWQSSa-.js","assets/AttendanceDashboard-Bj6RrjXr.js","assets/excelExport-B_NduTpG.js","assets/LoadingScreen-_hPz2y_i.js","assets/DeviceManagement-hfP4nsSC.js","assets/UserDeviceList-Dt97HOJW.js","assets/MyLocations-CspCVhgi.js","assets/AttendanceActionPage-CjB9cwAb.js","assets/RequestUnlockPage-BF6CIrww.js","assets/AttendanceSettings-Bs2zYb92.js","assets/NotificationsControl-sGER1UlW.js","assets/LeaveDashboard-B5vHLFAq.js","assets/HolidayCalendar-ycAr_EbJ.js","assets/ApplyLeave-DUTIsD7c.js","assets/HolidaySelectionPage-DkqSM-fR.js","assets/LeaveManagement-D5qxd_s6.js","assets/ApprovalWorkflow-CJN5HKc6.js","assets/WorkflowChart2D-CpA107X_.js","assets/WorkflowChartFullScreen-Dxhr9eRO.js","assets/TaskManagement-fopUK55R.js","assets/taskStore-CL2IH4rv.js","assets/EntityManagement-twwj_kLn.js","assets/PoliciesAndInsurance-BBqny82A.js","assets/EnrollmentRules-DixbhbPk.js","assets/OnboardingPdfOutput-QeAiDRWP.js","assets/UniformDashboard-CZQ6-A8T.js","assets/CostAnalysis-CodL2GGe.js","assets/InvoiceSummary-D7o1zjDl.js","assets/SiteAttendanceTracker-D2v0HNBb.js","assets/AddSiteAttendanceRecord-B1gUyW9-.js","assets/SearchableSelect-B7rWk5GL.js","assets/SiteFinanceTracker-Be5marYg.js","assets/FinanceModule-xtG_O6lL.js","assets/AddSiteFinanceRecord-C0MWam4O.js","assets/FieldStaffTracking-zNqcmJK2.js","assets/leaflet-src-BVmFvWPy.js","assets/LocationManagement-C9g1JbVw.js","assets/PreUpload-BzKNvmw4.js","assets/aadhaarUtils-BdeQVFak.js","assets/MySubmissions-dL_yM6oK.js","assets/MyTasks-CK8lZgvn.js","assets/UniformRequests-BweRbW5G.js","assets/SupportDashboard-CW28u1zL.js","assets/TicketDetail-CzeobhCo.js","assets/MyTeamPage-arFBvHCj.js","assets/MyTeamPage-CIGW-MKW.css","assets/FieldReports-BXojswj4.js","assets/TeamMemberProfile-CC25EFSV.js","assets/ReportingStructure-BbvgHUg2.js","assets/AddUserPage-DCRe4cSu.js","assets/AddPolicyPage-BSAbM96I.js","assets/NewTicketPage-CVmiwMz5.js","assets/AddGroupPage-CLDvj6Iz.js","assets/GrantCompOffPage-DSpZ1gTz.js","assets/AddModulePage-bJW2qdhb.js","assets/AddRolePage-xA2ED8-S.js","assets/AddSitePage-CPwpV3FU.js","assets/QuickAddSitePage-DIgOF2vC.js","assets/AddTaskPage-DxPDH2Ew.js","assets/NewUniformRequestPage-7SibdCEL.js","assets/PersonalDetails-My488iGb.js","assets/VerifiedInput-CBziK85I.js","assets/AddressDetails-CWAeTC7o.js","assets/OrganizationDetails-D47g8yzb.js","assets/FamilyDetails-CG10O0Xj.js","assets/EducationDetails-UeehPtzR.js","assets/BankDetails-BEKWiAzN.js","assets/UanDetails-CpGMyNjz.js","assets/EsiDetails-CjnKa-pi.js","assets/GmcDetails-Ce2DN5Xf.js","assets/UniformDetails-BfCB4dDu.js","assets/Documents-DmeepZV1.js","assets/Biometrics-CaS5H3_H.js","assets/Review-BNHq7uaU.js","assets/AadhaarScannerPage-DcTHK4SC.js","assets/FormsSelection-Cadw7Ejp.js","assets/GMCForm-CpJXaeqk.js","assets/ImageViewerPage-DtbzNHK6.js","assets/pwa-action-sheet.entry-BW90n4zH.js","assets/pwa-camera-modal.entry-DhCuPX6t.js","assets/pwa-toast.entry-BRAaddZT.js","assets/pwa-camera-modal-instance.entry-D7XwVe-F.js","assets/pwa-camera.entry-fK-_DVFp.js"])))=>i.map(i=>d[i]);
import{r as Qu,B as Fr,C as Et,U as Ls,a as ed,L as ec,X as _r,b as ti,S as Bn,c as Lt,T as Ze,M as tc,d as Pn,e as Mn,f as Bi,F as Gi,I as Ln,g as Hi,h as td,i as nd,j as nc,k as zi,l as rd,m as vr,n as rc,o as id,p as sd,q as od,s as ad,t as ld,u as cd,v as ud,w as dd,G as fd,x as md,P as pd,y as hd,z as io,A as so,H as ic,D as gd,E as sc,J as yd,K as _d,N as vd,O as wd,Q as wr,R as xd,V as bd,W as Cd,Y as Td,Z as Sd,_ as Ed,$ as Wi,a0 as Ad,a1 as Ji,a2 as kd,a3 as Id,a4 as Nd,a5 as Rd,a6 as Dd,a7 as Pd}from"./ui-vendor-B8EvWqdc.js";import{d as Md,a as oc,b as U,u as Jn,e as Ut,L as xr,R as Z,N as ac,f as kt,O as Or,h as Ld,i as R,H as $d}from"./react-vendor-BUaIliXj.js";import{_ as F}from"./pdf-vendor-CB_F1AVu.js";import{P as Ve,C as Xe,G as At,r as Vr,a as oo}from"./capacitor-vendor-CqiIOUn1.js";import{d as Wt,s as rn,e as An,f as we,a as Xn,b as Fd,g as Od,c as ao,h as lo,i as Vd,j as gt,p as bt,k as Ud,l as qd,m as ni}from"./utils-vendor-DmorxLnX.js";import{c as jd}from"./supabase-7WG3J4rU.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var f=Qu(),Qn={},co;function Bd(){if(co)return Qn;co=1;var n=Md();return Qn.createRoot=n.createRoot,Qn.hydrateRoot=n.hydrateRoot,Qn}var Gd=Bd();const Hd=oc(Gd),zd="https://fmyafuhxlorbafbacywa.supabase.co",Wd="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZteWFmdWh4bG9yYmFmYmFjeXdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyMjg1NDYsImV4cCI6MjA3NzgwNDU0Nn0.RqsniEqzNec6ww35TXJtLJD3mafnGbMI82om4XRUdUU",Jd=zd,Yd=Wd,Kd={getItem:async n=>{const{value:e}=await Ve.get({key:n});return e},setItem:async(n,e)=>{await Ve.set({key:n,value:e})},removeItem:async n=>{await Ve.remove({key:n})}},g=jd(Jd,Yd,{auth:{persistSession:!0,storage:Kd,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"}}),Zd=async n=>{try{let{data:e,error:t}=await g.from("users").select("*, role:roles(display_name)").eq("id",n.id).single();if(t&&t.code==="PGRST116"){const o={id:n.id,name:n.user_metadata.name||"New User",email:n.email,role_id:"unverified"},{data:a,error:d}=await g.from("users").insert(o).select("*, role:roles(display_name)").single();if(d)return console.error("Error creating user profile on-the-fly:",d.message,d),null;e=a,t=null}if(t)return console.error("Error fetching app profile:",t.message,t),null;const r=e.role,i=(Array.isArray(r)?r[0]?.display_name:r?.display_name)||e.role_id,s=typeof i=="string"?i.toLowerCase().replace(/\s+/g,"_"):i;return{id:e.id,name:e.name,email:n.email||"",phone:e.phone,role:s,roleId:e.role_id,organizationId:e.organization_id,organizationName:e.organization_name,reportingManagerId:e.reporting_manager_id,reportingManager2Id:e.reporting_manager_2_id,reportingManager3Id:e.reporting_manager_3_id,photoUrl:e.photo_url}}catch(e){return console.error("Exception fetching profile:",e),null}},Xd=async(n,e)=>await g.auth.signInWithPassword({email:n,password:e}),Qd=async({email:n,password:e,options:t})=>await g.auth.signUp({email:n,password:e,options:{...t,emailRedirectTo:`${window.location.origin}/`}}),ef=async(n,e)=>await g.from("users").update({role_id:e}).eq("id",n),tf=async()=>{const n=window.location.origin,e=n.endsWith("/")?n:`${n}/`;return console.log("Initiating Google Sign-In..."),console.log("Current Origin:",n),console.log("Target Redirect URL:",e),(e.includes("localhost")||e.includes("127.0.0.1"))&&(window.location.protocol==="https:"?(console.log("Environment: Production/Secure Local. Redirect URL is: "+e),console.warn("IMPORTANT: Ensure '"+e+"' is added to your Supabase Redirect URLs.")):console.warn("WARNING: You are using 'localhost' or '127.0.0.1' as the redirect URL. This may fail if there is a mismatch between the host used to access the app and the one whitelisted in Supabase.")),await g.auth.signInWithOAuth({provider:"google",options:{redirectTo:e,queryParams:{prompt:"select_account"}}})},nf=async()=>{const{error:n}=await g.auth.signOut();n&&console.error("Error signing out:",n.message)},rf=async n=>{const e=window.location.origin;return await g.auth.resetPasswordForEmail(n,{redirectTo:e})},sf=async n=>await g.auth.updateUser({password:n}),lt={getAppUserProfile:Zd,signInWithPassword:Xd,signUpWithPassword:Qd,signInWithGoogle:tf,signOut:nf,resetPasswordForEmail:rf,updateUserPassword:sf,approveUser:ef},Be=async(n,e)=>{try{const{data:t,error:r}=await g.from("notification_rules").select("*, send_alert").order("created_at",{ascending:!1});if(r)throw r;const s=(t||[]).map(a=>({id:a.id,eventType:a.event_type,recipientRole:a.recipient_role,recipientUserId:a.recipient_user_id,isEnabled:a.is_enabled,sendAlert:a.send_alert})).filter(a=>a.eventType===n&&a.isEnabled),o=new Map;for(const a of s){const d=async u=>{const m=o.get(u);o.set(u,m||a.sendAlert||!1)};if(a.recipientUserId)if(a.recipientUserId==="all"){const{data:u,error:m}=await g.from("users").select("id");if(!m&&u)for(const p of u)await d(p.id)}else await d(a.recipientUserId);else if(a.recipientRole)if(a.recipientRole==="direct_manager")e.actor.reportingManagerId&&await d(e.actor.reportingManagerId);else{const{data:u,error:m}=await g.from("users").select("id").eq("role",a.recipientRole);if(!m&&u)for(const p of u)await d(p.id)}}if(o.delete(e.actor.id),o.size>0){const a=`${e.actorName} ${e.actionText}${e.locString}`,d=Array.from(o.entries()).map(([u,m])=>({user_id:u,message:a,type:m?"security":of(n),link_to:e.link}));await g.from("notifications").insert(d)}}catch(t){console.warn(`Failed to dispatch notifications for ${n}:`,t)}},of=n=>n==="violation"||n.includes("rejected")||n.includes("security")?"security":n.includes("task")?"task_assigned":n.includes("request")?"approval_request":n==="greeting"?"greeting":"info";function af(n){const e=n.filter(p=>p.type==="check-in"||p.type==="check-out").sort((p,h)=>new Date(p.timestamp).getTime()-new Date(h.timestamp).getTime());let t=0,r=0,i=0,s=null,o=null;for(const p of e){const h=new Date(p.timestamp);if(p.type==="check-in"){if(s){const y=Wt(h,s);r+=Math.max(0,y)}o=h,i++}else if(p.type==="check-out"){if(o){const y=Wt(h,o);t+=Math.max(0,y),o=null}s=h}}const a=t+r,d=a/60,u=t/60,m=r/60;return{totalHours:d,siteHours:u,travelHours:m,sitePercentage:a>0?t/a*100:0,travelPercentage:a>0?r/a*100:0,siteVisits:i}}function lf(n,e){const t=[];n.sitePercentage<e.minimumSitePercentage&&t.push("site_time_low");let r="A";return n.totalHours>=e.minimumHoursFullDay?r="P":n.totalHours>=e.minimumHoursHalfDay&&(r="1/2P",t.includes("insufficient_hours")||t.push("insufficient_hours")),{isValid:t.length===0,violations:t,status:r}}var ye;(function(n){n.assertEqual=i=>{};function e(i){}n.assertIs=e;function t(i){throw new Error}n.assertNever=t,n.arrayToEnum=i=>{const s={};for(const o of i)s[o]=o;return s},n.getValidEnumValues=i=>{const s=n.objectKeys(i).filter(a=>typeof i[i[a]]!="number"),o={};for(const a of s)o[a]=i[a];return n.objectValues(o)},n.objectValues=i=>n.objectKeys(i).map(function(s){return i[s]}),n.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&s.push(o);return s},n.find=(i,s)=>{for(const o of i)if(s(o))return o},n.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}n.joinValues=r,n.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(ye||(ye={}));var uo;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(uo||(uo={}));const te=ye.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ft=n=>{switch(typeof n){case"undefined":return te.undefined;case"string":return te.string;case"number":return Number.isNaN(n)?te.nan:te.number;case"boolean":return te.boolean;case"function":return te.function;case"bigint":return te.bigint;case"symbol":return te.symbol;case"object":return Array.isArray(n)?te.array:n===null?te.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?te.promise:typeof Map<"u"&&n instanceof Map?te.map:typeof Set<"u"&&n instanceof Set?te.set:typeof Date<"u"&&n instanceof Date?te.date:te.object;default:return te.unknown}},G=ye.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Nt extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(s){return s.message},r={_errors:[]},i=s=>{for(const o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let a=r,d=0;for(;d<o.path.length;){const u=o.path[d];d===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(t(o))):a[u]=a[u]||{_errors:[]},a=a[u],d++}}};return i(this),r}static assert(e){if(!(e instanceof Nt))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ye.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const i of this.issues)if(i.path.length>0){const s=i.path[0];t[s]=t[s]||[],t[s].push(e(i))}else r.push(e(i));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Nt.create=n=>new Nt(n);const Yi=(n,e)=>{let t;switch(n.code){case G.invalid_type:n.received===te.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case G.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,ye.jsonStringifyReplacer)}`;break;case G.unrecognized_keys:t=`Unrecognized key(s) in object: ${ye.joinValues(n.keys,", ")}`;break;case G.invalid_union:t="Invalid input";break;case G.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${ye.joinValues(n.options)}`;break;case G.invalid_enum_value:t=`Invalid enum value. Expected ${ye.joinValues(n.options)}, received '${n.received}'`;break;case G.invalid_arguments:t="Invalid function arguments";break;case G.invalid_return_type:t="Invalid function return type";break;case G.invalid_date:t="Invalid date";break;case G.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:ye.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case G.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case G.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case G.custom:t="Invalid input";break;case G.invalid_intersection_types:t="Intersection results could not be merged";break;case G.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case G.not_finite:t="Number must be finite";break;default:t=e.defaultError,ye.assertNever(n)}return{message:t}};let cf=Yi;function uf(){return cf}const df=n=>{const{data:e,path:t,errorMaps:r,issueData:i}=n,s=[...t,...i.path||[]],o={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let a="";const d=r.filter(u=>!!u).slice().reverse();for(const u of d)a=u(o,{data:e,defaultError:a}).message;return{...i,path:s,message:a}};function X(n,e){const t=uf(),r=df({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===Yi?void 0:Yi].filter(i=>!!i)});n.common.issues.push(r)}class We{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const i of t){if(i.status==="aborted")return de;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const i of t){const s=await i.key,o=await i.value;r.push({key:s,value:o})}return We.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const i of t){const{key:s,value:o}=i;if(s.status==="aborted"||o.status==="aborted")return de;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(r[s.value]=o.value)}return{status:e.value,value:r}}}const de=Object.freeze({status:"aborted"}),$n=n=>({status:"dirty",value:n}),at=n=>({status:"valid",value:n}),fo=n=>n.status==="aborted",mo=n=>n.status==="dirty",yn=n=>n.status==="valid",br=n=>typeof Promise<"u"&&n instanceof Promise;var re;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e?.message})(re||(re={}));class xt{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const po=(n,e)=>{if(yn(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Nt(n.common.issues);return this._error=t,this._error}}};function fe(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:i}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(o,a)=>{const{message:d}=n;return o.code==="invalid_enum_value"?{message:d??a.defaultError}:typeof a.data>"u"?{message:d??r??a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:d??t??a.defaultError}},description:i}}class ge{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new We,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(br(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){const r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parseSync({data:e,path:r.path,parent:r});return po(r,i)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:t});return yn(r)?{value:r.value}:{issues:t.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(r=>yn(r)?{value:r.value}:{issues:t.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},i=this._parse({data:e,path:r.path,parent:r}),s=await(br(i)?i:Promise.resolve(i));return po(r,s)}refine(e,t){const r=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,s)=>{const o=e(i),a=()=>s.addIssue({code:G.custom,...r(i)});return typeof Promise<"u"&&o instanceof Promise?o.then(d=>d?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof t=="function"?t(r,i):t),!1))}_refinement(e){return new wn({schema:this,typeName:ue.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Ot.create(this,this._def)}nullable(){return xn.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return wt.create(this)}promise(){return Ar.create(this,this._def)}or(e){return Tr.create([this,e],this._def)}and(e){return Sr.create(this,e,this._def)}transform(e){return new wn({...fe(this._def),schema:this,typeName:ue.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Qi({...fe(this._def),innerType:this,defaultValue:t,typeName:ue.ZodDefault})}brand(){return new Mf({typeName:ue.ZodBranded,type:this,...fe(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new es({...fe(this._def),innerType:this,catchValue:t,typeName:ue.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return $s.create(this,e)}readonly(){return ts.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const ff=/^c[^\s-]{8,}$/i,mf=/^[0-9a-z]+$/,pf=/^[0-9A-HJKMNP-TV-Z]{26}$/i,hf=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,gf=/^[a-z0-9_-]{21}$/i,yf=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,_f=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,vf=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,wf="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ri;const xf=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,bf=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Cf=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Tf=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Sf=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ef=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,lc="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Af=new RegExp(`^${lc}$`);function cc(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);const t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function kf(n){return new RegExp(`^${cc(n)}$`)}function If(n){let e=`${lc}T${cc(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Nf(n,e){return!!((e==="v4"||!e)&&xf.test(n)||(e==="v6"||!e)&&Cf.test(n))}function Rf(n,e){if(!yf.test(n))return!1;try{const[t]=n.split(".");if(!t)return!1;const r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&i?.typ!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function Df(n,e){return!!((e==="v4"||!e)&&bf.test(n)||(e==="v6"||!e)&&Tf.test(n))}class vt extends ge{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==te.string){const s=this._getOrReturnCtx(e);return X(s,{code:G.invalid_type,expected:te.string,received:s.parsedType}),de}const r=new We;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),X(i,{code:G.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),X(i,{code:G.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(i=this._getOrReturnCtx(e,i),o?X(i,{code:G.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&X(i,{code:G.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")vf.test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"email",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")ri||(ri=new RegExp(wf,"u")),ri.test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"emoji",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")hf.test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"uuid",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")gf.test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"nanoid",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")ff.test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"cuid",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")mf.test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"cuid2",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")pf.test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"ulid",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),X(i,{validation:"url",code:G.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"regex",code:G.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),X(i,{code:G.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),X(i,{code:G.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),X(i,{code:G.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?If(s).test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{code:G.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?Af.test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{code:G.invalid_string,validation:"date",message:s.message}),r.dirty()):s.kind==="time"?kf(s).test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{code:G.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?_f.test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"duration",code:G.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?Nf(e.data,s.version)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"ip",code:G.invalid_string,message:s.message}),r.dirty()):s.kind==="jwt"?Rf(e.data,s.alg)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"jwt",code:G.invalid_string,message:s.message}),r.dirty()):s.kind==="cidr"?Df(e.data,s.version)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"cidr",code:G.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?Sf.test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"base64",code:G.invalid_string,message:s.message}),r.dirty()):s.kind==="base64url"?Ef.test(e.data)||(i=this._getOrReturnCtx(e,i),X(i,{validation:"base64url",code:G.invalid_string,message:s.message}),r.dirty()):ye.assertNever(s);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(i=>e.test(i),{validation:t,code:G.invalid_string,...re.errToObj(r)})}_addCheck(e){return new vt({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...re.errToObj(e)})}url(e){return this._addCheck({kind:"url",...re.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...re.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...re.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...re.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...re.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...re.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...re.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...re.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...re.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...re.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...re.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...re.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...re.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...re.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...re.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...re.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...re.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...re.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...re.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...re.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...re.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...re.errToObj(t)})}nonempty(e){return this.min(1,re.errToObj(e))}trim(){return new vt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new vt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new vt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}vt.create=n=>new vt({checks:[],typeName:ue.ZodString,coerce:n?.coerce??!1,...fe(n)});function Pf(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=t>r?t:r,s=Number.parseInt(n.toFixed(i).replace(".","")),o=Number.parseInt(e.toFixed(i).replace(".",""));return s%o/10**i}class Kt extends ge{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==te.number){const s=this._getOrReturnCtx(e);return X(s,{code:G.invalid_type,expected:te.number,received:s.parsedType}),de}let r;const i=new We;for(const s of this._def.checks)s.kind==="int"?ye.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{code:G.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),X(r,{code:G.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),X(r,{code:G.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?Pf(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),X(r,{code:G.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{code:G.not_finite,message:s.message}),i.dirty()):ye.assertNever(s);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,re.toString(t))}gt(e,t){return this.setLimit("min",e,!1,re.toString(t))}lte(e,t){return this.setLimit("max",e,!0,re.toString(t))}lt(e,t){return this.setLimit("max",e,!1,re.toString(t))}setLimit(e,t,r,i){return new Kt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:re.toString(i)}]})}_addCheck(e){return new Kt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:re.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:re.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:re.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:re.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:re.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:re.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:re.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:re.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:re.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ye.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Kt.create=n=>new Kt({checks:[],typeName:ue.ZodNumber,coerce:n?.coerce||!1,...fe(n)});class Zt extends ge{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==te.bigint)return this._getInvalidInput(e);let r;const i=new We;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),X(r,{code:G.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),X(r,{code:G.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),X(r,{code:G.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):ye.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:te.bigint,received:t.parsedType}),de}gte(e,t){return this.setLimit("min",e,!0,re.toString(t))}gt(e,t){return this.setLimit("min",e,!1,re.toString(t))}lte(e,t){return this.setLimit("max",e,!0,re.toString(t))}lt(e,t){return this.setLimit("max",e,!1,re.toString(t))}setLimit(e,t,r,i){return new Zt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:re.toString(i)}]})}_addCheck(e){return new Zt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:re.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:re.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:re.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:re.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:re.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Zt.create=n=>new Zt({checks:[],typeName:ue.ZodBigInt,coerce:n?.coerce??!1,...fe(n)});class Cr extends ge{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==te.boolean){const r=this._getOrReturnCtx(e);return X(r,{code:G.invalid_type,expected:te.boolean,received:r.parsedType}),de}return at(e.data)}}Cr.create=n=>new Cr({typeName:ue.ZodBoolean,coerce:n?.coerce||!1,...fe(n)});class _n extends ge{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==te.date){const s=this._getOrReturnCtx(e);return X(s,{code:G.invalid_type,expected:te.date,received:s.parsedType}),de}if(Number.isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return X(s,{code:G.invalid_date}),de}const r=new We;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),X(i,{code:G.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),X(i,{code:G.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):ye.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new _n({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:re.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:re.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}_n.create=n=>new _n({checks:[],coerce:n?.coerce||!1,typeName:ue.ZodDate,...fe(n)});class ho extends ge{_parse(e){if(this._getType(e)!==te.symbol){const r=this._getOrReturnCtx(e);return X(r,{code:G.invalid_type,expected:te.symbol,received:r.parsedType}),de}return at(e.data)}}ho.create=n=>new ho({typeName:ue.ZodSymbol,...fe(n)});class go extends ge{_parse(e){if(this._getType(e)!==te.undefined){const r=this._getOrReturnCtx(e);return X(r,{code:G.invalid_type,expected:te.undefined,received:r.parsedType}),de}return at(e.data)}}go.create=n=>new go({typeName:ue.ZodUndefined,...fe(n)});class yo extends ge{_parse(e){if(this._getType(e)!==te.null){const r=this._getOrReturnCtx(e);return X(r,{code:G.invalid_type,expected:te.null,received:r.parsedType}),de}return at(e.data)}}yo.create=n=>new yo({typeName:ue.ZodNull,...fe(n)});class _o extends ge{constructor(){super(...arguments),this._any=!0}_parse(e){return at(e.data)}}_o.create=n=>new _o({typeName:ue.ZodAny,...fe(n)});class Ki extends ge{constructor(){super(...arguments),this._unknown=!0}_parse(e){return at(e.data)}}Ki.create=n=>new Ki({typeName:ue.ZodUnknown,...fe(n)});class Vt extends ge{_parse(e){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:te.never,received:t.parsedType}),de}}Vt.create=n=>new Vt({typeName:ue.ZodNever,...fe(n)});class vo extends ge{_parse(e){if(this._getType(e)!==te.undefined){const r=this._getOrReturnCtx(e);return X(r,{code:G.invalid_type,expected:te.void,received:r.parsedType}),de}return at(e.data)}}vo.create=n=>new vo({typeName:ue.ZodVoid,...fe(n)});class wt extends ge{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),i=this._def;if(t.parsedType!==te.array)return X(t,{code:G.invalid_type,expected:te.array,received:t.parsedType}),de;if(i.exactLength!==null){const o=t.data.length>i.exactLength.value,a=t.data.length<i.exactLength.value;(o||a)&&(X(t,{code:o?G.too_big:G.too_small,minimum:a?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&(X(t,{code:G.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&(X(t,{code:G.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>i.type._parseAsync(new xt(t,o,t.path,a)))).then(o=>We.mergeArray(r,o));const s=[...t.data].map((o,a)=>i.type._parseSync(new xt(t,o,t.path,a)));return We.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new wt({...this._def,minLength:{value:e,message:re.toString(t)}})}max(e,t){return new wt({...this._def,maxLength:{value:e,message:re.toString(t)}})}length(e,t){return new wt({...this._def,exactLength:{value:e,message:re.toString(t)}})}nonempty(e){return this.min(1,e)}}wt.create=(n,e)=>new wt({type:n,minLength:null,maxLength:null,exactLength:null,typeName:ue.ZodArray,...fe(e)});function un(n){if(n instanceof Fe){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=Ot.create(un(r))}return new Fe({...n._def,shape:()=>e})}else return n instanceof wt?new wt({...n._def,type:un(n.element)}):n instanceof Ot?Ot.create(un(n.unwrap())):n instanceof xn?xn.create(un(n.unwrap())):n instanceof Xt?Xt.create(n.items.map(e=>un(e))):n}class Fe extends ge{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=ye.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==te.object){const u=this._getOrReturnCtx(e);return X(u,{code:G.invalid_type,expected:te.object,received:u.parsedType}),de}const{status:r,ctx:i}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Vt&&this._def.unknownKeys==="strip"))for(const u in i.data)o.includes(u)||a.push(u);const d=[];for(const u of o){const m=s[u],p=i.data[u];d.push({key:{status:"valid",value:u},value:m._parse(new xt(i,p,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof Vt){const u=this._def.unknownKeys;if(u==="passthrough")for(const m of a)d.push({key:{status:"valid",value:m},value:{status:"valid",value:i.data[m]}});else if(u==="strict")a.length>0&&(X(i,{code:G.unrecognized_keys,keys:a}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const m of a){const p=i.data[m];d.push({key:{status:"valid",value:m},value:u._parse(new xt(i,p,i.path,m)),alwaysSet:m in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const u=[];for(const m of d){const p=await m.key,h=await m.value;u.push({key:p,value:h,alwaysSet:m.alwaysSet})}return u}).then(u=>We.mergeObjectSync(r,u)):We.mergeObjectSync(r,d)}get shape(){return this._def.shape()}strict(e){return re.errToObj,new Fe({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{const i=this._def.errorMap?.(t,r).message??r.defaultError;return t.code==="unrecognized_keys"?{message:re.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new Fe({...this._def,unknownKeys:"strip"})}passthrough(){return new Fe({...this._def,unknownKeys:"passthrough"})}extend(e){return new Fe({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Fe({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ue.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Fe({...this._def,catchall:e})}pick(e){const t={};for(const r of ye.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new Fe({...this._def,shape:()=>t})}omit(e){const t={};for(const r of ye.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new Fe({...this._def,shape:()=>t})}deepPartial(){return un(this)}partial(e){const t={};for(const r of ye.objectKeys(this.shape)){const i=this.shape[r];e&&!e[r]?t[r]=i:t[r]=i.optional()}return new Fe({...this._def,shape:()=>t})}required(e){const t={};for(const r of ye.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof Ot;)s=s._def.innerType;t[r]=s}return new Fe({...this._def,shape:()=>t})}keyof(){return uc(ye.objectKeys(this.shape))}}Fe.create=(n,e)=>new Fe({shape:()=>n,unknownKeys:"strip",catchall:Vt.create(),typeName:ue.ZodObject,...fe(e)});Fe.strictCreate=(n,e)=>new Fe({shape:()=>n,unknownKeys:"strict",catchall:Vt.create(),typeName:ue.ZodObject,...fe(e)});Fe.lazycreate=(n,e)=>new Fe({shape:n,unknownKeys:"strip",catchall:Vt.create(),typeName:ue.ZodObject,...fe(e)});class Tr extends ge{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function i(s){for(const a of s)if(a.result.status==="valid")return a.result;for(const a of s)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;const o=s.map(a=>new Nt(a.ctx.common.issues));return X(t,{code:G.invalid_union,unionErrors:o}),de}if(t.common.async)return Promise.all(r.map(async s=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await s._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(i);{let s;const o=[];for(const d of r){const u={...t,common:{...t.common,issues:[]},parent:null},m=d._parseSync({data:t.data,path:t.path,parent:u});if(m.status==="valid")return m;m.status==="dirty"&&!s&&(s={result:m,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(s)return t.common.issues.push(...s.ctx.common.issues),s.result;const a=o.map(d=>new Nt(d));return X(t,{code:G.invalid_union,unionErrors:a}),de}}get options(){return this._def.options}}Tr.create=(n,e)=>new Tr({options:n,typeName:ue.ZodUnion,...fe(e)});function Zi(n,e){const t=Ft(n),r=Ft(e);if(n===e)return{valid:!0,data:n};if(t===te.object&&r===te.object){const i=ye.objectKeys(e),s=ye.objectKeys(n).filter(a=>i.indexOf(a)!==-1),o={...n,...e};for(const a of s){const d=Zi(n[a],e[a]);if(!d.valid)return{valid:!1};o[a]=d.data}return{valid:!0,data:o}}else if(t===te.array&&r===te.array){if(n.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<n.length;s++){const o=n[s],a=e[s],d=Zi(o,a);if(!d.valid)return{valid:!1};i.push(d.data)}return{valid:!0,data:i}}else return t===te.date&&r===te.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class Sr extends ge{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),i=(s,o)=>{if(fo(s)||fo(o))return de;const a=Zi(s.value,o.value);return a.valid?((mo(s)||mo(o))&&t.dirty(),{status:t.value,value:a.data}):(X(r,{code:G.invalid_intersection_types}),de)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,o])=>i(s,o)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Sr.create=(n,e,t)=>new Sr({left:n,right:e,typeName:ue.ZodIntersection,...fe(t)});class Xt extends ge{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==te.array)return X(r,{code:G.invalid_type,expected:te.array,received:r.parsedType}),de;if(r.data.length<this._def.items.length)return X(r,{code:G.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),de;!this._def.rest&&r.data.length>this._def.items.length&&(X(r,{code:G.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const s=[...r.data].map((o,a)=>{const d=this._def.items[a]||this._def.rest;return d?d._parse(new xt(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(s).then(o=>We.mergeArray(t,o)):We.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new Xt({...this._def,rest:e})}}Xt.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Xt({items:n,typeName:ue.ZodTuple,rest:null,...fe(e)})};class Er extends ge{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==te.object)return X(r,{code:G.invalid_type,expected:te.object,received:r.parsedType}),de;const i=[],s=this._def.keyType,o=this._def.valueType;for(const a in r.data)i.push({key:s._parse(new xt(r,a,r.path,a)),value:o._parse(new xt(r,r.data[a],r.path,a)),alwaysSet:a in r.data});return r.common.async?We.mergeObjectAsync(t,i):We.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof ge?new Er({keyType:e,valueType:t,typeName:ue.ZodRecord,...fe(r)}):new Er({keyType:vt.create(),valueType:e,typeName:ue.ZodRecord,...fe(t)})}}class wo extends ge{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==te.map)return X(r,{code:G.invalid_type,expected:te.map,received:r.parsedType}),de;const i=this._def.keyType,s=this._def.valueType,o=[...r.data.entries()].map(([a,d],u)=>({key:i._parse(new xt(r,a,r.path,[u,"key"])),value:s._parse(new xt(r,d,r.path,[u,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const d of o){const u=await d.key,m=await d.value;if(u.status==="aborted"||m.status==="aborted")return de;(u.status==="dirty"||m.status==="dirty")&&t.dirty(),a.set(u.value,m.value)}return{status:t.value,value:a}})}else{const a=new Map;for(const d of o){const u=d.key,m=d.value;if(u.status==="aborted"||m.status==="aborted")return de;(u.status==="dirty"||m.status==="dirty")&&t.dirty(),a.set(u.value,m.value)}return{status:t.value,value:a}}}}wo.create=(n,e,t)=>new wo({valueType:e,keyType:n,typeName:ue.ZodMap,...fe(t)});class Gn extends ge{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==te.set)return X(r,{code:G.invalid_type,expected:te.set,received:r.parsedType}),de;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(X(r,{code:G.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(X(r,{code:G.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const s=this._def.valueType;function o(d){const u=new Set;for(const m of d){if(m.status==="aborted")return de;m.status==="dirty"&&t.dirty(),u.add(m.value)}return{status:t.value,value:u}}const a=[...r.data.values()].map((d,u)=>s._parse(new xt(r,d,r.path,u)));return r.common.async?Promise.all(a).then(d=>o(d)):o(a)}min(e,t){return new Gn({...this._def,minSize:{value:e,message:re.toString(t)}})}max(e,t){return new Gn({...this._def,maxSize:{value:e,message:re.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Gn.create=(n,e)=>new Gn({valueType:n,minSize:null,maxSize:null,typeName:ue.ZodSet,...fe(e)});class Xi extends ge{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Xi.create=(n,e)=>new Xi({getter:n,typeName:ue.ZodLazy,...fe(e)});class xo extends ge{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return X(t,{received:t.data,code:G.invalid_literal,expected:this._def.value}),de}return{status:"valid",value:e.data}}get value(){return this._def.value}}xo.create=(n,e)=>new xo({value:n,typeName:ue.ZodLiteral,...fe(e)});function uc(n,e){return new vn({values:n,typeName:ue.ZodEnum,...fe(e)})}class vn extends ge{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return X(t,{expected:ye.joinValues(r),received:t.parsedType,code:G.invalid_type}),de}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return X(t,{received:t.data,code:G.invalid_enum_value,options:r}),de}return at(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return vn.create(e,{...this._def,...t})}exclude(e,t=this._def){return vn.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}vn.create=uc;class bo extends ge{_parse(e){const t=ye.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==te.string&&r.parsedType!==te.number){const i=ye.objectValues(t);return X(r,{expected:ye.joinValues(i),received:r.parsedType,code:G.invalid_type}),de}if(this._cache||(this._cache=new Set(ye.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const i=ye.objectValues(t);return X(r,{received:r.data,code:G.invalid_enum_value,options:i}),de}return at(e.data)}get enum(){return this._def.values}}bo.create=(n,e)=>new bo({values:n,typeName:ue.ZodNativeEnum,...fe(e)});class Ar extends ge{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==te.promise&&t.common.async===!1)return X(t,{code:G.invalid_type,expected:te.promise,received:t.parsedType}),de;const r=t.parsedType===te.promise?t.data:Promise.resolve(t.data);return at(r.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Ar.create=(n,e)=>new Ar({type:n,typeName:ue.ZodPromise,...fe(e)});class wn extends ge{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ue.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:o=>{X(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const o=i.transform(r.data,s);if(r.common.async)return Promise.resolve(o).then(async a=>{if(t.value==="aborted")return de;const d=await this._def.schema._parseAsync({data:a,path:r.path,parent:r});return d.status==="aborted"?de:d.status==="dirty"||t.value==="dirty"?$n(d.value):d});{if(t.value==="aborted")return de;const a=this._def.schema._parseSync({data:o,path:r.path,parent:r});return a.status==="aborted"?de:a.status==="dirty"||t.value==="dirty"?$n(a.value):a}}if(i.type==="refinement"){const o=a=>{const d=i.refinement(a,s);if(r.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?de:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?de:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(i.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!yn(o))return de;const a=i.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>yn(o)?Promise.resolve(i.transform(o.value,s)).then(a=>({status:t.value,value:a})):de);ye.assertNever(i)}}wn.create=(n,e,t)=>new wn({schema:n,typeName:ue.ZodEffects,effect:e,...fe(t)});wn.createWithPreprocess=(n,e,t)=>new wn({schema:e,effect:{type:"preprocess",transform:n},typeName:ue.ZodEffects,...fe(t)});class Ot extends ge{_parse(e){return this._getType(e)===te.undefined?at(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ot.create=(n,e)=>new Ot({innerType:n,typeName:ue.ZodOptional,...fe(e)});class xn extends ge{_parse(e){return this._getType(e)===te.null?at(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}xn.create=(n,e)=>new xn({innerType:n,typeName:ue.ZodNullable,...fe(e)});class Qi extends ge{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===te.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Qi.create=(n,e)=>new Qi({innerType:n,typeName:ue.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...fe(e)});class es extends ge{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return br(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Nt(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Nt(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}es.create=(n,e)=>new es({innerType:n,typeName:ue.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...fe(e)});class Co extends ge{_parse(e){if(this._getType(e)!==te.nan){const r=this._getOrReturnCtx(e);return X(r,{code:G.invalid_type,expected:te.nan,received:r.parsedType}),de}return{status:"valid",value:e.data}}}Co.create=n=>new Co({typeName:ue.ZodNaN,...fe(n)});class Mf extends ge{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class $s extends ge{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?de:s.status==="dirty"?(t.dirty(),$n(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?de:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,t){return new $s({in:e,out:t,typeName:ue.ZodPipeline})}}class ts extends ge{_parse(e){const t=this._def.innerType._parse(e),r=i=>(yn(i)&&(i.value=Object.freeze(i.value)),i);return br(t)?t.then(i=>r(i)):r(t)}unwrap(){return this._def.innerType}}ts.create=(n,e)=>new ts({innerType:n,typeName:ue.ZodReadonly,...fe(e)});var ue;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(ue||(ue={}));const Ht=vt.create,To=Kt.create;Zt.create;const Lf=Cr.create;_n.create;const So=Ki.create;Vt.create;const Fn=wt.create,$f=Fe.create,Ff=Tr.create;Sr.create;Xt.create;const Of=Er.create,Vf=Xi.create,Uf=vn.create;Ar.create;Ot.create;xn.create;const sn={string:(n=>vt.create({...n,coerce:!0})),number:(n=>Kt.create({...n,coerce:!0})),boolean:(n=>Cr.create({...n,coerce:!0})),bigint:(n=>Zt.create({...n,coerce:!0})),date:(n=>_n.create({...n,coerce:!0}))};let qf,jf;function Bf(){return{geminiUrl:qf,vertexUrl:jf}}function Gf(n,e,t){var r,i,s;if(!(!((r=n.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=Bf();return n.vertexai?(i=o.vertexUrl)!==null&&i!==void 0?i:e:(s=o.geminiUrl)!==null&&s!==void 0?s:t}return n.httpOptions.baseUrl}class Yn{}function ce(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function c(n,e,t){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in n))if(Array.isArray(t))n[a]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[a])){const d=n[a];if(Array.isArray(t))for(let u=0;u<d.length;u++){const m=d[u];c(m,e.slice(s+1),t[u])}else for(const u of d)c(u,e.slice(s+1),t)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in n||(n[a]=[{}]);const d=n[a];c(d[0],e.slice(s+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const r=e[e.length-1],i=n[r];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else n[r]=t}function l(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const r=e[t];if(r.endsWith("[]")){const i=r.slice(0,-2);if(i in n){const s=n[i];return Array.isArray(s)?s.map(o=>l(o,e.slice(t+1))):void 0}else return}else n=n[r]}return n}catch(t){if(t instanceof TypeError)return;throw t}}var Eo;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Eo||(Eo={}));var Ao;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Ao||(Ao={}));var ko;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(ko||(ko={}));var Io;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Io||(Io={}));var No;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(No||(No={}));var He;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT"})(He||(He={}));var Ro;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Ro||(Ro={}));var Do;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Do||(Do={}));var Po;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY"})(Po||(Po={}));var Mo;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Mo||(Mo={}));var Lo;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Lo||(Lo={}));var $o;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})($o||($o={}));var Fo;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Fo||(Fo={}));var Hn;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Hn||(Hn={}));var Oo;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Oo||(Oo={}));var ns;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(ns||(ns={}));var Vo;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Vo||(Vo={}));var Uo;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(Uo||(Uo={}));var qo;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(qo||(qo={}));var jo;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(jo||(jo={}));var Bo;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(Bo||(Bo={}));var Go;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(Go||(Go={}));var Ho;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Ho||(Ho={}));var zo;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(zo||(zo={}));var Wo;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi"})(Wo||(Wo={}));var Jo;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Jo||(Jo={}));var Yo;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Yo||(Yo={}));var Ko;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Ko||(Ko={}));var Zo;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Zo||(Zo={}));var Xo;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(Xo||(Xo={}));var Qo;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(Qo||(Qo={}));var ea;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(ea||(ea={}));var ta;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(ta||(ta={}));var na;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(na||(na={}));var ra;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(ra||(ra={}));var ia;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ia||(ia={}));var sa;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(sa||(sa={}));var oa;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(oa||(oa={}));var aa;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY"})(aa||(aa={}));var fn;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(fn||(fn={}));class kn{get text(){var e,t,r,i,s,o,a,d;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",m=!1;const p=[];for(const h of(d=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&d!==void 0?d:[]){for(const[y,v]of Object.entries(h))y!=="text"&&y!=="thought"&&(v!==null||v!==void 0)&&p.push(y);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;m=!0,u+=h.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),m?u:void 0}get data(){var e,t,r,i,s,o,a,d;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const m=[];for(const p of(d=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&d!==void 0?d:[]){for(const[h,y]of Object.entries(p))h!=="inlineData"&&(y!==null||y!==void 0)&&m.push(h);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return m.length>0&&console.warn(`there are non-data parts ${m} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,t,r,i,s,o,a,d;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(d=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||d===void 0?void 0:d.filter(m=>m.functionCall).map(m=>m.functionCall).filter(m=>m!==void 0);if(u?.length!==0)return u}get executableCode(){var e,t,r,i,s,o,a,d,u;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const m=(d=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||d===void 0?void 0:d.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if(m?.length!==0)return(u=m?.[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,t,r,i,s,o,a,d,u;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const m=(d=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||d===void 0?void 0:d.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if(m?.length!==0)return(u=m?.[0])===null||u===void 0?void 0:u.output}}class la{}class ca{}class Hf{}class zf{}class ua{}class da{}class fa{}class Wf{}class ma{}class pa{}class ha{}class Jf{}class rs{constructor(e){const t={};for(const r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Yf{}class Kf{}class Zf{get text(){var e,t,r;let i="",s=!1;const o=[];for(const a of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[d,u]of Object.entries(a))d!=="text"&&d!=="thought"&&u!==null&&o.push(d);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,t,r;let i="";const s=[];for(const o of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[a,d]of Object.entries(o))a!=="inlineData"&&d!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class Xf{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}function Ie(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function dc(n,e){const t=Ie(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function fc(n,e){return Array.isArray(e)?e.map(t=>kr(n,t)):[kr(n,e)]}function kr(n,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function Qf(n,e){const t=kr(n,e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function em(n,e){const t=kr(n,e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function ga(n,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function mc(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>ga(n,t)):[ga(n,e)]}function is(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function ya(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function _a(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Qe(n,e){if(e==null)throw new Error("ContentUnion is required");return is(e)?e:{role:"user",parts:mc(n,e)}}function pc(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const r=Qe(n,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(n.isVertexAI()){const t=Qe(n,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Qe(n,t)):[Qe(n,e)]}function ht(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(ya(e)||_a(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Qe(n,e)]}const t=[],r=[],i=is(e[0]);for(const s of e){const o=is(s);if(o!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(s);else{if(ya(s)||_a(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(s)}}return i||t.push({role:"user",parts:mc(n,r)}),t}const va=Uf(["string","number","integer","object","array","boolean","null"]),tm=Ff([va,Fn(va)]);function nm(n=!0){const e=Vf(()=>{const t=$f({type:tm.optional(),format:Ht().optional(),title:Ht().optional(),description:Ht().optional(),default:So().optional(),items:e.optional(),minItems:sn.string().optional(),maxItems:sn.string().optional(),enum:Fn(So()).optional(),properties:Of(Ht(),e).optional(),required:Fn(Ht()).optional(),minProperties:sn.string().optional(),maxProperties:sn.string().optional(),propertyOrdering:Fn(Ht()).optional(),minimum:To().optional(),maximum:To().optional(),minLength:sn.string().optional(),maxLength:sn.string().optional(),pattern:Ht().optional(),anyOf:Fn(e).optional(),additionalProperties:Lf().optional()});return n?t.strict():t});return e}function rm(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(r=>r!=="null");if(t.length===1)e.type=Object.keys(He).includes(t[0].toUpperCase())?He[t[0].toUpperCase()]:He.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of t)e.anyOf.push({type:Object.keys(He).includes(r.toUpperCase())?He[r.toUpperCase()]:He.TYPE_UNSPECIFIED})}}function Un(n){const e={},t=["items"],r=["anyOf"],i=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=n.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,n=s[1]):s[1].type==="null"&&(e.nullable=!0,n=s[0])),n.type instanceof Array&&rm(n.type,e);for(const[o,a]of Object.entries(n))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.keys(He).includes(a.toUpperCase())?a.toUpperCase():He.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=Un(a);else if(r.includes(o)){const d=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}d.push(Un(u))}e[o]=d}else if(i.includes(o)){const d={};for(const[u,m]of Object.entries(a))d[u]=Un(m);e[o]=d}else{if(o==="additionalProperties")continue;e[o]=a}return e}function Ir(n,e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=nm().parse(e);return Un(t)}else return Un(e)}function hc(n,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function gc(n,e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Ur(n,e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=Ir(n,t.parameters)),t.response&&(t.response=Ir(n,t.response));return e}function qr(n,e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const r of e)t.push(r);return t}function im(n,e,t,r=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===r;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:i?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function qt(n,e){if(typeof e!="string")throw new Error("name must be a string");return im(n,e,"cachedContents")}function yc(n,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function jt(n,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function sm(n){return n!=null&&typeof n=="object"&&"name"in n}function om(n){return n!=null&&typeof n=="object"&&"video"in n}function am(n){return n!=null&&typeof n=="object"&&"uri"in n}function _c(n,e){var t;let r;if(sm(e)&&(r=e.name),!(am(e)&&(r=e.uri,r===void 0))&&!(om(e)&&(r=(t=e.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const s=r.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${r}`);r=s[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function vc(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function wc(n,e){for(const t of["models","tunedModels","publisherModels"])if(lm(e,t))return e[t];return[]}function lm(n,e){return n!==null&&typeof n=="object"&&e in n}function cm(n,e){const t={},r=l(e,["fps"]);r!=null&&c(t,["fps"],r);const i=l(e,["endOffset"]);i!=null&&c(t,["endOffset"],i);const s=l(e,["startOffset"]);return s!=null&&c(t,["startOffset"],s),t}function um(n,e){const t={};if(l(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(e,["data"]);r!=null&&c(t,["data"],r);const i=l(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function dm(n,e){const t={},r=l(e,["videoMetadata"]);r!=null&&c(t,["videoMetadata"],cm(n,r));const i=l(e,["thought"]);i!=null&&c(t,["thought"],i);const s=l(e,["inlineData"]);s!=null&&c(t,["inlineData"],um(n,s));const o=l(e,["codeExecutionResult"]);o!=null&&c(t,["codeExecutionResult"],o);const a=l(e,["executableCode"]);a!=null&&c(t,["executableCode"],a);const d=l(e,["fileData"]);d!=null&&c(t,["fileData"],d);const u=l(e,["functionCall"]);u!=null&&c(t,["functionCall"],u);const m=l(e,["functionResponse"]);m!=null&&c(t,["functionResponse"],m);const p=l(e,["text"]);return p!=null&&c(t,["text"],p),t}function wa(n,e){const t={},r=l(e,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>dm(n,o))),c(t,["parts"],s)}const i=l(e,["role"]);return i!=null&&c(t,["role"],i),t}function fm(n,e){const t={},r=l(e,["behavior"]);r!=null&&c(t,["behavior"],r);const i=l(e,["description"]);i!=null&&c(t,["description"],i);const s=l(e,["name"]);s!=null&&c(t,["name"],s);const o=l(e,["parameters"]);o!=null&&c(t,["parameters"],o);const a=l(e,["response"]);return a!=null&&c(t,["response"],a),t}function mm(n,e){const t={},r=l(e,["startTime"]);r!=null&&c(t,["startTime"],r);const i=l(e,["endTime"]);return i!=null&&c(t,["endTime"],i),t}function pm(n,e){const t={},r=l(e,["timeRangeFilter"]);return r!=null&&c(t,["timeRangeFilter"],mm(n,r)),t}function hm(n,e){const t={},r=l(e,["mode"]);r!=null&&c(t,["mode"],r);const i=l(e,["dynamicThreshold"]);return i!=null&&c(t,["dynamicThreshold"],i),t}function gm(n,e){const t={},r=l(e,["dynamicRetrievalConfig"]);return r!=null&&c(t,["dynamicRetrievalConfig"],hm(n,r)),t}function ym(){return{}}function _m(n,e){const t={},r=l(e,["functionDeclarations"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(u=>fm(n,u))),c(t,["functionDeclarations"],d)}if(l(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(e,["googleSearch"]);i!=null&&c(t,["googleSearch"],pm(n,i));const s=l(e,["googleSearchRetrieval"]);if(s!=null&&c(t,["googleSearchRetrieval"],gm(n,s)),l(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(e,["urlContext"])!=null&&c(t,["urlContext"],ym());const a=l(e,["codeExecution"]);return a!=null&&c(t,["codeExecution"],a),t}function vm(n,e){const t={},r=l(e,["mode"]);r!=null&&c(t,["mode"],r);const i=l(e,["allowedFunctionNames"]);return i!=null&&c(t,["allowedFunctionNames"],i),t}function wm(n,e){const t={},r=l(e,["latitude"]);r!=null&&c(t,["latitude"],r);const i=l(e,["longitude"]);return i!=null&&c(t,["longitude"],i),t}function xm(n,e){const t={},r=l(e,["latLng"]);return r!=null&&c(t,["latLng"],wm(n,r)),t}function bm(n,e){const t={},r=l(e,["functionCallingConfig"]);r!=null&&c(t,["functionCallingConfig"],vm(n,r));const i=l(e,["retrievalConfig"]);return i!=null&&c(t,["retrievalConfig"],xm(n,i)),t}function Cm(n,e,t){const r={},i=l(e,["ttl"]);t!==void 0&&i!=null&&c(t,["ttl"],i);const s=l(e,["expireTime"]);t!==void 0&&s!=null&&c(t,["expireTime"],s);const o=l(e,["displayName"]);t!==void 0&&o!=null&&c(t,["displayName"],o);const a=l(e,["contents"]);if(t!==void 0&&a!=null){let p=ht(n,a);Array.isArray(p)&&(p=p.map(h=>wa(n,h))),c(t,["contents"],p)}const d=l(e,["systemInstruction"]);t!==void 0&&d!=null&&c(t,["systemInstruction"],wa(n,Qe(n,d)));const u=l(e,["tools"]);if(t!==void 0&&u!=null){let p=u;Array.isArray(p)&&(p=p.map(h=>_m(n,h))),c(t,["tools"],p)}const m=l(e,["toolConfig"]);if(t!==void 0&&m!=null&&c(t,["toolConfig"],bm(n,m)),l(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return r}function Tm(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["model"],dc(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],Cm(n,i,t)),t}function Sm(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["_url","name"],qt(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function Em(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["_url","name"],qt(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function Am(n,e,t){const r={},i=l(e,["ttl"]);t!==void 0&&i!=null&&c(t,["ttl"],i);const s=l(e,["expireTime"]);return t!==void 0&&s!=null&&c(t,["expireTime"],s),r}function km(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["_url","name"],qt(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],Am(n,i,t)),t}function Im(n,e,t){const r={},i=l(e,["pageSize"]);t!==void 0&&i!=null&&c(t,["_query","pageSize"],i);const s=l(e,["pageToken"]);return t!==void 0&&s!=null&&c(t,["_query","pageToken"],s),r}function Nm(n,e){const t={},r=l(e,["config"]);return r!=null&&c(t,["config"],Im(n,r,t)),t}function Rm(n,e){const t={},r=l(e,["fps"]);r!=null&&c(t,["fps"],r);const i=l(e,["endOffset"]);i!=null&&c(t,["endOffset"],i);const s=l(e,["startOffset"]);return s!=null&&c(t,["startOffset"],s),t}function Dm(n,e){const t={},r=l(e,["displayName"]);r!=null&&c(t,["displayName"],r);const i=l(e,["data"]);i!=null&&c(t,["data"],i);const s=l(e,["mimeType"]);return s!=null&&c(t,["mimeType"],s),t}function Pm(n,e){const t={},r=l(e,["videoMetadata"]);r!=null&&c(t,["videoMetadata"],Rm(n,r));const i=l(e,["thought"]);i!=null&&c(t,["thought"],i);const s=l(e,["inlineData"]);s!=null&&c(t,["inlineData"],Dm(n,s));const o=l(e,["codeExecutionResult"]);o!=null&&c(t,["codeExecutionResult"],o);const a=l(e,["executableCode"]);a!=null&&c(t,["executableCode"],a);const d=l(e,["fileData"]);d!=null&&c(t,["fileData"],d);const u=l(e,["functionCall"]);u!=null&&c(t,["functionCall"],u);const m=l(e,["functionResponse"]);m!=null&&c(t,["functionResponse"],m);const p=l(e,["text"]);return p!=null&&c(t,["text"],p),t}function xa(n,e){const t={},r=l(e,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Pm(n,o))),c(t,["parts"],s)}const i=l(e,["role"]);return i!=null&&c(t,["role"],i),t}function Mm(n,e){const t={};if(l(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=l(e,["description"]);r!=null&&c(t,["description"],r);const i=l(e,["name"]);i!=null&&c(t,["name"],i);const s=l(e,["parameters"]);s!=null&&c(t,["parameters"],s);const o=l(e,["response"]);return o!=null&&c(t,["response"],o),t}function Lm(n,e){const t={},r=l(e,["startTime"]);r!=null&&c(t,["startTime"],r);const i=l(e,["endTime"]);return i!=null&&c(t,["endTime"],i),t}function $m(n,e){const t={},r=l(e,["timeRangeFilter"]);return r!=null&&c(t,["timeRangeFilter"],Lm(n,r)),t}function Fm(n,e){const t={},r=l(e,["mode"]);r!=null&&c(t,["mode"],r);const i=l(e,["dynamicThreshold"]);return i!=null&&c(t,["dynamicThreshold"],i),t}function Om(n,e){const t={},r=l(e,["dynamicRetrievalConfig"]);return r!=null&&c(t,["dynamicRetrievalConfig"],Fm(n,r)),t}function Vm(){return{}}function Um(n,e){const t={},r=l(e,["apiKeyString"]);return r!=null&&c(t,["apiKeyString"],r),t}function qm(n,e){const t={},r=l(e,["apiKeyConfig"]);r!=null&&c(t,["apiKeyConfig"],Um(n,r));const i=l(e,["authType"]);i!=null&&c(t,["authType"],i);const s=l(e,["googleServiceAccountConfig"]);s!=null&&c(t,["googleServiceAccountConfig"],s);const o=l(e,["httpBasicAuthConfig"]);o!=null&&c(t,["httpBasicAuthConfig"],o);const a=l(e,["oauthConfig"]);a!=null&&c(t,["oauthConfig"],a);const d=l(e,["oidcConfig"]);return d!=null&&c(t,["oidcConfig"],d),t}function jm(n,e){const t={},r=l(e,["authConfig"]);return r!=null&&c(t,["authConfig"],qm(n,r)),t}function Bm(n,e){const t={},r=l(e,["functionDeclarations"]);if(r!=null){let m=r;Array.isArray(m)&&(m=m.map(p=>Mm(n,p))),c(t,["functionDeclarations"],m)}const i=l(e,["retrieval"]);i!=null&&c(t,["retrieval"],i);const s=l(e,["googleSearch"]);s!=null&&c(t,["googleSearch"],$m(n,s));const o=l(e,["googleSearchRetrieval"]);o!=null&&c(t,["googleSearchRetrieval"],Om(n,o)),l(e,["enterpriseWebSearch"])!=null&&c(t,["enterpriseWebSearch"],Vm());const d=l(e,["googleMaps"]);if(d!=null&&c(t,["googleMaps"],jm(n,d)),l(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const u=l(e,["codeExecution"]);return u!=null&&c(t,["codeExecution"],u),t}function Gm(n,e){const t={},r=l(e,["mode"]);r!=null&&c(t,["mode"],r);const i=l(e,["allowedFunctionNames"]);return i!=null&&c(t,["allowedFunctionNames"],i),t}function Hm(n,e){const t={},r=l(e,["latitude"]);r!=null&&c(t,["latitude"],r);const i=l(e,["longitude"]);return i!=null&&c(t,["longitude"],i),t}function zm(n,e){const t={},r=l(e,["latLng"]);return r!=null&&c(t,["latLng"],Hm(n,r)),t}function Wm(n,e){const t={},r=l(e,["functionCallingConfig"]);r!=null&&c(t,["functionCallingConfig"],Gm(n,r));const i=l(e,["retrievalConfig"]);return i!=null&&c(t,["retrievalConfig"],zm(n,i)),t}function Jm(n,e,t){const r={},i=l(e,["ttl"]);t!==void 0&&i!=null&&c(t,["ttl"],i);const s=l(e,["expireTime"]);t!==void 0&&s!=null&&c(t,["expireTime"],s);const o=l(e,["displayName"]);t!==void 0&&o!=null&&c(t,["displayName"],o);const a=l(e,["contents"]);if(t!==void 0&&a!=null){let h=ht(n,a);Array.isArray(h)&&(h=h.map(y=>xa(n,y))),c(t,["contents"],h)}const d=l(e,["systemInstruction"]);t!==void 0&&d!=null&&c(t,["systemInstruction"],xa(n,Qe(n,d)));const u=l(e,["tools"]);if(t!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(y=>Bm(n,y))),c(t,["tools"],h)}const m=l(e,["toolConfig"]);t!==void 0&&m!=null&&c(t,["toolConfig"],Wm(n,m));const p=l(e,["kmsKeyName"]);return t!==void 0&&p!=null&&c(t,["encryption_spec","kmsKeyName"],p),r}function Ym(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["model"],dc(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],Jm(n,i,t)),t}function Km(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["_url","name"],qt(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function Zm(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["_url","name"],qt(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function Xm(n,e,t){const r={},i=l(e,["ttl"]);t!==void 0&&i!=null&&c(t,["ttl"],i);const s=l(e,["expireTime"]);return t!==void 0&&s!=null&&c(t,["expireTime"],s),r}function Qm(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["_url","name"],qt(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],Xm(n,i,t)),t}function ep(n,e,t){const r={},i=l(e,["pageSize"]);t!==void 0&&i!=null&&c(t,["_query","pageSize"],i);const s=l(e,["pageToken"]);return t!==void 0&&s!=null&&c(t,["_query","pageToken"],s),r}function tp(n,e){const t={},r=l(e,["config"]);return r!=null&&c(t,["config"],ep(n,r,t)),t}function cr(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["displayName"]);i!=null&&c(t,["displayName"],i);const s=l(e,["model"]);s!=null&&c(t,["model"],s);const o=l(e,["createTime"]);o!=null&&c(t,["createTime"],o);const a=l(e,["updateTime"]);a!=null&&c(t,["updateTime"],a);const d=l(e,["expireTime"]);d!=null&&c(t,["expireTime"],d);const u=l(e,["usageMetadata"]);return u!=null&&c(t,["usageMetadata"],u),t}function np(){return{}}function rp(n,e){const t={},r=l(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=l(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>cr(n,o))),c(t,["cachedContents"],s)}return t}function ur(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["displayName"]);i!=null&&c(t,["displayName"],i);const s=l(e,["model"]);s!=null&&c(t,["model"],s);const o=l(e,["createTime"]);o!=null&&c(t,["createTime"],o);const a=l(e,["updateTime"]);a!=null&&c(t,["updateTime"],a);const d=l(e,["expireTime"]);d!=null&&c(t,["expireTime"],d);const u=l(e,["usageMetadata"]);return u!=null&&c(t,["usageMetadata"],u),t}function ip(){return{}}function sp(n,e){const t={},r=l(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=l(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ur(n,o))),c(t,["cachedContents"],s)}return t}var bn;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(bn||(bn={}));class jr{constructor(e,t,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,i)}init(e,t,r){var i,s;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}class op extends Yn{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new jr(bn.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=Ym(this.apiClient,e);return a=ce("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>ur(this.apiClient,m))}else{const u=Tm(this.apiClient,e);return a=ce("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>cr(this.apiClient,m))}}async get(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=Km(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>ur(this.apiClient,m))}else{const u=Sm(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>cr(this.apiClient,m))}}async delete(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=Zm(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(()=>{const m=ip(),p=new pa;return Object.assign(p,m),p})}else{const u=Em(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(()=>{const m=np(),p=new pa;return Object.assign(p,m),p})}}async update(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=Qm(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>ur(this.apiClient,m))}else{const u=km(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>cr(this.apiClient,m))}}async listInternal(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=tp(this.apiClient,e);return a=ce("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=sp(this.apiClient,m),h=new ha;return Object.assign(h,p),h})}else{const u=Nm(this.apiClient,e);return a=ce("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>{const p=rp(this.apiClient,m),h=new ha;return Object.assign(h,p),h})}}}function ba(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Re(n){return this instanceof Re?(this.v=n,this):new Re(n)}function qn(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(y){return function(v){return Promise.resolve(v).then(y,p)}}function a(y,v){r[y]&&(i[y]=function(_){return new Promise(function(x,b){s.push([y,_,x,b])>1||d(y,_)})},v&&(i[y]=v(i[y])))}function d(y,v){try{u(r[y](v))}catch(_){h(s[0][3],_)}}function u(y){y.value instanceof Re?Promise.resolve(y.value.v).then(m,p):h(s[0][2],y)}function m(y){d("next",y)}function p(y){d("throw",y)}function h(y,v){y(v),s.shift(),s.length&&d(s[0][0],s[0][1])}}function dr(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ba=="function"?ba(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,d){o=n[s](o),i(a,d,o.done,o.value)})}}function i(s,o,a,d){Promise.resolve(d).then(function(u){s({value:u,done:a})},o)}}function ap(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:xc(t)}function xc(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function lp(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Ca(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let r=0;for(;r<t;)if(n[r].role==="user")e.push(n[r]),r++;else{const i=[];let s=!0;for(;r<t&&n[r].role==="model";)i.push(n[r]),s&&!xc(n[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class cp{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new up(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class up{constructor(e,t,r,i={},s=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),lp(s)}async sendMessage(e){var t;await this.sendPromise;const r=Qe(this.apiClient,e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var s,o,a;const d=await i,u=(o=(s=d.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,m=d.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let h=[];m!=null&&(h=(a=m.slice(p))!==null&&a!==void 0?a:[]);const y=u?[u]:[];this.recordHistory(r,y,h)})(),await this.sendPromise,i}async sendMessageStream(e){var t;await this.sendPromise;const r=Qe(this.apiClient,e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const t=e?Ca(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var r,i;return qn(this,arguments,function*(){var o,a,d,u;const m=[];try{for(var p=!0,h=dr(e),y;y=yield Re(h.next()),o=y.done,!o;p=!0){u=y.value,p=!1;const v=u;if(ap(v)){const _=(i=(r=v.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;_!==void 0&&m.push(_)}yield yield Re(v)}}catch(v){a={error:v}}finally{try{!p&&!o&&(d=h.return)&&(yield Re(d.call(h)))}finally{if(a)throw a.error}}this.recordHistory(t,m)})}recordHistory(e,t,r){let i=[];t.length>0&&t.every(s=>s.role!==void 0)?i=t:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...Ca(r)):this.history.push(e),this.history.push(...i)}}function dp(n,e,t){const r={},i=l(e,["pageSize"]);t!==void 0&&i!=null&&c(t,["_query","pageSize"],i);const s=l(e,["pageToken"]);return t!==void 0&&s!=null&&c(t,["_query","pageToken"],s),r}function fp(n,e){const t={},r=l(e,["config"]);return r!=null&&c(t,["config"],dp(n,r,t)),t}function mp(n,e){const t={},r=l(e,["details"]);r!=null&&c(t,["details"],r);const i=l(e,["message"]);i!=null&&c(t,["message"],i);const s=l(e,["code"]);return s!=null&&c(t,["code"],s),t}function pp(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["displayName"]);i!=null&&c(t,["displayName"],i);const s=l(e,["mimeType"]);s!=null&&c(t,["mimeType"],s);const o=l(e,["sizeBytes"]);o!=null&&c(t,["sizeBytes"],o);const a=l(e,["createTime"]);a!=null&&c(t,["createTime"],a);const d=l(e,["expirationTime"]);d!=null&&c(t,["expirationTime"],d);const u=l(e,["updateTime"]);u!=null&&c(t,["updateTime"],u);const m=l(e,["sha256Hash"]);m!=null&&c(t,["sha256Hash"],m);const p=l(e,["uri"]);p!=null&&c(t,["uri"],p);const h=l(e,["downloadUri"]);h!=null&&c(t,["downloadUri"],h);const y=l(e,["state"]);y!=null&&c(t,["state"],y);const v=l(e,["source"]);v!=null&&c(t,["source"],v);const _=l(e,["videoMetadata"]);_!=null&&c(t,["videoMetadata"],_);const x=l(e,["error"]);return x!=null&&c(t,["error"],mp(n,x)),t}function hp(n,e){const t={},r=l(e,["file"]);r!=null&&c(t,["file"],pp(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function gp(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["_url","file"],_c(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function yp(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["_url","file"],_c(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function _p(n,e){const t={},r=l(e,["details"]);r!=null&&c(t,["details"],r);const i=l(e,["message"]);i!=null&&c(t,["message"],i);const s=l(e,["code"]);return s!=null&&c(t,["code"],s),t}function ss(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["displayName"]);i!=null&&c(t,["displayName"],i);const s=l(e,["mimeType"]);s!=null&&c(t,["mimeType"],s);const o=l(e,["sizeBytes"]);o!=null&&c(t,["sizeBytes"],o);const a=l(e,["createTime"]);a!=null&&c(t,["createTime"],a);const d=l(e,["expirationTime"]);d!=null&&c(t,["expirationTime"],d);const u=l(e,["updateTime"]);u!=null&&c(t,["updateTime"],u);const m=l(e,["sha256Hash"]);m!=null&&c(t,["sha256Hash"],m);const p=l(e,["uri"]);p!=null&&c(t,["uri"],p);const h=l(e,["downloadUri"]);h!=null&&c(t,["downloadUri"],h);const y=l(e,["state"]);y!=null&&c(t,["state"],y);const v=l(e,["source"]);v!=null&&c(t,["source"],v);const _=l(e,["videoMetadata"]);_!=null&&c(t,["videoMetadata"],_);const x=l(e,["error"]);return x!=null&&c(t,["error"],_p(n,x)),t}function vp(n,e){const t={},r=l(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=l(e,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ss(n,o))),c(t,["files"],s)}return t}function wp(){return{}}function xp(){return{}}class bp extends Yn{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new jr(bn.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>ss(this.apiClient,t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=fp(this.apiClient,e);return s=ce("files",a._url),o=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const u=vp(this.apiClient,d),m=new Jf;return Object.assign(m,u),m})}}async createInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=hp(this.apiClient,e);return s=ce("upload/v1beta/files",a._url),o=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(()=>{const d=wp(),u=new Yf;return Object.assign(u,d),u})}}async get(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=gp(this.apiClient,e);return s=ce("files/{file}",a._url),o=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>ss(this.apiClient,d))}}async delete(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=yp(this.apiClient,e);return s=ce("files/{file}",a._url),o=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(()=>{const d=xp(),u=new Kf;return Object.assign(u,d),u})}}}function Cp(n,e){const t={},r=l(e,["voiceName"]);return r!=null&&c(t,["voiceName"],r),t}function Tp(n,e){const t={},r=l(e,["voiceName"]);return r!=null&&c(t,["voiceName"],r),t}function bc(n,e){const t={},r=l(e,["prebuiltVoiceConfig"]);return r!=null&&c(t,["prebuiltVoiceConfig"],Cp(n,r)),t}function Sp(n,e){const t={},r=l(e,["prebuiltVoiceConfig"]);return r!=null&&c(t,["prebuiltVoiceConfig"],Tp(n,r)),t}function Ep(n,e){const t={},r=l(e,["speaker"]);r!=null&&c(t,["speaker"],r);const i=l(e,["voiceConfig"]);return i!=null&&c(t,["voiceConfig"],bc(n,i)),t}function Ap(n,e){const t={},r=l(e,["speakerVoiceConfigs"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Ep(n,s))),c(t,["speakerVoiceConfigs"],i)}return t}function kp(n,e){const t={},r=l(e,["voiceConfig"]);r!=null&&c(t,["voiceConfig"],bc(n,r));const i=l(e,["multiSpeakerVoiceConfig"]);i!=null&&c(t,["multiSpeakerVoiceConfig"],Ap(n,i));const s=l(e,["languageCode"]);return s!=null&&c(t,["languageCode"],s),t}function Ip(n,e){const t={},r=l(e,["voiceConfig"]);if(r!=null&&c(t,["voiceConfig"],Sp(n,r)),l(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=l(e,["languageCode"]);return i!=null&&c(t,["languageCode"],i),t}function Np(n,e){const t={},r=l(e,["fps"]);r!=null&&c(t,["fps"],r);const i=l(e,["endOffset"]);i!=null&&c(t,["endOffset"],i);const s=l(e,["startOffset"]);return s!=null&&c(t,["startOffset"],s),t}function Rp(n,e){const t={},r=l(e,["fps"]);r!=null&&c(t,["fps"],r);const i=l(e,["endOffset"]);i!=null&&c(t,["endOffset"],i);const s=l(e,["startOffset"]);return s!=null&&c(t,["startOffset"],s),t}function Dp(n,e){const t={};if(l(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(e,["data"]);r!=null&&c(t,["data"],r);const i=l(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function Pp(n,e){const t={},r=l(e,["displayName"]);r!=null&&c(t,["displayName"],r);const i=l(e,["data"]);i!=null&&c(t,["data"],i);const s=l(e,["mimeType"]);return s!=null&&c(t,["mimeType"],s),t}function Mp(n,e){const t={},r=l(e,["videoMetadata"]);r!=null&&c(t,["videoMetadata"],Np(n,r));const i=l(e,["thought"]);i!=null&&c(t,["thought"],i);const s=l(e,["inlineData"]);s!=null&&c(t,["inlineData"],Dp(n,s));const o=l(e,["codeExecutionResult"]);o!=null&&c(t,["codeExecutionResult"],o);const a=l(e,["executableCode"]);a!=null&&c(t,["executableCode"],a);const d=l(e,["fileData"]);d!=null&&c(t,["fileData"],d);const u=l(e,["functionCall"]);u!=null&&c(t,["functionCall"],u);const m=l(e,["functionResponse"]);m!=null&&c(t,["functionResponse"],m);const p=l(e,["text"]);return p!=null&&c(t,["text"],p),t}function Lp(n,e){const t={},r=l(e,["videoMetadata"]);r!=null&&c(t,["videoMetadata"],Rp(n,r));const i=l(e,["thought"]);i!=null&&c(t,["thought"],i);const s=l(e,["inlineData"]);s!=null&&c(t,["inlineData"],Pp(n,s));const o=l(e,["codeExecutionResult"]);o!=null&&c(t,["codeExecutionResult"],o);const a=l(e,["executableCode"]);a!=null&&c(t,["executableCode"],a);const d=l(e,["fileData"]);d!=null&&c(t,["fileData"],d);const u=l(e,["functionCall"]);u!=null&&c(t,["functionCall"],u);const m=l(e,["functionResponse"]);m!=null&&c(t,["functionResponse"],m);const p=l(e,["text"]);return p!=null&&c(t,["text"],p),t}function $p(n,e){const t={},r=l(e,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Mp(n,o))),c(t,["parts"],s)}const i=l(e,["role"]);return i!=null&&c(t,["role"],i),t}function Fp(n,e){const t={},r=l(e,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Lp(n,o))),c(t,["parts"],s)}const i=l(e,["role"]);return i!=null&&c(t,["role"],i),t}function Op(n,e){const t={},r=l(e,["behavior"]);r!=null&&c(t,["behavior"],r);const i=l(e,["description"]);i!=null&&c(t,["description"],i);const s=l(e,["name"]);s!=null&&c(t,["name"],s);const o=l(e,["parameters"]);o!=null&&c(t,["parameters"],o);const a=l(e,["response"]);return a!=null&&c(t,["response"],a),t}function Vp(n,e){const t={};if(l(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=l(e,["description"]);r!=null&&c(t,["description"],r);const i=l(e,["name"]);i!=null&&c(t,["name"],i);const s=l(e,["parameters"]);s!=null&&c(t,["parameters"],s);const o=l(e,["response"]);return o!=null&&c(t,["response"],o),t}function Up(n,e){const t={},r=l(e,["startTime"]);r!=null&&c(t,["startTime"],r);const i=l(e,["endTime"]);return i!=null&&c(t,["endTime"],i),t}function qp(n,e){const t={},r=l(e,["startTime"]);r!=null&&c(t,["startTime"],r);const i=l(e,["endTime"]);return i!=null&&c(t,["endTime"],i),t}function jp(n,e){const t={},r=l(e,["timeRangeFilter"]);return r!=null&&c(t,["timeRangeFilter"],Up(n,r)),t}function Bp(n,e){const t={},r=l(e,["timeRangeFilter"]);return r!=null&&c(t,["timeRangeFilter"],qp(n,r)),t}function Gp(n,e){const t={},r=l(e,["mode"]);r!=null&&c(t,["mode"],r);const i=l(e,["dynamicThreshold"]);return i!=null&&c(t,["dynamicThreshold"],i),t}function Hp(n,e){const t={},r=l(e,["mode"]);r!=null&&c(t,["mode"],r);const i=l(e,["dynamicThreshold"]);return i!=null&&c(t,["dynamicThreshold"],i),t}function zp(n,e){const t={},r=l(e,["dynamicRetrievalConfig"]);return r!=null&&c(t,["dynamicRetrievalConfig"],Gp(n,r)),t}function Wp(n,e){const t={},r=l(e,["dynamicRetrievalConfig"]);return r!=null&&c(t,["dynamicRetrievalConfig"],Hp(n,r)),t}function Jp(){return{}}function Yp(n,e){const t={},r=l(e,["apiKeyString"]);return r!=null&&c(t,["apiKeyString"],r),t}function Kp(n,e){const t={},r=l(e,["apiKeyConfig"]);r!=null&&c(t,["apiKeyConfig"],Yp(n,r));const i=l(e,["authType"]);i!=null&&c(t,["authType"],i);const s=l(e,["googleServiceAccountConfig"]);s!=null&&c(t,["googleServiceAccountConfig"],s);const o=l(e,["httpBasicAuthConfig"]);o!=null&&c(t,["httpBasicAuthConfig"],o);const a=l(e,["oauthConfig"]);a!=null&&c(t,["oauthConfig"],a);const d=l(e,["oidcConfig"]);return d!=null&&c(t,["oidcConfig"],d),t}function Zp(n,e){const t={},r=l(e,["authConfig"]);return r!=null&&c(t,["authConfig"],Kp(n,r)),t}function Xp(){return{}}function Qp(n,e){const t={},r=l(e,["functionDeclarations"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(u=>Op(n,u))),c(t,["functionDeclarations"],d)}if(l(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(e,["googleSearch"]);i!=null&&c(t,["googleSearch"],jp(n,i));const s=l(e,["googleSearchRetrieval"]);if(s!=null&&c(t,["googleSearchRetrieval"],zp(n,s)),l(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(e,["urlContext"])!=null&&c(t,["urlContext"],Xp());const a=l(e,["codeExecution"]);return a!=null&&c(t,["codeExecution"],a),t}function eh(n,e){const t={},r=l(e,["functionDeclarations"]);if(r!=null){let m=r;Array.isArray(m)&&(m=m.map(p=>Vp(n,p))),c(t,["functionDeclarations"],m)}const i=l(e,["retrieval"]);i!=null&&c(t,["retrieval"],i);const s=l(e,["googleSearch"]);s!=null&&c(t,["googleSearch"],Bp(n,s));const o=l(e,["googleSearchRetrieval"]);o!=null&&c(t,["googleSearchRetrieval"],Wp(n,o)),l(e,["enterpriseWebSearch"])!=null&&c(t,["enterpriseWebSearch"],Jp());const d=l(e,["googleMaps"]);if(d!=null&&c(t,["googleMaps"],Zp(n,d)),l(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const u=l(e,["codeExecution"]);return u!=null&&c(t,["codeExecution"],u),t}function th(n,e){const t={},r=l(e,["handle"]);if(r!=null&&c(t,["handle"],r),l(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function nh(n,e){const t={},r=l(e,["handle"]);r!=null&&c(t,["handle"],r);const i=l(e,["transparent"]);return i!=null&&c(t,["transparent"],i),t}function Ta(){return{}}function Sa(){return{}}function rh(n,e){const t={},r=l(e,["disabled"]);r!=null&&c(t,["disabled"],r);const i=l(e,["startOfSpeechSensitivity"]);i!=null&&c(t,["startOfSpeechSensitivity"],i);const s=l(e,["endOfSpeechSensitivity"]);s!=null&&c(t,["endOfSpeechSensitivity"],s);const o=l(e,["prefixPaddingMs"]);o!=null&&c(t,["prefixPaddingMs"],o);const a=l(e,["silenceDurationMs"]);return a!=null&&c(t,["silenceDurationMs"],a),t}function ih(n,e){const t={},r=l(e,["disabled"]);r!=null&&c(t,["disabled"],r);const i=l(e,["startOfSpeechSensitivity"]);i!=null&&c(t,["startOfSpeechSensitivity"],i);const s=l(e,["endOfSpeechSensitivity"]);s!=null&&c(t,["endOfSpeechSensitivity"],s);const o=l(e,["prefixPaddingMs"]);o!=null&&c(t,["prefixPaddingMs"],o);const a=l(e,["silenceDurationMs"]);return a!=null&&c(t,["silenceDurationMs"],a),t}function sh(n,e){const t={},r=l(e,["automaticActivityDetection"]);r!=null&&c(t,["automaticActivityDetection"],rh(n,r));const i=l(e,["activityHandling"]);i!=null&&c(t,["activityHandling"],i);const s=l(e,["turnCoverage"]);return s!=null&&c(t,["turnCoverage"],s),t}function oh(n,e){const t={},r=l(e,["automaticActivityDetection"]);r!=null&&c(t,["automaticActivityDetection"],ih(n,r));const i=l(e,["activityHandling"]);i!=null&&c(t,["activityHandling"],i);const s=l(e,["turnCoverage"]);return s!=null&&c(t,["turnCoverage"],s),t}function ah(n,e){const t={},r=l(e,["targetTokens"]);return r!=null&&c(t,["targetTokens"],r),t}function lh(n,e){const t={},r=l(e,["targetTokens"]);return r!=null&&c(t,["targetTokens"],r),t}function ch(n,e){const t={},r=l(e,["triggerTokens"]);r!=null&&c(t,["triggerTokens"],r);const i=l(e,["slidingWindow"]);return i!=null&&c(t,["slidingWindow"],ah(n,i)),t}function uh(n,e){const t={},r=l(e,["triggerTokens"]);r!=null&&c(t,["triggerTokens"],r);const i=l(e,["slidingWindow"]);return i!=null&&c(t,["slidingWindow"],lh(n,i)),t}function dh(n,e){const t={},r=l(e,["proactiveAudio"]);return r!=null&&c(t,["proactiveAudio"],r),t}function fh(n,e){const t={},r=l(e,["proactiveAudio"]);return r!=null&&c(t,["proactiveAudio"],r),t}function mh(n,e,t){const r={},i=l(e,["generationConfig"]);t!==void 0&&i!=null&&c(t,["setup","generationConfig"],i);const s=l(e,["responseModalities"]);t!==void 0&&s!=null&&c(t,["setup","generationConfig","responseModalities"],s);const o=l(e,["temperature"]);t!==void 0&&o!=null&&c(t,["setup","generationConfig","temperature"],o);const a=l(e,["topP"]);t!==void 0&&a!=null&&c(t,["setup","generationConfig","topP"],a);const d=l(e,["topK"]);t!==void 0&&d!=null&&c(t,["setup","generationConfig","topK"],d);const u=l(e,["maxOutputTokens"]);t!==void 0&&u!=null&&c(t,["setup","generationConfig","maxOutputTokens"],u);const m=l(e,["mediaResolution"]);t!==void 0&&m!=null&&c(t,["setup","generationConfig","mediaResolution"],m);const p=l(e,["seed"]);t!==void 0&&p!=null&&c(t,["setup","generationConfig","seed"],p);const h=l(e,["speechConfig"]);t!==void 0&&h!=null&&c(t,["setup","generationConfig","speechConfig"],kp(n,gc(n,h)));const y=l(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&c(t,["setup","generationConfig","enableAffectiveDialog"],y);const v=l(e,["systemInstruction"]);t!==void 0&&v!=null&&c(t,["setup","systemInstruction"],$p(n,Qe(n,v)));const _=l(e,["tools"]);if(t!==void 0&&_!=null){let N=qr(n,_);Array.isArray(N)&&(N=N.map(D=>Qp(n,Ur(n,D)))),c(t,["setup","tools"],N)}const x=l(e,["sessionResumption"]);t!==void 0&&x!=null&&c(t,["setup","sessionResumption"],th(n,x));const b=l(e,["inputAudioTranscription"]);t!==void 0&&b!=null&&c(t,["setup","inputAudioTranscription"],Ta());const w=l(e,["outputAudioTranscription"]);t!==void 0&&w!=null&&c(t,["setup","outputAudioTranscription"],Ta());const A=l(e,["realtimeInputConfig"]);t!==void 0&&A!=null&&c(t,["setup","realtimeInputConfig"],sh(n,A));const S=l(e,["contextWindowCompression"]);t!==void 0&&S!=null&&c(t,["setup","contextWindowCompression"],ch(n,S));const C=l(e,["proactivity"]);return t!==void 0&&C!=null&&c(t,["setup","proactivity"],dh(n,C)),r}function ph(n,e,t){const r={},i=l(e,["generationConfig"]);t!==void 0&&i!=null&&c(t,["setup","generationConfig"],i);const s=l(e,["responseModalities"]);t!==void 0&&s!=null&&c(t,["setup","generationConfig","responseModalities"],s);const o=l(e,["temperature"]);t!==void 0&&o!=null&&c(t,["setup","generationConfig","temperature"],o);const a=l(e,["topP"]);t!==void 0&&a!=null&&c(t,["setup","generationConfig","topP"],a);const d=l(e,["topK"]);t!==void 0&&d!=null&&c(t,["setup","generationConfig","topK"],d);const u=l(e,["maxOutputTokens"]);t!==void 0&&u!=null&&c(t,["setup","generationConfig","maxOutputTokens"],u);const m=l(e,["mediaResolution"]);t!==void 0&&m!=null&&c(t,["setup","generationConfig","mediaResolution"],m);const p=l(e,["seed"]);t!==void 0&&p!=null&&c(t,["setup","generationConfig","seed"],p);const h=l(e,["speechConfig"]);t!==void 0&&h!=null&&c(t,["setup","generationConfig","speechConfig"],Ip(n,gc(n,h)));const y=l(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&c(t,["setup","generationConfig","enableAffectiveDialog"],y);const v=l(e,["systemInstruction"]);t!==void 0&&v!=null&&c(t,["setup","systemInstruction"],Fp(n,Qe(n,v)));const _=l(e,["tools"]);if(t!==void 0&&_!=null){let N=qr(n,_);Array.isArray(N)&&(N=N.map(D=>eh(n,Ur(n,D)))),c(t,["setup","tools"],N)}const x=l(e,["sessionResumption"]);t!==void 0&&x!=null&&c(t,["setup","sessionResumption"],nh(n,x));const b=l(e,["inputAudioTranscription"]);t!==void 0&&b!=null&&c(t,["setup","inputAudioTranscription"],Sa());const w=l(e,["outputAudioTranscription"]);t!==void 0&&w!=null&&c(t,["setup","outputAudioTranscription"],Sa());const A=l(e,["realtimeInputConfig"]);t!==void 0&&A!=null&&c(t,["setup","realtimeInputConfig"],oh(n,A));const S=l(e,["contextWindowCompression"]);t!==void 0&&S!=null&&c(t,["setup","contextWindowCompression"],uh(n,S));const C=l(e,["proactivity"]);return t!==void 0&&C!=null&&c(t,["setup","proactivity"],fh(n,C)),r}function hh(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["setup","model"],Ie(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],mh(n,i,t)),t}function gh(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["setup","model"],Ie(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],ph(n,i,t)),t}function yh(){return{}}function _h(){return{}}function vh(){return{}}function wh(){return{}}function xh(n,e){const t={},r=l(e,["media"]);r!=null&&c(t,["mediaChunks"],fc(n,r));const i=l(e,["audio"]);i!=null&&c(t,["audio"],em(n,i));const s=l(e,["audioStreamEnd"]);s!=null&&c(t,["audioStreamEnd"],s);const o=l(e,["video"]);o!=null&&c(t,["video"],Qf(n,o));const a=l(e,["text"]);return a!=null&&c(t,["text"],a),l(e,["activityStart"])!=null&&c(t,["activityStart"],yh()),l(e,["activityEnd"])!=null&&c(t,["activityEnd"],vh()),t}function bh(n,e){const t={},r=l(e,["media"]);if(r!=null&&c(t,["mediaChunks"],fc(n,r)),l(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const i=l(e,["audioStreamEnd"]);if(i!=null&&c(t,["audioStreamEnd"],i),l(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(l(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return l(e,["activityStart"])!=null&&c(t,["activityStart"],_h()),l(e,["activityEnd"])!=null&&c(t,["activityEnd"],wh()),t}function Cc(n,e){const t={},r=l(e,["text"]);r!=null&&c(t,["text"],r);const i=l(e,["weight"]);return i!=null&&c(t,["weight"],i),t}function Ch(n,e){const t={},r=l(e,["weightedPrompts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Cc(n,s))),c(t,["weightedPrompts"],i)}return t}function Tc(n,e){const t={},r=l(e,["temperature"]);r!=null&&c(t,["temperature"],r);const i=l(e,["topK"]);i!=null&&c(t,["topK"],i);const s=l(e,["seed"]);s!=null&&c(t,["seed"],s);const o=l(e,["guidance"]);o!=null&&c(t,["guidance"],o);const a=l(e,["bpm"]);a!=null&&c(t,["bpm"],a);const d=l(e,["density"]);d!=null&&c(t,["density"],d);const u=l(e,["brightness"]);u!=null&&c(t,["brightness"],u);const m=l(e,["scale"]);m!=null&&c(t,["scale"],m);const p=l(e,["muteBass"]);p!=null&&c(t,["muteBass"],p);const h=l(e,["muteDrums"]);h!=null&&c(t,["muteDrums"],h);const y=l(e,["onlyBassAndDrums"]);y!=null&&c(t,["onlyBassAndDrums"],y);const v=l(e,["musicGenerationMode"]);return v!=null&&c(t,["musicGenerationMode"],v),t}function Th(n,e){const t={},r=l(e,["musicGenerationConfig"]);return r!=null&&c(t,["musicGenerationConfig"],Tc(n,r)),t}function Sc(n,e){const t={},r=l(e,["model"]);return r!=null&&c(t,["model"],r),t}function Ec(n,e){const t={},r=l(e,["weightedPrompts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Cc(n,s))),c(t,["weightedPrompts"],i)}return t}function os(n,e){const t={},r=l(e,["setup"]);r!=null&&c(t,["setup"],Sc(n,r));const i=l(e,["clientContent"]);i!=null&&c(t,["clientContent"],Ec(n,i));const s=l(e,["musicGenerationConfig"]);s!=null&&c(t,["musicGenerationConfig"],Tc(n,s));const o=l(e,["playbackControl"]);return o!=null&&c(t,["playbackControl"],o),t}function Sh(){return{}}function Eh(){return{}}function Ah(n,e){const t={},r=l(e,["fps"]);r!=null&&c(t,["fps"],r);const i=l(e,["endOffset"]);i!=null&&c(t,["endOffset"],i);const s=l(e,["startOffset"]);return s!=null&&c(t,["startOffset"],s),t}function kh(n,e){const t={},r=l(e,["fps"]);r!=null&&c(t,["fps"],r);const i=l(e,["endOffset"]);i!=null&&c(t,["endOffset"],i);const s=l(e,["startOffset"]);return s!=null&&c(t,["startOffset"],s),t}function Ih(n,e){const t={},r=l(e,["data"]);r!=null&&c(t,["data"],r);const i=l(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function Nh(n,e){const t={},r=l(e,["displayName"]);r!=null&&c(t,["displayName"],r);const i=l(e,["data"]);i!=null&&c(t,["data"],i);const s=l(e,["mimeType"]);return s!=null&&c(t,["mimeType"],s),t}function Rh(n,e){const t={},r=l(e,["videoMetadata"]);r!=null&&c(t,["videoMetadata"],Ah(n,r));const i=l(e,["thought"]);i!=null&&c(t,["thought"],i);const s=l(e,["inlineData"]);s!=null&&c(t,["inlineData"],Ih(n,s));const o=l(e,["codeExecutionResult"]);o!=null&&c(t,["codeExecutionResult"],o);const a=l(e,["executableCode"]);a!=null&&c(t,["executableCode"],a);const d=l(e,["fileData"]);d!=null&&c(t,["fileData"],d);const u=l(e,["functionCall"]);u!=null&&c(t,["functionCall"],u);const m=l(e,["functionResponse"]);m!=null&&c(t,["functionResponse"],m);const p=l(e,["text"]);return p!=null&&c(t,["text"],p),t}function Dh(n,e){const t={},r=l(e,["videoMetadata"]);r!=null&&c(t,["videoMetadata"],kh(n,r));const i=l(e,["thought"]);i!=null&&c(t,["thought"],i);const s=l(e,["inlineData"]);s!=null&&c(t,["inlineData"],Nh(n,s));const o=l(e,["codeExecutionResult"]);o!=null&&c(t,["codeExecutionResult"],o);const a=l(e,["executableCode"]);a!=null&&c(t,["executableCode"],a);const d=l(e,["fileData"]);d!=null&&c(t,["fileData"],d);const u=l(e,["functionCall"]);u!=null&&c(t,["functionCall"],u);const m=l(e,["functionResponse"]);m!=null&&c(t,["functionResponse"],m);const p=l(e,["text"]);return p!=null&&c(t,["text"],p),t}function Ph(n,e){const t={},r=l(e,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Rh(n,o))),c(t,["parts"],s)}const i=l(e,["role"]);return i!=null&&c(t,["role"],i),t}function Mh(n,e){const t={},r=l(e,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Dh(n,o))),c(t,["parts"],s)}const i=l(e,["role"]);return i!=null&&c(t,["role"],i),t}function Ea(n,e){const t={},r=l(e,["text"]);r!=null&&c(t,["text"],r);const i=l(e,["finished"]);return i!=null&&c(t,["finished"],i),t}function Aa(n,e){const t={},r=l(e,["text"]);r!=null&&c(t,["text"],r);const i=l(e,["finished"]);return i!=null&&c(t,["finished"],i),t}function Lh(n,e){const t={},r=l(e,["retrievedUrl"]);r!=null&&c(t,["retrievedUrl"],r);const i=l(e,["urlRetrievalStatus"]);return i!=null&&c(t,["urlRetrievalStatus"],i),t}function $h(n,e){const t={},r=l(e,["urlMetadata"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Lh(n,s))),c(t,["urlMetadata"],i)}return t}function Fh(n,e){const t={},r=l(e,["modelTurn"]);r!=null&&c(t,["modelTurn"],Ph(n,r));const i=l(e,["turnComplete"]);i!=null&&c(t,["turnComplete"],i);const s=l(e,["interrupted"]);s!=null&&c(t,["interrupted"],s);const o=l(e,["groundingMetadata"]);o!=null&&c(t,["groundingMetadata"],o);const a=l(e,["generationComplete"]);a!=null&&c(t,["generationComplete"],a);const d=l(e,["inputTranscription"]);d!=null&&c(t,["inputTranscription"],Ea(n,d));const u=l(e,["outputTranscription"]);u!=null&&c(t,["outputTranscription"],Ea(n,u));const m=l(e,["urlContextMetadata"]);return m!=null&&c(t,["urlContextMetadata"],$h(n,m)),t}function Oh(n,e){const t={},r=l(e,["modelTurn"]);r!=null&&c(t,["modelTurn"],Mh(n,r));const i=l(e,["turnComplete"]);i!=null&&c(t,["turnComplete"],i);const s=l(e,["interrupted"]);s!=null&&c(t,["interrupted"],s);const o=l(e,["groundingMetadata"]);o!=null&&c(t,["groundingMetadata"],o);const a=l(e,["generationComplete"]);a!=null&&c(t,["generationComplete"],a);const d=l(e,["inputTranscription"]);d!=null&&c(t,["inputTranscription"],Aa(n,d));const u=l(e,["outputTranscription"]);return u!=null&&c(t,["outputTranscription"],Aa(n,u)),t}function Vh(n,e){const t={},r=l(e,["id"]);r!=null&&c(t,["id"],r);const i=l(e,["args"]);i!=null&&c(t,["args"],i);const s=l(e,["name"]);return s!=null&&c(t,["name"],s),t}function Uh(n,e){const t={},r=l(e,["args"]);r!=null&&c(t,["args"],r);const i=l(e,["name"]);return i!=null&&c(t,["name"],i),t}function qh(n,e){const t={},r=l(e,["functionCalls"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Vh(n,s))),c(t,["functionCalls"],i)}return t}function jh(n,e){const t={},r=l(e,["functionCalls"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Uh(n,s))),c(t,["functionCalls"],i)}return t}function Bh(n,e){const t={},r=l(e,["ids"]);return r!=null&&c(t,["ids"],r),t}function Gh(n,e){const t={},r=l(e,["ids"]);return r!=null&&c(t,["ids"],r),t}function er(n,e){const t={},r=l(e,["modality"]);r!=null&&c(t,["modality"],r);const i=l(e,["tokenCount"]);return i!=null&&c(t,["tokenCount"],i),t}function tr(n,e){const t={},r=l(e,["modality"]);r!=null&&c(t,["modality"],r);const i=l(e,["tokenCount"]);return i!=null&&c(t,["tokenCount"],i),t}function Hh(n,e){const t={},r=l(e,["promptTokenCount"]);r!=null&&c(t,["promptTokenCount"],r);const i=l(e,["cachedContentTokenCount"]);i!=null&&c(t,["cachedContentTokenCount"],i);const s=l(e,["responseTokenCount"]);s!=null&&c(t,["responseTokenCount"],s);const o=l(e,["toolUsePromptTokenCount"]);o!=null&&c(t,["toolUsePromptTokenCount"],o);const a=l(e,["thoughtsTokenCount"]);a!=null&&c(t,["thoughtsTokenCount"],a);const d=l(e,["totalTokenCount"]);d!=null&&c(t,["totalTokenCount"],d);const u=l(e,["promptTokensDetails"]);if(u!=null){let y=u;Array.isArray(y)&&(y=y.map(v=>er(n,v))),c(t,["promptTokensDetails"],y)}const m=l(e,["cacheTokensDetails"]);if(m!=null){let y=m;Array.isArray(y)&&(y=y.map(v=>er(n,v))),c(t,["cacheTokensDetails"],y)}const p=l(e,["responseTokensDetails"]);if(p!=null){let y=p;Array.isArray(y)&&(y=y.map(v=>er(n,v))),c(t,["responseTokensDetails"],y)}const h=l(e,["toolUsePromptTokensDetails"]);if(h!=null){let y=h;Array.isArray(y)&&(y=y.map(v=>er(n,v))),c(t,["toolUsePromptTokensDetails"],y)}return t}function zh(n,e){const t={},r=l(e,["promptTokenCount"]);r!=null&&c(t,["promptTokenCount"],r);const i=l(e,["cachedContentTokenCount"]);i!=null&&c(t,["cachedContentTokenCount"],i);const s=l(e,["candidatesTokenCount"]);s!=null&&c(t,["responseTokenCount"],s);const o=l(e,["toolUsePromptTokenCount"]);o!=null&&c(t,["toolUsePromptTokenCount"],o);const a=l(e,["thoughtsTokenCount"]);a!=null&&c(t,["thoughtsTokenCount"],a);const d=l(e,["totalTokenCount"]);d!=null&&c(t,["totalTokenCount"],d);const u=l(e,["promptTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(_=>tr(n,_))),c(t,["promptTokensDetails"],v)}const m=l(e,["cacheTokensDetails"]);if(m!=null){let v=m;Array.isArray(v)&&(v=v.map(_=>tr(n,_))),c(t,["cacheTokensDetails"],v)}const p=l(e,["candidatesTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(_=>tr(n,_))),c(t,["responseTokensDetails"],v)}const h=l(e,["toolUsePromptTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(_=>tr(n,_))),c(t,["toolUsePromptTokensDetails"],v)}const y=l(e,["trafficType"]);return y!=null&&c(t,["trafficType"],y),t}function Wh(n,e){const t={},r=l(e,["timeLeft"]);return r!=null&&c(t,["timeLeft"],r),t}function Jh(n,e){const t={},r=l(e,["timeLeft"]);return r!=null&&c(t,["timeLeft"],r),t}function Yh(n,e){const t={},r=l(e,["newHandle"]);r!=null&&c(t,["newHandle"],r);const i=l(e,["resumable"]);i!=null&&c(t,["resumable"],i);const s=l(e,["lastConsumedClientMessageIndex"]);return s!=null&&c(t,["lastConsumedClientMessageIndex"],s),t}function Kh(n,e){const t={},r=l(e,["newHandle"]);r!=null&&c(t,["newHandle"],r);const i=l(e,["resumable"]);i!=null&&c(t,["resumable"],i);const s=l(e,["lastConsumedClientMessageIndex"]);return s!=null&&c(t,["lastConsumedClientMessageIndex"],s),t}function Zh(n,e){const t={};l(e,["setupComplete"])!=null&&c(t,["setupComplete"],Sh());const i=l(e,["serverContent"]);i!=null&&c(t,["serverContent"],Fh(n,i));const s=l(e,["toolCall"]);s!=null&&c(t,["toolCall"],qh(n,s));const o=l(e,["toolCallCancellation"]);o!=null&&c(t,["toolCallCancellation"],Bh(n,o));const a=l(e,["usageMetadata"]);a!=null&&c(t,["usageMetadata"],Hh(n,a));const d=l(e,["goAway"]);d!=null&&c(t,["goAway"],Wh(n,d));const u=l(e,["sessionResumptionUpdate"]);return u!=null&&c(t,["sessionResumptionUpdate"],Yh(n,u)),t}function Xh(n,e){const t={};l(e,["setupComplete"])!=null&&c(t,["setupComplete"],Eh());const i=l(e,["serverContent"]);i!=null&&c(t,["serverContent"],Oh(n,i));const s=l(e,["toolCall"]);s!=null&&c(t,["toolCall"],jh(n,s));const o=l(e,["toolCallCancellation"]);o!=null&&c(t,["toolCallCancellation"],Gh(n,o));const a=l(e,["usageMetadata"]);a!=null&&c(t,["usageMetadata"],zh(n,a));const d=l(e,["goAway"]);d!=null&&c(t,["goAway"],Jh(n,d));const u=l(e,["sessionResumptionUpdate"]);return u!=null&&c(t,["sessionResumptionUpdate"],Kh(n,u)),t}function Qh(){return{}}function eg(n,e){const t={},r=l(e,["text"]);r!=null&&c(t,["text"],r);const i=l(e,["weight"]);return i!=null&&c(t,["weight"],i),t}function tg(n,e){const t={},r=l(e,["weightedPrompts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>eg(n,s))),c(t,["weightedPrompts"],i)}return t}function ng(n,e){const t={},r=l(e,["temperature"]);r!=null&&c(t,["temperature"],r);const i=l(e,["topK"]);i!=null&&c(t,["topK"],i);const s=l(e,["seed"]);s!=null&&c(t,["seed"],s);const o=l(e,["guidance"]);o!=null&&c(t,["guidance"],o);const a=l(e,["bpm"]);a!=null&&c(t,["bpm"],a);const d=l(e,["density"]);d!=null&&c(t,["density"],d);const u=l(e,["brightness"]);u!=null&&c(t,["brightness"],u);const m=l(e,["scale"]);m!=null&&c(t,["scale"],m);const p=l(e,["muteBass"]);p!=null&&c(t,["muteBass"],p);const h=l(e,["muteDrums"]);h!=null&&c(t,["muteDrums"],h);const y=l(e,["onlyBassAndDrums"]);y!=null&&c(t,["onlyBassAndDrums"],y);const v=l(e,["musicGenerationMode"]);return v!=null&&c(t,["musicGenerationMode"],v),t}function rg(n,e){const t={},r=l(e,["clientContent"]);r!=null&&c(t,["clientContent"],tg(n,r));const i=l(e,["musicGenerationConfig"]);return i!=null&&c(t,["musicGenerationConfig"],ng(n,i)),t}function ig(n,e){const t={},r=l(e,["data"]);r!=null&&c(t,["data"],r);const i=l(e,["mimeType"]);i!=null&&c(t,["mimeType"],i);const s=l(e,["sourceMetadata"]);return s!=null&&c(t,["sourceMetadata"],rg(n,s)),t}function sg(n,e){const t={},r=l(e,["audioChunks"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>ig(n,s))),c(t,["audioChunks"],i)}return t}function og(n,e){const t={},r=l(e,["text"]);r!=null&&c(t,["text"],r);const i=l(e,["filteredReason"]);return i!=null&&c(t,["filteredReason"],i),t}function ag(n,e){const t={};l(e,["setupComplete"])!=null&&c(t,["setupComplete"],Qh());const i=l(e,["serverContent"]);i!=null&&c(t,["serverContent"],sg(n,i));const s=l(e,["filteredPrompt"]);return s!=null&&c(t,["filteredPrompt"],og(n,s)),t}function lg(n,e){const t={},r=l(e,["fps"]);r!=null&&c(t,["fps"],r);const i=l(e,["endOffset"]);i!=null&&c(t,["endOffset"],i);const s=l(e,["startOffset"]);return s!=null&&c(t,["startOffset"],s),t}function cg(n,e){const t={};if(l(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(e,["data"]);r!=null&&c(t,["data"],r);const i=l(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function ug(n,e){const t={},r=l(e,["videoMetadata"]);r!=null&&c(t,["videoMetadata"],lg(n,r));const i=l(e,["thought"]);i!=null&&c(t,["thought"],i);const s=l(e,["inlineData"]);s!=null&&c(t,["inlineData"],cg(n,s));const o=l(e,["codeExecutionResult"]);o!=null&&c(t,["codeExecutionResult"],o);const a=l(e,["executableCode"]);a!=null&&c(t,["executableCode"],a);const d=l(e,["fileData"]);d!=null&&c(t,["fileData"],d);const u=l(e,["functionCall"]);u!=null&&c(t,["functionCall"],u);const m=l(e,["functionResponse"]);m!=null&&c(t,["functionResponse"],m);const p=l(e,["text"]);return p!=null&&c(t,["text"],p),t}function Br(n,e){const t={},r=l(e,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>ug(n,o))),c(t,["parts"],s)}const i=l(e,["role"]);return i!=null&&c(t,["role"],i),t}function dg(n,e){const t={};if(l(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=l(e,["category"]);r!=null&&c(t,["category"],r);const i=l(e,["threshold"]);return i!=null&&c(t,["threshold"],i),t}function fg(n,e){const t={},r=l(e,["behavior"]);r!=null&&c(t,["behavior"],r);const i=l(e,["description"]);i!=null&&c(t,["description"],i);const s=l(e,["name"]);s!=null&&c(t,["name"],s);const o=l(e,["parameters"]);o!=null&&c(t,["parameters"],o);const a=l(e,["response"]);return a!=null&&c(t,["response"],a),t}function mg(n,e){const t={},r=l(e,["startTime"]);r!=null&&c(t,["startTime"],r);const i=l(e,["endTime"]);return i!=null&&c(t,["endTime"],i),t}function pg(n,e){const t={},r=l(e,["timeRangeFilter"]);return r!=null&&c(t,["timeRangeFilter"],mg(n,r)),t}function hg(n,e){const t={},r=l(e,["mode"]);r!=null&&c(t,["mode"],r);const i=l(e,["dynamicThreshold"]);return i!=null&&c(t,["dynamicThreshold"],i),t}function gg(n,e){const t={},r=l(e,["dynamicRetrievalConfig"]);return r!=null&&c(t,["dynamicRetrievalConfig"],hg(n,r)),t}function yg(){return{}}function _g(n,e){const t={},r=l(e,["functionDeclarations"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(u=>fg(n,u))),c(t,["functionDeclarations"],d)}if(l(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=l(e,["googleSearch"]);i!=null&&c(t,["googleSearch"],pg(n,i));const s=l(e,["googleSearchRetrieval"]);if(s!=null&&c(t,["googleSearchRetrieval"],gg(n,s)),l(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(e,["urlContext"])!=null&&c(t,["urlContext"],yg());const a=l(e,["codeExecution"]);return a!=null&&c(t,["codeExecution"],a),t}function vg(n,e){const t={},r=l(e,["mode"]);r!=null&&c(t,["mode"],r);const i=l(e,["allowedFunctionNames"]);return i!=null&&c(t,["allowedFunctionNames"],i),t}function wg(n,e){const t={},r=l(e,["latitude"]);r!=null&&c(t,["latitude"],r);const i=l(e,["longitude"]);return i!=null&&c(t,["longitude"],i),t}function xg(n,e){const t={},r=l(e,["latLng"]);return r!=null&&c(t,["latLng"],wg(n,r)),t}function bg(n,e){const t={},r=l(e,["functionCallingConfig"]);r!=null&&c(t,["functionCallingConfig"],vg(n,r));const i=l(e,["retrievalConfig"]);return i!=null&&c(t,["retrievalConfig"],xg(n,i)),t}function Cg(n,e){const t={},r=l(e,["voiceName"]);return r!=null&&c(t,["voiceName"],r),t}function Ac(n,e){const t={},r=l(e,["prebuiltVoiceConfig"]);return r!=null&&c(t,["prebuiltVoiceConfig"],Cg(n,r)),t}function Tg(n,e){const t={},r=l(e,["speaker"]);r!=null&&c(t,["speaker"],r);const i=l(e,["voiceConfig"]);return i!=null&&c(t,["voiceConfig"],Ac(n,i)),t}function Sg(n,e){const t={},r=l(e,["speakerVoiceConfigs"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Tg(n,s))),c(t,["speakerVoiceConfigs"],i)}return t}function Eg(n,e){const t={},r=l(e,["voiceConfig"]);r!=null&&c(t,["voiceConfig"],Ac(n,r));const i=l(e,["multiSpeakerVoiceConfig"]);i!=null&&c(t,["multiSpeakerVoiceConfig"],Sg(n,i));const s=l(e,["languageCode"]);return s!=null&&c(t,["languageCode"],s),t}function Ag(n,e){const t={},r=l(e,["includeThoughts"]);r!=null&&c(t,["includeThoughts"],r);const i=l(e,["thinkingBudget"]);return i!=null&&c(t,["thinkingBudget"],i),t}function kg(n,e,t){const r={},i=l(e,["systemInstruction"]);t!==void 0&&i!=null&&c(t,["systemInstruction"],Br(n,Qe(n,i)));const s=l(e,["temperature"]);s!=null&&c(r,["temperature"],s);const o=l(e,["topP"]);o!=null&&c(r,["topP"],o);const a=l(e,["topK"]);a!=null&&c(r,["topK"],a);const d=l(e,["candidateCount"]);d!=null&&c(r,["candidateCount"],d);const u=l(e,["maxOutputTokens"]);u!=null&&c(r,["maxOutputTokens"],u);const m=l(e,["stopSequences"]);m!=null&&c(r,["stopSequences"],m);const p=l(e,["responseLogprobs"]);p!=null&&c(r,["responseLogprobs"],p);const h=l(e,["logprobs"]);h!=null&&c(r,["logprobs"],h);const y=l(e,["presencePenalty"]);y!=null&&c(r,["presencePenalty"],y);const v=l(e,["frequencyPenalty"]);v!=null&&c(r,["frequencyPenalty"],v);const _=l(e,["seed"]);_!=null&&c(r,["seed"],_);const x=l(e,["responseMimeType"]);x!=null&&c(r,["responseMimeType"],x);const b=l(e,["responseSchema"]);if(b!=null&&c(r,["responseSchema"],Ir(n,b)),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const w=l(e,["safetySettings"]);if(t!==void 0&&w!=null){let W=w;Array.isArray(W)&&(W=W.map(ne=>dg(n,ne))),c(t,["safetySettings"],W)}const A=l(e,["tools"]);if(t!==void 0&&A!=null){let W=qr(n,A);Array.isArray(W)&&(W=W.map(ne=>_g(n,Ur(n,ne)))),c(t,["tools"],W)}const S=l(e,["toolConfig"]);if(t!==void 0&&S!=null&&c(t,["toolConfig"],bg(n,S)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const C=l(e,["cachedContent"]);t!==void 0&&C!=null&&c(t,["cachedContent"],qt(n,C));const N=l(e,["responseModalities"]);N!=null&&c(r,["responseModalities"],N);const D=l(e,["mediaResolution"]);D!=null&&c(r,["mediaResolution"],D);const V=l(e,["speechConfig"]);if(V!=null&&c(r,["speechConfig"],Eg(n,hc(n,V))),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const O=l(e,["thinkingConfig"]);return O!=null&&c(r,["thinkingConfig"],Ag(n,O)),r}function ka(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["contents"]);if(i!=null){let o=ht(n,i);Array.isArray(o)&&(o=o.map(a=>Br(n,a))),c(t,["contents"],o)}const s=l(e,["config"]);return s!=null&&c(t,["generationConfig"],kg(n,s,t)),t}function Ig(n,e,t){const r={},i=l(e,["taskType"]);t!==void 0&&i!=null&&c(t,["requests[]","taskType"],i);const s=l(e,["title"]);t!==void 0&&s!=null&&c(t,["requests[]","title"],s);const o=l(e,["outputDimensionality"]);if(t!==void 0&&o!=null&&c(t,["requests[]","outputDimensionality"],o),l(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function Ng(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["contents"]);i!=null&&c(t,["requests[]","content"],pc(n,i));const s=l(e,["config"]);s!=null&&c(t,["config"],Ig(n,s,t));const o=l(e,["model"]);return o!==void 0&&c(t,["requests[]","model"],Ie(n,o)),t}function Rg(n,e,t){const r={};if(l(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=l(e,["numberOfImages"]);t!==void 0&&i!=null&&c(t,["parameters","sampleCount"],i);const s=l(e,["aspectRatio"]);t!==void 0&&s!=null&&c(t,["parameters","aspectRatio"],s);const o=l(e,["guidanceScale"]);if(t!==void 0&&o!=null&&c(t,["parameters","guidanceScale"],o),l(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=l(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&c(t,["parameters","safetySetting"],a);const d=l(e,["personGeneration"]);t!==void 0&&d!=null&&c(t,["parameters","personGeneration"],d);const u=l(e,["includeSafetyAttributes"]);t!==void 0&&u!=null&&c(t,["parameters","includeSafetyAttributes"],u);const m=l(e,["includeRaiReason"]);t!==void 0&&m!=null&&c(t,["parameters","includeRaiReason"],m);const p=l(e,["language"]);t!==void 0&&p!=null&&c(t,["parameters","language"],p);const h=l(e,["outputMimeType"]);t!==void 0&&h!=null&&c(t,["parameters","outputOptions","mimeType"],h);const y=l(e,["outputCompressionQuality"]);if(t!==void 0&&y!=null&&c(t,["parameters","outputOptions","compressionQuality"],y),l(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(l(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Dg(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["prompt"]);i!=null&&c(t,["instances[0]","prompt"],i);const s=l(e,["config"]);return s!=null&&c(t,["config"],Rg(n,s,t)),t}function Pg(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","name"],Ie(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function Mg(n,e,t){const r={},i=l(e,["pageSize"]);t!==void 0&&i!=null&&c(t,["_query","pageSize"],i);const s=l(e,["pageToken"]);t!==void 0&&s!=null&&c(t,["_query","pageToken"],s);const o=l(e,["filter"]);t!==void 0&&o!=null&&c(t,["_query","filter"],o);const a=l(e,["queryBase"]);return t!==void 0&&a!=null&&c(t,["_url","models_url"],vc(n,a)),r}function Lg(n,e){const t={},r=l(e,["config"]);return r!=null&&c(t,["config"],Mg(n,r,t)),t}function $g(n,e,t){const r={},i=l(e,["displayName"]);t!==void 0&&i!=null&&c(t,["displayName"],i);const s=l(e,["description"]);t!==void 0&&s!=null&&c(t,["description"],s);const o=l(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&c(t,["defaultCheckpointId"],o),r}function Fg(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","name"],Ie(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],$g(n,i,t)),t}function Og(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","name"],Ie(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function Vg(n,e){const t={};if(l(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(l(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(l(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function Ug(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["contents"]);if(i!=null){let o=ht(n,i);Array.isArray(o)&&(o=o.map(a=>Br(n,a))),c(t,["contents"],o)}const s=l(e,["config"]);return s!=null&&c(t,["config"],Vg(n,s)),t}function qg(n,e){const t={};if(l(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=l(e,["imageBytes"]);r!=null&&c(t,["bytesBase64Encoded"],jt(n,r));const i=l(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function jg(n,e,t){const r={},i=l(e,["numberOfVideos"]);if(t!==void 0&&i!=null&&c(t,["parameters","sampleCount"],i),l(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=l(e,["durationSeconds"]);if(t!==void 0&&s!=null&&c(t,["parameters","durationSeconds"],s),l(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=l(e,["aspectRatio"]);if(t!==void 0&&o!=null&&c(t,["parameters","aspectRatio"],o),l(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const a=l(e,["personGeneration"]);if(t!==void 0&&a!=null&&c(t,["parameters","personGeneration"],a),l(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=l(e,["negativePrompt"]);if(t!==void 0&&d!=null&&c(t,["parameters","negativePrompt"],d),l(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Bg(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["prompt"]);i!=null&&c(t,["instances[0]","prompt"],i);const s=l(e,["image"]);s!=null&&c(t,["instances[0]","image"],qg(n,s));const o=l(e,["config"]);return o!=null&&c(t,["config"],jg(n,o,t)),t}function Gg(n,e){const t={},r=l(e,["fps"]);r!=null&&c(t,["fps"],r);const i=l(e,["endOffset"]);i!=null&&c(t,["endOffset"],i);const s=l(e,["startOffset"]);return s!=null&&c(t,["startOffset"],s),t}function Hg(n,e){const t={},r=l(e,["displayName"]);r!=null&&c(t,["displayName"],r);const i=l(e,["data"]);i!=null&&c(t,["data"],i);const s=l(e,["mimeType"]);return s!=null&&c(t,["mimeType"],s),t}function zg(n,e){const t={},r=l(e,["videoMetadata"]);r!=null&&c(t,["videoMetadata"],Gg(n,r));const i=l(e,["thought"]);i!=null&&c(t,["thought"],i);const s=l(e,["inlineData"]);s!=null&&c(t,["inlineData"],Hg(n,s));const o=l(e,["codeExecutionResult"]);o!=null&&c(t,["codeExecutionResult"],o);const a=l(e,["executableCode"]);a!=null&&c(t,["executableCode"],a);const d=l(e,["fileData"]);d!=null&&c(t,["fileData"],d);const u=l(e,["functionCall"]);u!=null&&c(t,["functionCall"],u);const m=l(e,["functionResponse"]);m!=null&&c(t,["functionResponse"],m);const p=l(e,["text"]);return p!=null&&c(t,["text"],p),t}function Tn(n,e){const t={},r=l(e,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>zg(n,o))),c(t,["parts"],s)}const i=l(e,["role"]);return i!=null&&c(t,["role"],i),t}function Wg(n,e){const t={},r=l(e,["featureSelectionPreference"]);return r!=null&&c(t,["featureSelectionPreference"],r),t}function Jg(n,e){const t={},r=l(e,["method"]);r!=null&&c(t,["method"],r);const i=l(e,["category"]);i!=null&&c(t,["category"],i);const s=l(e,["threshold"]);return s!=null&&c(t,["threshold"],s),t}function Yg(n,e){const t={};if(l(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=l(e,["description"]);r!=null&&c(t,["description"],r);const i=l(e,["name"]);i!=null&&c(t,["name"],i);const s=l(e,["parameters"]);s!=null&&c(t,["parameters"],s);const o=l(e,["response"]);return o!=null&&c(t,["response"],o),t}function Kg(n,e){const t={},r=l(e,["startTime"]);r!=null&&c(t,["startTime"],r);const i=l(e,["endTime"]);return i!=null&&c(t,["endTime"],i),t}function Zg(n,e){const t={},r=l(e,["timeRangeFilter"]);return r!=null&&c(t,["timeRangeFilter"],Kg(n,r)),t}function Xg(n,e){const t={},r=l(e,["mode"]);r!=null&&c(t,["mode"],r);const i=l(e,["dynamicThreshold"]);return i!=null&&c(t,["dynamicThreshold"],i),t}function Qg(n,e){const t={},r=l(e,["dynamicRetrievalConfig"]);return r!=null&&c(t,["dynamicRetrievalConfig"],Xg(n,r)),t}function ey(){return{}}function ty(n,e){const t={},r=l(e,["apiKeyString"]);return r!=null&&c(t,["apiKeyString"],r),t}function ny(n,e){const t={},r=l(e,["apiKeyConfig"]);r!=null&&c(t,["apiKeyConfig"],ty(n,r));const i=l(e,["authType"]);i!=null&&c(t,["authType"],i);const s=l(e,["googleServiceAccountConfig"]);s!=null&&c(t,["googleServiceAccountConfig"],s);const o=l(e,["httpBasicAuthConfig"]);o!=null&&c(t,["httpBasicAuthConfig"],o);const a=l(e,["oauthConfig"]);a!=null&&c(t,["oauthConfig"],a);const d=l(e,["oidcConfig"]);return d!=null&&c(t,["oidcConfig"],d),t}function ry(n,e){const t={},r=l(e,["authConfig"]);return r!=null&&c(t,["authConfig"],ny(n,r)),t}function kc(n,e){const t={},r=l(e,["functionDeclarations"]);if(r!=null){let m=r;Array.isArray(m)&&(m=m.map(p=>Yg(n,p))),c(t,["functionDeclarations"],m)}const i=l(e,["retrieval"]);i!=null&&c(t,["retrieval"],i);const s=l(e,["googleSearch"]);s!=null&&c(t,["googleSearch"],Zg(n,s));const o=l(e,["googleSearchRetrieval"]);o!=null&&c(t,["googleSearchRetrieval"],Qg(n,o)),l(e,["enterpriseWebSearch"])!=null&&c(t,["enterpriseWebSearch"],ey());const d=l(e,["googleMaps"]);if(d!=null&&c(t,["googleMaps"],ry(n,d)),l(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const u=l(e,["codeExecution"]);return u!=null&&c(t,["codeExecution"],u),t}function iy(n,e){const t={},r=l(e,["mode"]);r!=null&&c(t,["mode"],r);const i=l(e,["allowedFunctionNames"]);return i!=null&&c(t,["allowedFunctionNames"],i),t}function sy(n,e){const t={},r=l(e,["latitude"]);r!=null&&c(t,["latitude"],r);const i=l(e,["longitude"]);return i!=null&&c(t,["longitude"],i),t}function oy(n,e){const t={},r=l(e,["latLng"]);return r!=null&&c(t,["latLng"],sy(n,r)),t}function ay(n,e){const t={},r=l(e,["functionCallingConfig"]);r!=null&&c(t,["functionCallingConfig"],iy(n,r));const i=l(e,["retrievalConfig"]);return i!=null&&c(t,["retrievalConfig"],oy(n,i)),t}function ly(n,e){const t={},r=l(e,["voiceName"]);return r!=null&&c(t,["voiceName"],r),t}function cy(n,e){const t={},r=l(e,["prebuiltVoiceConfig"]);return r!=null&&c(t,["prebuiltVoiceConfig"],ly(n,r)),t}function uy(n,e){const t={},r=l(e,["voiceConfig"]);if(r!=null&&c(t,["voiceConfig"],cy(n,r)),l(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=l(e,["languageCode"]);return i!=null&&c(t,["languageCode"],i),t}function dy(n,e){const t={},r=l(e,["includeThoughts"]);r!=null&&c(t,["includeThoughts"],r);const i=l(e,["thinkingBudget"]);return i!=null&&c(t,["thinkingBudget"],i),t}function fy(n,e,t){const r={},i=l(e,["systemInstruction"]);t!==void 0&&i!=null&&c(t,["systemInstruction"],Tn(n,Qe(n,i)));const s=l(e,["temperature"]);s!=null&&c(r,["temperature"],s);const o=l(e,["topP"]);o!=null&&c(r,["topP"],o);const a=l(e,["topK"]);a!=null&&c(r,["topK"],a);const d=l(e,["candidateCount"]);d!=null&&c(r,["candidateCount"],d);const u=l(e,["maxOutputTokens"]);u!=null&&c(r,["maxOutputTokens"],u);const m=l(e,["stopSequences"]);m!=null&&c(r,["stopSequences"],m);const p=l(e,["responseLogprobs"]);p!=null&&c(r,["responseLogprobs"],p);const h=l(e,["logprobs"]);h!=null&&c(r,["logprobs"],h);const y=l(e,["presencePenalty"]);y!=null&&c(r,["presencePenalty"],y);const v=l(e,["frequencyPenalty"]);v!=null&&c(r,["frequencyPenalty"],v);const _=l(e,["seed"]);_!=null&&c(r,["seed"],_);const x=l(e,["responseMimeType"]);x!=null&&c(r,["responseMimeType"],x);const b=l(e,["responseSchema"]);b!=null&&c(r,["responseSchema"],Ir(n,b));const w=l(e,["routingConfig"]);w!=null&&c(r,["routingConfig"],w);const A=l(e,["modelSelectionConfig"]);A!=null&&c(r,["modelConfig"],Wg(n,A));const S=l(e,["safetySettings"]);if(t!==void 0&&S!=null){let ie=S;Array.isArray(ie)&&(ie=ie.map(pe=>Jg(n,pe))),c(t,["safetySettings"],ie)}const C=l(e,["tools"]);if(t!==void 0&&C!=null){let ie=qr(n,C);Array.isArray(ie)&&(ie=ie.map(pe=>kc(n,Ur(n,pe)))),c(t,["tools"],ie)}const N=l(e,["toolConfig"]);t!==void 0&&N!=null&&c(t,["toolConfig"],ay(n,N));const D=l(e,["labels"]);t!==void 0&&D!=null&&c(t,["labels"],D);const V=l(e,["cachedContent"]);t!==void 0&&V!=null&&c(t,["cachedContent"],qt(n,V));const O=l(e,["responseModalities"]);O!=null&&c(r,["responseModalities"],O);const W=l(e,["mediaResolution"]);W!=null&&c(r,["mediaResolution"],W);const ne=l(e,["speechConfig"]);ne!=null&&c(r,["speechConfig"],uy(n,hc(n,ne)));const se=l(e,["audioTimestamp"]);se!=null&&c(r,["audioTimestamp"],se);const J=l(e,["thinkingConfig"]);return J!=null&&c(r,["thinkingConfig"],dy(n,J)),r}function Ia(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["contents"]);if(i!=null){let o=ht(n,i);Array.isArray(o)&&(o=o.map(a=>Tn(n,a))),c(t,["contents"],o)}const s=l(e,["config"]);return s!=null&&c(t,["generationConfig"],fy(n,s,t)),t}function my(n,e,t){const r={},i=l(e,["taskType"]);t!==void 0&&i!=null&&c(t,["instances[]","task_type"],i);const s=l(e,["title"]);t!==void 0&&s!=null&&c(t,["instances[]","title"],s);const o=l(e,["outputDimensionality"]);t!==void 0&&o!=null&&c(t,["parameters","outputDimensionality"],o);const a=l(e,["mimeType"]);t!==void 0&&a!=null&&c(t,["instances[]","mimeType"],a);const d=l(e,["autoTruncate"]);return t!==void 0&&d!=null&&c(t,["parameters","autoTruncate"],d),r}function py(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["contents"]);i!=null&&c(t,["instances[]","content"],pc(n,i));const s=l(e,["config"]);return s!=null&&c(t,["config"],my(n,s,t)),t}function hy(n,e,t){const r={},i=l(e,["outputGcsUri"]);t!==void 0&&i!=null&&c(t,["parameters","storageUri"],i);const s=l(e,["negativePrompt"]);t!==void 0&&s!=null&&c(t,["parameters","negativePrompt"],s);const o=l(e,["numberOfImages"]);t!==void 0&&o!=null&&c(t,["parameters","sampleCount"],o);const a=l(e,["aspectRatio"]);t!==void 0&&a!=null&&c(t,["parameters","aspectRatio"],a);const d=l(e,["guidanceScale"]);t!==void 0&&d!=null&&c(t,["parameters","guidanceScale"],d);const u=l(e,["seed"]);t!==void 0&&u!=null&&c(t,["parameters","seed"],u);const m=l(e,["safetyFilterLevel"]);t!==void 0&&m!=null&&c(t,["parameters","safetySetting"],m);const p=l(e,["personGeneration"]);t!==void 0&&p!=null&&c(t,["parameters","personGeneration"],p);const h=l(e,["includeSafetyAttributes"]);t!==void 0&&h!=null&&c(t,["parameters","includeSafetyAttributes"],h);const y=l(e,["includeRaiReason"]);t!==void 0&&y!=null&&c(t,["parameters","includeRaiReason"],y);const v=l(e,["language"]);t!==void 0&&v!=null&&c(t,["parameters","language"],v);const _=l(e,["outputMimeType"]);t!==void 0&&_!=null&&c(t,["parameters","outputOptions","mimeType"],_);const x=l(e,["outputCompressionQuality"]);t!==void 0&&x!=null&&c(t,["parameters","outputOptions","compressionQuality"],x);const b=l(e,["addWatermark"]);t!==void 0&&b!=null&&c(t,["parameters","addWatermark"],b);const w=l(e,["enhancePrompt"]);return t!==void 0&&w!=null&&c(t,["parameters","enhancePrompt"],w),r}function gy(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["prompt"]);i!=null&&c(t,["instances[0]","prompt"],i);const s=l(e,["config"]);return s!=null&&c(t,["config"],hy(n,s,t)),t}function Fs(n,e){const t={},r=l(e,["gcsUri"]);r!=null&&c(t,["gcsUri"],r);const i=l(e,["imageBytes"]);i!=null&&c(t,["bytesBase64Encoded"],jt(n,i));const s=l(e,["mimeType"]);return s!=null&&c(t,["mimeType"],s),t}function yy(n,e){const t={},r=l(e,["maskMode"]);r!=null&&c(t,["maskMode"],r);const i=l(e,["segmentationClasses"]);i!=null&&c(t,["maskClasses"],i);const s=l(e,["maskDilation"]);return s!=null&&c(t,["dilation"],s),t}function _y(n,e){const t={},r=l(e,["controlType"]);r!=null&&c(t,["controlType"],r);const i=l(e,["enableControlImageComputation"]);return i!=null&&c(t,["computeControl"],i),t}function vy(n,e){const t={},r=l(e,["styleDescription"]);return r!=null&&c(t,["styleDescription"],r),t}function wy(n,e){const t={},r=l(e,["subjectType"]);r!=null&&c(t,["subjectType"],r);const i=l(e,["subjectDescription"]);return i!=null&&c(t,["subjectDescription"],i),t}function xy(n,e){const t={},r=l(e,["referenceImage"]);r!=null&&c(t,["referenceImage"],Fs(n,r));const i=l(e,["referenceId"]);i!=null&&c(t,["referenceId"],i);const s=l(e,["referenceType"]);s!=null&&c(t,["referenceType"],s);const o=l(e,["maskImageConfig"]);o!=null&&c(t,["maskImageConfig"],yy(n,o));const a=l(e,["controlImageConfig"]);a!=null&&c(t,["controlImageConfig"],_y(n,a));const d=l(e,["styleImageConfig"]);d!=null&&c(t,["styleImageConfig"],vy(n,d));const u=l(e,["subjectImageConfig"]);return u!=null&&c(t,["subjectImageConfig"],wy(n,u)),t}function by(n,e,t){const r={},i=l(e,["outputGcsUri"]);t!==void 0&&i!=null&&c(t,["parameters","storageUri"],i);const s=l(e,["negativePrompt"]);t!==void 0&&s!=null&&c(t,["parameters","negativePrompt"],s);const o=l(e,["numberOfImages"]);t!==void 0&&o!=null&&c(t,["parameters","sampleCount"],o);const a=l(e,["aspectRatio"]);t!==void 0&&a!=null&&c(t,["parameters","aspectRatio"],a);const d=l(e,["guidanceScale"]);t!==void 0&&d!=null&&c(t,["parameters","guidanceScale"],d);const u=l(e,["seed"]);t!==void 0&&u!=null&&c(t,["parameters","seed"],u);const m=l(e,["safetyFilterLevel"]);t!==void 0&&m!=null&&c(t,["parameters","safetySetting"],m);const p=l(e,["personGeneration"]);t!==void 0&&p!=null&&c(t,["parameters","personGeneration"],p);const h=l(e,["includeSafetyAttributes"]);t!==void 0&&h!=null&&c(t,["parameters","includeSafetyAttributes"],h);const y=l(e,["includeRaiReason"]);t!==void 0&&y!=null&&c(t,["parameters","includeRaiReason"],y);const v=l(e,["language"]);t!==void 0&&v!=null&&c(t,["parameters","language"],v);const _=l(e,["outputMimeType"]);t!==void 0&&_!=null&&c(t,["parameters","outputOptions","mimeType"],_);const x=l(e,["outputCompressionQuality"]);t!==void 0&&x!=null&&c(t,["parameters","outputOptions","compressionQuality"],x);const b=l(e,["editMode"]);t!==void 0&&b!=null&&c(t,["parameters","editMode"],b);const w=l(e,["baseSteps"]);return t!==void 0&&w!=null&&c(t,["parameters","editConfig","baseSteps"],w),r}function Cy(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["prompt"]);i!=null&&c(t,["instances[0]","prompt"],i);const s=l(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(d=>xy(n,d))),c(t,["instances[0]","referenceImages"],a)}const o=l(e,["config"]);return o!=null&&c(t,["config"],by(n,o,t)),t}function Ty(n,e,t){const r={},i=l(e,["includeRaiReason"]);t!==void 0&&i!=null&&c(t,["parameters","includeRaiReason"],i);const s=l(e,["outputMimeType"]);t!==void 0&&s!=null&&c(t,["parameters","outputOptions","mimeType"],s);const o=l(e,["outputCompressionQuality"]);t!==void 0&&o!=null&&c(t,["parameters","outputOptions","compressionQuality"],o);const a=l(e,["numberOfImages"]);t!==void 0&&a!=null&&c(t,["parameters","sampleCount"],a);const d=l(e,["mode"]);return t!==void 0&&d!=null&&c(t,["parameters","mode"],d),r}function Sy(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["image"]);i!=null&&c(t,["instances[0]","image"],Fs(n,i));const s=l(e,["upscaleFactor"]);s!=null&&c(t,["parameters","upscaleConfig","upscaleFactor"],s);const o=l(e,["config"]);return o!=null&&c(t,["config"],Ty(n,o,t)),t}function Ey(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","name"],Ie(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function Ay(n,e,t){const r={},i=l(e,["pageSize"]);t!==void 0&&i!=null&&c(t,["_query","pageSize"],i);const s=l(e,["pageToken"]);t!==void 0&&s!=null&&c(t,["_query","pageToken"],s);const o=l(e,["filter"]);t!==void 0&&o!=null&&c(t,["_query","filter"],o);const a=l(e,["queryBase"]);return t!==void 0&&a!=null&&c(t,["_url","models_url"],vc(n,a)),r}function ky(n,e){const t={},r=l(e,["config"]);return r!=null&&c(t,["config"],Ay(n,r,t)),t}function Iy(n,e,t){const r={},i=l(e,["displayName"]);t!==void 0&&i!=null&&c(t,["displayName"],i);const s=l(e,["description"]);t!==void 0&&s!=null&&c(t,["description"],s);const o=l(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&c(t,["defaultCheckpointId"],o),r}function Ny(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],Iy(n,i,t)),t}function Ry(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","name"],Ie(n,r));const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function Dy(n,e,t){const r={},i=l(e,["systemInstruction"]);t!==void 0&&i!=null&&c(t,["systemInstruction"],Tn(n,Qe(n,i)));const s=l(e,["tools"]);if(t!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(d=>kc(n,d))),c(t,["tools"],a)}const o=l(e,["generationConfig"]);return t!==void 0&&o!=null&&c(t,["generationConfig"],o),r}function Py(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["contents"]);if(i!=null){let o=ht(n,i);Array.isArray(o)&&(o=o.map(a=>Tn(n,a))),c(t,["contents"],o)}const s=l(e,["config"]);return s!=null&&c(t,["config"],Dy(n,s,t)),t}function My(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["contents"]);if(i!=null){let o=ht(n,i);Array.isArray(o)&&(o=o.map(a=>Tn(n,a))),c(t,["contents"],o)}const s=l(e,["config"]);return s!=null&&c(t,["config"],s),t}function Ly(n,e,t){const r={},i=l(e,["numberOfVideos"]);t!==void 0&&i!=null&&c(t,["parameters","sampleCount"],i);const s=l(e,["outputGcsUri"]);t!==void 0&&s!=null&&c(t,["parameters","storageUri"],s);const o=l(e,["fps"]);t!==void 0&&o!=null&&c(t,["parameters","fps"],o);const a=l(e,["durationSeconds"]);t!==void 0&&a!=null&&c(t,["parameters","durationSeconds"],a);const d=l(e,["seed"]);t!==void 0&&d!=null&&c(t,["parameters","seed"],d);const u=l(e,["aspectRatio"]);t!==void 0&&u!=null&&c(t,["parameters","aspectRatio"],u);const m=l(e,["resolution"]);t!==void 0&&m!=null&&c(t,["parameters","resolution"],m);const p=l(e,["personGeneration"]);t!==void 0&&p!=null&&c(t,["parameters","personGeneration"],p);const h=l(e,["pubsubTopic"]);t!==void 0&&h!=null&&c(t,["parameters","pubsubTopic"],h);const y=l(e,["negativePrompt"]);t!==void 0&&y!=null&&c(t,["parameters","negativePrompt"],y);const v=l(e,["enhancePrompt"]);return t!==void 0&&v!=null&&c(t,["parameters","enhancePrompt"],v),r}function $y(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["_url","model"],Ie(n,r));const i=l(e,["prompt"]);i!=null&&c(t,["instances[0]","prompt"],i);const s=l(e,["image"]);s!=null&&c(t,["instances[0]","image"],Fs(n,s));const o=l(e,["config"]);return o!=null&&c(t,["config"],Ly(n,o,t)),t}function Fy(n,e){const t={},r=l(e,["fps"]);r!=null&&c(t,["fps"],r);const i=l(e,["endOffset"]);i!=null&&c(t,["endOffset"],i);const s=l(e,["startOffset"]);return s!=null&&c(t,["startOffset"],s),t}function Oy(n,e){const t={},r=l(e,["data"]);r!=null&&c(t,["data"],r);const i=l(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function Vy(n,e){const t={},r=l(e,["videoMetadata"]);r!=null&&c(t,["videoMetadata"],Fy(n,r));const i=l(e,["thought"]);i!=null&&c(t,["thought"],i);const s=l(e,["inlineData"]);s!=null&&c(t,["inlineData"],Oy(n,s));const o=l(e,["codeExecutionResult"]);o!=null&&c(t,["codeExecutionResult"],o);const a=l(e,["executableCode"]);a!=null&&c(t,["executableCode"],a);const d=l(e,["fileData"]);d!=null&&c(t,["fileData"],d);const u=l(e,["functionCall"]);u!=null&&c(t,["functionCall"],u);const m=l(e,["functionResponse"]);m!=null&&c(t,["functionResponse"],m);const p=l(e,["text"]);return p!=null&&c(t,["text"],p),t}function Uy(n,e){const t={},r=l(e,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Vy(n,o))),c(t,["parts"],s)}const i=l(e,["role"]);return i!=null&&c(t,["role"],i),t}function qy(n,e){const t={},r=l(e,["citationSources"]);return r!=null&&c(t,["citations"],r),t}function jy(n,e){const t={},r=l(e,["retrievedUrl"]);r!=null&&c(t,["retrievedUrl"],r);const i=l(e,["urlRetrievalStatus"]);return i!=null&&c(t,["urlRetrievalStatus"],i),t}function By(n,e){const t={},r=l(e,["urlMetadata"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>jy(n,s))),c(t,["urlMetadata"],i)}return t}function Gy(n,e){const t={},r=l(e,["content"]);r!=null&&c(t,["content"],Uy(n,r));const i=l(e,["citationMetadata"]);i!=null&&c(t,["citationMetadata"],qy(n,i));const s=l(e,["tokenCount"]);s!=null&&c(t,["tokenCount"],s);const o=l(e,["finishReason"]);o!=null&&c(t,["finishReason"],o);const a=l(e,["urlContextMetadata"]);a!=null&&c(t,["urlContextMetadata"],By(n,a));const d=l(e,["avgLogprobs"]);d!=null&&c(t,["avgLogprobs"],d);const u=l(e,["groundingMetadata"]);u!=null&&c(t,["groundingMetadata"],u);const m=l(e,["index"]);m!=null&&c(t,["index"],m);const p=l(e,["logprobsResult"]);p!=null&&c(t,["logprobsResult"],p);const h=l(e,["safetyRatings"]);return h!=null&&c(t,["safetyRatings"],h),t}function Na(n,e){const t={},r=l(e,["candidates"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(d=>Gy(n,d))),c(t,["candidates"],a)}const i=l(e,["modelVersion"]);i!=null&&c(t,["modelVersion"],i);const s=l(e,["promptFeedback"]);s!=null&&c(t,["promptFeedback"],s);const o=l(e,["usageMetadata"]);return o!=null&&c(t,["usageMetadata"],o),t}function Hy(n,e){const t={},r=l(e,["values"]);return r!=null&&c(t,["values"],r),t}function zy(){return{}}function Wy(n,e){const t={},r=l(e,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Hy(n,o))),c(t,["embeddings"],s)}return l(e,["metadata"])!=null&&c(t,["metadata"],zy()),t}function Jy(n,e){const t={},r=l(e,["bytesBase64Encoded"]);r!=null&&c(t,["imageBytes"],jt(n,r));const i=l(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function Ic(n,e){const t={},r=l(e,["safetyAttributes","categories"]);r!=null&&c(t,["categories"],r);const i=l(e,["safetyAttributes","scores"]);i!=null&&c(t,["scores"],i);const s=l(e,["contentType"]);return s!=null&&c(t,["contentType"],s),t}function Yy(n,e){const t={},r=l(e,["_self"]);r!=null&&c(t,["image"],Jy(n,r));const i=l(e,["raiFilteredReason"]);i!=null&&c(t,["raiFilteredReason"],i);const s=l(e,["_self"]);return s!=null&&c(t,["safetyAttributes"],Ic(n,s)),t}function Ky(n,e){const t={},r=l(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Yy(n,o))),c(t,["generatedImages"],s)}const i=l(e,["positivePromptSafetyAttributes"]);return i!=null&&c(t,["positivePromptSafetyAttributes"],Ic(n,i)),t}function Zy(n,e){const t={},r=l(e,["baseModel"]);r!=null&&c(t,["baseModel"],r);const i=l(e,["createTime"]);i!=null&&c(t,["createTime"],i);const s=l(e,["updateTime"]);return s!=null&&c(t,["updateTime"],s),t}function as(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["displayName"]);i!=null&&c(t,["displayName"],i);const s=l(e,["description"]);s!=null&&c(t,["description"],s);const o=l(e,["version"]);o!=null&&c(t,["version"],o);const a=l(e,["_self"]);a!=null&&c(t,["tunedModelInfo"],Zy(n,a));const d=l(e,["inputTokenLimit"]);d!=null&&c(t,["inputTokenLimit"],d);const u=l(e,["outputTokenLimit"]);u!=null&&c(t,["outputTokenLimit"],u);const m=l(e,["supportedGenerationMethods"]);return m!=null&&c(t,["supportedActions"],m),t}function Xy(n,e){const t={},r=l(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=l(e,["_self"]);if(i!=null){let s=wc(n,i);Array.isArray(s)&&(s=s.map(o=>as(n,o))),c(t,["models"],s)}return t}function Qy(){return{}}function e_(n,e){const t={},r=l(e,["totalTokens"]);r!=null&&c(t,["totalTokens"],r);const i=l(e,["cachedContentTokenCount"]);return i!=null&&c(t,["cachedContentTokenCount"],i),t}function t_(n,e){const t={},r=l(e,["video","uri"]);r!=null&&c(t,["uri"],r);const i=l(e,["video","encodedVideo"]);i!=null&&c(t,["videoBytes"],jt(n,i));const s=l(e,["encoding"]);return s!=null&&c(t,["mimeType"],s),t}function n_(n,e){const t={},r=l(e,["_self"]);return r!=null&&c(t,["video"],t_(n,r)),t}function r_(n,e){const t={},r=l(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>n_(n,a))),c(t,["generatedVideos"],o)}const i=l(e,["raiMediaFilteredCount"]);i!=null&&c(t,["raiMediaFilteredCount"],i);const s=l(e,["raiMediaFilteredReasons"]);return s!=null&&c(t,["raiMediaFilteredReasons"],s),t}function i_(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["metadata"]);i!=null&&c(t,["metadata"],i);const s=l(e,["done"]);s!=null&&c(t,["done"],s);const o=l(e,["error"]);o!=null&&c(t,["error"],o);const a=l(e,["response","generateVideoResponse"]);return a!=null&&c(t,["response"],r_(n,a)),t}function s_(n,e){const t={},r=l(e,["fps"]);r!=null&&c(t,["fps"],r);const i=l(e,["endOffset"]);i!=null&&c(t,["endOffset"],i);const s=l(e,["startOffset"]);return s!=null&&c(t,["startOffset"],s),t}function o_(n,e){const t={},r=l(e,["displayName"]);r!=null&&c(t,["displayName"],r);const i=l(e,["data"]);i!=null&&c(t,["data"],i);const s=l(e,["mimeType"]);return s!=null&&c(t,["mimeType"],s),t}function a_(n,e){const t={},r=l(e,["videoMetadata"]);r!=null&&c(t,["videoMetadata"],s_(n,r));const i=l(e,["thought"]);i!=null&&c(t,["thought"],i);const s=l(e,["inlineData"]);s!=null&&c(t,["inlineData"],o_(n,s));const o=l(e,["codeExecutionResult"]);o!=null&&c(t,["codeExecutionResult"],o);const a=l(e,["executableCode"]);a!=null&&c(t,["executableCode"],a);const d=l(e,["fileData"]);d!=null&&c(t,["fileData"],d);const u=l(e,["functionCall"]);u!=null&&c(t,["functionCall"],u);const m=l(e,["functionResponse"]);m!=null&&c(t,["functionResponse"],m);const p=l(e,["text"]);return p!=null&&c(t,["text"],p),t}function l_(n,e){const t={},r=l(e,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>a_(n,o))),c(t,["parts"],s)}const i=l(e,["role"]);return i!=null&&c(t,["role"],i),t}function c_(n,e){const t={},r=l(e,["citations"]);return r!=null&&c(t,["citations"],r),t}function u_(n,e){const t={},r=l(e,["content"]);r!=null&&c(t,["content"],l_(n,r));const i=l(e,["citationMetadata"]);i!=null&&c(t,["citationMetadata"],c_(n,i));const s=l(e,["finishMessage"]);s!=null&&c(t,["finishMessage"],s);const o=l(e,["finishReason"]);o!=null&&c(t,["finishReason"],o);const a=l(e,["avgLogprobs"]);a!=null&&c(t,["avgLogprobs"],a);const d=l(e,["groundingMetadata"]);d!=null&&c(t,["groundingMetadata"],d);const u=l(e,["index"]);u!=null&&c(t,["index"],u);const m=l(e,["logprobsResult"]);m!=null&&c(t,["logprobsResult"],m);const p=l(e,["safetyRatings"]);return p!=null&&c(t,["safetyRatings"],p),t}function Ra(n,e){const t={},r=l(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(m=>u_(n,m))),c(t,["candidates"],u)}const i=l(e,["createTime"]);i!=null&&c(t,["createTime"],i);const s=l(e,["responseId"]);s!=null&&c(t,["responseId"],s);const o=l(e,["modelVersion"]);o!=null&&c(t,["modelVersion"],o);const a=l(e,["promptFeedback"]);a!=null&&c(t,["promptFeedback"],a);const d=l(e,["usageMetadata"]);return d!=null&&c(t,["usageMetadata"],d),t}function d_(n,e){const t={},r=l(e,["truncated"]);r!=null&&c(t,["truncated"],r);const i=l(e,["token_count"]);return i!=null&&c(t,["tokenCount"],i),t}function f_(n,e){const t={},r=l(e,["values"]);r!=null&&c(t,["values"],r);const i=l(e,["statistics"]);return i!=null&&c(t,["statistics"],d_(n,i)),t}function m_(n,e){const t={},r=l(e,["billableCharacterCount"]);return r!=null&&c(t,["billableCharacterCount"],r),t}function p_(n,e){const t={},r=l(e,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>f_(n,o))),c(t,["embeddings"],s)}const i=l(e,["metadata"]);return i!=null&&c(t,["metadata"],m_(n,i)),t}function h_(n,e){const t={},r=l(e,["gcsUri"]);r!=null&&c(t,["gcsUri"],r);const i=l(e,["bytesBase64Encoded"]);i!=null&&c(t,["imageBytes"],jt(n,i));const s=l(e,["mimeType"]);return s!=null&&c(t,["mimeType"],s),t}function Nc(n,e){const t={},r=l(e,["safetyAttributes","categories"]);r!=null&&c(t,["categories"],r);const i=l(e,["safetyAttributes","scores"]);i!=null&&c(t,["scores"],i);const s=l(e,["contentType"]);return s!=null&&c(t,["contentType"],s),t}function Os(n,e){const t={},r=l(e,["_self"]);r!=null&&c(t,["image"],h_(n,r));const i=l(e,["raiFilteredReason"]);i!=null&&c(t,["raiFilteredReason"],i);const s=l(e,["_self"]);s!=null&&c(t,["safetyAttributes"],Nc(n,s));const o=l(e,["prompt"]);return o!=null&&c(t,["enhancedPrompt"],o),t}function g_(n,e){const t={},r=l(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Os(n,o))),c(t,["generatedImages"],s)}const i=l(e,["positivePromptSafetyAttributes"]);return i!=null&&c(t,["positivePromptSafetyAttributes"],Nc(n,i)),t}function y_(n,e){const t={},r=l(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Os(n,s))),c(t,["generatedImages"],i)}return t}function __(n,e){const t={},r=l(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Os(n,s))),c(t,["generatedImages"],i)}return t}function v_(n,e){const t={},r=l(e,["endpoint"]);r!=null&&c(t,["name"],r);const i=l(e,["deployedModelId"]);return i!=null&&c(t,["deployedModelId"],i),t}function w_(n,e){const t={},r=l(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&c(t,["baseModel"],r);const i=l(e,["createTime"]);i!=null&&c(t,["createTime"],i);const s=l(e,["updateTime"]);return s!=null&&c(t,["updateTime"],s),t}function x_(n,e){const t={},r=l(e,["checkpointId"]);r!=null&&c(t,["checkpointId"],r);const i=l(e,["epoch"]);i!=null&&c(t,["epoch"],i);const s=l(e,["step"]);return s!=null&&c(t,["step"],s),t}function ls(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["displayName"]);i!=null&&c(t,["displayName"],i);const s=l(e,["description"]);s!=null&&c(t,["description"],s);const o=l(e,["versionId"]);o!=null&&c(t,["version"],o);const a=l(e,["deployedModels"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(y=>v_(n,y))),c(t,["endpoints"],h)}const d=l(e,["labels"]);d!=null&&c(t,["labels"],d);const u=l(e,["_self"]);u!=null&&c(t,["tunedModelInfo"],w_(n,u));const m=l(e,["defaultCheckpointId"]);m!=null&&c(t,["defaultCheckpointId"],m);const p=l(e,["checkpoints"]);if(p!=null){let h=p;Array.isArray(h)&&(h=h.map(y=>x_(n,y))),c(t,["checkpoints"],h)}return t}function b_(n,e){const t={},r=l(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=l(e,["_self"]);if(i!=null){let s=wc(n,i);Array.isArray(s)&&(s=s.map(o=>ls(n,o))),c(t,["models"],s)}return t}function C_(){return{}}function T_(n,e){const t={},r=l(e,["totalTokens"]);return r!=null&&c(t,["totalTokens"],r),t}function S_(n,e){const t={},r=l(e,["tokensInfo"]);return r!=null&&c(t,["tokensInfo"],r),t}function E_(n,e){const t={},r=l(e,["gcsUri"]);r!=null&&c(t,["uri"],r);const i=l(e,["bytesBase64Encoded"]);i!=null&&c(t,["videoBytes"],jt(n,i));const s=l(e,["mimeType"]);return s!=null&&c(t,["mimeType"],s),t}function A_(n,e){const t={},r=l(e,["_self"]);return r!=null&&c(t,["video"],E_(n,r)),t}function k_(n,e){const t={},r=l(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>A_(n,a))),c(t,["generatedVideos"],o)}const i=l(e,["raiMediaFilteredCount"]);i!=null&&c(t,["raiMediaFilteredCount"],i);const s=l(e,["raiMediaFilteredReasons"]);return s!=null&&c(t,["raiMediaFilteredReasons"],s),t}function I_(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["metadata"]);i!=null&&c(t,["metadata"],i);const s=l(e,["done"]);s!=null&&c(t,["done"],s);const o=l(e,["error"]);o!=null&&c(t,["error"],o);const a=l(e,["response"]);return a!=null&&c(t,["response"],k_(n,a)),t}const N_="Content-Type",R_="X-Server-Timeout",D_="User-Agent",cs="x-goog-api-client",P_="0.15.0",M_=`google-genai-sdk/${P_}`,L_="v1beta1",$_="v1beta",Da=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Rc extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class us extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class F_{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:L_,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:$_,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,r){const i=[this.getRequestUrlInternal(t)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,t){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(t))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r){if(t&&t.timeout||r){const i=new AbortController,s=i.signal;t.timeout&&t?.timeout>0&&setTimeout(()=>i.abort(),t.timeout),r&&r.addEventListener("abort",()=>{i.abort()}),e.signal=s}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await Pa(i),new rs(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await Pa(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var t;return qn(this,arguments,function*(){const i=(t=e?.body)===null||t===void 0?void 0:t.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:d}=yield Re(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(d);try{const p=JSON.parse(u);if("error"in p){const h=JSON.parse(JSON.stringify(p.error)),y=h.status,v=h.code,_=`got status: ${y}. ${JSON.stringify(p)}`;if(v>=400&&v<500)throw new Rc(_);if(v>=500&&v<600)throw new us(_)}}catch(p){const h=p;if(h.name==="ClientError"||h.name==="ServerError")throw p}o+=u;let m=o.match(Da);for(;m;){const p=m[1];try{const h=new Response(p,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield Re(new rs(h)),o=o.slice(m[0].length),m=o.match(Da)}catch(h){throw new Error(`exception parsing stream chunk ${p}. ${h}`)}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},t=M_+" "+this.clientOptions.userAgentExtra;return e[D_]=t,e[cs]=t,e[N_]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[r,i]of Object.entries(e.headers))t.append(r,i);e.timeout&&e.timeout>0&&t.append(R_,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var r;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(e);i.sizeBytes=String(o.size);const a=(r=t?.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const d=await this.fetchUploadUrl(i,t);return s.upload(e,d,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var r;let i={};t?.httpOptions?i=t.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const s={file:e},o=await this.request({path:ce("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:i});if(!o||!o?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const a=(r=o?.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}}async function Pa(n){var e;if(n===void 0)throw new us("response is undefined");if(!n.ok){const t=n.status,r=n.statusText;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const s=`got status: ${t} ${r}. ${JSON.stringify(i)}`;throw t>=400&&t<500?new Rc(s):t>=500&&t<600?new us(s):new Error(s)}}const O_="mcp_used/unknown";function ds(n){for(const e of n)if(Vs(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function fs(n){var e;n[cs]=(((e=n[cs])!==null&&e!==void 0?e:"")+` ${O_}`).trimStart()}function V_(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>Vs(i)))!==null&&r!==void 0?r:!1}function U_(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>!Vs(i)))!==null&&r!==void 0?r:!1}function Vs(n){return n!==null&&typeof n=="object"&&"tool"in n&&"callTool"in n}async function q_(n,e,t){const r=new Xf,i=JSON.parse(t.data),s=ag(n,i);Object.assign(r,s),e(r)}class j_{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=H_(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),d=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const m=new Promise(A=>{u=A}),p=e.callbacks,h=function(){u({})},y=this.apiClient,v={onopen:h,onmessage:A=>{q_(y,p.onmessage,A)},onerror:(t=p?.onerror)!==null&&t!==void 0?t:function(A){},onclose:(r=p?.onclose)!==null&&r!==void 0?r:function(A){}},_=this.webSocketFactory.create(d,G_(o),v);_.connect(),await m;const x=Ie(this.apiClient,e.model),b=Sc(this.apiClient,{model:x}),w=os(this.apiClient,{setup:b});return _.send(JSON.stringify(w)),new B_(_,this.apiClient)}}class B_{constructor(e,t){this.conn=e,this.apiClient=t}async setClientContent(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=Ch(this.apiClient,e),r=Ec(this.apiClient,t);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=Th(this.apiClient,e),r=os(this.apiClient,t);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const t=os(this.apiClient,{playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(fn.PLAY)}pause(){this.sendPlaybackControl(fn.PAUSE)}stop(){this.sendPlaybackControl(fn.STOP)}resetContext(){this.sendPlaybackControl(fn.RESET_CONTEXT)}close(){this.conn.close()}}function G_(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function H_(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const z_="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function W_(n,e,t){const r=new Zf;let i;if(t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),n.isVertexAI()){const s=Xh(n,i);Object.assign(r,s)}else{const s=Zh(n,i);Object.assign(r,s)}e(r)}class J_{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new j_(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,i,s,o,a;const d=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let m;const p=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&ds(e.config.tools)&&fs(p);const h=X_(p);if(this.apiClient.isVertexAI())m=`${d}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(h);else{const O=this.apiClient.getApiKey();m=`${d}/ws/google.ai.generativelanguage.${u}.GenerativeService.BidiGenerateContent?key=${O}`}let y=()=>{};const v=new Promise(O=>{y=O}),_=e.callbacks,x=function(){var O;(O=_?.onopen)===null||O===void 0||O.call(_),y({})},b=this.apiClient,w={onopen:x,onmessage:O=>{W_(b,_.onmessage,O)},onerror:(t=_?.onerror)!==null&&t!==void 0?t:function(O){},onclose:(r=_?.onclose)!==null&&r!==void 0?r:function(O){}},A=this.webSocketFactory.create(m,Z_(h),w);A.connect(),await v;let S=Ie(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&S.startsWith("publishers/")){const O=this.apiClient.getProject(),W=this.apiClient.getLocation();S=`projects/${O}/locations/${W}/`+S}let C={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Hn.AUDIO]}:e.config.responseModalities=[Hn.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const N=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],D=[];for(const O of N)if(this.isCallableTool(O)){const W=O;D.push(await W.tool())}else D.push(O);D.length>0&&(e.config.tools=D);const V={model:S,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?C=gh(this.apiClient,V):C=hh(this.apiClient,V),delete C.config,A.send(JSON.stringify(C)),new K_(A,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Y_={turnComplete:!0};class K_{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=ht(e,t.turns),e.isVertexAI()?r=r.map(i=>Tn(e,i)):r=r.map(i=>Br(e,i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(z_)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},Y_),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:bh(this.apiClient,e)}:t={realtimeInput:xh(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Z_(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function X_(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const Ma=10;function La(n){var e,t,r;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(t=n?.tools)!==null&&t!==void 0?t:[])if(fr(o)){i=!0;break}if(!i)return!0;const s=(r=n?.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function fr(n){return"callTool"in n&&typeof n.callTool=="function"}function $a(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}class Q_ extends Yn{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var r,i,s,o,a;if(t.config&&t.config.tools&&ds(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),fs(t.config.httpOptions.headers)),!V_(t)||La(t.config))return await this.generateContentInternal(t);if(U_(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");const d=await this.transformCallableTools(t);let u,m;const p=ht(this.apiClient,d.contents),h=(s=(i=(r=d.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:Ma;let y=0;for(;y<h&&(u=await this.generateContentInternal(d),!(!u.functionCalls||u.functionCalls.length===0));){const v=u.candidates[0].content,_=[];for(const x of(a=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(fr(x)){const w=await x.callTool(u.functionCalls);_.push(...w)}y++,m={role:"user",parts:_},d.contents=ht(this.apiClient,d.contents),d.contents.push(v),d.contents.push(m),$a(d.config)&&(p.push(v),p.push(m))}return $a(d.config)&&(u.automaticFunctionCallingHistory=p),u},this.generateContentStream=async t=>{if(t.config&&t.config.tools&&ds(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),fs(t.config.httpOptions.headers)),La(t.config)){const r=await this.transformCallableTools(t);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var i;let s;const o=[];if(r?.generatedImages)for(const d of r.generatedImages)d&&d?.safetyAttributes&&((i=d?.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=d?.safetyAttributes:o.push(d);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s}:a={generatedImages:o},a}),this.list=async t=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new jr(bn.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(i)}}async transformCallableTools(e){var t;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const i=await Promise.all(r.map(async o=>fr(o)?await o.tool():o)),s={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:i})};return s.config.tools=i,s}async initAfcToolsMap(e){var t,r,i;const s=new Map;for(const o of(r=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&r!==void 0?r:[])if(fr(o)){const a=o,d=await a.tool();for(const u of(i=d.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(e){var t,r,i;const s=(i=(r=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:Ma;let o=!1,a=0;const d=await this.initAfcToolsMap(e);return(function(u,m,p){var h,y;return qn(this,arguments,function*(){for(var v,_,x,b;a<s;){o&&(a++,o=!1);const C=yield Re(u.transformCallableTools(p)),N=yield Re(u.generateContentStreamInternal(C)),D=[],V=[];try{for(var w=!0,A=(_=void 0,dr(N)),S;S=yield Re(A.next()),v=S.done,!v;w=!0){b=S.value,w=!1;const O=b;if(yield yield Re(O),O.candidates&&(!((h=O.candidates[0])===null||h===void 0)&&h.content)){V.push(O.candidates[0].content);for(const W of(y=O.candidates[0].content.parts)!==null&&y!==void 0?y:[])if(a<s&&W.functionCall){if(!W.functionCall.name)throw new Error("Function call name was not returned by the model.");if(m.has(W.functionCall.name)){const ne=yield Re(m.get(W.functionCall.name).callTool([W.functionCall]));D.push(...ne)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${m.keys()}, mising tool: ${W.functionCall.name}`)}}}}catch(O){_={error:O}}finally{try{!w&&!v&&(x=A.return)&&(yield Re(x.call(A)))}finally{if(_)throw _.error}}if(D.length>0){o=!0;const O=new kn;O.candidates=[{content:{role:"user",parts:D}}],yield yield Re(O);const W=[];W.push(...V),W.push({role:"user",parts:D});const ne=ht(u.apiClient,p.contents).concat(W);p.contents=ne}else break}})})(this,d,e)}async generateContentInternal(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=Ia(this.apiClient,e);return a=ce("{model}:generateContent",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=Ra(this.apiClient,m),h=new kn;return Object.assign(h,p),h})}else{const u=ka(this.apiClient,e);return a=ce("{model}:generateContent",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>{const p=Na(this.apiClient,m),h=new kn;return Object.assign(h,p),h})}}async generateContentStreamInternal(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=Ia(this.apiClient,e);a=ce("{model}:streamGenerateContent?alt=sse",u._url),d=u._query,delete u.config,delete u._url,delete u._query;const m=this.apiClient;return o=m.requestStream({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return qn(this,arguments,function*(){var h,y,v,_;try{for(var x=!0,b=dr(p),w;w=yield Re(b.next()),h=w.done,!h;x=!0){_=w.value,x=!1;const S=Ra(m,yield Re(_.json())),C=new kn;Object.assign(C,S),yield yield Re(C)}}catch(A){y={error:A}}finally{try{!x&&!h&&(v=b.return)&&(yield Re(v.call(b)))}finally{if(y)throw y.error}}})})}else{const u=ka(this.apiClient,e);a=ce("{model}:streamGenerateContent?alt=sse",u._url),d=u._query,delete u.config,delete u._url,delete u._query;const m=this.apiClient;return o=m.requestStream({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(p){return qn(this,arguments,function*(){var h,y,v,_;try{for(var x=!0,b=dr(p),w;w=yield Re(b.next()),h=w.done,!h;x=!0){_=w.value,x=!1;const S=Na(m,yield Re(_.json())),C=new kn;Object.assign(C,S),yield yield Re(C)}}catch(A){y={error:A}}finally{try{!x&&!h&&(v=b.return)&&(yield Re(v.call(b)))}finally{if(y)throw y.error}}})})}}async embedContent(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=py(this.apiClient,e);return a=ce("{model}:predict",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=p_(this.apiClient,m),h=new la;return Object.assign(h,p),h})}else{const u=Ng(this.apiClient,e);return a=ce("{model}:batchEmbedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>{const p=Wy(this.apiClient,m),h=new la;return Object.assign(h,p),h})}}async generateImagesInternal(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=gy(this.apiClient,e);return a=ce("{model}:predict",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=g_(this.apiClient,m),h=new ca;return Object.assign(h,p),h})}else{const u=Dg(this.apiClient,e);return a=ce("{model}:predict",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>{const p=Ky(this.apiClient,m),h=new ca;return Object.assign(h,p),h})}}async editImageInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Cy(this.apiClient,e);return s=ce("{model}:predict",a._url),o=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const u=y_(this.apiClient,d),m=new Hf;return Object.assign(m,u),m})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Sy(this.apiClient,e);return s=ce("{model}:predict",a._url),o=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const u=__(this.apiClient,d),m=new zf;return Object.assign(m,u),m})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=Ey(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>ls(this.apiClient,m))}else{const u=Pg(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>as(this.apiClient,m))}}async listInternal(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=ky(this.apiClient,e);return a=ce("{models_url}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=b_(this.apiClient,m),h=new ua;return Object.assign(h,p),h})}else{const u=Lg(this.apiClient,e);return a=ce("{models_url}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>{const p=Xy(this.apiClient,m),h=new ua;return Object.assign(h,p),h})}}async update(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=Ny(this.apiClient,e);return a=ce("{model}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>ls(this.apiClient,m))}else{const u=Fg(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>as(this.apiClient,m))}}async delete(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=Ry(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(()=>{const m=C_(),p=new da;return Object.assign(p,m),p})}else{const u=Og(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(()=>{const m=Qy(),p=new da;return Object.assign(p,m),p})}}async countTokens(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=Py(this.apiClient,e);return a=ce("{model}:countTokens",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=T_(this.apiClient,m),h=new fa;return Object.assign(h,p),h})}else{const u=Ug(this.apiClient,e);return a=ce("{model}:countTokens",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>{const p=e_(this.apiClient,m),h=new fa;return Object.assign(h,p),h})}}async computeTokens(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=My(this.apiClient,e);return s=ce("{model}:computeTokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const u=S_(this.apiClient,d),m=new Wf;return Object.assign(m,u),m})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=$y(this.apiClient,e);return a=ce("{model}:predictLongRunning",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>I_(this.apiClient,m))}else{const u=Bg(this.apiClient,e);return a=ce("{model}:predictLongRunning",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>i_(this.apiClient,m))}}}function ev(n,e){const t={},r=l(e,["operationName"]);r!=null&&c(t,["_url","operationName"],r);const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function tv(n,e){const t={},r=l(e,["operationName"]);r!=null&&c(t,["_url","operationName"],r);const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function nv(n,e){const t={},r=l(e,["operationName"]);r!=null&&c(t,["operationName"],r);const i=l(e,["resourceName"]);i!=null&&c(t,["_url","resourceName"],i);const s=l(e,["config"]);return s!=null&&c(t,["config"],s),t}function rv(n,e){const t={},r=l(e,["video","uri"]);r!=null&&c(t,["uri"],r);const i=l(e,["video","encodedVideo"]);i!=null&&c(t,["videoBytes"],jt(n,i));const s=l(e,["encoding"]);return s!=null&&c(t,["mimeType"],s),t}function iv(n,e){const t={},r=l(e,["_self"]);return r!=null&&c(t,["video"],rv(n,r)),t}function sv(n,e){const t={},r=l(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>iv(n,a))),c(t,["generatedVideos"],o)}const i=l(e,["raiMediaFilteredCount"]);i!=null&&c(t,["raiMediaFilteredCount"],i);const s=l(e,["raiMediaFilteredReasons"]);return s!=null&&c(t,["raiMediaFilteredReasons"],s),t}function ov(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["metadata"]);i!=null&&c(t,["metadata"],i);const s=l(e,["done"]);s!=null&&c(t,["done"],s);const o=l(e,["error"]);o!=null&&c(t,["error"],o);const a=l(e,["response","generateVideoResponse"]);return a!=null&&c(t,["response"],sv(n,a)),t}function av(n,e){const t={},r=l(e,["gcsUri"]);r!=null&&c(t,["uri"],r);const i=l(e,["bytesBase64Encoded"]);i!=null&&c(t,["videoBytes"],jt(n,i));const s=l(e,["mimeType"]);return s!=null&&c(t,["mimeType"],s),t}function lv(n,e){const t={},r=l(e,["_self"]);return r!=null&&c(t,["video"],av(n,r)),t}function cv(n,e){const t={},r=l(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>lv(n,a))),c(t,["generatedVideos"],o)}const i=l(e,["raiMediaFilteredCount"]);i!=null&&c(t,["raiMediaFilteredCount"],i);const s=l(e,["raiMediaFilteredReasons"]);return s!=null&&c(t,["raiMediaFilteredReasons"],s),t}function Fa(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["metadata"]);i!=null&&c(t,["metadata"],i);const s=l(e,["done"]);s!=null&&c(t,["done"],s);const o=l(e,["error"]);o!=null&&c(t,["error"],o);const a=l(e,["response"]);return a!=null&&c(t,["response"],cv(n,a)),t}class uv extends Yn{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let s;return r&&"httpOptions"in r&&(s=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:s}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=tv(this.apiClient,e);return a=ce("{operationName}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>Fa(this.apiClient,m))}else{const u=ev(this.apiClient,e);return a=ce("{operationName}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>ov(this.apiClient,m))}}async fetchPredictVideosOperationInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=nv(this.apiClient,e);return s=ce("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>Fa(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}}function dv(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["_url","name"],r);const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function fv(n,e,t){const r={},i=l(e,["pageSize"]);t!==void 0&&i!=null&&c(t,["_query","pageSize"],i);const s=l(e,["pageToken"]);t!==void 0&&s!=null&&c(t,["_query","pageToken"],s);const o=l(e,["filter"]);return t!==void 0&&o!=null&&c(t,["_query","filter"],o),r}function mv(n,e){const t={},r=l(e,["config"]);return r!=null&&c(t,["config"],fv(n,r,t)),t}function pv(n,e){const t={},r=l(e,["textInput"]);r!=null&&c(t,["textInput"],r);const i=l(e,["output"]);return i!=null&&c(t,["output"],i),t}function hv(n,e){const t={};if(l(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=l(e,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>pv(n,s))),c(t,["examples","examples"],i)}return t}function gv(n,e,t){const r={};if(l(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=l(e,["tunedModelDisplayName"]);if(t!==void 0&&i!=null&&c(t,["displayName"],i),l(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=l(e,["epochCount"]);t!==void 0&&s!=null&&c(t,["tuningTask","hyperparameters","epochCount"],s);const o=l(e,["learningRateMultiplier"]);if(o!=null&&c(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),l(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(l(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=l(e,["batchSize"]);t!==void 0&&a!=null&&c(t,["tuningTask","hyperparameters","batchSize"],a);const d=l(e,["learningRate"]);return t!==void 0&&d!=null&&c(t,["tuningTask","hyperparameters","learningRate"],d),r}function yv(n,e){const t={},r=l(e,["baseModel"]);r!=null&&c(t,["baseModel"],r);const i=l(e,["trainingDataset"]);i!=null&&c(t,["tuningTask","trainingData"],hv(n,i));const s=l(e,["config"]);return s!=null&&c(t,["config"],gv(n,s,t)),t}function _v(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["_url","name"],r);const i=l(e,["config"]);return i!=null&&c(t,["config"],i),t}function vv(n,e,t){const r={},i=l(e,["pageSize"]);t!==void 0&&i!=null&&c(t,["_query","pageSize"],i);const s=l(e,["pageToken"]);t!==void 0&&s!=null&&c(t,["_query","pageToken"],s);const o=l(e,["filter"]);return t!==void 0&&o!=null&&c(t,["_query","filter"],o),r}function wv(n,e){const t={},r=l(e,["config"]);return r!=null&&c(t,["config"],vv(n,r,t)),t}function xv(n,e,t){const r={},i=l(e,["gcsUri"]);if(t!==void 0&&i!=null&&c(t,["supervisedTuningSpec","trainingDatasetUri"],i),l(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function bv(n,e){const t={},r=l(e,["gcsUri"]);return r!=null&&c(t,["validationDatasetUri"],r),t}function Cv(n,e,t){const r={},i=l(e,["validationDataset"]);t!==void 0&&i!=null&&c(t,["supervisedTuningSpec"],bv(n,i));const s=l(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&c(t,["tunedModelDisplayName"],s);const o=l(e,["description"]);t!==void 0&&o!=null&&c(t,["description"],o);const a=l(e,["epochCount"]);t!==void 0&&a!=null&&c(t,["supervisedTuningSpec","hyperParameters","epochCount"],a);const d=l(e,["learningRateMultiplier"]);t!==void 0&&d!=null&&c(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const u=l(e,["exportLastCheckpointOnly"]);t!==void 0&&u!=null&&c(t,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const m=l(e,["adapterSize"]);if(t!==void 0&&m!=null&&c(t,["supervisedTuningSpec","hyperParameters","adapterSize"],m),l(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(l(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function Tv(n,e){const t={},r=l(e,["baseModel"]);r!=null&&c(t,["baseModel"],r);const i=l(e,["trainingDataset"]);i!=null&&c(t,["supervisedTuningSpec","trainingDatasetUri"],xv(n,i,t));const s=l(e,["config"]);return s!=null&&c(t,["config"],Cv(n,s,t)),t}function Sv(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["model"],r);const i=l(e,["name"]);return i!=null&&c(t,["endpoint"],i),t}function Dc(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["state"]);i!=null&&c(t,["state"],yc(n,i));const s=l(e,["createTime"]);s!=null&&c(t,["createTime"],s);const o=l(e,["tuningTask","startTime"]);o!=null&&c(t,["startTime"],o);const a=l(e,["tuningTask","completeTime"]);a!=null&&c(t,["endTime"],a);const d=l(e,["updateTime"]);d!=null&&c(t,["updateTime"],d);const u=l(e,["description"]);u!=null&&c(t,["description"],u);const m=l(e,["baseModel"]);m!=null&&c(t,["baseModel"],m);const p=l(e,["_self"]);p!=null&&c(t,["tunedModel"],Sv(n,p));const h=l(e,["distillationSpec"]);h!=null&&c(t,["distillationSpec"],h);const y=l(e,["experiment"]);y!=null&&c(t,["experiment"],y);const v=l(e,["labels"]);v!=null&&c(t,["labels"],v);const _=l(e,["pipelineJob"]);_!=null&&c(t,["pipelineJob"],_);const x=l(e,["tunedModelDisplayName"]);return x!=null&&c(t,["tunedModelDisplayName"],x),t}function Ev(n,e){const t={},r=l(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=l(e,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Dc(n,o))),c(t,["tuningJobs"],s)}return t}function Av(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["metadata"]);i!=null&&c(t,["metadata"],i);const s=l(e,["done"]);s!=null&&c(t,["done"],s);const o=l(e,["error"]);return o!=null&&c(t,["error"],o),t}function kv(n,e){const t={},r=l(e,["checkpointId"]);r!=null&&c(t,["checkpointId"],r);const i=l(e,["epoch"]);i!=null&&c(t,["epoch"],i);const s=l(e,["step"]);s!=null&&c(t,["step"],s);const o=l(e,["endpoint"]);return o!=null&&c(t,["endpoint"],o),t}function Iv(n,e){const t={},r=l(e,["model"]);r!=null&&c(t,["model"],r);const i=l(e,["endpoint"]);i!=null&&c(t,["endpoint"],i);const s=l(e,["checkpoints"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>kv(n,a))),c(t,["checkpoints"],o)}return t}function ms(n,e){const t={},r=l(e,["name"]);r!=null&&c(t,["name"],r);const i=l(e,["state"]);i!=null&&c(t,["state"],yc(n,i));const s=l(e,["createTime"]);s!=null&&c(t,["createTime"],s);const o=l(e,["startTime"]);o!=null&&c(t,["startTime"],o);const a=l(e,["endTime"]);a!=null&&c(t,["endTime"],a);const d=l(e,["updateTime"]);d!=null&&c(t,["updateTime"],d);const u=l(e,["error"]);u!=null&&c(t,["error"],u);const m=l(e,["description"]);m!=null&&c(t,["description"],m);const p=l(e,["baseModel"]);p!=null&&c(t,["baseModel"],p);const h=l(e,["tunedModel"]);h!=null&&c(t,["tunedModel"],Iv(n,h));const y=l(e,["supervisedTuningSpec"]);y!=null&&c(t,["supervisedTuningSpec"],y);const v=l(e,["tuningDataStats"]);v!=null&&c(t,["tuningDataStats"],v);const _=l(e,["encryptionSpec"]);_!=null&&c(t,["encryptionSpec"],_);const x=l(e,["partnerModelTuningSpec"]);x!=null&&c(t,["partnerModelTuningSpec"],x);const b=l(e,["distillationSpec"]);b!=null&&c(t,["distillationSpec"],b);const w=l(e,["experiment"]);w!=null&&c(t,["experiment"],w);const A=l(e,["labels"]);A!=null&&c(t,["labels"],A);const S=l(e,["pipelineJob"]);S!=null&&c(t,["pipelineJob"],S);const C=l(e,["tunedModelDisplayName"]);return C!=null&&c(t,["tunedModelDisplayName"],C),t}function Nv(n,e){const t={},r=l(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=l(e,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ms(n,o))),c(t,["tuningJobs"],s)}return t}class Rv extends Yn{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new jr(bn.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let i="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?i=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(i=r.name.split("/operations/")[0]),{name:i,state:ns.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=_v(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>ms(this.apiClient,m))}else{const u=dv(this.apiClient,e);return a=ce("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>Dc(this.apiClient,m))}}async listInternal(e){var t,r,i,s;let o,a="",d={};if(this.apiClient.isVertexAI()){const u=wv(this.apiClient,e);return a=ce("tuningJobs",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=Nv(this.apiClient,m),h=new ma;return Object.assign(h,p),h})}else{const u=mv(this.apiClient,e);return a=ce("tunedModels",u._url),d=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>{const p=Ev(this.apiClient,m),h=new ma;return Object.assign(h,p),h})}}async tuneInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Tv(this.apiClient,e);return s=ce("tuningJobs",a._url),o=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>ms(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=yv(this.apiClient,e);return s=ce("tunedModels",a._url),o=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>Av(this.apiClient,d))}}}class Dv{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Pv=1024*1024*8,Mv=3,Lv=1e3,$v=2,ii="x-goog-upload-status";async function Fv(n,e,t){var r,i,s;let o=0,a=0,d=new rs(new Response),u="upload";for(o=n.size;a<o;){const p=Math.min(Pv,o-a),h=n.slice(a,a+p);a+p>=o&&(u+=", finalize");let y=0,v=Lv;for(;y<Mv&&(d=await t.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(p)}}}),!(!((r=d?.headers)===null||r===void 0)&&r[ii]));)y++,await Vv(v),v=v*$v;if(a+=p,((i=d?.headers)===null||i===void 0?void 0:i[ii])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const m=await d?.json();if(((s=d?.headers)===null||s===void 0?void 0:s[ii])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return m.file}async function Ov(n){return{size:n.size,type:n.type}}function Vv(n){return new Promise(e=>setTimeout(e,n))}class Uv{async upload(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Fv(e,t,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Ov(e)}}class qv{create(e,t,r){return new jv(e,t,r)}}class jv{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}const Oa="x-goog-api-key";class Bv{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(Oa)===null&&e.append(Oa,this.apiKey)}}const Gv="gl-node/";class Hv{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const r=Gf(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new Bv(this.apiKey);this.apiClient=new F_({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:Gv+"web",uploader:new Uv,downloader:new Dv}),this.models=new Q_(this.apiClient),this.live=new J_(this.apiClient,i,new qv),this.chats=new cp(this.models,this.apiClient),this.caches=new op(this.apiClient),this.files=new bp(this.apiClient),this.operations=new uv(this.apiClient),this.tunings=new Rv(this.apiClient)}}var si={exports:{}},Va;function zv(){return Va||(Va=1,(function(n){var e=(function(t){var r=Object.prototype,i=r.hasOwnProperty,s=Object.defineProperty||function(L,I,$){L[I]=$.value},o,a=typeof Symbol=="function"?Symbol:{},d=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",m=a.toStringTag||"@@toStringTag";function p(L,I,$){return Object.defineProperty(L,I,{value:$,enumerable:!0,configurable:!0,writable:!0}),L[I]}try{p({},"")}catch{p=function(I,$,E){return I[$]=E}}function h(L,I,$,E){var q=I&&I.prototype instanceof A?I:A,ee=Object.create(q.prototype),he=new _e(E||[]);return s(ee,"_invoke",{value:se(L,$,he)}),ee}t.wrap=h;function y(L,I,$){try{return{type:"normal",arg:L.call(I,$)}}catch(E){return{type:"throw",arg:E}}}var v="suspendedStart",_="suspendedYield",x="executing",b="completed",w={};function A(){}function S(){}function C(){}var N={};p(N,d,function(){return this});var D=Object.getPrototypeOf,V=D&&D(D(Ne([])));V&&V!==r&&i.call(V,d)&&(N=V);var O=C.prototype=A.prototype=Object.create(N);S.prototype=C,s(O,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:S,configurable:!0}),S.displayName=p(C,m,"GeneratorFunction");function W(L){["next","throw","return"].forEach(function(I){p(L,I,function($){return this._invoke(I,$)})})}t.isGeneratorFunction=function(L){var I=typeof L=="function"&&L.constructor;return I?I===S||(I.displayName||I.name)==="GeneratorFunction":!1},t.mark=function(L){return Object.setPrototypeOf?Object.setPrototypeOf(L,C):(L.__proto__=C,p(L,m,"GeneratorFunction")),L.prototype=Object.create(O),L},t.awrap=function(L){return{__await:L}};function ne(L,I){function $(ee,he,me,Se){var be=y(L[ee],L,he);if(be.type==="throw")Se(be.arg);else{var ae=be.arg,le=ae.value;return le&&typeof le=="object"&&i.call(le,"__await")?I.resolve(le.__await).then(function(ve){$("next",ve,me,Se)},function(ve){$("throw",ve,me,Se)}):I.resolve(le).then(function(ve){ae.value=ve,me(ae)},function(ve){return $("throw",ve,me,Se)})}}var E;function q(ee,he){function me(){return new I(function(Se,be){$(ee,he,Se,be)})}return E=E?E.then(me,me):me()}s(this,"_invoke",{value:q})}W(ne.prototype),p(ne.prototype,u,function(){return this}),t.AsyncIterator=ne,t.async=function(L,I,$,E,q){q===void 0&&(q=Promise);var ee=new ne(h(L,I,$,E),q);return t.isGeneratorFunction(I)?ee:ee.next().then(function(he){return he.done?he.value:ee.next()})};function se(L,I,$){var E=v;return function(ee,he){if(E===x)throw new Error("Generator is already running");if(E===b){if(ee==="throw")throw he;return Pe()}for($.method=ee,$.arg=he;;){var me=$.delegate;if(me){var Se=J(me,$);if(Se){if(Se===w)continue;return Se}}if($.method==="next")$.sent=$._sent=$.arg;else if($.method==="throw"){if(E===v)throw E=b,$.arg;$.dispatchException($.arg)}else $.method==="return"&&$.abrupt("return",$.arg);E=x;var be=y(L,I,$);if(be.type==="normal"){if(E=$.done?b:_,be.arg===w)continue;return{value:be.arg,done:$.done}}else be.type==="throw"&&(E=b,$.method="throw",$.arg=be.arg)}}}function J(L,I){var $=I.method,E=L.iterator[$];if(E===o)return I.delegate=null,$==="throw"&&L.iterator.return&&(I.method="return",I.arg=o,J(L,I),I.method==="throw")||$!=="return"&&(I.method="throw",I.arg=new TypeError("The iterator does not provide a '"+$+"' method")),w;var q=y(E,L.iterator,I.arg);if(q.type==="throw")return I.method="throw",I.arg=q.arg,I.delegate=null,w;var ee=q.arg;if(!ee)return I.method="throw",I.arg=new TypeError("iterator result is not an object"),I.delegate=null,w;if(ee.done)I[L.resultName]=ee.value,I.next=L.nextLoc,I.method!=="return"&&(I.method="next",I.arg=o);else return ee;return I.delegate=null,w}W(O),p(O,m,"Generator"),p(O,d,function(){return this}),p(O,"toString",function(){return"[object Generator]"});function ie(L){var I={tryLoc:L[0]};1 in L&&(I.catchLoc=L[1]),2 in L&&(I.finallyLoc=L[2],I.afterLoc=L[3]),this.tryEntries.push(I)}function pe(L){var I=L.completion||{};I.type="normal",delete I.arg,L.completion=I}function _e(L){this.tryEntries=[{tryLoc:"root"}],L.forEach(ie,this),this.reset(!0)}t.keys=function(L){var I=Object(L),$=[];for(var E in I)$.push(E);return $.reverse(),function q(){for(;$.length;){var ee=$.pop();if(ee in I)return q.value=ee,q.done=!1,q}return q.done=!0,q}};function Ne(L){if(L){var I=L[d];if(I)return I.call(L);if(typeof L.next=="function")return L;if(!isNaN(L.length)){var $=-1,E=function q(){for(;++$<L.length;)if(i.call(L,$))return q.value=L[$],q.done=!1,q;return q.value=o,q.done=!0,q};return E.next=E}}return{next:Pe}}t.values=Ne;function Pe(){return{value:o,done:!0}}return _e.prototype={constructor:_e,reset:function(L){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(pe),!L)for(var I in this)I.charAt(0)==="t"&&i.call(this,I)&&!isNaN(+I.slice(1))&&(this[I]=o)},stop:function(){this.done=!0;var L=this.tryEntries[0],I=L.completion;if(I.type==="throw")throw I.arg;return this.rval},dispatchException:function(L){if(this.done)throw L;var I=this;function $(Se,be){return ee.type="throw",ee.arg=L,I.next=Se,be&&(I.method="next",I.arg=o),!!be}for(var E=this.tryEntries.length-1;E>=0;--E){var q=this.tryEntries[E],ee=q.completion;if(q.tryLoc==="root")return $("end");if(q.tryLoc<=this.prev){var he=i.call(q,"catchLoc"),me=i.call(q,"finallyLoc");if(he&&me){if(this.prev<q.catchLoc)return $(q.catchLoc,!0);if(this.prev<q.finallyLoc)return $(q.finallyLoc)}else if(he){if(this.prev<q.catchLoc)return $(q.catchLoc,!0)}else if(me){if(this.prev<q.finallyLoc)return $(q.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(L,I){for(var $=this.tryEntries.length-1;$>=0;--$){var E=this.tryEntries[$];if(E.tryLoc<=this.prev&&i.call(E,"finallyLoc")&&this.prev<E.finallyLoc){var q=E;break}}q&&(L==="break"||L==="continue")&&q.tryLoc<=I&&I<=q.finallyLoc&&(q=null);var ee=q?q.completion:{};return ee.type=L,ee.arg=I,q?(this.method="next",this.next=q.finallyLoc,w):this.complete(ee)},complete:function(L,I){if(L.type==="throw")throw L.arg;return L.type==="break"||L.type==="continue"?this.next=L.arg:L.type==="return"?(this.rval=this.arg=L.arg,this.method="return",this.next="end"):L.type==="normal"&&I&&(this.next=I),w},finish:function(L){for(var I=this.tryEntries.length-1;I>=0;--I){var $=this.tryEntries[I];if($.finallyLoc===L)return this.complete($.completion,$.afterLoc),pe($),w}},catch:function(L){for(var I=this.tryEntries.length-1;I>=0;--I){var $=this.tryEntries[I];if($.tryLoc===L){var E=$.completion;if(E.type==="throw"){var q=E.arg;pe($)}return q}}throw new Error("illegal catch attempt")},delegateYield:function(L,I,$){return this.delegate={iterator:Ne(L),resultName:I,nextLoc:$},this.method==="next"&&(this.arg=o),w}},t})(n.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(si)),si.exports}var oi,Ua;function Us(){return Ua||(Ua=1,oi=(n,e)=>`${n}-${e}-${Math.random().toString(16).slice(3,8)}`),oi}var ai,qa;function Pc(){if(qa)return ai;qa=1;const n=Us();let e=0;return ai=({id:t,action:r,payload:i={}})=>{let s=t;return typeof s>"u"&&(s=n("Job",e),e+=1),{id:s,action:r,payload:i}},ai}var In={},ja;function qs(){if(ja)return In;ja=1;let n=!1;return In.logging=n,In.setLogging=e=>{n=e},In.log=(...e)=>n?console.log.apply(this,e):null,In}var li,Ba;function Wv(){if(Ba)return li;Ba=1;const n=Pc(),{log:e}=qs(),t=Us();let r=0;return li=()=>{const i=t("Scheduler",r),s={},o={};let a=[];r+=1;const d=()=>a.length,u=()=>Object.keys(s).length,m=()=>{if(a.length!==0){const _=Object.keys(s);for(let x=0;x<_.length;x+=1)if(typeof o[_[x]]>"u"){a[0](s[_[x]]);break}}},p=(_,x)=>new Promise((b,w)=>{const A=n({action:_,payload:x});a.push(async S=>{a.shift(),o[S.id]=A;try{b(await S[_].apply(this,[...x,A.id]))}catch(C){w(C)}finally{delete o[S.id],m()}}),e(`[${i}]: Add ${A.id} to JobQueue`),e(`[${i}]: JobQueue length=${a.length}`),m()});return{addWorker:_=>(s[_.id]=_,e(`[${i}]: Add ${_.id}`),e(`[${i}]: Number of workers=${u()}`),m(),_.id),addJob:async(_,...x)=>{if(u()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return p(_,x)},terminate:async()=>{Object.keys(s).forEach(async _=>{await s[_].terminate()}),a=[]},getQueueLen:d,getNumWorkers:u}},li}function Jv(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ci,Ga;function Yv(){return Ga||(Ga=1,ci=n=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof Jv=="function"&&(e.type="node"),typeof n>"u"?e:e[n]}),ci}var ui,Ha;function Kv(){if(Ha)return ui;Ha=1;const e=Yv()("type")==="browser"?t=>new URL(t,window.location.href).href:t=>t;return ui=t=>{const r={...t};return["corePath","workerPath","langPath"].forEach(i=>{t[i]&&(r[i]=e(r[i]))}),r},ui}var di,za;function Mc(){return za||(za=1,di={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),di}const Zv="7.0.0",Xv={version:Zv};var fi,Wa;function Qv(){return Wa||(Wa=1,fi={workerBlobURL:!0,logger:()=>{}}),fi}var mi,Ja;function ew(){if(Ja)return mi;Ja=1;const n=Xv.version;return mi={...Qv(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${n}/dist/worker.min.js`},mi}var pi,Ya;function tw(){return Ya||(Ya=1,pi=({workerPath:n,workerBlobURL:e})=>{let t;if(Blob&&URL&&e){const r=new Blob([`importScripts("${n}");`],{type:"application/javascript"});t=new Worker(URL.createObjectURL(r))}else t=new Worker(n);return t}),pi}var hi,Ka;function nw(){return Ka||(Ka=1,hi=n=>{n.terminate()}),hi}var gi,Za;function rw(){return Za||(Za=1,gi=(n,e)=>{n.onmessage=({data:t})=>{e(t)}}),gi}var yi,Xa;function iw(){return Xa||(Xa=1,yi=async(n,e)=>{n.postMessage(e)}),yi}var _i,Qa;function sw(){if(Qa)return _i;Qa=1;const n=t=>new Promise((r,i)=>{const s=new FileReader;s.onload=()=>{r(s.result)},s.onerror=({target:{error:{code:o}}})=>{i(Error(`File could not be read! Code=${o}`))},s.readAsArrayBuffer(t)}),e=async t=>{let r=t;if(typeof t>"u")return"undefined";if(typeof t=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(t)?r=atob(t.split(",")[1]).split("").map(i=>i.charCodeAt(0)):r=await(await fetch(t)).arrayBuffer();else if(typeof HTMLElement<"u"&&t instanceof HTMLElement)t.tagName==="IMG"&&(r=await e(t.src)),t.tagName==="VIDEO"&&(r=await e(t.poster)),t.tagName==="CANVAS"&&await new Promise(i=>{t.toBlob(async s=>{r=await n(s),i()})});else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){const i=await t.convertToBlob();r=await n(i)}else(t instanceof File||t instanceof Blob)&&(r=await n(t));return new Uint8Array(r)};return _i=e,_i}var vi,el;function ow(){if(el)return vi;el=1;const n=ew(),e=tw(),t=nw(),r=rw(),i=iw(),s=sw();return vi={defaultOptions:n,spawnWorker:e,terminateWorker:t,onMessage:r,send:i,loadImage:s},vi}var wi,tl;function Lc(){if(tl)return wi;tl=1;const n=Kv(),e=Pc(),{log:t}=qs(),r=Us(),i=Mc(),{defaultOptions:s,spawnWorker:o,terminateWorker:a,onMessage:d,loadImage:u,send:m}=ow();let p=0;return wi=async(h="eng",y=i.LSTM_ONLY,v={},_={})=>{const x=r("Worker",p),{logger:b,errorHandler:w,...A}=n({...s,...v}),S={},C=typeof h=="string"?h.split("+"):h;let N=y,D=_;const V=[i.DEFAULT,i.LSTM_ONLY].includes(y)&&!A.legacyCore;let O,W;const ne=new Promise((ae,le)=>{W=ae,O=le}),se=ae=>{O(ae.message)};let J=o(A);J.onerror=se,p+=1;const ie=({id:ae,action:le,payload:ve})=>new Promise((Me,qe)=>{t(`[${x}]: Start ${ae}, action=${le}`);const je=`${le}-${ae}`;S[je]={resolve:Me,reject:qe},m(J,{workerId:x,jobId:ae,action:le,payload:ve})}),pe=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),_e=ae=>ie(e({id:ae,action:"load",payload:{options:{lstmOnly:V,corePath:A.corePath,logging:A.logging}}})),Ne=(ae,le,ve)=>ie(e({id:ve,action:"FS",payload:{method:"writeFile",args:[ae,le]}})),Pe=(ae,le)=>ie(e({id:le,action:"FS",payload:{method:"readFile",args:[ae,{encoding:"utf8"}]}})),L=(ae,le)=>ie(e({id:le,action:"FS",payload:{method:"unlink",args:[ae]}})),I=(ae,le,ve)=>ie(e({id:ve,action:"FS",payload:{method:ae,args:le}})),$=(ae,le)=>ie(e({id:le,action:"loadLanguage",payload:{langs:ae,options:{langPath:A.langPath,dataPath:A.dataPath,cachePath:A.cachePath,cacheMethod:A.cacheMethod,gzip:A.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(N)&&!A.legacyLang}}})),E=(ae,le,ve,Me)=>ie(e({id:Me,action:"initialize",payload:{langs:ae,oem:le,config:ve}})),q=(ae="eng",le,ve,Me)=>{if(V&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(le))throw Error("Legacy model requested but code missing.");const qe=le||N;N=qe;const je=ve||D;D=je;const Dt=(typeof ae=="string"?ae.split("+"):ae).filter(nn=>!C.includes(nn));return C.push(...Dt),Dt.length>0?$(Dt,Me).then(()=>E(ae,qe,je,Me)):E(ae,qe,je,Me)},ee=(ae={},le)=>ie(e({id:le,action:"setParameters",payload:{params:ae}})),he=async(ae,le={},ve={text:!0},Me)=>ie(e({id:Me,action:"recognize",payload:{image:await u(ae),options:le,output:ve}})),me=async(ae,le)=>{if(V)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return ie(e({id:le,action:"detect",payload:{image:await u(ae)}}))},Se=async()=>(J!==null&&(a(J),J=null),Promise.resolve());d(J,({workerId:ae,jobId:le,status:ve,action:Me,data:qe})=>{const je=`${Me}-${le}`;if(ve==="resolve")t(`[${ae}]: Complete ${le}`),S[je].resolve({jobId:le,data:qe}),delete S[je];else if(ve==="reject")if(S[je].reject(qe),delete S[je],Me==="load"&&O(qe),w)w(qe);else throw Error(qe);else ve==="progress"&&b({...qe,userJobId:le})});const be={id:x,worker:J,load:pe,writeText:Ne,readText:Pe,removeFile:L,FS:I,reinitialize:q,setParameters:ee,recognize:he,detect:me,terminate:Se};return _e().then(()=>$(h)).then(()=>E(h,y,_)).then(()=>W(be)).catch(()=>{}),ne},wi}var xi,nl;function aw(){if(nl)return xi;nl=1;const n=Lc();return xi={recognize:async(r,i,s)=>{const o=await n(i,1,s);return o.recognize(r).finally(async()=>{await o.terminate()})},detect:async(r,i)=>{const s=await n("osd",0,i);return s.detect(r).finally(async()=>{await s.terminate()})}},xi}var bi,rl;function lw(){return rl||(rl=1,bi={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),bi}var Ci,il;function cw(){return il||(il=1,Ci={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),Ci}var Ti,sl;function uw(){if(sl)return Ti;sl=1,zv();const n=Wv(),e=Lc(),t=aw(),r=lw(),i=Mc(),s=cw(),{setLogging:o}=qs();return Ti={languages:r,OEM:i,PSM:s,createScheduler:n,createWorker:e,setLogging:o,...t},Ti}var dw=uw();const zn="onboarding-documents",ps="avatars",ol="support-attachments",Nn="logo",Rn="background",Si="task-attachments",fw="your-google-genai-api-key";let St=null;St=new Hv({apiKey:fw});const mw=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Delhi","Jammu and Kashmir","Ladakh","Puducherry","Chandigarh"],Ei={Bangalore:"Bengaluru",Mysore:"Mysuru",Mangalore:"Mangaluru",Vizag:"Visakhapatnam",Hydrabat:"Hyderabad",Cochin:"Kochi"},on={Hyderabad:"Telangana",Secunderabad:"Telangana",Warangal:"Telangana",Nizamabad:"Telangana",Bengaluru:"Karnataka",Hubballi:"Karnataka",Dharwad:"Karnataka",Mysuru:"Karnataka",Mangaluru:"Karnataka",Mumbai:"Maharashtra",Pune:"Maharashtra",Chennai:"Tamil Nadu",Delhi:"Delhi","New Delhi":"Delhi",Kochi:"Kerala",Visakhapatnam:"Andhra Pradesh",Vijayawada:"Andhra Pradesh"},pw=n=>{if(!n)return"";const e=n.trim();return e.toLowerCase()==="telugana"?"Telangana":e},hs=n=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return n.map(hs);const e={...n};if(typeof e.name=="string"&&typeof e.path=="string"){const t=e.path.startsWith("avatars/")?ps:zn,{data:{publicUrl:r}}=g.storage.from(t).getPublicUrl(e.path);e.preview=r,e.url=r}for(const t in e)e[t]=hs(e[t]);return e},Nr=async(n,e,t)=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return Promise.all(n.map(i=>Nr(i,e,t)));const r={...n};if(r.file instanceof File){const i=r.file,s=`${e}/documents/${Date.now()}_${i.name}`,{error:o}=await g.storage.from(zn).upload(s,i);if(o)throw o;try{await g.from("user_documents").insert({user_id:e,submission_id:t||null,name:r.name||i.name,bucket:zn,path:s,file_type:i.type,file_size:i.size})}catch(a){console.error("Failed to record uploaded document:",a)}return{name:r.name||i.name,type:i.type,size:i.size,path:s}}if(typeof r.name=="string"&&r.path)return{name:r.name,type:r.type,size:r.size,path:r.path};for(const i in r)Object.prototype.hasOwnProperty.call(r,i)&&(r[i]=await Nr(r[i],e,t));return r},hw=async n=>await(await fetch(n)).blob(),K=n=>{if(Array.isArray(n))return n.map(e=>K(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)&&!(n instanceof File)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=t.replace(/[A-Z]/g,i=>`_${i.toLowerCase()}`);e[r]=K(n[t])}return e}return n},M=n=>{if(Array.isArray(n))return n.map(e=>M(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=t.replace(/_([a-z])/g,i=>i[1].toUpperCase());e[r]=M(n[t])}return hs(e)}return n},al=async(n,e=1e3)=>{let t=[],r=0,i=e-1,s=!0;for(;s;){const{data:o,error:a}=await n.range(r,i);if(a)throw a;o&&o.length>0?(t=t.concat(o),o.length<e?s=!1:(r+=e,i+=e)):s=!1}return t},B={toCamelCase:M,handleError:n=>{if(!n)throw new Error("An unknown error occurred.");const e=(n.status===400||n.code==="400")&&(n.message?.includes("invalid")||n.message?.includes("expired")||n.message?.includes("token")),t=n.status===401||n.code==="401";throw(e||t)&&(console.error("CRITICAL AUTH ERROR (400/401) DETECTED:",n.message),window.dispatchEvent(new CustomEvent("supabase-auth-failure",{detail:n}))),n},getInitialAppData:async()=>{const{data:n,error:e}=await g.from("settings").select("*").eq("id","singleton").maybeSingle();if(e)return B.handleError(e);if(!n)throw new Error("Core application settings are missing from the database.");const{data:t,error:r}=await g.from("roles").select("*");if(r)return B.handleError(r);const{data:i,error:s}=await g.from("holidays").select("*");return s?B.handleError(s):{settings:M(n),roles:(t||[]).map(M),holidays:(i||[]).map(M)}},getSiteAttendanceRecords:async()=>{const{data:n,error:e}=await g.from("site_attendance_tracker").select("*").order("billing_date",{ascending:!1});if(e)throw e;return(n||[]).map(M)},saveSiteAttendanceRecord:async n=>{const{id:e,billingDifference:t,managementFeeDifference:r,variationStatus:i,createdAt:s,updatedAt:o,...a}=n,d=K(a);let u;e?u=g.from("site_attendance_tracker").update(d).eq("id",e):u=g.from("site_attendance_tracker").insert(d);const{data:m,error:p}=await u.select().single();if(p)throw p;return M(m)},deleteSiteAttendanceRecord:async n=>{const{error:e}=await g.from("site_attendance_tracker").delete().eq("id",n);if(e)throw e},getSiteInvoiceRecords:async n=>{let e=g.from("site_invoice_tracker").select("*").is("deleted_at",null).order("site_name");n&&(e=e.eq("created_by",n));const{data:t,error:r}=await e;if(r)throw r;return(t||[]).map(M)},getDeletedSiteInvoiceRecords:async n=>{let e=g.from("site_invoice_tracker").select("*").not("deleted_at","is",null).order("site_name");n&&(e=e.eq("created_by",n));const{data:t,error:r}=await e;if(r)throw r;return(t||[]).map(M)},saveSiteInvoiceRecord:async n=>{const{id:e,sNo:t,createdAt:r,updatedAt:i,...s}=n,o=K(s);let a;e?a=g.from("site_invoice_tracker").update(o).eq("id",e):a=g.from("site_invoice_tracker").insert(o);const{data:d,error:u}=await a.select().single();if(u)throw u;return M(d)},softDeleteSiteInvoiceRecord:async(n,e,t,r)=>{const{error:i}=await g.from("site_invoice_tracker").update({deleted_at:new Date().toISOString(),deleted_by:t,deleted_by_name:r,deleted_reason:e}).eq("id",n);if(i)throw i},bulkSoftDeleteSiteInvoiceRecords:async(n,e,t,r)=>{const{error:i}=await g.from("site_invoice_tracker").update({deleted_at:new Date().toISOString(),deleted_by:t,deleted_by_name:r,deleted_reason:e}).in("id",n);if(i)throw i},restoreSiteInvoiceRecord:async n=>{const{error:e}=await g.from("site_invoice_tracker").update({deleted_at:null,deleted_by:null,deleted_by_name:null,deleted_reason:null}).eq("id",n);if(e)throw e},permanentlyDeleteSiteInvoiceRecord:async n=>{const{error:e}=await g.from("site_invoice_tracker").delete().eq("id",n);if(e)throw e},bulkRestoreSiteInvoiceRecords:async n=>{const{error:e}=await g.from("site_invoice_tracker").update({deleted_at:null,deleted_by:null,deleted_by_name:null,deleted_reason:null}).in("id",n);if(e)throw e},bulkPermanentlyDeleteSiteInvoiceRecords:async n=>{const{error:e}=await g.from("site_invoice_tracker").delete().in("id",n);if(e)throw e},getSiteInvoiceDefaults:async n=>{let e=g.from("site_invoice_defaults").select("*").order("site_name");n&&(e=e.eq("created_by",n));const{data:t,error:r}=await e;if(r)throw r;return(t||[]).map(M)},upsertSiteContract:async(n,e,t)=>{const{data:r}=await g.from("site_invoice_defaults").select("id").eq("site_id",n).eq("billing_year",e).maybeSingle(),i={site_id:n,billing_year:e,company_name:t.companyName,contract_amount:t.contractAmount,contract_management_fee:t.contractManagementFee};if(r){const{error:s}=await g.from("site_invoice_defaults").update({...i,updated_at:new Date().toISOString()}).eq("id",r.id);if(s)throw s}else{const s=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;let o=null;if(s.test(n)){const{data:a}=await g.from("organizations").select("short_name").eq("id",n).single();o=a}if(o){const{error:a}=await g.from("site_invoice_defaults").insert({...i,site_name:o.short_name,created_by:t.createdBy,created_by_name:t.createdByName});if(a)throw a}}},saveSiteInvoiceDefault:async n=>{const{id:e,createdAt:t,updatedAt:r,...i}=n,s=K(i);let o;e?o=g.from("site_invoice_defaults").update({...s,updated_at:new Date().toISOString()}).eq("id",e):o=g.from("site_invoice_defaults").upsert(s,{onConflict:"site_id"});const{data:a,error:d}=await o.select().single();if(d)throw d;return M(a)},bulkSaveSiteInvoiceDefaults:async n=>{const e=n.map(r=>{const{id:i,createdAt:s,updatedAt:o,...a}=r;return K(a)}),{error:t}=await g.from("site_invoice_defaults").upsert(e,{onConflict:"site_id"});if(t)throw t},bulkSaveSiteInvoiceRecords:async n=>{const e=n.map(r=>{const{id:i,sNo:s,createdAt:o,updatedAt:a,...d}=r;return K(d)}),{error:t}=await g.from("site_invoice_tracker").insert(e);if(t)throw t},updateAttendanceSettings:async n=>{const{error:e}=await g.from("settings").update(K(n)).eq("id","singleton");if(e)throw e},getVerificationSubmissions:async(n,e,t)=>{let r=g.from("onboarding_submissions").select("*, user:user_id(reporting_manager_id)");n&&(r=r.eq("status",n)),e&&(r=r.eq("organization_id",e));const{data:i,error:s}=await r.order("created_at",{ascending:!1}).limit(5e3);if(s)throw s;let o=i||[];return t&&(o=o.filter(a=>a.user?.reporting_manager_id===t||a.user?.reporting_manager_2_id===t||a.user?.reporting_manager_3_id===t)),o.map(M)},getOnboardingDataById:async n=>{const{data:e,error:t}=await g.from("onboarding_submissions").select("*").eq("id",n).single();if(t&&t.code!=="PGRST116")throw t;return e?M(e):null},_saveSubmission:async(n,e)=>{const{data:{session:t}}=await g.auth.getSession();if(!t?.user)throw new Error("User not authenticated");const r=n.id&&!n.id.startsWith("draft_")?n.id:crypto.randomUUID(),i=await Nr(n,t.user.id,r),o={...K(i),id:r,user_id:t.user.id,employee_id:n.personal?.employeeId||null,status:e?"draft":n.status};delete o.file,delete o.confirm_account_number,delete o.is_qr_verified;const{data:a,error:d}=await g.from("onboarding_submissions").upsert(o,{onConflict:"id"}).select("id").single();if(d)throw console.error("Save submission error:",d),d;return{draftId:a.id}},saveDraft:async n=>B._saveSubmission(n,!0),submitGmcPublicForm:async n=>{const{error:e}=await g.from("gmc_form_submissions").insert([K(n)]);if(e)throw e},getGMCRates:async()=>{const{data:n,error:e}=await g.from("gmc_rates").select("*").order("min_age",{ascending:!0});if(e)throw e;return(n||[]).map(M)},updateGMCRate:async(n,e)=>{const{error:t}=await g.from("gmc_rates").update(K(e)).eq("id",n);if(t)throw t},addGMCRate:async n=>{const{error:e}=await g.from("gmc_rates").insert([K(n)]);if(e)throw e},deleteGMCRate:async n=>{const{error:e}=await g.from("gmc_rates").delete().eq("id",n);if(e)throw e},getGmcSubmissions:async n=>{const{name:e,site:t,role:r,company:i,minAge:s,maxAge:o,maritalStatus:a,startDate:d,endDate:u,page:m,limit:p}=n||{};let h=g.from("gmc_form_submissions").select("*",{count:"exact"});if(e&&(h=h.ilike("employee_name",`%${e}%`)),t&&(h=h.eq("site_name",t)),i&&(h=h.eq("company_name",i)),a&&(h=h.eq("marital_status",a)),s!==void 0||o!==void 0){const A=new Date;if(o!==void 0){const S=new Date(A.getFullYear()-o-1,A.getMonth(),A.getDate()+1);h=h.gte("dob",we(S,"yyyy-MM-dd"))}if(s!==void 0){const S=new Date(A.getFullYear()-s,A.getMonth(),A.getDate());h=h.lte("dob",we(S,"yyyy-MM-dd"))}}d&&(h=h.gte("updated_at",rn(new Date(d)).toISOString())),u&&(h=h.lte("updated_at",An(new Date(u)).toISOString()));const y=m||1,v=p||10;if(!(p===-1)){const A=(y-1)*v,S=A+v-1;h=h.range(A,S)}const{data:x,error:b,count:w}=await h.order("updated_at",{ascending:!1});if(b)throw b;return{data:(x||[]).map(M),total:w||0}},getEntities:async()=>{const{data:n,error:e}=await g.from("entities").select("*").order("name");if(e)throw e;return(n||[]).map(M)},getGroups:async()=>{const{data:n,error:e}=await g.from("organization_groups").select("*").order("name");if(e)throw e;return(n||[]).map(M)},submitOnboarding:async n=>{const{draftId:e}=await B._saveSubmission(n,!1),t=await B.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve submitted data.");const{data:{user:r}}=await g.auth.getUser();return r&&Be("onboarding_submitted",{actorName:n.personal.firstName+" "+n.personal.lastName,actionText:"has submitted a new enrollment",locString:"",actor:{id:r.id,name:r.email||"Admin",role:"admin"}}),t},updateOnboarding:async n=>{const{draftId:e}=await B._saveSubmission(n,n.status==="draft"),t=await B.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve updated data.");return t},verifySubmission:async n=>{const{error:e}=await g.from("onboarding_submissions").update({status:"verified",portal_sync_status:"pending_sync"}).eq("id",n);if(e)throw e;const t=await B.getOnboardingDataById(n),{data:{user:r}}=await g.auth.getUser();t&&r&&Be("onboarding_verified",{actorName:"Enrollment for "+t.personal.firstName,actionText:"has been verified",locString:"",actor:{id:r.id,name:r.email||"Admin",role:"admin"}})},requestChanges:async(n,e)=>{const{error:t}=await g.from("onboarding_submissions").update({status:"rejected"}).eq("id",n);if(t)throw t;const r=await B.getOnboardingDataById(n),{data:{user:i}}=await g.auth.getUser();r&&i&&Be("onboarding_rejected",{actorName:"Enrollment for "+r.personal.firstName,actionText:"has been rejected (changes requested)",locString:"",actor:{id:i.id,name:i.email||"Admin",role:"admin"}})},syncPortals:async n=>{const{data:e,error:t}=await g.functions.invoke("sync-portals",{body:{submissionId:n}});if(t)throw t;return M(e)},deleteFile:async n=>{const{error:e}=await g.storage.from(zn).remove([n]);if(e)throw e},uploadDocument:async(n,e=zn,t,r)=>{const{data:{session:i}}=await g.auth.getSession(),s=i?.user?.id||"anonymous_user",o=`${s}/documents/${Date.now()}_${n.name}`,{error:a}=await g.storage.from(e).upload(o,n);if(a)throw a;const{data:d}=g.storage.from(e).getPublicUrl(o);if(!d.publicUrl)throw new Error("Could not get public URL for uploaded file.");try{await g.from("user_documents").insert({user_id:s,submission_id:t||null,name:r||n.name,bucket:e,path:o,file_type:n.type,file_size:n.size})}catch(u){console.error("Failed to insert user_documents record:",u)}return{url:d.publicUrl,path:o}},bulkUpdateUserLeaves:async n=>{for(const e of n){const{error:t}=await g.from("users").update(K(e)).eq("id",e.id);if(t)throw t}},getUsers:async n=>{let e=g.from("users").select("*, role_id",{count:"exact"});n?.search&&(e=e.or(`name.ilike.%${n.search}%,email.ilike.%${n.search}%`));const t=n?.sortBy||"created_at",r=n?.sortAscending??!!n?.sortBy;e=e.order(t,{ascending:r});const i=n?.page!==void 0&&n?.pageSize!==void 0;if(i){const u=(n.page-1)*n.pageSize,m=u+n.pageSize-1;e=e.range(u,m)}const{data:s,count:o,error:a}=await e;if(a)throw a;const d=(s||[]).map(u=>M({...u,role:u.role_id}));return i?{data:d,total:o||0}:d},getUserHolidays:async n=>{const{data:e,error:t}=await g.from("user_holidays").select("*").eq("user_id",n);return t&&t.code!=="PGRST116"?(console.warn("User holidays table might not exist:",t),[]):(e||[]).map(M)},getAllUserHolidays:async()=>{const{data:n,error:e}=await g.from("user_holidays").select("*");return e?(console.warn("Error fetching all user holidays:",e),[]):(n||[]).map(M)},saveUserHolidays:async(n,e)=>{const t=e[0]?.year||new Date().getFullYear();if(await g.from("user_holidays").delete().eq("user_id",n).eq("year",t),e.length>0){const{error:r}=await g.from("user_holidays").insert(e.map(i=>({user_id:n,holiday_name:i.holidayName,holiday_date:i.holidayDate,year:i.year})));if(r)throw r}},getUserById:async n=>{const{data:e,error:t}=await g.from("users").select("*, role_id").eq("id",n).single();return t?null:M({...e,role:e.role_id})},getUsersWithManagers:async()=>{const{data:n,error:e}=await g.from("users").select("*");if(e)throw e;const t=(n||[]).map(i=>({...M({...i,role:i.role_id}),reportingManagerId:i.reporting_manager_id,reportingManager2Id:i.reporting_manager_2_id,reportingManager3Id:i.reporting_manager_3_id})),r=new Map(t.map(i=>[i.id,i.name]));return t.map(i=>({...i,managerName:i.reportingManagerId?r.get(i.reportingManagerId):void 0,manager2Name:i.reportingManager2Id?r.get(i.reportingManager2Id):void 0,manager3Name:i.reportingManager3Id?r.get(i.reportingManager3Id):void 0}))},getTeamMembers:async n=>{const{data:e,error:t}=await g.from("users").select("*, role_id").or(`reporting_manager_id.eq.${n},reporting_manager_2_id.eq.${n},reporting_manager_3_id.eq.${n}`);if(t)throw t;return(e||[]).map(r=>M({...r,role:r.role_id}))},getLatestLocations:async n=>{if(n.length===0)return{};const e=await Promise.all(n.map(r=>g.from("attendance_events").select("user_id, latitude, longitude, timestamp, location_name").eq("user_id",r).order("timestamp",{ascending:!1}).limit(1).maybeSingle())),t={};return e.forEach(({data:r})=>{r&&(t[r.user_id]=M(r))}),t},getLocationHistory:async(n,e,t)=>B.getAttendanceEvents(n,e,t),getFieldStaff:async n=>{let e=await B.getUsers();return n&&(e=e.filter(t=>t.reportingManagerId===n||t.reportingManager2Id===n||t.reportingManager3Id===n)),e.filter(t=>t.role==="field_staff")},getTeamLocations:async n=>{if(n.length===0)return{};const e=p=>{if(!p||typeof p!="string")return"";const h=p.trim();if(!h)return"";const v=h.replace(/,\s*$/,"").replace(/\s+(State|Union\s+Territory|City)$/i,"").toLowerCase().split(/\s+/).map(_=>_.charAt(0).toUpperCase()+_.slice(1)).join(" ");return Ei[v]||v},t=(p,h)=>{const y=e(p);if(y&&on[y])return on[y];const v=(h||"").toLowerCase();for(const[_,x]of Object.entries(on))if(v.includes(_.toLowerCase()))return x;for(const[_,x]of Object.entries(Ei))if(v.includes(_.toLowerCase())&&on[x])return on[x];for(const _ of mw)if(v.includes(_.toLowerCase()))return _;return null},r=p=>{const h=(p||"").toLowerCase();for(const y of Object.keys(on))if(h.includes(y.toLowerCase()))return y;for(const[y,v]of Object.entries(Ei))if(h.includes(y.toLowerCase()))return v;return null},[i,s,o]=await Promise.all([g.from("onboarding_submissions").select("user_id, address").in("user_id",n).not("address","is",null),g.from("users").select("id, organization_id, organization_name").in("id",n),g.from("organizations").select("id, address")]),a={},d=new Map((o.data||[]).map(p=>[p.id,p.address])),u=new Map((s.data||[]).map(p=>[p.id,p.organization_id])),m=new Map((s.data||[]).map(p=>[p.id,p.organization_name]));return n.forEach(p=>{const h=u.get(p),y=m.get(p),v=h?d.get(h):null,_=`${y||""} ${v||""}`;if(_.trim()){const x=t("",_);let b=r(_);x&&(a[p]={state:x,city:b||"Other"})}}),(i.data||[]).forEach(p=>{const h=p.address,y=h?.present?.state||h?.permanent?.state||h?.state,v=h?.present?.city||h?.permanent?.city||h?.city;let _=e(pw(y)),x=e(v);!_&&x?_=t(x,""):!_&&!x&&typeof h=="string"&&(_=t("",h),x=r(h)),_&&p.user_id&&(a[p.user_id]={state:_,city:x||"Other"})}),a},getNearbyUsers:async()=>{const n=await B.getUsers();let e={};try{const t=new Date;t.setHours(0,0,0,0);const r=new Date,i=await B.getAllAttendanceEvents(t.toISOString(),r.toISOString()),s={};i.forEach(o=>{const{userId:a,type:d,timestamp:u}=o;a&&(!s[a]||new Date(u)>new Date(s[a].timestamp))&&(s[a]={type:d.toLowerCase(),timestamp:u})}),e=Object.fromEntries(Object.entries(s).map(([o,a])=>{const d=a.type.toLowerCase().replace(/[-_\s]/g,""),u=d==="checkin";return console.log(`User ${o}: latest event type = "${a.type}", normalized = "${d}", isCheckIn = ${u}`),[o,u]}))}catch(t){console.warn("Failed to compute user availability:",t)}return n.map(t=>({...t,isAvailable:e[t.id]??!1}))},updateUser:async(n,e)=>{const{role:t,biometricId:r,organizationId:i,organizationName:s,...o}=e,a=K(o);if(t&&(a.role_id=t),r!==void 0&&(a.biometric_id=r),i!==void 0&&(a.organization_id=i),s!==void 0&&(a.organization_name=s),"photo_url"in a){const{data:{session:m}}=await g.auth.getSession();if(!m?.user)throw new Error("User not authenticated for photo upload");const p=m.user.id,{data:h}=await g.from("users").select("photo_url").eq("id",n).single(),y=h?.photo_url,v=async _=>{if(_)try{const b=new URL(_).pathname.split("/public/")[1];if(b){const[w,...A]=b.split("/"),S=A.join("/");S&&await g.storage.from(w).remove([S])}}catch(x){console.error("Failed to process old avatar URL for deletion:",x)}};if(a.photo_url&&a.photo_url.startsWith("data:")){await v(y);const _=await hw(a.photo_url),x=a.photo_url.split(";")[0].split("/")[1]||"jpg",b=`${p}/${Date.now()}.${x}`,{error:w}=await g.storage.from(ps).upload(b,_,{upsert:!0});if(w)throw w;const{data:{publicUrl:A}}=g.storage.from(ps).getPublicUrl(b);a.photo_url=A}else a.photo_url===null&&await v(y)}const{data:d,error:u}=await g.from("users").update(a).eq("id",n).select().single();if(u)throw u;return M({...d,role:d.role_id})},approveUser:async(n,e)=>{const{data:t,error:r}=await g.rpc("approve_user",{user_id:n,role_text:e});if(r)throw r;return{message:"User approved successfully"}},createUser:async n=>{const{role:e,...t}=n,r=K(t);e&&(r.role_id=e);const{data:i,error:s}=await g.from("users").insert(r).select().single();if(s)throw s;return M({...i,role:i.role_id})},deleteUser:async n=>{const{error:e}=await g.from("users").delete().eq("id",n);if(e)throw e},updateUserReportingManager:async(n,e,t=1)=>{const r={1:"reporting_manager_id",2:"reporting_manager_2_id",3:"reporting_manager_3_id"},{error:i}=await g.from("users").update({[r[t]]:e}).eq("id",n);if(i)throw i},getOrganizations:async n=>{let e=g.from("organizations").select("*",{count:"exact"});const t=n?.page!==void 0&&n?.pageSize!==void 0;if(t){const a=(n.page-1)*n.pageSize,d=a+n.pageSize-1;e=e.range(a,d)}const{data:r,count:i,error:s}=await e.order("short_name");if(s)throw s;const o=(r||[]).map(M);return t?{data:o,total:i||0}:o},createOrganization:async n=>{const{data:e,error:t}=await g.from("organizations").insert(K(n)).select().single();if(t)throw t;return M(e)},getOrganizationStructure:async()=>{const{data:n,error:e}=await g.from("organization_groups").select("*");if(e)throw e;const{data:t,error:r}=await g.from("companies").select("*");if(r)throw r;const{data:i,error:s}=await g.from("entities").select("*");if(s)throw s;const o=(n||[]).map(M),a=(t||[]).map(M),d=(i||[]).map(M),u=new Map;return a.forEach(m=>{const p={...m,entities:d.filter(h=>h.companyId===m.id)};u.has(m.groupId)||u.set(m.groupId,[]),u.get(m.groupId).push(p)}),o.map(m=>({...m,companies:u.get(m.id)||[],locations:[]}))},bulkSaveOrganizationStructure:async n=>{const e=n.map(({companies:p,locations:h,...y})=>K(y)),{error:t}=await g.from("organization_groups").upsert(e);if(t)throw t;const r=n.flatMap(p=>p.companies.map(h=>({...h,groupId:p.id}))),i=r.map(({entities:p,...h})=>K(h)),{error:s}=await g.from("companies").upsert(i);if(s)throw s;const o=r.flatMap(p=>p.entities.map(h=>({...h,companyId:p.id}))),a=o.map(p=>K(p)),{error:d}=await g.from("entities").upsert(a);if(d)throw d;const u=o.map(p=>({id:p.organizationId||p.id,short_name:p.name,full_name:p.name,address:p.registeredAddress||"",updated_at:new Date().toISOString()})),{error:m}=await g.from("organizations").upsert(u,{onConflict:"id"});if(m)throw m},createOrganizationGroup:async n=>{const{data:e,error:t}=await g.from("organization_groups").insert(K(n)).select().single();if(t)throw t;return M(e)},updateOrganizationGroup:async(n,e)=>{const{data:t,error:r}=await g.from("organization_groups").update(K(e)).eq("id",n).select().single();if(r)throw r;return M(t)},deleteOrganizationGroup:async n=>{const{error:e}=await g.from("organization_groups").delete().eq("id",n);if(e)throw e},createCompany:async n=>{const{entities:e,...t}=n,{data:r,error:i}=await g.from("companies").insert(K(t)).select().single();if(i)throw i;return M({...r,entities:[]})},updateCompany:async(n,e)=>{const{entities:t,...r}=e,{data:i,error:s}=await g.from("companies").update(K(r)).eq("id",n).select().single();if(s)throw s;return M(i)},deleteCompany:async n=>{const{error:e}=await g.from("companies").delete().eq("id",n);if(e)throw e},saveEntity:async n=>{const{id:e,...t}=n,r=K(t);let i;e&&!e.startsWith("new_")?i=g.from("entities").update(r).eq("id",e):i=g.from("entities").insert({...r,id:e?.startsWith("new_")?`ent_${Date.now()}`:e});const{data:s,error:o}=await i.select().single();if(o)throw o;return M(s)},deleteEntity:async n=>{const{error:e}=await g.from("entities").delete().eq("id",n);if(e)throw e},saveSiteConfiguration:async(n,e)=>{const{data:t,error:r}=await g.from("site_configurations").upsert({organization_id:n,config_data:e},{onConflict:"organization_id"});if(r)throw r},getSiteConfigurations:async()=>{const{data:n,error:e}=await g.from("site_configurations").select("*");if(e)throw e;return(n||[]).map(t=>({...M(t.config_data),organizationId:t.organization_id}))},bulkUploadOrganizations:async n=>{const{count:e,error:t}=await g.from("organizations").upsert(K(n),{onConflict:"id"});if(t)throw t;return{count:e||0}},getModules:async()=>{const{data:n,error:e}=await g.from("app_modules").select("*");if(e)throw e;return(n||[]).map(M)},saveModules:async n=>{const{error:e}=await g.from("app_modules").upsert(K(n));if(e)throw e},getRoles:async()=>{const{data:n,error:e}=await g.from("roles").select("*");if(e)throw e;return(n||[]).map(M)},saveRoles:async n=>{const{error:e}=await g.from("roles").upsert(K(n));if(e)throw e},getHolidays:async()=>{const{data:n,error:e}=await g.from("holidays").select("*");if(e)throw e;return(n||[]).map(M)},addHoliday:async n=>{const{data:e,error:t}=await g.from("holidays").insert(K(n)).select().single();if(t)throw t;return M(e)},removeHoliday:async n=>{const{error:e}=await g.from("holidays").delete().eq("id",n);if(e)throw e},getAttendanceEvents:async(n,e,t)=>{const r=g.from("attendance_events").select("*").eq("user_id",n).gte("timestamp",e).lte("timestamp",t).order("timestamp",{ascending:!0});return(await al(r)||[]).map(M)},getAllAttendanceEvents:async(n,e)=>{const t=g.from("attendance_events").select("*").gte("timestamp",n).lte("timestamp",e).order("timestamp",{ascending:!0});return(await al(t)||[]).map(M)},getAttendanceDashboardData:async(n,e,t,r="UTC")=>{const{data:i,error:s}=await g.rpc("get_attendance_dashboard_data",{start_date_iso:we(n,"yyyy-MM-dd"),end_date_iso:we(e,"yyyy-MM-dd"),current_date_iso:we(t,"yyyy-MM-dd"),p_timezone:r});if(s)throw new Error("Could not load attendance dashboard data from the database function.");return i},addAttendanceEvent:async n=>{const{error:e}=await g.from("attendance_events").insert(K(n));if(e)throw e},requestAttendanceUnlock:async n=>{const{data:{session:e}}=await g.auth.getSession();if(!e?.user)throw new Error("Not authenticated");const{error:t}=await g.from("attendance_unlock_requests").insert({user_id:e.user.id,reason:n,status:"pending",requested_at:new Date().toISOString()});if(t)throw t},getAttendanceUnlockRequests:async n=>{let e=g.from("attendance_unlock_requests").select("*, user:user_id(name, photo_url, reporting_manager_id, reporting_manager_2_id, reporting_manager_3_id)").eq("status","pending").order("requested_at",{ascending:!1});const{data:t,error:r}=await e;if(r)throw r;let i=t;return n&&(i=t.filter(s=>s.user?.reporting_manager_id===n||s.user?.reporting_manager_2_id===n||s.user?.reporting_manager_3_id===n)),i.map(s=>({id:s.id,userId:s.user_id,userName:s.user?.name||"Unknown",userPhoto:s.user?.photo_url,reason:s.reason,status:s.status,requestedAt:s.requested_at,managerId:s.manager_id,respondedAt:s.responded_at,rejectionReason:s.rejection_reason}))},respondToUnlockRequest:async(n,e,t)=>{const{data:{session:r}}=await g.auth.getSession();if(!r?.user)throw new Error("Not authenticated");const i={status:e,manager_id:r.user.id,responded_at:new Date().toISOString()};e==="rejected"&&t&&(i.rejection_reason=t);const{error:s}=await g.from("attendance_unlock_requests").update(i).eq("id",n);if(s)throw s},checkUnlockStatus:async()=>{const{data:{session:n}}=await g.auth.getSession();if(!n?.user)return 0;new Date().toISOString().split("T")[0];const{data:e,error:t}=await g.from("attendance_unlock_requests").select("id").eq("user_id",n.user.id).eq("status","approved").gte("requested_at",rn(new Date).toISOString()).lte("requested_at",An(new Date).toISOString());return t?0:e?.length||0},getDailyUnlockRequestCount:async()=>{const{data:{session:n}}=await g.auth.getSession();if(!n?.user)return 0;new Date().toISOString().split("T")[0];const{data:e,error:t}=await g.from("attendance_unlock_requests").select("id").eq("user_id",n.user.id).in("status",["pending","approved"]).gte("requested_at",rn(new Date).toISOString()).lte("requested_at",An(new Date).toISOString());return t?0:e?.length||0},getMyUnlockRequest:async()=>{const{data:{session:n}}=await g.auth.getSession();if(!n?.user)return null;new Date().toISOString().split("T")[0];const{data:e,error:t}=await g.from("attendance_unlock_requests").select("*").eq("user_id",n.user.id).gte("requested_at",rn(new Date).toISOString()).order("requested_at",{ascending:!1}).limit(1).maybeSingle();return t?null:e?M(e):null},getAppRoles:async()=>{const{data:n,error:e}=await g.from("roles").select("id, display_name");if(e)throw e;return(n||[]).map(t=>({id:t.id,displayName:t.display_name}))},async triggerMissedCheckouts(n){const{data:{session:e}}=await g.auth.getSession(),{data:t,error:r}=await g.functions.invoke("trigger-missed-checkouts",{body:{manual:!0,settings:n?K(n):void 0},headers:{Authorization:`Bearer ${e?.access_token||""}`}});if(r)throw console.error("Edge Function Error:",r),r;let i=0;return t?.groups&&Object.values(t.groups).forEach(s=>{s.usersProcessed&&(i+=s.usersProcessed)}),{count:i}},getLocations:async()=>{const{data:n,error:e}=await g.from("locations").select("*, created_by_user:created_by (id, name)");if(e)throw e;return(n||[]).map(t=>{const r=M(t),s=r.createdByUser?.name||void 0,{createdByUser:o,...a}=r;return{...a,createdByName:s}})},getUserLocations:async n=>{const{data:e,error:t}=await g.from("user_locations").select("location_id:location_id (*), id").eq("user_id",n);if(t)throw t;return(e||[]).map(r=>{const i=r.location_id||{};return M(i)})},createLocation:async n=>{const e=K(n),{data:t,error:r}=await g.from("locations").insert(e).select("*").maybeSingle();if(r)throw r;return t?M(t):null},assignLocationToUser:async(n,e)=>{const{error:t}=await g.from("user_locations").insert({user_id:n,location_id:e});if(t)throw t},updateLocation:async(n,e)=>{const t=K(e),{data:r,error:i}=await g.from("locations").update(t).eq("id",n).select("*").maybeSingle();if(i)throw i;return r?M(r):null},deleteLocation:async n=>{const{error:e}=await g.from("locations").delete().eq("id",n);if(e)throw e},unassignLocationFromUser:async(n,e)=>{const{error:t}=await g.from("user_locations").delete().match({user_id:n,location_id:e});if(t)throw t},uploadLogo:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:r}=await g.storage.from(Nn).upload(t,n,{upsert:!0});if(r)throw r;const{data:{publicUrl:i}}=g.storage.from(Nn).getPublicUrl(t);return i},getLogos:async()=>{const{data:n,error:e}=await g.storage.from(Nn).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:r}}=g.storage.from(Nn).getPublicUrl(t.name);return{name:t.name,url:r}})},deleteLogo:async n=>{const{error:e}=await g.storage.from(Nn).remove([n]);if(e)throw e},uploadBackground:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:r}=await g.storage.from(Rn).upload(t,n,{upsert:!0});if(r)throw r;const{data:{publicUrl:i}}=g.storage.from(Rn).getPublicUrl(t);return i},getBackgroundImages:async()=>{const{data:n,error:e}=await g.storage.from(Rn).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:r}}=g.storage.from(Rn).getPublicUrl(t.name);return{name:t.name,url:r}})},deleteBackground:async n=>{const{error:e}=await g.storage.from(Rn).remove([n]);if(e)throw e},getAttendanceSettings:async()=>{const{data:n,error:e}=await g.from("settings").select("attendance_settings").eq("id","singleton").single();if(e)return B.handleError(e);if(!n?.attendance_settings)throw new Error("Attendance settings are not configured.");return M(n.attendance_settings)},saveAttendanceSettings:async n=>{const{error:e}=await g.from("settings").upsert({id:"singleton",attendance_settings:K(n)},{onConflict:"id"});if(e)throw console.error("Error saving attendance settings:",e),e},saveApiSettings:async n=>{const{error:e}=await g.from("settings").upsert({id:"singleton",api_settings:K(n)},{onConflict:"id"});if(e)throw console.error("Error saving API settings:",e),e},saveAddressSettings:async n=>{const{error:e}=await g.from("settings").upsert({id:"singleton",address_settings:K(n)},{onConflict:"id"});if(e)throw console.error("Error saving address settings:",e),e},saveGeminiApiSettings:async n=>{const{error:e}=await g.from("settings").upsert({id:"singleton",gemini_api_settings:K(n)},{onConflict:"id"});if(e)throw e},saveOfflineOcrSettings:async n=>{const{error:e}=await g.from("settings").upsert({id:"singleton",offline_ocr_settings:K(n)},{onConflict:"id"});if(e)throw e},savePerfiosApiSettings:async n=>{const{error:e}=await g.from("settings").upsert({id:"singleton",perfios_api_settings:K(n)},{onConflict:"id"});if(e)throw e},saveOtpSettings:async n=>{const{error:e}=await g.from("settings").upsert({id:"singleton",otp_settings:K(n)},{onConflict:"id"});if(e)throw e},saveSiteManagementSettings:async n=>{const{error:e}=await g.from("settings").upsert({id:"singleton",site_management_settings:K(n)},{onConflict:"id"});if(e)throw e},saveNotificationSettings:async n=>{const{error:e}=await g.from("settings").upsert({id:"singleton",notification_settings:K(n)},{onConflict:"id"});if(e)throw e},getRecurringHolidays:async()=>{const{data:n,error:e}=await g.from("recurring_holidays").select("*");if(e)throw e;return(n||[]).map(t=>({id:t.id,type:t.role_type,day:t.day,n:t.occurrence}))},addRecurringHoliday:async n=>{const e={role_type:n.type||"office",day:n.day,occurrence:n.n},{data:t,error:r}=await g.from("recurring_holidays").insert(e).select().single();if(r)throw r;return{id:t.id,type:t.role_type,day:t.day,n:t.occurrence}},deleteRecurringHoliday:async n=>{const{error:e}=await g.from("recurring_holidays").delete().eq("id",n);if(e)throw e},createAssignment:async(n,e,t)=>{const r=(await B.getOrganizations()).find(s=>s.id===e);await B.createTask({name:`Visit ${r?.shortName||"site"} for verification`,description:`Perform on-site duties and verification tasks for ${r?.shortName}.`,dueDate:t,priority:"Medium",assignedToId:n});const{error:i}=await g.from("site_assignments").insert({officer_id:n,site_id:e,assignment_date:t});if(i&&i.code!=="23505")throw i},getLeaveBalancesForUser:async(n,e)=>{const t=I=>{const $=(I||"").toLowerCase();return["hr","admin","finance","developer","management","office_staff","back_office_staff","bd","operation_manager","field_staff","finance_manager","hr_ops","business developer","unverified","operation manager","field staff","finance manager","hr ops"].includes($)?"office":["site_manager","site_supervisor","site manager","site supervisor"].includes($)?"site":"field"},[{data:r,error:i},{data:s,error:o}]=await Promise.all([g.from("settings").select("attendance_settings").eq("id","singleton").single(),g.from("users").select(`
          role_id, 
          role:roles(display_name),
          earned_leave_opening_balance, 
          earned_leave_opening_date, 
          sick_leave_opening_balance, 
          sick_leave_opening_date
        `).eq("id",n).single()]);if(i||!r?.attendance_settings)throw new Error("Could not load attendance rules.");if(o)throw o;const a=s.role,d=(Array.isArray(a)?a[0]?.display_name:a?.display_name)||s.role_id,u=t(d),m=M(r.attendance_settings)[u],p=e?new Date(e.replace(/-/g,"/")):new Date,h=p.getFullYear(),y=`${h}-01-01`,v=we(p,"yyyy-MM-dd"),[{data:_,error:x},{data:b,error:w},{data:A,error:S},{data:C,error:N},D,{data:V,error:O}]=await Promise.all([g.from("leave_requests").select("leave_type, start_date, end_date, day_option").eq("user_id",n).eq("status","approved").gte("start_date",y).lte("start_date",`${h}-12-31`),g.from("comp_off_logs").select("*").eq("user_id",n),g.from("extra_work_logs").select("hours_worked").eq("user_id",n).eq("claim_type","OT").eq("status","Approved").gte("work_date",we(ao(p),"yyyy-MM-dd")).lte("work_date",we(lo(p),"yyyy-MM-dd")),g.from("holidays").select("*"),B.getRecurringHolidays(),g.from("attendance_events").select("timestamp").eq("user_id",n).gte("timestamp",y).lte("timestamp",`${h}-12-31`)]);if(x||w||S||N||O){const I=x||w||S||N||O;return B.handleError(I)}const W=I=>I?v>I:!1;let ne=m.annualEarnedLeaves||0;if(m.earnedLeaveAccrual){const I=s.earned_leave_opening_balance||0,$=s.earned_leave_opening_date||we(new Date,"yyyy-MM-dd"),E=await B.getCountableDays(n,$,we(new Date,"yyyy-MM-dd"),C||[],D||[],m);ne=I+Math.floor(E/m.earnedLeaveAccrual.daysRequired)*m.earnedLeaveAccrual.amountEarned}const se=new Set((V||[]).map(I=>we(new Date(I.timestamp),"yyyy-MM-dd"))),J=new Set(C.map(I=>we(new Date(I.date),"yyyy-MM-dd")));let ie=0,pe=0;se.forEach(I=>{const $=new Date(I),E=we($,"EEEE");(D||[]).some(ee=>{if(ee.type&&ee.type!==u||ee.day!==E)return!1;if(ee.n===0)return!0;const he=$.getDate(),me=Math.ceil(he/7);return ee.n===me})&&ie++,(E==="Sunday"||J.has(I))&&pe++});let _e=0;if(m.enableSickLeaveAccrual){const I=s.sick_leave_opening_date;let $=0,E=y;I&&new Date(I.replace(/-/g,"/")).getFullYear()===h&&($=I.endsWith("-01-01")?0:s.sick_leave_opening_balance||0,E=I);const q=new Date(Math.max(new Date(E.replace(/-/g,"/")).getTime(),new Date(y.replace(/-/g,"/")).getTime()));let ee=ao(q),he=0;const me=new Set((V||[]).map(be=>we(new Date(be.timestamp),"yyyy-MM"))),Se=lo(p);for(;ee<=Se;){const be=we(ee,"yyyy-MM");me.has(be)&&(he+=1),ee=new Date(ee.getFullYear(),ee.getMonth()+1,1)}_e=$+he}else _e=m.annualSickLeaves||0;const Ne=(b||[]).filter(I=>I.status==="earned"||I.status==="used").length+pe,Pe={earned:W(m.earnedLeavesExpiryDate),sick:W(m.sickLeavesExpiryDate),floating:W(m.floatingLeavesExpiryDate),compOff:W(m.compOffLeavesExpiryDate)},L={userId:n,earnedTotal:ne,earnedUsed:0,sickTotal:_e,sickUsed:0,floatingTotal:ie,floatingUsed:0,compOffTotal:Ne,compOffUsed:0,otHoursThisMonth:(A||[]).reduce((I,$)=>I+($.hours_worked||0),0),expiryStates:Pe};return(_||[]).forEach(I=>{const $=I.day_option==="half"?.5:Xn(new Date(I.end_date),new Date(I.start_date))+1,E=I.start_date;I.leave_type==="Earned"&&(!Pe.earned||m.earnedLeavesExpiryDate&&E<=m.earnedLeavesExpiryDate)&&(L.earnedUsed+=$),I.leave_type==="Sick"&&(!Pe.sick||m.sickLeavesExpiryDate&&E<=m.sickLeavesExpiryDate)&&(L.sickUsed+=$),I.leave_type==="Floating"&&(!Pe.floating||m.floatingLeavesExpiryDate&&E<=m.floatingLeavesExpiryDate)&&(L.floatingUsed+=$),I.leave_type==="Comp Off"&&(!Pe.compOff||m.compOffLeavesExpiryDate&&E<=m.compOffLeavesExpiryDate)&&(L.compOffUsed+=$)}),L},getCountableDays:async(n,e,t,r,i,s)=>{const{data:o,error:a}=await g.from("attendance_events").select("timestamp").eq("user_id",n).gte("timestamp",rn(new Date(e)).toISOString()).lte("timestamp",An(new Date(t)).toISOString());if(a)throw a;const d=new Set((o||[]).map(y=>we(new Date(y.timestamp),"yyyy-MM-dd"))),u=new Set(r.map(y=>we(new Date(y.date),"yyyy-MM-dd")));let m=0;const p={start:new Date(e),end:new Date(t)};return Fd(p).forEach(y=>{const v=we(y,"yyyy-MM-dd");if(d.has(v)){m++;return}if(u.has(v)){m++;return}const _=Od(y);if(s.weeklyOffDays?.includes(_)){m++;return}if(i.some(b=>{if(b.day!==we(y,"EEEE"))return!1;if(b.n===0)return!0;const w=y.getDate(),A=Math.ceil(w/7);return b.n===A})){m++;return}}),m},submitLeaveRequest:async n=>{const{data:e,error:t}=await g.from("users").select("reporting_manager_id").eq("id",n.userId).single();if(t)throw t;const r=await Nr(n,n.userId,""),i=K(r);delete i.user_name;const{data:s,error:o}=await g.from("leave_requests").insert({...i,status:"pending_manager_approval",current_approver_id:e.reporting_manager_id||null,approval_history:[]}).select("*").single();if(o)throw o;if(e.reporting_manager_id)try{Be("leave_request",{actorName:n.userName||"An employee",actionText:`has submitted a new ${n.leaveType} leave request`,locString:"",actor:{id:n.userId,name:n.userName||"Employee",role:"staff",reportingManagerId:e.reporting_manager_id}})}catch(a){console.error("Failed to trigger leave notification:",a)}return M(s)},updateLeaveRequest:async(n,e)=>{const t=K(e);delete t.user_name;const{data:r,error:i}=await g.from("leave_requests").update(t).eq("id",n).select().single();if(i)throw i;return M(r)},updateLeaveType:async(n,e)=>{const{data:t,error:r}=await g.from("leave_requests").select("user_id, leave_type, status, start_date, end_date, day_option").eq("id",n).single();if(r)throw r;const i=t.leave_type;if(t.status==="approved"&&(i==="Comp Off"&&e!=="Comp Off"&&await g.from("comp_off_logs").update({status:"earned",leave_request_id:null}).eq("leave_request_id",n),e==="Comp Off"&&i!=="Comp Off")){const o=t.day_option==="half"?.5:Xn(new Date(t.end_date.replace(/-/g,"/")),new Date(t.start_date.replace(/-/g,"/")))+1,{data:a}=await g.from("comp_off_logs").select("id").eq("user_id",t.user_id).eq("status","earned").limit(Math.ceil(o));a&&a.length>0&&await g.from("comp_off_logs").update({status:"used",leave_request_id:n}).in("id",a.map(d=>d.id))}const{error:s}=await g.from("leave_requests").update({leave_type:e}).eq("id",n);if(s)throw s},cancelLeaveRequest:async n=>{const{error:e}=await g.from("leave_requests").delete().eq("id",n);if(e)throw e},getLeaveRequests:async n=>{let e=g.from("leave_requests").select("*, users(name)",{count:"exact"});if(n?.userId&&(e=e.eq("user_id",n.userId)),n?.userIds&&(e=e.in("user_id",n.userIds)),n?.status&&(e=e.eq("status",n.status)),n?.forApproverId){const{data:d}=await g.from("users").select("id").or(`reporting_manager_2_id.eq.${n.forApproverId},reporting_manager_3_id.eq.${n.forApproverId}`),u=(d||[]).map(m=>m.id);u.length>0?e=e.or(`current_approver_id.eq.${n.forApproverId},user_id.in.(${u.join(",")})`):e=e.eq("current_approver_id",n.forApproverId)}if(n?.startDate&&n?.endDate&&(e=e.lte("start_date",n.endDate).gte("end_date",n.startDate)),n?.page&&n?.pageSize){const d=(n.page-1)*n.pageSize,u=d+n.pageSize-1;e=e.range(d,u)}const{data:t,count:r,error:i}=await e.order("start_date",{ascending:!1});if(i)return B.handleError(i);const s=[...new Set((t||[]).map(d=>d.current_approver_id).filter(Boolean))];let o={};if(s.length>0){const{data:d}=await g.from("users").select("id, name").in("id",s);o=(d||[]).reduce((u,m)=>({...u,[m.id]:m.name}),{})}return{data:(t||[]).map(d=>{const u=M(d),m=Array.isArray(d.users)?d.users[0]:d.users;return{...u,userName:m?.name||"Unknown",currentApproverName:d.current_approver_id&&o[d.current_approver_id]||null}}),total:r||0}},getTasks:async n=>{let e=g.from("tasks").select("*",{count:"exact"});const t=n?.page!==void 0&&n?.pageSize!==void 0;if(t){const a=(n.page-1)*n.pageSize,d=a+n.pageSize-1;e=e.range(a,d)}const{data:r,count:i,error:s}=await e.order("created_at",{ascending:!1});if(s)throw s;const o=(r||[]).map(M);return t?{data:o,total:i||0}:o},createTask:async n=>{const{data:e,error:t}=await g.from("tasks").insert(K({...n,status:"To Do",escalationStatus:"None"})).select().single();if(t)throw t;return e.assigned_to_id&&Be("task_assigned",{actorName:e.name,actionText:"has been assigned",locString:"",actor:{id:e.created_by_id||"",name:"System",role:"admin"}}),M(e)},updateTask:async(n,e)=>{if(e?.completionPhoto&&e.completionPhoto.file){const i=e.completionPhoto,s=i.file;try{const{path:o}=await B.uploadDocument(s,Si);e.completionPhoto={name:i.name,type:i.type,size:i.size,path:o}}catch(o){console.error("Failed to upload task completion photo:",o),delete e.completionPhoto}}const{data:t,error:r}=await g.from("tasks").update(K(e)).eq("id",n).select().single();if(r)throw r;return e.status==="Done"&&Be("task_completed",{actorName:t.name,actionText:"has been completed",locString:"",actor:{id:t.assigned_to_id||"",name:"Staff",role:"staff"}}),M(t)},deleteTask:async n=>{const{error:e}=await g.from("tasks").delete().eq("id",n);if(e)throw e},runAutomaticEscalations:async()=>{const{data:n,error:e}=await g.functions.invoke("run-escalations");if(e)throw e;return M(n)},getNotifications:async n=>{const{data:e,error:t}=await g.from("notifications").select("*").eq("user_id",n).order("created_at",{ascending:!1});return t?B.handleError(t):(e||[]).map(M)},createNotification:async n=>{const{title:e,...t}=n,{data:r,error:i}=await g.from("notifications").insert(K(t)).select().single();if(i)throw i;return M(r)},markNotificationAsRead:async n=>{await g.from("notifications").update({is_read:!0}).eq("id",n)},markAllNotificationsAsRead:async n=>{await g.from("notifications").update({is_read:!0}).eq("user_id",n).eq("is_read",!1)},getNotificationRules:async()=>{const{data:n,error:e}=await g.from("notification_rules").select("*").order("created_at",{ascending:!1});return e?B.handleError(e):n.map(M)},saveNotificationRule:async n=>{const e=K(n);if(n.id){const{data:t,error:r}=await g.from("notification_rules").update(e).eq("id",n.id).select().single();if(r)throw r;return M(t)}else{const{data:t,error:r}=await g.from("notification_rules").insert(e).select().single();if(r)throw r;return M(t)}},deleteNotificationRule:async n=>{const{error:e}=await g.from("notification_rules").delete().eq("id",n);if(e)throw e},broadcastNotification:async n=>{let e=n.userIds||[];if(n.role){const{data:i,error:s}=await g.from("users").select("id").eq("role",n.role);if(s)throw s;e=[...new Set([...e,...i.map(o=>o.id)])]}if(e.length===0&&!n.role){const{data:i,error:s}=await g.from("users").select("id");if(s)throw s;e=i.map(o=>o.id)}const t=e.map(i=>K({userId:i,message:n.message,type:n.type||"info"})),{error:r}=await g.from("notifications").insert(t);if(r)throw r},getChecklistTemplates:async n=>{const{data:e,error:t}=await g.from("checklist_templates").select("*").eq("job_type",n).eq("is_active",!0).order("version",{ascending:!1});if(t)throw t;return(e||[]).map(M)},submitFieldReport:async n=>{const{data:e,error:t}=await g.from("field_reports").insert(K(n)).select().single();if(t)throw t;const{data:{user:r}}=await g.auth.getUser();return Be("field_report",{actorName:n.siteName||"Field staff",actionText:`has submitted a ${n.jobType} report`,locString:"",actor:{id:r?.id||n.userId||"",name:r?.user_metadata?.name||"Staff",role:"staff"}}),M(e)},getFieldReports:async n=>{let e=g.from("field_reports").select("*",{count:"exact"});n?.startDate&&(e=e.gte("created_at",n.startDate)),n?.endDate&&(e=e.lte("created_at",n.endDate)),n?.userId&&n.userId!=="all"?e=e.eq("user_id",n.userId):n?.userIds&&n.userIds.length>0&&(e=e.in("user_id",n.userIds)),n?.siteName&&n.siteName!=="all"&&(e=e.eq("site_name",n.siteName));const t=n?.page!==void 0&&n?.pageSize!==void 0;if(t){const a=(n.page-1)*n.pageSize,d=a+n.pageSize-1;e=e.range(a,d)}const{data:r,count:i,error:s}=await e.order("created_at",{ascending:!1});if(s)throw s;const o=(r||[]).map(M);return t?{data:o,total:i||0}:o},getFieldReportFilterOptions:async n=>{let e=g.from("field_reports").select("user_id, site_name");n&&n.length>0&&(e=e.in("user_id",n));const{data:t,error:r}=await e;if(r)throw r;const i=Array.from(new Set(t.map(d=>d.user_id))),s=Array.from(new Set(t.map(d=>d.site_name))).sort(),{data:o,error:a}=await g.from("users").select("id, name").in("id",i);if(a)throw a;return{users:(o||[]).map(M).sort((d,u)=>d.name.localeCompare(u.name)),sites:s}},getFieldReportById:async n=>{const{data:e,error:t}=await g.from("field_reports").select("*").eq("id",n).single();if(t)throw t;return M(e)},createAuthUser:async n=>{const{name:e,email:t,password:r,role:i}=n;try{const{error:s}=await g.functions.invoke("admin-create-user",{body:{name:e,email:t,password:r,role:i}});if(s)throw s;const a=(await B.getUsers()).find(d=>d.email===t);if(a)return a;console.warn("admin-create-user completed but user not found; falling back to client side signup")}catch(s){const o=typeof s?.message=="string"?s.message:String(s);if(!o.toLowerCase().includes("failed to send a request")&&!o.toLowerCase().includes("edge function"))throw s;console.warn("Edge function not reachable (net::ERR_FAILED or similar), falling back to client side signup");const{data:a,error:d}=await g.auth.signUp({email:t,password:r,options:{data:{name:e}}});if(d||!a?.user)throw d?.status===429?new Error("User creation rate limit reached. Please wait a few minutes before trying again or use the admin edge function if available."):d||new Error("Failed to sign up user");const u=a.user;try{const{error:m}=await g.from("users").upsert({id:u.id,name:e,email:t,role_id:i},{onConflict:"id"});if(m)throw m}catch(m){console.warn("Failed to upsert user profile after fallback signup (possible RLS violation):",m)}return{id:u.id,name:e,email:t,role:i,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}}return{id:"",name:e,email:t,role:i,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}},getPolicies:async()=>{const{data:n,error:e}=await g.from("policies").select("*");if(e)throw e;return(n||[]).map(M)},createPolicy:async n=>{const{data:e,error:t}=await g.from("policies").insert(K(n)).select().single();if(t)throw t;return M(e)},getInsurances:async()=>{const{data:n,error:e}=await g.from("insurances").select("*");if(e)throw e;return(n||[]).map(M)},createInsurance:async n=>{const{data:e,error:t}=await g.from("insurances").insert(K(n)).select().single();if(t)throw t;return M(e)},getApprovalWorkflowSettings:async()=>{const{data:n,error:e}=await g.from("settings").select("approval_workflow_settings").eq("id","singleton").single();if(e)throw e;if(!n?.approval_workflow_settings)throw new Error("Approval workflow settings are not configured.");return M(n.approval_workflow_settings)},updateApprovalWorkflowSettings:async n=>{const{error:e}=await g.from("settings").update({approval_workflow_settings:K({finalConfirmationRole:n})}).eq("id","singleton");if(e)throw e},approveLeaveRequest:async(n,e)=>{const{data:t,error:r}=await g.from("leave_requests").select("approval_history, user_id, leave_type, start_date, end_date, day_option").eq("id",n).single();if(r)throw r;const i=await B.getLeaveBalancesForUser(t.user_id),s=t.day_option==="half"?.5:Xn(new Date(t.end_date),new Date(t.start_date))+1,o=`${t.leave_type.toLowerCase()}Total`.replace("earnedtotal","earnedTotal").replace("sicktotal","sickTotal").replace("floatingtotal","floatingTotal").replace("compofftotal","compOffTotal"),a=o,d=o.replace("Total","Used"),u=i[a]-i[d];if(u<s){const _=`Insufficient ${t.leave_type} balance. Available: ${u} days, Requested: ${s} days.`;await B.rejectLeaveRequest(n,e,_);return}const{finalConfirmationRole:m}=await B.getApprovalWorkflowSettings(),{data:p,error:h}=await g.from("users").select("name").eq("id",e).single();if(h)throw h;const y={approver_id:e,approver_name:p.name,status:"approved",timestamp:new Date().toISOString()},v=[...t.approval_history||[],y];if(t.leave_type==="Comp Off"){const{error:_}=await g.from("leave_requests").update({status:"approved",current_approver_id:null,approval_history:v}).eq("id",n);if(_)throw _;Be("leave_approved",{actorName:"Leave request",actionText:"has been approved",locString:"",actor:{id:e,name:p.name,role:"admin"}});const x=t.day_option==="half"?.5:Xn(new Date(t.end_date),new Date(t.start_date))+1,{data:b}=await g.from("comp_off_logs").select("id").eq("user_id",t.user_id).eq("status","earned").limit(Math.ceil(x));b&&b.length>0&&await g.from("comp_off_logs").update({status:"used",leave_request_id:n}).in("id",b.map(w=>w.id));return}if(m==="reporting_manager"){const{error:_}=await g.from("leave_requests").update({status:"approved",current_approver_id:null,approval_history:v}).eq("id",n);if(_)throw _;Be("leave_approved",{actorName:"Leave request",actionText:"has been approved",locString:"",actor:{id:e,name:p.name,role:"admin"}})}else{const{data:_}=await g.from("users").select("id").eq("role_id",m).limit(1).single(),{error:x}=await g.from("leave_requests").update({status:"pending_hr_confirmation",current_approver_id:_?.id||null,approval_history:v}).eq("id",n);if(x)throw x}},rejectLeaveRequest:async(n,e,t="")=>{const{data:r,error:i}=await g.from("leave_requests").select("approval_history").eq("id",n).single();if(i)throw i;const{data:s,error:o}=await g.from("users").select("name").eq("id",e).single();if(o)throw o;const a={approver_id:e,approver_name:s.name,status:"rejected",timestamp:new Date().toISOString(),comments:t},d=[...r.approval_history||[],a],{error:u}=await g.from("leave_requests").update({status:"rejected",current_approver_id:null,approval_history:d}).eq("id",n);if(u)throw u;Be("leave_rejected",{actorName:"Leave request",actionText:"has been rejected",locString:"",actor:{id:e,name:s.name,role:"admin"}})},reconsiderLeaveRequest:async(n,e)=>{const{data:t,error:r}=await g.from("leave_requests").select("approval_history, user_id").eq("id",n).single();if(r)throw r;const{data:i,error:s}=await g.from("users").select("reporting_manager_id").eq("id",t.user_id).single();if(s)throw s;const{data:o,error:a}=await g.from("users").select("name").eq("id",e).single();if(a)throw a;const d={approver_id:e,approver_name:o.name,status:"reconsidered",timestamp:new Date().toISOString(),comments:"Request reset for reconsideration."},u=[...t.approval_history||[],d],{error:m}=await g.from("leave_requests").update({status:"pending_manager_approval",current_approver_id:i.reporting_manager_id||null,approval_history:u}).eq("id",n);if(m)throw m},cancelApprovedLeave:async(n,e,t)=>{const{data:r,error:i}=await g.from("leave_requests").select("approval_history, user_id, leave_type").eq("id",n).single();if(i)throw i;const{data:s}=await g.from("users").select("name").eq("id",e).single(),o={approver_id:e,approver_name:s?.name||"System",status:"cancelled",timestamp:new Date().toISOString(),comments:t},a=[...r.approval_history||[],o],{error:d}=await g.from("leave_requests").update({status:"cancelled",current_approver_id:null,approval_history:a}).eq("id",n);if(d)throw d;r.leave_type==="Comp Off"&&await g.from("comp_off_logs").update({status:"earned",leave_request_id:null}).eq("leave_request_id",n)},withdrawLeaveRequest:async(n,e)=>{const{data:t,error:r}=await g.from("leave_requests").select("user_id, status").eq("id",n).single();if(r)throw r;if(t.user_id!==e)throw new Error("Unauthorized to withdraw this request.");if(["approved","rejected","cancelled"].includes(t.status))throw new Error("Cannot withdraw an already processed request.");const{error:i}=await g.from("leave_requests").update({status:"withdrawn",current_approver_id:null}).eq("id",n);if(i)throw i},confirmLeaveByHR:async(n,e)=>{const{data:t,error:r}=await g.from("leave_requests").select("leave_type, user_id, approval_history").eq("id",n).single();if(r)throw r;const{data:i,error:s}=await g.from("users").select("name").eq("id",e).single();if(s)throw s;const o={approver_id:e,approver_name:i.name,status:"approved",timestamp:new Date().toISOString(),comments:"Final approval."},a=[...t.approval_history||[],o],{error:d}=await g.from("leave_requests").update({status:"approved",current_approver_id:null,approval_history:a}).eq("id",n);if(d)throw d;if(t.leave_type==="Comp Off"){const{data:u,error:m}=await g.from("comp_off_logs").select("id").eq("user_id",t.user_id).eq("status","earned").limit(1).single();if(m&&m.code!=="PGRST116")throw m;u&&await g.from("comp_off_logs").update({status:"used",leave_request_id:n}).eq("id",u.id)}},submitExtraWorkClaim:async n=>{const{error:e}=await g.from("extra_work_logs").insert(K({...n,status:"Pending"}));if(e)throw e},getExtraWorkLogs:async n=>{let e=g.from("extra_work_logs").select("*, user:user_id(reporting_manager_id, reporting_manager_2_id, reporting_manager_3_id)",{count:"exact"});if(n?.userId&&(e=e.eq("user_id",n.userId)),n?.status&&(e=e.eq("status",n.status)),n?.workDate&&(e=e.eq("work_date",n.workDate)),n?.page&&n?.pageSize){const o=(n.page-1)*n.pageSize,a=o+n.pageSize-1;e=e.range(o,a)}let{data:t,count:r,error:i}=await e.order("work_date",{ascending:!1});if(i)throw i;let s=t||[];return n?.managerId&&(s=s.filter(o=>o.user?.reporting_manager_id===n.managerId||o.user?.reporting_manager_2_id===n.managerId||o.user?.reporting_manager_3_id===n.managerId)),{data:s.map(M),total:r||s.length}},approveExtraWorkClaim:async(n,e)=>{const{data:t,error:r}=await g.from("users").select("name").eq("id",e).single();if(r)throw r;const{data:i,error:s}=await g.from("extra_work_logs").select("*").eq("id",n).single();if(s)throw s;if(!i)throw new Error("Claim not found.");const{error:o}=await g.from("extra_work_logs").update({status:"Approved",approver_id:e,approver_name:t.name,approved_at:new Date().toISOString()}).eq("id",n);if(o)throw o;i.claim_type==="Comp Off"&&await B.addCompOffLog({userId:i.user_id,userName:i.user_name,dateEarned:i.work_date,reason:`Claim approved: ${i.reason}`,status:"earned",grantedById:e,grantedByName:t.name})},rejectExtraWorkClaim:async(n,e,t)=>{const{data:r,error:i}=await g.from("users").select("name").eq("id",e).single();if(i)throw i;const{error:s}=await g.from("extra_work_logs").update({status:"Rejected",approver_id:e,approver_name:r.name,rejection_reason:t}).eq("id",n);if(s)throw s},getManpowerDetails:async n=>{const{data:e,error:t}=await g.from("site_manpower").select("manpower_details").eq("organization_id",n).single();if(t&&t.code!=="PGRST116")throw t;return M(e?.manpower_details||[])},updateManpowerDetails:async(n,e)=>{const{error:t}=await g.from("site_manpower").upsert({organization_id:n,manpower_details:K(e),updated_at:new Date().toISOString()},{onConflict:"organization_id"});if(t)throw t},addCompOffLog:async n=>{const{data:e,error:t}=await g.from("comp_off_logs").insert(K(n)).select().single();if(t)throw t;return M(e)},exportAllData:async()=>{const n=["roles","organization_groups","companies","organizations","entities","users","site_configurations","app_modules","onboarding_submissions","settings","leave_requests","attendance_events","attendance_approvals","locations","user_locations","notifications","tasks","notification_rules","checklist_templates","field_reports","policies","insurances","comp_off_logs","extra_work_logs","uniform_requests","field_attendance_violations","biometric_devices","holidays","recurring_holidays","site_gents_uniform_configs","site_ladies_uniform_configs","site_uniform_details_configs","support_tickets","ticket_posts","ticket_comments","attendance_audit_logs"],e={};for(const t of n){const{data:r,error:i}=await g.from(t).select("*");if(i){console.warn(`Skipping table ${t}:`,i.message);continue}e[t]=r}return M(e)},getBackups:async()=>{const{data:n,error:e}=await g.from("system_backups").select("*, users(name)").order("created_at",{ascending:!1});if(e)throw e;return(n||[]).map(t=>({...M(t),createdByName:t.users?.name||"System"}))},createBackup:async(n,e)=>{const{data:t}=await g.auth.getUser();if(!t.user)throw new Error("Not authenticated");let r=n;if(!r){const p=new Date,h=`${p.getDate()}-${p.getMonth()+1}-${p.getFullYear()}`,{count:y}=await g.from("system_backups").select("*",{count:"exact",head:!0}).gte("created_at",new Date().toISOString().split("T")[0]);r=`Paradigm ${h} backup ${(y||0)+1}`}const i=await B.exportAllData(),s=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),a=`restoration_points/${`backup_${Date.now()}.json`}`,{error:d}=await g.storage.from("backups").upload(a,s);if(d)throw console.error("Storage Upload Error:",d),d.message.includes("not found")||d.status===400?new Error('Storage bucket "backups" not found. Please create it in the Supabase Dashboard.'):d;const{data:u,error:m}=await g.from("system_backups").insert({name:r,description:e,snapshot_path:a,size_bytes:s.size,created_by:t.user.id,status:"completed"}).select().single();if(m)throw m;return M(u)},autoBackupCheck:async()=>{try{const{data:n}=await g.from("settings").select("api_settings").eq("id","singleton").single();if(!n?.api_settings?.auto_backup_enabled)return;const{count:e}=await g.from("system_backups").select("*",{count:"exact",head:!0}).gte("created_at",new Date().toISOString().split("T")[0]);if(e&&e>0)return;console.log("Triggering automated backup..."),await B.createBackup()}catch(n){console.error("Auto-backup failed:",n)}},restoreFromBackup:async n=>{const{data:e,error:t}=await g.from("system_backups").select("*").eq("id",n).single();if(t)throw t;const{data:r,error:i}=await g.storage.from("backups").download(e.snapshot_path);if(i)throw i;const s=await r.text(),o=K(JSON.parse(s)),a=["roles","organization_groups","companies","organizations","entities","users","site_configurations","app_modules","onboarding_submissions","settings","leave_requests","attendance_events","attendance_approvals","locations","user_locations","notifications","tasks","notification_rules","checklist_templates","field_reports","policies","insurances","comp_off_logs","extra_work_logs","uniform_requests","field_attendance_violations","biometric_devices","holidays","recurring_holidays","site_gents_uniform_configs","site_ladies_uniform_configs","site_uniform_details_configs","support_tickets","ticket_posts","ticket_comments","attendance_audit_logs"];for(const d of a.reverse()){if(!o[d])continue;const{error:u}=await g.from(d).delete().neq("id","00000000-0000-0000-0000-000000000000");u&&console.error(`Failed to clear table ${d}:`,u)}for(const d of a.reverse()){if(!o[d]||o[d].length===0)continue;const{error:u}=await g.from(d).insert(o[d]);if(u)throw new Error(`Restoration failed at table ${d}: ${u.message}`)}},getPincodeDetails:async n=>new Promise(e=>setTimeout(()=>e({city:"Bengaluru",state:"Karnataka"}),500)),suggestDepartmentForDesignation:async n=>{const e={"Security Guard":"Security","Housekeeping Staff":"Housekeeping","Site Manager":"Management"},t=Object.keys(e).find(r=>n.toLowerCase().includes(r.toLowerCase()));return Promise.resolve(t?e[t]:null)},verifyBankAccountWithPerfios:async n=>{console.log("Mock verifying bank account:",n),await new Promise(t=>setTimeout(t,1500));const e=Math.random()>.1;return{success:e,message:e?"Bank account verified successfully.":"Account holder name did not match.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:e,uan:null,esi:null,accountHolderName:e,accountNumber:e,ifscCode:!0}}},verifyAadhaar:async n=>{console.log("Mock verifying Aadhaar:",n),await new Promise(t=>setTimeout(t,1e3));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"Aadhaar details verified.":"Invalid Aadhaar number.",verifiedFields:{name:null,dob:null,aadhaar:e,bank:null,uan:null,esi:null}}},lookupUan:async n=>{console.log("Mock looking up UAN:",n),await new Promise(t=>setTimeout(t,1200));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"UAN found and linked.":"UAN not found in EPFO database.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:null,uan:e,esi:null}}},extractDataFromImage:async(n,e,t,r)=>{if(!St)return console.warn("AI feature disabled: cannot extract data from image. Returning empty result."),{};const s=(await St.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:`Extract the structured data from this document image. It is a ${r||"document"}.`},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:t}})).text.trim();return JSON.parse(s)},extractDataFromImageLocal:async(n,e)=>{const t=await dw.createWorker("eng");try{const{data:{text:r}}=await t.recognize(`data:image/png;base64,${n}`),i={},s=r.replace(/\n/g," ");if(e==="PAN"){const o=s.match(/[A-Z]{5}[0-9]{4}[A-Z]{1}/);o&&(i.panNumber=o[0])}else if(e==="Aadhaar"){const o=s.match(/\d{4}\s\d{4}\s\d{4}/);o&&(i.aadhaarNumber=o[0].replace(/\s/g,""))}else if(e==="Bank"||e==="Cheque"){const o=s.match(/[A-Z]{4}0[A-Z0-9]{6}/);o&&(i.ifscCode=o[0]);const a=s.match(/\d{9,18}/);a&&(i.accountNumber=a[0])}else if(e==="Salary"||e==="UAN"){const o=s.match(/\d{12}/);o&&(i.uanNumber=o[0])}return i}finally{await t.terminate()}},crossVerifyNames:async(n,e)=>{if(!St){const i=n.trim().toLowerCase()===e.trim().toLowerCase();return{isMatch:i,reason:i?"Names are identical (case-insensitive match) without AI.":"AI disabled; simple case-insensitive comparison used."}}const r=(await St.models.generateContent({model:"gemini-2.5-flash",contents:`Are these two names referring to the same person? Name 1: "${n}", Name 2: "${e}". Respond in JSON format with two keys: "isMatch" (boolean) and "reason" (a brief string explanation).`,config:{responseMimeType:"application/json",responseSchema:{type:He.OBJECT,properties:{isMatch:{type:He.BOOLEAN},reason:{type:He.STRING}}}}})).text.trim();return JSON.parse(r)},verifyFingerprintImage:async(n,e)=>{if(!St)return{containsFingerprints:!1,reason:"AI disabled; cannot detect fingerprints."};const r=(await St.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:'Does this image contain one or more human fingerprints? The image might be a scan from paper. Respond in JSON with "containsFingerprints" (boolean) and "reason" (string).'},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:{type:He.OBJECT,properties:{containsFingerprints:{type:He.BOOLEAN},reason:{type:He.STRING}}}}})).text.trim();return JSON.parse(r)},enhanceDocumentPhoto:async(n,e)=>{if(!St)return console.warn("AI disabled; returning original document photo without enhancement."),n;const t=await St.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:[{text:"Enhance this document photo. Improve contrast, correct perspective to be flat, and make text as clear as possible. Return only the enhanced image."},{inlineData:{data:n,mimeType:e}}]},config:{responseModalities:[Hn.IMAGE]}});for(const r of t.candidates[0].content.parts)if(r.inlineData)return r.inlineData.data;throw new Error("AI did not return an enhanced image.")},getCompOffLogs:async n=>{const{data:e,error:t}=await g.from("comp_off_logs").select("*").eq("user_id",n).order("date_earned",{ascending:!1});if(t)throw t;return(e||[]).map(M)},checkCompOffTableExists:async()=>{const{error:n}=await g.from("comp_off_logs").select("id").limit(1);if(n)throw n},getAllSiteAssets:async()=>{const{data:n,error:e}=await g.from("site_configurations").select("organization_id, config_data");if(e)throw e;const t={};return n.forEach(r=>{const i=r.config_data;t[r.organization_id]=M(i?.assets||[])}),t},updateSiteAssets:async(n,e)=>{const{data:t,error:r}=await g.from("site_configurations").select("config_data").eq("organization_id",n).maybeSingle();if(r)throw r;const s={...t?.config_data||{},assets:K(e)},{error:o}=await g.from("site_configurations").upsert({organization_id:n,config_data:s},{onConflict:"organization_id"});if(o)throw o},getBackOfficeIdSeries:async()=>{const{data:n,error:e}=await g.from("settings").select("back_office_id_series").eq("id","singleton").single();if(e)throw e;return(n?.back_office_id_series||[]).map(M)},updateBackOfficeIdSeries:async n=>{const{error:e}=await g.from("settings").upsert({id:"singleton",back_office_id_series:K(n)},{onConflict:"id"});if(e)throw e},getSiteStaffDesignations:async()=>{const{data:n,error:e}=await g.from("settings").select("site_staff_designations").eq("id","singleton").single();if(e)throw e;return(n?.site_staff_designations||[]).map(M)},updateSiteStaffDesignations:async n=>{const{error:e}=await g.from("settings").upsert({id:"singleton",site_staff_designations:K(n)},{onConflict:"id"});if(e)throw e},getAllSiteIssuedTools:async()=>{const{data:n,error:e}=await g.from("site_configurations").select("organization_id, config_data");if(e)throw e;const t={};return n.forEach(r=>{const i=r.config_data;t[r.organization_id]=M(i?.issuedTools||[])}),t},getToolsList:async()=>{const{data:n,error:e}=await g.from("settings").select("master_tools").eq("id","singleton").single();if(e)throw e;return M(n.master_tools)},updateSiteIssuedTools:async(n,e)=>{const{data:t,error:r}=await g.from("site_configurations").select("config_data").eq("organization_id",n).maybeSingle();if(r)throw r;const s={...t?.config_data||{},issuedTools:K(e)},{error:o}=await g.from("site_configurations").upsert({organization_id:n,config_data:s},{onConflict:"organization_id"});if(o)throw o},getAllSiteGentsUniforms:async()=>{const{data:n,error:e}=await g.from("site_gents_uniform_configs").select("organization_id, config_data");if(e)throw e;const t={};return n.forEach(r=>{t[r.organization_id]=M(r.config_data)}),t},getMasterGentsUniforms:async()=>{const{data:n,error:e}=await g.from("settings").select("master_gents_uniforms").eq("id","singleton").single();if(e)throw e;return M(n.master_gents_uniforms||{pants:[],shirts:[]})},updateSiteGentsUniforms:async(n,e)=>{const{error:t}=await g.from("site_gents_uniform_configs").upsert({organization_id:n,config_data:K(e)},{onConflict:"organization_id"});if(t)throw t},getAllSiteUniformDetails:async()=>{const{data:n,error:e}=await g.from("site_uniform_details_configs").select("organization_id, config_data");if(e)throw e;const t={};return n.forEach(r=>{t[r.organization_id]=M(r.config_data)}),t},updateSiteUniformDetails:async(n,e)=>{const{error:t}=await g.from("site_uniform_details_configs").upsert({organization_id:n,config_data:K(e)},{onConflict:"organization_id"});if(t)throw t},getAllSiteLadiesUniforms:async()=>{const{data:n,error:e}=await g.from("site_ladies_uniform_configs").select("organization_id, config_data");if(e)throw e;const t={};return n.forEach(r=>{t[r.organization_id]=M(r.config_data)}),t},getMasterLadiesUniforms:async()=>{const{data:n,error:e}=await g.from("settings").select("master_ladies_uniforms").eq("id","singleton").single();if(e)throw e;return M(n.master_ladies_uniforms||{pants:[],shirts:[]})},updateSiteLadiesUniforms:async(n,e)=>{const{error:t}=await g.from("site_ladies_uniform_configs").upsert({organization_id:n,config_data:K(e)},{onConflict:"organization_id"});if(t)throw t},getUniformRequests:async()=>{const{data:n,error:e}=await g.from("uniform_requests").select("*");if(e)throw e;return(n||[]).map(M)},submitUniformRequest:async n=>{const{data:e,error:t}=await g.from("uniform_requests").insert(K(n)).select().single();if(t)throw t;return M(e)},updateUniformRequest:async n=>{const{data:e,error:t}=await g.from("uniform_requests").update(K(n)).eq("id",n.id).select().single();if(t)throw t;return M(e)},deleteUniformRequest:async n=>{const{error:e}=await g.from("uniform_requests").delete().eq("id",n);if(e)throw e},getInvoiceStatuses:async n=>(console.log("Mock fetching invoice statuses for",n),Promise.resolve({})),getInvoiceSummaryData:async(n,e)=>(console.log("Mock fetching invoice data for",n,e),Promise.resolve({siteName:"Mock Site",siteAddress:"Mock Address",invoiceNumber:"INV-001",invoiceDate:"2023-01-31",statementMonth:"January-2023",lineItems:[]})),getSupportTickets:async()=>{const{data:n,error:e}=await g.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))");if(e)throw e;return(n||[]).map(M)},getSupportTicketById:async n=>{const{data:e,error:t}=await g.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))").eq("id",n).single();if(t)throw t;return M(e)},createSupportTicket:async n=>{const e=n.attachment;if(e&&e.file instanceof File)try{const{path:i}=await B.uploadDocument(e.file,ol);n.attachment={name:e.name,type:e.type,size:e.size,path:i}}catch(i){console.error("Failed to upload support ticket attachment:",i),delete n.attachment}const{data:t,error:r}=await g.from("support_tickets").insert(K(n)).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(r)throw r;return Be("support_ticket",{actorName:n.raisedByName||"A user",actionText:"has raised a new support ticket",locString:`: ${n.title}`,actor:{id:n.raisedById||"",name:n.raisedByName||"User",role:"staff"}}),M(t)},updateSupportTicket:async(n,e)=>{const t=e.attachment;if(t&&t.file instanceof File)try{const{path:s}=await B.uploadDocument(t.file,ol);e.attachment={name:t.name,type:t.type,size:t.size,path:s}}catch(s){console.error("Failed to upload updated support ticket attachment:",s),delete e.attachment}const{data:r,error:i}=await g.from("support_tickets").update(K(e)).eq("id",n).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(i)throw i;return M(r)},addTicketPost:async(n,e)=>{const{data:t,error:r}=await g.from("ticket_posts").insert(K(e)).select("*, comments:ticket_comments(*)").single();if(r)throw r;return Be("support_response",{actorName:e.authorName||"Staff",actionText:"has responded to a support ticket",locString:"",actor:{id:e.authorId||"",name:e.authorName||"Staff",role:e.authorRole||"hr"}}),M(t)},togglePostLike:async(n,e)=>{const{data:t,error:r}=await g.from("ticket_posts").select("likes").eq("id",n).single();if(r)throw r;const i=t.likes||[],s=i.includes(e)?i.filter(a=>a!==e):[...i,e],{error:o}=await g.from("ticket_posts").update({likes:s}).eq("id",n);if(o)throw o},addPostComment:async(n,e)=>{const{data:t,error:r}=await g.from("ticket_comments").insert(K(e)).select().single();if(r)throw r;return M(t)},getVerificationCostBreakdown:async(n,e)=>{const{data:t,error:r}=await g.from("onboarding_submissions").select("id, employee_id, personal, enrollment_date, verification_usage").gte("enrollment_date",n).lte("enrollment_date",e);if(r)throw r;return(t||[]).map(i=>{const s=M(i);return{id:s.id,employeeId:s.personal.employeeId,employeeName:`${s.personal.firstName} ${s.personal.lastName}`,enrollmentDate:s.enrollmentDate,totalCost:0,breakdown:s.verificationUsage||[]}})},generatePdf:async(n,e)=>{try{const t=(await F(async()=>{const{default:r}=await import("./html2pdf-DgNOHyuA.js").then(i=>i.h);return{default:r}},__vite__mapDeps([0,1,2]))).default;await t().set(e).from(n).save()}catch(t){throw console.error("PDF generation failed:",t),t}},batchResolveAddresses:async n=>{if(n.length===0)return{};const e=d=>parseFloat(d.toFixed(6)),t=Array.from(new Set(n.map(d=>`${e(d.lat)},${e(d.lon)}`))).map(d=>{const[u,m]=d.split(",").map(Number);return{lat:u,lon:m}}),r={},i=[],s=t.map(d=>d.lat),{data:o,error:a}=await g.from("location_cache").select("*").in("latitude",s);!a&&o&&o.forEach(d=>{const u=e(parseFloat(d.latitude)),m=e(parseFloat(d.longitude)),p=`${u},${m}`;t.some(h=>e(h.lat)===u&&e(h.lon)===m)&&(r[p]=d.address)}),t.forEach(d=>{const u=`${e(d.lat)},${e(d.lon)}`;r[u]||i.push(d)}),console.log("Geocoding API: Found",Object.keys(r).length,"cached,",i.length,"missing");for(const d of i)try{const u=await F(()=>Promise.resolve().then(()=>gw),void 0).then(p=>p.reverseGeocode(d.lat,d.lon)),m=`${e(d.lat)},${e(d.lon)}`;r[m]=u,await g.from("location_cache").insert({latitude:e(d.lat),longitude:e(d.lon),address:u}),console.log("Geocoding API: Fetched and cached",m,"->",u),await new Promise(p=>setTimeout(p,1e3))}catch(u){console.error(`Failed to resolve address for ${d.lat},${d.lon}`,u);const m=`${e(d.lat)},${e(d.lon)}`;r[m]=`${d.lat.toFixed(4)}, ${d.lon.toFixed(4)}`}return r},sendSecurityAlert:async(n,e,t,r)=>{const{data:i,error:s}=await g.from("users").select("reporting_manager_id").eq("id",n).single();if(s||!i?.reporting_manager_id){console.warn("Could not find reporting manager for security alert");return}const o=t==="developer_mode"?"attempted to access the application with Developer Mode enabled":"attempted to access the application with Location Spoofing detected",a=r?` using device: ${r}`:"";await B.createNotification({userId:i.reporting_manager_id,title:" Security Alert",message:`${e} ${o}${a}. Access was blocked for security reasons.`,type:"security",link:"/user-management"})},sendDeviceChangeAlert:async(n,e,t,r)=>{const{data:i,error:s}=await g.from("users").select("name, reporting_manager_id").eq("id",n).single();if(s||!i?.reporting_manager_id){console.warn("Could not find reporting manager for device change alert");return}const o=e||i.name||"An employee";await B.createNotification({userId:i.reporting_manager_id,title:" Device Change Detected",message:`${o} logged in from a new device. Previous device: ${t}, New device: ${r}`,type:"info",link:"/user-management"})},getBiometricDevices:async()=>{const{data:n,error:e}=await g.from("biometric_devices").select("*, organization:organizations(short_name)").order("name");if(e)throw e;return(n||[]).map(M)},addBiometricDevice:async n=>{const e={...n};e.sn&&(e.sn=e.sn.toLowerCase());const{data:t,error:r}=await g.from("biometric_devices").insert(K(e)).select().single();if(r)throw r;return M(t)},deleteBiometricDevice:async n=>{const{error:e}=await g.from("biometric_devices").delete().eq("id",n);if(e)throw e},updateBiometricDevice:async(n,e)=>{const t={...e};t.sn&&(t.sn=t.sn.toLowerCase());const{data:r,error:i}=await g.from("biometric_devices").update(K(t)).eq("id",n).select().single();if(i)throw i;return M(r)},getViolations:async(n,e)=>{let t=g.from("attendance_violations").select("*").eq("user_id",n);e&&(t=t.eq("violation_month",e));const{data:r,error:i}=await t.order("violation_date",{ascending:!1});if(i)throw i;return(r||[]).map(M)},addViolation:async n=>{const{data:e,error:t}=await g.from("attendance_violations").insert(K(n)).select().maybeSingle();if(t)throw t;return e?M(e):null},getViolationCount:async(n,e)=>{const{count:t,error:r}=await g.from("attendance_violations").select("*",{count:"exact",head:!0}).eq("user_id",n).eq("violation_month",e);if(r)throw r;return t||0},resetViolations:async(n,e,t,r)=>{const i=await B.getViolationCount(n,e),{error:s}=await g.from("violation_resets").insert(K({userId:n,resetMonth:e,previousViolationCount:i,resetBy:r,resetReason:t}));if(s)throw s;const{error:o}=await g.from("attendance_violations").delete().eq("user_id",n).eq("violation_month",e);if(o)throw o;const{error:a}=await g.from("users").update({salary_hold:!1,salary_hold_reason:null,salary_hold_date:null}).eq("id",n);if(a)throw a},getResetHistory:async n=>{let e=g.from("violation_resets").select(`
        *,
        user:users!violation_resets_user_id_fkey(name),
        admin:users!violation_resets_reset_by_fkey(name)
      `);n&&(e=e.eq("user_id",n));const{data:t,error:r}=await e.order("reset_at",{ascending:!1});if(r)throw r;return(t||[]).map(i=>({...M(i),userName:i.user?.name,resetByName:i.admin?.name}))},setSalaryHold:async(n,e,t)=>{const{error:r}=await g.from("users").update({salary_hold:e,salary_hold_reason:t||null,salary_hold_date:e?new Date().toISOString():null}).eq("id",n);if(r)throw r},getGeofencingSettings:async()=>{const{data:n,error:e}=await g.from("settings").select("geofencing_verification_enabled, max_violations_per_month").eq("id","singleton").maybeSingle();if(e)throw e;return{enabled:n?.geofencing_verification_enabled??!1,maxViolationsPerMonth:n?.max_violations_per_month??3}},updateGeofencingSettings:async n=>{const e={};n.enabled!==void 0&&(e.geofencing_verification_enabled=n.enabled),n.maxViolationsPerMonth!==void 0&&(e.max_violations_per_month=n.maxViolationsPerMonth);const{error:t}=await g.from("settings").update(e).eq("id","singleton");if(t)throw t},sendFieldReport:async(n,e,t,r,i)=>{const s=`field-reports/${n}_${Date.now()}.pdf`,{error:o}=await g.storage.from(Si).upload(s,e,{upsert:!0});o&&console.error("PDF Upload Failed:",o);const{data:{publicUrl:a}}=g.storage.from(Si).getPublicUrl(s);let d=!1;try{console.log("Invoking sending-email function...");const{error:u}=await g.functions.invoke("send-email",{body:{to:["sudhan@paradigmfms.com"],subject:`New Field Report from ${i}`,html:`<p>Hi,</p><p>${i} has submitted a new field report.</p><p><a href="${a}">Click here to view the report</a></p>`,attachments:[{filename:`FieldReport_${n.substring(0,8)}.pdf`,path:a}]}});if(u)throw console.error("Edge function failed:",u),u;d=!0,console.log("Email sent successfully via backend.")}catch(u){console.error("Backend email failed, falling back to client-side:",u)}try{await B.createNotification({userId:t,message:`New Field Report: ${i} has submitted report ${n.substring(0,8)}.`,type:"info"})}catch(u){console.error("Failed to send notification:",u)}if(!d){const u=encodeURIComponent(`New Field Report from ${i}`),m=encodeURIComponent(`Hi,

Please find the field report attached:
${a}

Submitted by: ${i}
Report ID: ${n}`);setTimeout(()=>{window.open(`mailto:sudhan@paradigmfms.com?subject=${u}&body=${m}`,"_blank")},500)}},async getFieldViolations(n){const{data:e,error:t}=await g.from("field_attendance_violations").select("*").eq("user_id",n).order("date",{ascending:!1});if(t)throw console.error("Error fetching field violations:",t),t;return e.map(r=>({id:r.id,userId:r.user_id,date:r.date,totalHours:parseFloat(r.total_hours),siteHours:parseFloat(r.site_hours),travelHours:parseFloat(r.travel_hours),sitePercentage:parseFloat(r.site_percentage),travelPercentage:parseFloat(r.travel_percentage),violationType:r.violation_type,requiredSitePercentage:parseFloat(r.required_site_percentage),status:r.status,acknowledgedBy:r.acknowledged_by,acknowledgedAt:r.acknowledged_at,managerNotes:r.manager_notes,escalatedTo:r.escalated_to,escalatedAt:r.escalated_at,escalationLevel:r.escalation_level,affectsSalary:r.affects_salary,affectsPerformance:r.affects_performance,attendanceGranted:r.attendance_granted,createdAt:r.created_at,updatedAt:r.updated_at}))},async createFieldViolation(n){const{siteVisits:e,...t}=n,{data:r,error:i}=await g.from("field_attendance_violations").insert(K(t)).select().maybeSingle();if(i)throw i;return r?M(r):null},async acknowledgeFieldViolation(n,e){const{data:{user:t}}=await g.auth.getUser();if(!t)throw new Error("Not authenticated");const{error:r}=await g.from("field_attendance_violations").update({status:"acknowledged",acknowledged_by:t.id,acknowledged_at:new Date().toISOString(),manager_notes:e,attendance_granted:!0}).eq("id",n);if(r)throw console.error("Error acknowledging violation:",r),r},async exportFieldViolations(n,e){const t=await this.getFieldViolations(n),r=["Date","Violation Type","Total Hours","Site Hours","Site %","Travel Hours","Travel %","Required Site %","Status","Acknowledged By","Acknowledged At","Notes"].join(","),i=t.map(u=>[u.date,u.violationType,u.totalHours.toFixed(2),u.siteHours.toFixed(2),u.sitePercentage.toFixed(1),u.travelHours.toFixed(2),u.travelPercentage.toFixed(1),u.requiredSitePercentage,u.status,u.acknowledgedBy||"",u.acknowledgedAt||"",`"${u.managerNotes||""}"`].join(",")),s=[r,...i].join(`
`),o=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),d=URL.createObjectURL(o);a.setAttribute("href",d),a.setAttribute("download",`${e}_violations_${we(new Date,"yyyy-MM-dd")}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},async processFieldAttendance(n,e){try{const t=rn(new Date(e)).toISOString(),r=An(new Date(e)).toISOString(),i=await this.getAttendanceEvents(n,t,r);if(i.length===0)return;const s=af(i),o=await this.getUserById(n);if(!o)return;const a=await this.getAttendanceSettings();if(o.role!=="field_staff")return;const d=a.field;if(!d.enableSiteTimeTracking)return;const u=d.dailyWorkingHours?.max||9,m=d.dailyWorkingHours?.min||7,p=lf(s,{minimumSitePercentage:d.minimumSitePercentage||75,minimumHoursFullDay:u,minimumHoursHalfDay:m}),y=(await this.getFieldViolations(n)).find(v=>v.date===e);if(p.isValid){if(y&&(y.status==="pending"||y.status==="escalated")){await g.from("field_attendance_violations").delete().eq("id",y.id);const v=we(new Date(e),"yyyy-MM-dd");await g.from("notifications").delete().ilike("message",`%${n}%`).ilike("message",`%${v}%`).ilike("message","%Field attendance violation%"),await g.from("notifications").delete().ilike("message",`%${o.name}%`).ilike("message",`%${v}%`).ilike("message","%Field attendance violation%")}}else{const v=p.violations.includes("site_time_low")?"site_time_low":"insufficient_hours";y?y.status==="pending"&&await g.from("field_attendance_violations").update(K({...s,violationType:v,requiredSitePercentage:d.minimumSitePercentage||75})).eq("id",y.id):(await this.createFieldViolation({userId:n,date:e,...s,violationType:v,requiredSitePercentage:d.minimumSitePercentage||75,status:"pending",affectsSalary:!0,affectsPerformance:!0}),o.reportingManagerId&&await Be("violation",{actorName:o.name,actionText:`has a site time violation for ${we(new Date(e),"MMM dd")}. Site percentage: ${s.sitePercentage.toFixed(1)}%`,locString:"",actor:{id:o.id,name:o.name,reportingManagerId:o.reportingManagerId,role:o.role}}))}}catch(t){console.error("Error processing field attendance violations:",t)}},async getPendingFinanceRecords(n){let e=g.from("site_finance_tracker").select("*, creator:created_by(reporting_manager_id, reporting_manager_2_id, reporting_manager_3_id)").eq("status","pending").is("deleted_at",null).order("created_at",{ascending:!1});const{data:t,error:r}=await e;if(r)throw r;let i=t||[];return n&&(i=i.filter(s=>s.creator?.reporting_manager_id===n||s.creator?.reporting_manager_2_id===n||s.creator?.reporting_manager_3_id===n)),i.map(M)},async respondToFinanceRecord(n,e){const{error:t}=await g.from("site_finance_tracker").update({status:e}).eq("id",n);if(t)throw t},async getSiteFinanceRecord(n){const{data:e,error:t}=await g.from("site_finance_tracker").select("*").eq("id",n).single();if(t){if(t.code==="PGRST116")return null;throw t}return M(e)},async getLastFinanceRecordForSite(n){const{data:e,error:t}=await g.from("site_finance_tracker").select("*").eq("site_id",n).is("deleted_at",null).order("created_at",{ascending:!1}).limit(1).single();if(t){if(t.code==="PGRST116")return null;throw t}return M(e)},async getSiteFinanceRecords(n,e){let t=g.from("site_finance_tracker").select("*").eq("billing_month",n).is("deleted_at",null).order("site_name");e&&(t=t.eq("created_by",e));const{data:r,error:i}=await t;if(i)throw i;return(r||[]).map(M)},async saveSiteFinanceRecord(n){const e=K(n);delete e.total_billed_amount;const{data:t,error:r}=await g.from("site_finance_tracker").upsert({status:"pending",...e}).select().single();if(r)throw r;return M(t)},async bulkSaveSiteFinanceRecords(n){const e=n.map(r=>{const{id:i,createdAt:s,updatedAt:o,...a}=r,d=K(a);return delete d.total_billed_amount,d.status="pending",d}),{error:t}=await g.from("site_finance_tracker").insert(e);if(t)throw console.error("Finance bulk save error:",t.message,t.details,t.hint),t},async deleteSiteFinanceRecord(n,e,t,r){const{error:i}=await g.from("site_finance_tracker").update({deleted_at:new Date().toISOString(),deleted_by:t,deleted_by_name:r,deleted_reason:e}).eq("id",n);if(i)throw i},async bulkSoftDeleteSiteFinanceRecords(n,e,t,r){const{error:i}=await g.from("site_finance_tracker").update({deleted_at:new Date().toISOString(),deleted_by:t,deleted_by_name:r,deleted_reason:e}).in("id",n);if(i)throw i},async getDeletedSiteFinanceRecords(n){let e=g.from("site_finance_tracker").select("*").not("deleted_at","is",null).order("deleted_at",{ascending:!1});n&&(e=e.eq("created_by",n));const{data:t,error:r}=await e;if(r)throw r;return(t||[]).map(M)},async restoreSiteFinanceRecord(n){const{error:e}=await g.from("site_finance_tracker").update({deleted_at:null,deleted_by:null,deleted_by_name:null,deleted_reason:null}).eq("id",n);if(e)throw e},async permanentlyDeleteSiteFinanceRecord(n){const{error:e}=await g.from("site_finance_tracker").delete().eq("id",n);if(e)throw e},async bulkRestoreSiteFinanceRecords(n){const{error:e}=await g.from("site_finance_tracker").update({deleted_at:null,deleted_by:null,deleted_by_name:null,deleted_reason:null}).in("id",n);if(e)throw e},async bulkPermanentlyDeleteSiteFinanceRecords(n){const{error:e}=await g.from("site_finance_tracker").delete().in("id",n);if(e)throw e},async getUniqueTrackerSites(){const{data:n,error:e}=await g.from("site_finance_tracker").select("site_id, site_name").is("deleted_at",null);if(e)throw e;const t=new Map;return n?.forEach(r=>{r.site_id&&r.site_name&&t.set(r.site_id,r.site_name)}),Array.from(t.entries()).map(([r,i])=>({id:r,name:i}))}},gs=(n,e,t="Operation timed out")=>{const r=new Promise((i,s)=>{setTimeout(()=>s(new Error(t)),e)});return Promise.race([n,r])};function ys(n,e,t,r){const i=m=>m*Math.PI/180,o=i(t-n),a=i(r-e),d=Math.sin(o/2)*Math.sin(o/2)+Math.cos(i(n))*Math.cos(i(t))*Math.sin(a/2)*Math.sin(a/2);return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}async function _s(n,e){const t=`${n.toFixed(4)}, ${e.toFixed(4)}`;try{const r=`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${n}&lon=${e}&zoom=16&addressdetails=1`,i=await fetch(r);if(!i.ok)return t;const s=await i.json();if(s.address){const{road:o,suburb:a,city:d,village:u,town:m,state:p,country:h}=s.address,y=[o,a,d||u||m,p].filter(Boolean).join(", ");if(y)return y}return s.display_name?s.display_name:t}catch(r){return console.warn("Reverse geocode failed:",r),t}}async function $c(n=50,e=2e4){if(Xe.isNativePlatform())try{if((await At.checkPermissions()).location!=="granted"&&(await At.requestPermissions()).location!=="granted")throw new Error("Location permission denied")}catch(t){console.warn("Capacitor checkPermissions not available:",t)}return new Promise(async(t,r)=>{let i=null,s=null,o=!1;const a=u=>{o||(o=!0,t(u))},d=setTimeout(async()=>{if(s)try{await At.clearWatch({id:s})}catch{}if(i){a(i);return}console.warn("[Location] watchPosition timed out, trying fallback chain...");try{const u=await At.getCurrentPosition({enableHighAccuracy:!1,timeout:8e3,maximumAge:3e5});console.log("[Location] Fallback 1 (low-accuracy) succeeded, accuracy:",u.coords.accuracy),a(u);return}catch(u){console.warn("[Location] Fallback 1 (low-accuracy) failed:",u)}try{const u=await At.getCurrentPosition({enableHighAccuracy:!0,timeout:8e3,maximumAge:3e5});console.log("[Location] Fallback 2 (high-accuracy cached) succeeded, accuracy:",u.coords.accuracy),a(u);return}catch(u){console.warn("[Location] Fallback 2 (high-accuracy cached) failed:",u)}if(typeof navigator<"u"&&navigator.geolocation){try{const u=await new Promise((m,p)=>{navigator.geolocation.getCurrentPosition(m,p,{enableHighAccuracy:!1,timeout:1e4,maximumAge:3e5})});console.log("[Location] Fallback 3 (WebView navigator.geolocation) succeeded, accuracy:",u.coords.accuracy),a(u);return}catch(u){console.warn("[Location] Fallback 3 (WebView navigator.geolocation) failed:",u)}try{const u=await new Promise((m,p)=>{navigator.geolocation.getCurrentPosition(m,p,{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e5})});console.log("[Location] Fallback 3b (WebView high-accuracy) succeeded, accuracy:",u.coords.accuracy),a(u);return}catch(u){console.warn("[Location] Fallback 3b (WebView high-accuracy) failed:",u)}}o||r(new Error("GPS Signal Weak. Please ensure you are outdoors or near a window and that location is enabled."))},e);try{s=await At.watchPosition({enableHighAccuracy:!0,timeout:e,maximumAge:6e4},(u,m)=>{if(m){console.warn("[Location] watchPosition error:",m);return}if(u){const p=u;(!i||p.coords.accuracy&&p.coords.accuracy<(i.coords.accuracy||1/0))&&(i=p,console.log("[Location] watchPosition got fix, accuracy:",p.coords.accuracy)),p.coords.accuracy&&p.coords.accuracy<=n&&(clearTimeout(d),s&&At.clearWatch({id:s}).catch(()=>{}),a(p))}})}catch(u){console.error("[Location] Failed to start watchPosition:",u)}})}const gw=Object.freeze(Object.defineProperty({__proto__:null,calculateDistanceMeters:ys,getPrecisePosition:$c,reverseGeocode:_s},Symbol.toStringTag,{value:"Module"}));function yw(n){const e=[...n].sort((p,h)=>new Date(p.timestamp).getTime()-new Date(h.timestamp).getTime());let t=0,r=0,i=null,s=null,o=null,a=null,d=null;e.forEach(p=>{const h=new Date(p.timestamp);switch(p.type){case"check-in":a||(a=h);break;case"check-out":a&&(t+=Wt(h,a),a=null);break;case"break-in":d=h,i||(i=p.timestamp),s=p.timestamp,o=null;break;case"break-out":d&&(r+=Wt(h,d),d=null,o=p.timestamp);break}});const u=new Date;a&&Vd(u,a)&&(t+=Wt(u,a)),d&&(r+=Wt(u,d));const m=Math.max(0,(t-r)/60);return{totalHours:t/60,breakHours:r/60,workingHours:m,firstBreakIn:i,lastBreakIn:s,lastBreakOut:o}}function _w(n){if(n.length===0)return{checkIn:null,checkOut:null,firstBreakIn:null,lastBreakIn:null,breakOut:null,totalHours:0,breakHours:0,workingHours:0};const e=[...n].sort((s,o)=>new Date(s.timestamp).getTime()-new Date(o.timestamp).getTime()),t=e.find(s=>s.type==="check-in"),r=[...e].reverse().find(s=>s.type==="check-out"),i=yw(n);return{checkIn:t?.timestamp||null,checkOut:r?.timestamp||null,firstBreakIn:i.firstBreakIn,lastBreakIn:i.lastBreakIn,breakOut:i.lastBreakOut,totalHours:i.totalHours,breakHours:i.breakHours,workingHours:i.workingHours}}var ll;(function(n){n[n.Sunday=1]="Sunday",n[n.Monday=2]="Monday",n[n.Tuesday=3]="Tuesday",n[n.Wednesday=4]="Wednesday",n[n.Thursday=5]="Thursday",n[n.Friday=6]="Friday",n[n.Saturday=7]="Saturday"})(ll||(ll={}));const ut=Vr("LocalNotifications",{web:()=>F(()=>import("./web-DIl_6ofK.js"),__vite__mapDeps([3,4,2,1])).then(n=>new n.LocalNotificationsWeb)}),js={SHIFT_END:1001,BREAK_END:1002},vw=async()=>{if(Xe.isNativePlatform())try{(await ut.requestPermissions()).display!=="granted"&&console.warn("Local notification permissions not granted")}catch(n){console.error("Error requesting notification permissions:",n)}},Fc=async(n,e=9)=>{if(Xe.isNativePlatform())try{const t=new Date(n.getTime()+e*60*60*1e3);if(t<=new Date)return;await ut.schedule({notifications:[{title:"Shift Ending Soon ",body:"Your 9-hour shift is about to end. Don't forget to punch out!",id:js.SHIFT_END,schedule:{at:t},sound:"beep.wav",smallIcon:"ic_stat_icon_config_sample",actionTypeId:"",extra:null}]}),console.log(`Scheduled shift end reminder for ${t.toLocaleTimeString()}`)}catch(t){console.error("Failed to schedule shift end reminder:",t)}},Oc=async(n,e=60)=>{if(Xe.isNativePlatform())try{const t=new Date(n.getTime()+e*60*1e3);if(t<=new Date)return;await ut.schedule({notifications:[{title:"Break Over ",body:"Your break time is up. Please punch back in!",id:js.BREAK_END,schedule:{at:t},sound:"beep.wav",smallIcon:"ic_stat_icon_config_sample",actionTypeId:"",extra:null}]}),console.log(`Scheduled break end reminder for ${t.toLocaleTimeString()}`)}catch(t){console.error("Failed to schedule break end reminder:",t)}},mr=async n=>{if(Xe.isNativePlatform())try{const e=js[n];await ut.cancel({notifications:[{id:e}]}),console.log(`Cancelled notification type: ${n}`)}catch(e){console.warn(`Error cancelling notification ${n}:`,e)}},ww=Object.freeze(Object.defineProperty({__proto__:null,cancelNotification:mr,requestNotificationPermissions:vw,scheduleBreakEndReminder:Oc,scheduleShiftEndReminder:Fc},Symbol.toStringTag,{value:"Module"})),nr=n=>{const e=n.toLowerCase();return e.includes("timed out")?"The request took too long. Please check your internet connection and try again.":e.includes("invalid api key")||e.includes("configuration")?"System configuration error. Please contact support.":e.includes("failed to fetch")||e.includes("network")?"Unable to connect. Please check your internet connection.":e.includes("invalid login credentials")?'Incorrect email or password. If you use Google Sign-In, please click "Sign in with Google".':e.includes("user already registered")||e.includes("already exists")?"This email is already registered. Please sign in.":e.includes("email not confirmed")?"Please verify your email address. Check your inbox for the confirmation link.":e.includes("too many requests")||e.includes("rate limit")?"Too many attempts. Please wait a few minutes before trying again.":e.includes("weak password")?"Password is too weak. Please use a stronger password.":(console.error("Unhandled auth error:",n),"Something went wrong. Please try again or contact support.")},cl=n=>{switch(n){case"check-in":return"punched in";case"check-out":return"punched out";case"break-in":return"started a break ";case"break-out":return"ended a break ";default:return"updated attendance"}},Ai=()=>{const n=new Date().getHours();return n<12?"Good Morning":n<17?"Good Afternoon":"Good Evening"},De=gt()((n,e)=>({user:null,isInitialized:!1,isCheckedIn:!1,isAttendanceLoading:!0,lastCheckInTime:null,lastCheckOutTime:null,firstBreakInTime:null,lastBreakInTime:null,lastBreakOutTime:null,totalBreakDurationToday:0,totalWorkingDurationToday:0,isOnBreak:!1,error:null,loading:!1,geofencingSettings:null,breakLimit:60,dailyPunchCount:0,approvedUnlockCount:0,dailyUnlockRequestCount:0,isPunchUnlocked:!1,isFieldCheckedIn:!1,isFieldCheckedOut:!1,forceLogout:async t=>{console.log(`Force logout triggered. Reason: ${t||"Unknown"}`),n({error:t||"Your session has expired. Please log in again.",loading:!1,user:null}),await Ve.remove({key:"supabase.auth.rememberMe"}),await lt.signOut(),e().resetAttendance()},isLoginAnimationPending:!1,setLoginAnimationPending:t=>n({isLoginAnimationPending:t}),setUser:t=>n({user:t,error:null,loading:!1}),setInitialized:t=>n({isInitialized:t}),setLoading:t=>n({loading:t}),resetAttendance:()=>n({isCheckedIn:!1,isAttendanceLoading:!1,lastCheckInTime:null,lastCheckOutTime:null,firstBreakInTime:null,lastBreakInTime:null,lastBreakOutTime:null,totalBreakDurationToday:0,totalWorkingDurationToday:0,isOnBreak:!1,isLoginAnimationPending:!1,dailyPunchCount:0,approvedUnlockCount:0,dailyUnlockRequestCount:0,isPunchUnlocked:!1,isFieldCheckedIn:!1,isFieldCheckedOut:!1}),setError:t=>n({error:t}),loginWithEmail:async(t,r,i)=>{n({error:null,loading:!0});try{await Ve.remove({key:"supabase.auth.rememberMe"}),await lt.signOut()}catch{}try{const s=Xe.isNativePlatform(),o=lt.signInWithPassword(t,r),{data:a,error:d}=s?await o:await gs(o,2e4,"Login attempt timed out. Please check your network connection.").catch(m=>({data:{user:null,session:null},error:{message:m.message}}));if(d||!a.user||!a.session){const m=nr(d?.message||"Invalid login credentials");return n({error:m,loading:!1}),{error:{message:m}}}await Ve.set({key:"rememberedEmail",value:t}),await Ve.set({key:"supabase.auth.rememberMe",value:a.session.refresh_token});const u=await lt.getAppUserProfile(a.user);if(u){n({user:u,error:null,loading:!1});try{const m=`greetingSent_${u.id}`,p=Ai();await B.createNotification({userId:u.id,message:`${p}, ${u.name||"there"}! Welcome back to Paradigm Services.`,type:"greeting"})}catch(m){console.error("Failed to send login greeting notification",m)}return{error:null}}else{await lt.signOut();const m="Login successful, but failed to retrieve user profile. Please try again.";return n({user:null,error:m,loading:!1}),{error:{message:m}}}}catch(s){console.error("Unexpected error during login flow:",s);const o=nr("Unexpected error during login flow");return n({user:null,error:o,loading:!1}),{error:{message:o}}}},signUp:async(t,r,i)=>{n({error:null,loading:!0});const{data:s,error:o}=await lt.signUpWithPassword({email:r,password:i,options:{data:{name:t}}});if(o){const a=nr(o.message);return n({error:a,loading:!1}),{error:{message:a}}}if(s?.user)try{await B.createUser({id:s.user.id,name:t,email:r,role:"unverified"})}catch(a){console.error("Error creating profile during signup:",a)}return n({loading:!1}),{error:null}},loginWithGoogle:async()=>{n({error:null,loading:!0});const{error:t}=await lt.signInWithGoogle();if(t){const r=nr(t.message);return n({error:r,loading:!1}),{error:{message:r}}}return n({loading:!1}),{error:null}},sendPasswordReset:async t=>{const{error:r}=await lt.resetPasswordForEmail(t);return r?{error:{message:r.message}}:{error:null}},logout:async()=>{const t=e().user;if(t)try{const r=Ai(),i=new Date().getHours()>=20?"Good Night":r;await B.createNotification({userId:t.id,message:`${i}, ${t.name||"there"}! Thanks for your hard work today.`,type:"greeting"})}catch(r){console.error("Failed to send logout farewell notification",r)}await Ve.remove({key:"supabase.auth.rememberMe"}),await Ve.remove({key:"rememberedEmail"}),await lt.signOut(),e().resetAttendance(),n({user:null,error:null,loading:!1})},updateUserProfile:t=>n(r=>({user:r.user?{...r.user,...t}:null})),fetchGeofencingSettings:async()=>{const{user:t}=e();if(t)try{const r=await B.getAttendanceSettings(),s=["admin","hr","finance","developer"].includes(t.role)?r.office:r.field;n({geofencingSettings:{enabled:s.geofencingEnabled??!1,maxViolationsPerMonth:s.maxViolationsPerMonth??3},breakLimit:s.lunchBreakDuration??60})}catch(r){console.error("Failed to fetch geofencing settings:",r)}},checkAttendanceStatus:async()=>{const{user:t}=e();if(!t){n({isAttendanceLoading:!1});return}n({isAttendanceLoading:!0});try{const r=new Date,i=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0).toISOString(),s=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59,999).toISOString(),o=await B.getAttendanceEvents(t.id,i,s),a=await B.checkUnlockStatus(),d=await B.getDailyUnlockRequestCount();if(o.length===0){n({isCheckedIn:!1,lastCheckInTime:null,lastCheckOutTime:null,isAttendanceLoading:!1,dailyPunchCount:0,approvedUnlockCount:a,dailyUnlockRequestCount:d,isPunchUnlocked:a>0,isFieldCheckedIn:!1,isFieldCheckedOut:!1});return}const{checkIn:u,checkOut:m,firstBreakIn:p,lastBreakIn:h,breakOut:y,breakHours:v,workingHours:_}=_w(o),x=o[o.length-1],w=o.filter(J=>!J.workType||J.workType==="office").filter(J=>J.type==="check-in"||J.type==="check-out").pop(),A=w?w.type==="check-in":!1,C=o.filter(J=>J.workType==="field").filter(J=>J.type==="check-in"||J.type==="check-out").pop(),N=C?C.type==="check-in":!1,D=o.filter(J=>J.type==="break-in"||J.type==="break-out"),V=D.length>0?D[D.length-1]:null,O=V?V.type==="break-in":!1,W=o.filter(J=>J.type==="check-in"&&(!J.workType||J.workType==="office")).length,ne=Math.max(0,W-1),se=a>ne;n({isCheckedIn:A,isOnBreak:O,lastCheckInTime:u,lastCheckOutTime:x?.type==="check-out"?m:null,firstBreakInTime:p,lastBreakInTime:h,lastBreakOutTime:y,totalBreakDurationToday:v,totalWorkingDurationToday:_,isAttendanceLoading:!1,dailyPunchCount:W,approvedUnlockCount:a,dailyUnlockRequestCount:d,isPunchUnlocked:se,isFieldCheckedIn:N,isFieldCheckedOut:C?C.type==="check-out":!1})}catch(r){console.error("Failed to check attendance status:",r),n({isAttendanceLoading:!1})}finally{e().fetchGeofencingSettings()}},toggleCheckInStatus:async(t,r,i,s,o)=>{const{user:a,isCheckedIn:d,geofencingSettings:u,dailyPunchCount:m}=e();if(!a)return{success:!1,message:"User not found"};const p=o||(d?"check-out":"check-in");a.role;let h=u;if(!h)try{const y=await B.getAttendanceSettings(),_=["admin","hr","finance","developer"].includes(a.role)?y.office:y.field;h={enabled:_.geofencingEnabled??!1,maxViolationsPerMonth:_.maxViolationsPerMonth??3},n({geofencingSettings:h})}catch{h={enabled:!1,maxViolationsPerMonth:3}}try{let y=null,v=null;try{y=await $c(150,25e3)}catch(D){console.warn("[Location] All location acquisition stages failed:",D.message);const V=a.organizationName?`Near ${a.organizationName} (Estimated)`:"GPS Unavailable";v=D.message.includes("permission")?"Location Permission Denied":V}const _=async(D,V,O,W)=>{const se=e().dailyPunchCount>=1&&p==="check-in"&&i!=="field";await B.addAttendanceEvent({userId:a.id,timestamp:new Date().toISOString(),type:p,latitude:D,longitude:V,locationId:O,locationName:W,checkoutNote:p==="check-out"?t:void 0,attachmentUrl:p==="check-out"&&r||void 0,workType:i,fieldReportId:p==="check-out"?s:void 0,isOt:se||void 0}),await e().checkAttendanceStatus();try{const J=m===0&&p==="check-in",ie=J?`${Ai()}, `:"",pe=i==="field"?"checked":"punched",_e=p==="check-in"?`${pe} in`:p==="check-out"?`${pe} out`:p==="break-in"?"started your break ":"ended your break ",Ne=we(new Date,"hh:mm a"),Pe=W?` at ${W}`:"";await B.createNotification({userId:a.id,message:`${ie}${a.name||"there"}! You have ${_e}${Pe} at ${Ne}.`,type:J?"greeting":"info"})}catch(J){console.warn("Failed to send user attendance notification",J)}if(Xe.isNativePlatform()&&(p==="break-in"||p==="break-out")){const J=p==="break-in"?"":"",ie=p==="break-in"?`${J} Break Started`:`${J} Break Ended`,pe=we(new Date,"hh:mm a"),_e=W||"Current Location";ut.schedule({notifications:[{title:ie,body:`You ${p.replace("-"," ")} at ${pe} near ${_e}. Enjoy your time! `,id:Date.now(),schedule:{at:new Date(Date.now()+500)},sound:"beep.wav",extra:null}]})}if(Be(p.replace("-","_"),{actorName:a.name||"An employee",actionText:cl(p),locString:W?` at ${W}`:"",actor:{id:a.id,name:a.name,role:a.role,reportingManagerId:a.reportingManagerId}}),se&&p==="check-in"&&Be("ot_punch",{actorName:a.name||"An employee",actionText:"has started an overtime (OT) punch cycle",locString:W?` at ${W}`:"",actor:{id:a.id,name:a.name,role:a.role,reportingManagerId:a.reportingManagerId}}),a.role==="field_staff"){const J=we(new Date,"yyyy-MM-dd");B.processFieldAttendance(a.id,J).catch(ie=>console.error("Violation check failed:",ie))}return p==="check-in"?Fc(new Date,9):p==="check-out"?(mr("SHIFT_END"),mr("BREAK_END")):p==="break-in"?Oc(new Date,e().breakLimit):p==="break-out"&&mr("BREAK_END"),{success:!0,message:`Successfully ${p==="check-in"?"punch in":p==="check-out"?"punch out":p.replace("-"," ")}!`}};if(!y||!y.coords)return await _(void 0,void 0,null,v||"GPS Unavailable");const{latitude:x,longitude:b,accuracy:w}=y.coords;if(typeof w=="number"&&w>1e3)return await _(x,b,null,null);let A=null,S=null,C=!1;try{const D=await B.getUserLocations(a.id);for(const V of D)if(ys(x,b,V.latitude,V.longitude)<=V.radius){A=V.id,S=V.name;break}if(!A){const V=await B.getLocations();for(const O of V)if(ys(x,b,O.latitude,O.longitude)<=O.radius){A=O.id,S=O.name,B.assignLocationToUser(a.id,O.id).catch(()=>{});break}}if(h.enabled&&!A){C=!0;try{S=await _s(x,b)}catch{S="Outside Geofence"}const V=new Date;await B.addViolation({userId:a.id,violationDate:V.toISOString(),violationMonth:`${V.getFullYear()}-${String(V.getMonth()+1).padStart(2,"0")}`,attemptedLatitude:x,attemptedLongitude:b,locationName:S}).catch(O=>console.error("Failed to log geofencing violation:",O)),Be("violation",{actorName:a.name||"An employee",actionText:cl(p),locString:` outside their assigned geofence at ${S}`,title:" Geofencing Violation",link:"/hr/field-staff-tracking",actor:{id:a.id,name:a.name,role:a.role,reportingManagerId:a.reportingManagerId}})}else if(!A)try{S=await _s(x,b)}catch{S="Mobile Punch-in"}}catch(D){console.warn("Location name resolution failed:",D)}const N=await _(x,b,A,S);return C?{success:!0,message:`Successfully ${p==="check-in"?"punch in":p==="check-out"?"punch out":p.replace("-"," ")}! (Note: Recorded as geofencing violation)`}:N}catch(y){return console.error("Error during attendance update:",y),{success:!1,message:"Failed to update attendance."}}},subscribeToAttendance:()=>{const{user:t}=e();if(!t?.id)return;const r=g.channel(`attendance_changes_${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"attendance_events",filter:`user_id=eq.${t.id}`},()=>{console.log("Realtime: Attendance event detected, refreshing status..."),e().checkAttendanceStatus()}).subscribe(),i=g.channel(`unlock_changes_${t.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"attendance_unlock_requests",filter:`user_id=eq.${t.id}`},s=>{console.log("Realtime: Unlock request change detected:",s),e().checkAttendanceStatus()}).subscribe();return()=>{g.removeChannel(r),g.removeChannel(i)}}})),xw={};function en(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var s;const o=d=>d===null?null:JSON.parse(d,void 0),a=(s=t.getItem(i))!=null?s:null;return a instanceof Promise?a.then(o):o(a)},setItem:(i,s)=>t.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>t.removeItem(i)}}const Wn=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return Wn(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return Wn(r)(t)}}}},bw=(n,e)=>(t,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:x=>x,version:0,merge:(x,b)=>({...b,...x}),...e},o=!1;const a=new Set,d=new Set;let u;try{u=s.getStorage()}catch{}if(!u)return n((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...x)},r,i);const m=Wn(s.serialize),p=()=>{const x=s.partialize({...r()});let b;const w=m({state:x,version:s.version}).then(A=>u.setItem(s.name,A)).catch(A=>{b=A});if(b)throw b;return w},h=i.setState;i.setState=(x,b)=>{h(x,b),p()};const y=n((...x)=>{t(...x),p()},r,i);let v;const _=()=>{var x;if(!u)return;o=!1,a.forEach(w=>w(r()));const b=((x=s.onRehydrateStorage)==null?void 0:x.call(s,r()))||void 0;return Wn(u.getItem.bind(u))(s.name).then(w=>{if(w)return s.deserialize(w)}).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==s.version){if(s.migrate)return s.migrate(w.state,w.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return w.state}).then(w=>{var A;return v=s.merge(w,(A=r())!=null?A:y),t(v,!0),p()}).then(()=>{b?.(v,void 0),o=!0,d.forEach(w=>w(v))}).catch(w=>{b?.(void 0,w)})};return i.persist={setOptions:x=>{s={...s,...x},x.getStorage&&(u=x.getStorage())},clearStorage:()=>{u?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:x=>(a.add(x),()=>{a.delete(x)}),onFinishHydration:x=>(d.add(x),()=>{d.delete(x)})},_(),v||y},Cw=(n,e)=>(t,r,i)=>{let s={storage:en(()=>localStorage),partialize:_=>_,version:0,merge:(_,x)=>({...x,..._}),...e},o=!1;const a=new Set,d=new Set;let u=s.storage;if(!u)return n((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(..._)},r,i);const m=()=>{const _=s.partialize({...r()});return u.setItem(s.name,{state:_,version:s.version})},p=i.setState;i.setState=(_,x)=>{p(_,x),m()};const h=n((..._)=>{t(..._),m()},r,i);i.getInitialState=()=>h;let y;const v=()=>{var _,x;if(!u)return;o=!1,a.forEach(w=>{var A;return w((A=r())!=null?A:h)});const b=((x=s.onRehydrateStorage)==null?void 0:x.call(s,(_=r())!=null?_:h))||void 0;return Wn(u.getItem.bind(u))(s.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==s.version){if(s.migrate)return[!0,s.migrate(w.state,w.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var A;const[S,C]=w;if(y=s.merge(C,(A=r())!=null?A:h),t(y,!0),S)return m()}).then(()=>{b?.(y,void 0),y=r(),o=!0,d.forEach(w=>w(y))}).catch(w=>{b?.(void 0,w)})};return i.persist={setOptions:_=>{s={...s,..._},_.storage&&(u=_.storage)},clearStorage:()=>{u?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:_=>(a.add(_),()=>{a.delete(_)}),onFinishHydration:_=>(d.add(_),()=>{d.delete(_)})},s.skipHydration||v(),y||h},Tw=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((xw?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),bw(n,e)):Cw(n,e),Sn=Tw,Sw=gt(Sn(n=>({theme:"light",isAutomatic:!0,setTheme:e=>n({theme:e,isAutomatic:!1}),setAutomatic:e=>n({isAutomatic:e}),_setThemeInternal:e=>n({theme:e})}),{name:"paradigm-app-theme",storage:en(()=>localStorage)})),Ew={esiCtcThreshold:21e3,enforceManpowerLimit:!1,manpowerLimitRule:"warn",allowSalaryEdit:!1,salaryThreshold:21e3,defaultPolicySingle:"1L",defaultPolicyMarried:"2L",enableEsiRule:!1,enableGmcRule:!1,enforceFamilyValidation:!0,rulesByDesignation:{}},Aw=gt()(n=>({...Ew,init:e=>{e&&n(e)},updateRules:e=>n(t=>({...t,...e}))})),kw={unverified:[],admin:["view_all_submissions","manage_users","manage_sites","view_entity_management","view_developer_settings","view_operations_dashboard","view_site_dashboard","create_enrollment","manage_roles_and_permissions","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_approval_workflow","download_attendance_report","manage_tasks","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","view_field_staff_tracking","manage_modules","access_support_desk","view_my_team","view_field_reports","manage_biometric_devices","manage_geo_locations","view_my_locations","view_profile","view_mobile_nav_home","view_mobile_nav_tasks","view_mobile_nav_profile"],hr:["view_all_submissions","manage_users","manage_sites","view_entity_management","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","download_attendance_report","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","access_support_desk","view_profile","view_mobile_nav_home","view_mobile_nav_tasks","view_mobile_nav_profile"],finance:["view_invoice_summary","view_verification_costing","view_own_attendance","apply_for_leave","view_profile","view_mobile_nav_home","view_mobile_nav_tasks","view_mobile_nav_profile"],developer:["view_all_submissions","manage_users","manage_sites","view_entity_management","view_developer_settings","view_operations_dashboard","view_site_dashboard","create_enrollment","manage_roles_and_permissions","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_approval_workflow","download_attendance_report","manage_tasks","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","view_field_staff_tracking","manage_modules","access_support_desk","view_my_team","view_field_reports","manage_biometric_devices","manage_geo_locations","view_my_locations","view_profile","view_mobile_nav_home","view_mobile_nav_tasks","view_mobile_nav_profile"],operation_manager:["view_operations_dashboard","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","access_support_desk","view_my_team","view_field_reports","view_field_staff_tracking","manage_geo_locations","view_my_locations","view_profile","download_attendance_report","view_mobile_nav_home","view_mobile_nav_profile"],site_manager:["view_site_dashboard","create_enrollment","view_my_team","view_own_attendance","apply_for_leave","manage_leave_requests","access_support_desk","view_profile","view_mobile_nav_home","view_mobile_nav_tasks","view_mobile_nav_profile"],field_staff:["create_enrollment","view_own_attendance","apply_for_leave","access_support_desk","view_profile","view_mobile_nav_home","view_mobile_nav_tasks","view_mobile_nav_profile"],management:["view_all_submissions","manage_users","manage_sites","view_entity_management","view_developer_settings","view_operations_dashboard","view_site_dashboard","create_enrollment","manage_roles_and_permissions","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_approval_workflow","download_attendance_report","manage_tasks","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","view_field_staff_tracking","manage_modules","access_support_desk","view_my_team","view_field_reports","manage_biometric_devices","manage_geo_locations","view_my_locations","view_profile","view_mobile_nav_home","view_mobile_nav_tasks","view_mobile_nav_profile"],hr_ops:["view_all_submissions","manage_users","manage_sites","view_entity_management","view_operations_dashboard","view_site_dashboard","create_enrollment","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","download_attendance_report","manage_tasks","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","view_field_staff_tracking","access_support_desk","view_my_team","view_field_reports","manage_geo_locations","view_my_locations","view_profile","view_mobile_nav_home","view_mobile_nav_tasks","view_mobile_nav_profile"],finance_manager:["view_all_submissions","view_entity_management","view_invoice_summary","view_verification_costing","view_own_attendance","apply_for_leave","view_profile","view_mobile_nav_home","view_mobile_nav_tasks","view_mobile_nav_profile"],bd:["access_support_desk","view_profile","view_mobile_nav_home","view_mobile_nav_tasks","view_mobile_nav_profile"]},En=gt(Sn((n,e)=>({permissions:kw,initRoles:t=>{if(!t)return;const r={...e().permissions};let i=!1;t.forEach(s=>{if(s.permissions){const o=Array.isArray(s.permissions)?s.permissions.filter(m=>!!m):[],a=["view_profile","view_own_attendance","view_mobile_nav_home","view_mobile_nav_profile"],d=[...new Set([...a,...o])],u=s.id.toLowerCase();r[u]=d,i=!0}else{const o=s.id.toLowerCase();o!=="unverified"&&!r[o]&&(r[o]=["view_profile","view_own_attendance","view_mobile_nav_home","view_mobile_nav_profile"],i=!0)}}),i&&n({permissions:r})},addRolePermissionEntry:t=>{n(r=>({permissions:{...r.permissions,[t.id]:[]}}))},removeRolePermissionEntry:t=>{n(r=>{const i={...r.permissions};return delete i[t],{permissions:i}})},renameRolePermissionEntry:(t,r)=>{n(i=>{const s={...i.permissions};return s[t]&&(s[r]=s[t],delete s[t]),{permissions:s}})},setRolePermissions:(t,r)=>{n(i=>({permissions:{...i.permissions,[t]:r}}))}}),{name:"paradigm_app_permissions_v7",storage:en(()=>localStorage)})),dT=[{name:"Republic Day",date:"01-26",isFixed:!0},{name:"May Day",date:"05-01",isFixed:!0},{name:"Independence Day",date:"08-15",isFixed:!0},{name:"Gandhi Jayanti",date:"10-02",isFixed:!0},{name:"Karnataka Rajyotsava",date:"11-01",isFixed:!0}],ki=[{name:"New Year",date:"-01-01"},{name:"Uttarayana Punyakala, Makara Sankranti Festival",date:"-01-15"},{name:"Ugadi Festival",date:"-03-19"},{name:"Khutub-E-Ramzan",date:"-03-21"},{name:"Mahaveera Jayanthi",date:"-03-31"},{name:"Good Friday",date:"-04-03"},{name:"Dr. B.R. Ambedkar Jayanthi",date:"-04-14"},{name:"Basava Jayanthi, Akshaya Tritiya",date:"-04-20"},{name:"Bakrid",date:"-05-28"},{name:"Last Day of Moharam",date:"-06-26"},{name:"Eid-Milad",date:"-08-26"},{name:"Varasiddhi Vinayaka Vrata",date:"-09-14"},{name:"Mahanavami, Ayudhapooja",date:"-10-20"},{name:"Vijayadasami",date:"-10-21"},{name:"Balipadyami, Deepavali",date:"-11-10"},{name:"Kanakadasa Jayanthi",date:"-11-27"},{name:"Christmas",date:"-12-25"}],ul={enablePincodeVerification:!0},Iw={office:{minimumHoursFullDay:8,minimumHoursHalfDay:4,annualEarnedLeaves:0,annualSickLeaves:0,monthlyFloatingLeaves:0,annualCompOffLeaves:0,enableAttendanceNotifications:!1,sickLeaveCertificateThreshold:2,geofencingEnabled:!1,maxViolationsPerMonth:3,fixedOfficeHours:{checkInTime:"09:00",checkOutTime:"18:00"},dailyWorkingHours:{min:7,max:9},monthlyTargetHours:216,enableHoursBasedCalculation:!0,enableBreakTracking:!0,lunchBreakDuration:60,maxHolidaysPerCategory:10,adminAllocatedHolidays:5,employeeHolidays:6,enableCustomHolidays:!1,holidayPool:[...ki],weeklyOffDays:[0]},field:{minimumHoursFullDay:9,minimumHoursHalfDay:5,annualEarnedLeaves:0,annualSickLeaves:0,monthlyFloatingLeaves:0,annualCompOffLeaves:0,enableAttendanceNotifications:!0,sickLeaveCertificateThreshold:3,geofencingEnabled:!0,maxViolationsPerMonth:3,weeklyOffDays:[0],fixedOfficeHours:{checkInTime:"09:00",checkOutTime:"18:00"},dailyWorkingHours:{min:7,max:9},minimumSitePercentage:75,maximumTravelPercentage:25,enableSiteTimeTracking:!0,maxHolidaysPerCategory:10,adminAllocatedHolidays:5,employeeHolidays:6,enableCustomHolidays:!1,holidayPool:[...ki]},site:{minimumHoursFullDay:9,minimumHoursHalfDay:5,annualEarnedLeaves:0,annualSickLeaves:0,monthlyFloatingLeaves:0,annualCompOffLeaves:0,enableAttendanceNotifications:!0,sickLeaveCertificateThreshold:3,geofencingEnabled:!0,maxViolationsPerMonth:3,fixedOfficeHours:{checkInTime:"09:00",checkOutTime:"18:00"},dailyWorkingHours:{min:7,max:9},maxHolidaysPerCategory:10,adminAllocatedHolidays:5,employeeHolidays:6,enableCustomHolidays:!1,holidayPool:[...ki]}},Nw={applicability:"Optional - Opt-in Default",optInDisclaimer:"Please note that currently the GMC facility covers only spouse and two children. If you would like to continue, please select below relationships and submit.",coverageDetails:"Spouse and two children",optOutDisclaimer:"Please note that you are opting out of the GMC Facility. You will have to submit a declaration to the company towards the same along with proof of your existing insurance.",requireAlternateInsurance:!0,collectProvider:!0,collectStartDate:!0,collectEndDate:!0,collectExtentOfCover:!0},dl={enabled:!0,clientId:"",clientSecret:""},fl={enabled:!0},ml={enabled:!0},pl={enabled:!1},hl={autoBackupEnabled:!1,backupSchedule:{frequency:"daily",startTime:"00:00",interval:1,dayOfWeek:0,dayOfMonth:1,monthOfYear:1}},gl={email:{enabled:!1}},Rw=[{id:"cost_1",name:"Profile Picture",cost:0},{id:"cost_2",name:"Mobile to Form Prefill",cost:7},{id:"cost_3",name:"KYC OCR (Plus)",cost:1.5},{id:"cost_4",name:"Aadhaar Mobile Link",cost:2.5},{id:"cost_5",name:"EPF UAN Lookup",cost:2.5},{id:"cost_6",name:"Cheque OCR",cost:3},{id:"cost_7",name:"Bank AC Verification Advanced",cost:2.25},{id:"cost_8",name:"PAN Profile Detailed",cost:5},{id:"cost_9",name:"Aadhaar Verification",cost:1.75},{id:"cost_10",name:"Voter ID OCR",cost:1.5},{id:"cost_11",name:"Driving License OCR",cost:1.5},{id:"cost_12",name:"Education Certificate OCR",cost:2},{id:"cost_13",name:"Experience/Salary Slip OCR",cost:2},{id:"cost_14",name:"ESI Card OCR",cost:1.5}],yl={enableProvisionalSites:!1},Dw=gt()(Sn(n=>({address:ul,attendance:Iw,officeHolidays:[],fieldHolidays:[],siteHolidays:[],recurringHolidays:[],gmcPolicy:Nw,perfiosApi:dl,geminiApi:fl,otp:ml,notifications:gl,verificationCosts:Rw,siteManagement:yl,apiSettings:hl,offlineOcr:pl,initSettings:e=>{if(e){const{holidays:t,attendanceSettings:r,recurringHolidays:i,apiSettings:s,addressSettings:o,geminiApiSettings:a,offlineOcrSettings:d,perfiosApiSettings:u,otpSettings:m,siteManagementSettings:p,notificationSettings:h}=e,y=t.filter(x=>x.type==="office"),v=t.filter(x=>x.type==="field"),_=t.filter(x=>x.type==="site");n({officeHolidays:y,fieldHolidays:v,siteHolidays:_,attendance:r,recurringHolidays:i||[],apiSettings:s||hl,address:o||ul,geminiApi:a||fl,offlineOcr:d||pl,perfiosApi:u||dl,otp:m||ml,siteManagement:p||yl,notifications:h||gl})}},updateAddressSettings:e=>n(t=>({address:{...t.address,...e}})),updateAttendanceSettings:e=>n({attendance:e}),updateGmcPolicySettings:e=>n(t=>({gmcPolicy:{...t.gmcPolicy,...e}})),updatePerfiosApiSettings:e=>n(t=>({perfiosApi:{...t.perfiosApi,...e}})),updateGeminiApiSettings:e=>n(t=>({geminiApi:{...t.geminiApi,...e}})),updateOtpSettings:e=>n(t=>({otp:{...t.otp,...e}})),updateNotificationSettings:e=>n(t=>({notifications:{...t.notifications,...e,email:{...t.notifications.email,...e.email}}})),updateVerificationCosts:e=>n({verificationCosts:e}),updateSiteManagementSettings:e=>n(t=>({siteManagement:{...t.siteManagement,...e}})),updateApiSettings:e=>n(t=>({apiSettings:{...t.apiSettings,...e}})),updateOfflineOcrSettings:e=>n(t=>({offlineOcr:{...t.offlineOcr,...e}})),addHoliday:async(e,t)=>{const r=await B.addHoliday({...t,type:e});n(i=>{const s=e==="office"?"officeHolidays":e==="field"?"fieldHolidays":"siteHolidays",o=[...i[s],r].sort((a,d)=>new Date(a.date).getTime()-new Date(d.date).getTime());return{[s]:o}})},removeHoliday:async(e,t)=>{await B.removeHoliday(t),n(r=>{const i=e==="office"?"officeHolidays":e==="field"?"fieldHolidays":"siteHolidays";return{[i]:r[i].filter(s=>s.id!==t)}})},addRecurringHoliday:async e=>{const t=await B.addRecurringHoliday(e);n(r=>({recurringHolidays:[...r.recurringHolidays,t]}))},removeRecurringHoliday:async e=>{await B.deleteRecurringHoliday(e),n(t=>({recurringHolidays:t.recurringHolidays.filter(r=>r.id!==e)}))}}),{name:"paradigm_app_settings",storage:en(()=>localStorage)})),rr=n=>{const[e,t]=U.useState(window.matchMedia(n).matches);return U.useEffect(()=>{const r=window.matchMedia(n),i=()=>t(r.matches);try{r.addEventListener("change",i)}catch{r.addListener(i)}return()=>{try{r.removeEventListener("change",i)}catch{r.removeListener(i)}}},[n]),e},ir=768,Gr=()=>{const n=rr(`(max-width: ${ir-1}px)`),e=rr(`(min-width: ${ir}px) and (max-width: 1024px)`),t=rr("(min-width: 1025px)"),r=rr(`(min-width: ${ir}px)`);return{isMobile:n,isTablet:e,isDesktop:t,isWeb:r,breakpoint:ir}},_l=()=>({id:`draft_${Date.now()}`,status:"draft",enrollmentDate:new Date().toISOString().split("T")[0],personal:{employeeId:`PARA-${Math.floor(1e3+Math.random()*9e3)}`,firstName:"",lastName:"",dob:"",gender:"",maritalStatus:"",bloodGroup:"",mobile:"",alternateMobile:"",email:"",emergencyContactName:"",emergencyContactNumber:"",relationship:"",salary:null,verifiedStatus:{}},address:{present:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},permanent:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},sameAsPresent:!0},family:[],education:[],bank:{accountHolderName:"",accountNumber:"",confirmAccountNumber:"",ifscCode:"",bankName:"",branchName:"",verifiedStatus:{}},uan:{hasPreviousPf:!1,verifiedStatus:{},salarySlip:null},esi:{hasEsi:!1,verifiedStatus:{}},gmc:{isOptedIn:null,policyAmount:"",nomineeName:"",nomineeRelation:"",selectedSpouseId:"",selectedChildIds:[],gmcPolicyCopy:null,declarationAccepted:!1},organization:{designation:"",department:"",reportingManager:"",organizationId:"",organizationName:"",joiningDate:we(new Date,"yyyy-MM-dd"),workType:"Full-time",defaultSalary:null},uniforms:[],biometrics:{signatureImage:null,fingerprints:{leftThumb:null,leftIndex:null,leftMiddle:null,leftRing:null,leftLittle:null,rightThumb:null,rightIndex:null,rightMiddle:null,rightRing:null,rightLittle:null}},salaryChangeRequest:null,requiresManualVerification:!1,formsGenerated:!1,verificationUsage:[]}),Pw=gt(n=>({data:_l(),setData:e=>n({data:e}),updatePersonal:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,...e}}})),setPersonalVerifiedStatus:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,verifiedStatus:{...t.data.personal.verifiedStatus,...e}}}})),updateAddress:e=>n(t=>({data:{...t.data,address:{...t.data.address,...e}}})),setAddressVerifiedStatus:(e,t)=>n(r=>({data:{...r.data,address:{...r.data.address,[e]:{...r.data.address[e],verifiedStatus:{...r.data.address[e].verifiedStatus,...t}}}}})),updateFamily:e=>n(t=>({data:{...t.data,family:e}})),updateEducation:e=>n(t=>({data:{...t.data,education:e}})),updateBank:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,...e}}})),setBankVerifiedStatus:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,verifiedStatus:{...t.data.bank.verifiedStatus,...e}}}})),updateUan:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,...e}}})),setUanVerifiedStatus:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,verifiedStatus:{...t.data.uan.verifiedStatus,...e}}}})),updateEsi:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,...e}}})),setEsiVerifiedStatus:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,verifiedStatus:{...t.data.esi.verifiedStatus,...e}}}})),updateGmc:e=>n(t=>({data:{...t.data,gmc:{...t.data.gmc,...e}}})),updateOrganization:e=>n(t=>({data:{...t.data,organization:{...t.data.organization,...e}}})),updateUniforms:e=>n(t=>({data:{...t.data,uniforms:e}})),updateBiometrics:e=>n(t=>({data:{...t.data,biometrics:{...t.data.biometrics,...e}}})),setSalaryChangeRequest:e=>n(t=>({data:{...t.data,salaryChangeRequest:e}})),setRequiresManualVerification:e=>n(t=>({data:{...t.data,requiresManualVerification:e}})),setFormsGenerated:e=>n(t=>({data:{...t.data,formsGenerated:e}})),logVerificationUsage:e=>n(t=>{const r=JSON.parse(JSON.stringify(t.data.verificationUsage||[])),i=r.find(s=>s.name===e);return i?i.count+=1:r.push({name:e,count:1}),{data:{...t.data,verificationUsage:r}}}),reset:()=>n({data:_l()}),addFamilyMember:()=>n(e=>({data:{...e.data,family:[...e.data.family,{id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""}]}})),updateFamilyMember:(e,t)=>n(r=>({data:{...r.data,family:r.data.family.map(i=>i.id===e?{...i,...t}:i)}})),removeFamilyMember:e=>n(t=>({data:{...t.data,family:t.data.family.filter(r=>r.id!==e)}})),addEducationRecord:()=>n(e=>({data:{...e.data,education:[...e.data.education,{id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""}]}})),updateEducationRecord:(e,t)=>n(r=>({data:{...r.data,education:r.data.education.map(i=>i.id===e?{...i,...t}:i)}})),removeEducationRecord:e=>n(t=>({data:{...t.data,education:t.data.education.filter(r=>r.id!==e)}})),addOrUpdateEmergencyContactAsFamilyMember:()=>n(e=>{const{personal:t,family:r}=e.data,{emergencyContactName:i,emergencyContactNumber:s,relationship:o}=t;if(i&&["Spouse","Child","Father","Mother"].includes(o)){const d=r.find(u=>u.name.toLowerCase()===i.toLowerCase()&&u.relation===o);if(d){if(d.phone!==s){const u=r.map(m=>m.id===d.id?{...m,phone:s}:m);return{data:{...e.data,family:u}}}}else{const u={id:`fam_emergency_${Date.now()}`,name:i,relation:o,phone:s,dob:"",gender:"",dependent:!1,idProof:null,occupation:""};return{data:{...e.data,family:[...r,u]}}}}return e})})),Vc=gt(n=>({deferredPrompt:null,isInstallable:!1,setDeferredPrompt:e=>n({deferredPrompt:e,isInstallable:!!e}),clearDeferredPrompt:()=>n({deferredPrompt:null,isInstallable:!1})})),Cn=gt()((n,e)=>({notifications:[],unreadCount:0,isLoading:!1,error:null,isPanelOpen:!1,setIsPanelOpen:t=>n({isPanelOpen:t}),togglePanel:()=>n(t=>({isPanelOpen:!t.isPanelOpen})),fetchNotifications:async()=>{const t=De.getState().user;if(t){n({isLoading:!0,error:null});try{const r=await B.getNotifications(t.id),i=r.filter(s=>!s.isRead).length;n({notifications:r,unreadCount:i,isLoading:!1}),e().updateBadgeCount()}catch(r){console.error("Failed to fetch notifications:",r),n({error:"Failed to fetch notifications.",isLoading:!1})}}},markAsRead:async t=>{const r=e().notifications.find(i=>i.id===t);if(!(r&&r.isRead))try{await B.markNotificationAsRead(t),n(i=>({notifications:i.notifications.map(s=>s.id===t?{...s,isRead:!0}:s),unreadCount:Math.max(0,i.unreadCount-1)})),e().updateBadgeCount()}catch(i){console.error("Failed to mark notification as read:",i)}},markAllAsRead:async()=>{const t=De.getState().user;if(t&&e().unreadCount!==0)try{await B.markAllNotificationsAsRead(t.id),n(r=>({notifications:r.notifications.map(i=>({...i,isRead:!0})),unreadCount:0})),e().updateBadgeCount()}catch(r){console.error("Failed to mark all notifications as read:",r)}},updateBadgeCount:async()=>{if(Xe.isNativePlatform())try{const t=e().unreadCount,r="@capawesome/capacitor-badge",{Badge:i}=await import(r).catch(()=>({Badge:null}));i&&typeof i.set=="function"&&await i.set({count:t})}catch(t){console.warn("Badge plugin notification failed:",t)}},subscribeToNotifications:()=>{const t=De.getState().user;if(!t)return()=>{};const r=g.channel(`user-notifications-${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${t.id}`},async i=>{const s=B.toCamelCase(i.new);if(n(o=>({notifications:[s,...o.notifications],unreadCount:o.unreadCount+1})),Xe.isNativePlatform())try{await ut.schedule({notifications:[{title:s.title||"New Notification",body:s.message,id:Math.floor(Math.random()*1e4),extra:{link:s.linkTo},sound:"beep.wav"}]}),e().updateBadgeCount()}catch(o){console.error("Failed to schedule local notification:",o)}}).subscribe();return()=>{g.removeChannel(r)}}})),j=(n,e=1)=>U.lazy(async()=>{try{return await n()}catch(t){if(e>0)return console.warn(`Failed to load chunk, retrying... (${e} retries left)`,t),await new Promise(r=>setTimeout(r,1e3)),t instanceof TypeError||t.name==="ChunkLoadError"?(console.error("Chunk loading failed. Reloading page..."),window.location.reload(),new Promise(()=>{})):n();throw console.error("Max retries reached for lazy load.",t),t}}),mn="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",fT="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",Mw=gt(Sn(n=>({currentLogo:mn,defaultLogo:mn,setCurrentLogo:e=>n({currentLogo:e}),setDefaultLogo:()=>n(e=>({defaultLogo:e.currentLogo})),resetToDefault:()=>n(e=>({currentLogo:e.defaultLogo})),resetToOriginal:()=>n({currentLogo:mn,defaultLogo:mn})}),{name:"paradigm-app-logo",storage:en(()=>localStorage)})),Qt=({className:n="",localPath:e})=>{const t=Mw(i=>i.currentLogo),r=e||t;return f.jsx("img",{src:r,alt:"Paradigm Logo",className:`w-auto object-contain ${!n.includes("h-")&&"h-10"} ${n}`,onError:i=>{const s=i.target;s.src!==mn&&(s.src=mn)}})},$e=({children:n,className:e="",variant:t="primary",size:r="md",isLoading:i=!1,...s})=>{const a=`btn-${t}`,d=`btn-${r}`;return f.jsx("button",{...s,className:`btn ${a} ${d} ${e}`,disabled:i||s.disabled,children:i?f.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):n})},Lw=gt(Sn(n=>({autoClickOnHover:!0,autoScrollOnHover:!0,setAutoClickOnHover:e=>n({autoClickOnHover:e}),setAutoScrollOnHover:e=>n({autoScrollOnHover:e})}),{name:"paradigm-ui-settings",storage:en(()=>localStorage)})),Bs=n=>{if(!n)return!1;const e=n.toLowerCase().replace(/_/g," ").trim();return e==="admin"||e==="super admin"||e==="superadmin"||e==="super_admin"||e==="developer"},$w=({className:n=""})=>{const{unreadCount:e,togglePanel:t,isPanelOpen:r}=Cn();return f.jsx("div",{className:`relative ${n}`,children:f.jsxs("button",{onClick:t,className:`group relative p-2.5 rounded-xl transition-all duration-300 btn-icon ${r?"bg-accent/10 text-accent ring-2 ring-accent/20":"bg-transparent text-emerald-500 md:text-muted hover:bg-page hover:text-primary-text"}`,children:[f.jsx(Fr,{className:`h-5 w-5 transition-transform duration-300 ${r?"scale-110":"group-hover:rotate-12"}`}),e>0&&f.jsxs("span",{className:"absolute top-1.5 right-1.5 flex h-4 w-4",children:[f.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-500 opacity-75"}),f.jsx("span",{className:"relative inline-flex rounded-full h-4 w-4 bg-red-600 text-[10px] items-center justify-center font-bold text-white shadow-lg border border-white",children:e>9?"9+":e})]})]})})},Fw=({className:n})=>f.jsxs("svg",{viewBox:"0 0 144 144",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:n,children:[f.jsx("circle",{cx:"72",cy:"72",r:"72",fill:"#F0EBE3"}),f.jsx("path",{d:"M109.5 144H34.5C34.5 119.464 51.18 99 72 99C92.82 99 109.5 119.464 109.5 144Z",fill:"white"}),f.jsx("path",{d:"M84 99C84 105.627 78.6274 111 72 111C65.3726 111 60 105.627 60 99H84Z",fill:"#E1C699"}),f.jsx("path",{d:"M96 87C96 70.4315 85.3726 57 72 57C58.6274 57 48 70.4315 48 87H96Z",fill:"#4A4A4A"}),f.jsx("rect",{x:"62",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"}),f.jsx("rect",{x:"77",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"})]}),Ii=[Fw],Uc=({className:n,photoUrl:e,seed:t})=>{const{user:r}=De();if(e&&(e.startsWith("http")||e.startsWith("https")||e.startsWith("data:")))return f.jsx("img",{src:e,alt:"Profile",className:`object-cover ${n||""}`,onError:d=>d.currentTarget.style.display="none"});const s=t||r?.id;if(!s){const d=Ii[0];return f.jsx(d,{className:`text-muted/60 ${n||""}`})}const o=s.charCodeAt(s.length-1)%Ii.length,a=Ii[o];return f.jsx(a,{className:n||""})},qc=({setIsMobileMenuOpen:n})=>{const{user:e,logout:t}=De(),{permissions:r}=En(),i=Jn(),[s,o]=U.useState(!1),a=U.useRef(null),{isMobile:d}=Gr();Ut(),U.useEffect(()=>{const p=h=>{a.current&&!a.current.contains(h.target)&&o(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const u=p=>p.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase()),m=()=>{n?.(!1),o(!1),i("/auth/logout")};return f.jsx(f.Fragment,{children:f.jsx("header",{className:`sticky top-0 z-40 transition-all duration-200 ${d?"bg-[#041b0f] shadow-md":"bg-transparent shadow-none"}`,style:{paddingTop:"env(safe-area-inset-top)"},children:f.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:f.jsxs("div",{className:"flex items-center h-16",children:[f.jsx("div",{className:"flex-1 flex justify-center md:justify-start min-w-0 px-2",children:d&&f.jsx("div",{className:"flex items-center justify-center bg-transparent p-2 border-0",children:f.jsx(Qt,{className:"border-0 h-[52px]"})})}),f.jsx("div",{className:"flex-none flex justify-end w-auto min-w-10",children:f.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[f.jsx($w,{}),!d&&e&&f.jsxs("div",{className:"relative",ref:a,children:[f.jsxs("button",{onClick:()=>o(!s),className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-white/10 transition-colors","aria-expanded":s,"aria-haspopup":"true",children:[f.jsx(Uc,{photoUrl:e.photoUrl,seed:e.id,className:"h-8 w-8 rounded-lg"}),f.jsxs("div",{className:"text-left hidden sm:block",children:[f.jsx("span",{className:`text-sm font-semibold ${d?"text-white":"text-primary-text"}`,children:e.name}),f.jsx("span",{className:`text-xs block ${d?"text-white/70":"text-muted"}`,children:u(e.role)})]}),f.jsx(Et,{className:`h-4 w-4 ${d?"text-white/70":"text-muted"}`})]}),s&&f.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-card rounded-xl shadow-card border border-border py-1 z-40 animate-fade-in-down",role:"menu",children:[f.jsxs(xr,{to:"/profile",onClick:()=>o(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[f.jsx(Ls,{className:"mr-2 h-4 w-4"}),"Profile"]}),e&&(Bs(e.role)||r[e.role]?.includes("apply_for_leave"))&&f.jsxs(xr,{to:"/leaves/dashboard",onClick:()=>o(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[f.jsx(ed,{className:"mr-2 h-4 w-4"}),"Tracker"]}),f.jsxs("button",{onClick:m,className:"flex items-center w-full text-left px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[f.jsx(ec,{className:"mr-2 h-4 w-4"}),"Log Out"]})]})]})]})})]})})})})},Ow=({type:n,size:e="h-5 w-5"})=>{const t={task_assigned:rc,task_escalated:Ze,provisional_site_reminder:zi,security:Bn,info:vr,warning:Ze,greeting:rd,approval_request:zi},r={task_assigned:"bg-indigo-50 text-indigo-600 border-indigo-100",task_escalated:"bg-amber-50 text-amber-600 border-amber-100",provisional_site_reminder:"bg-purple-50 text-purple-600 border-purple-100",security:"bg-rose-50 text-rose-600 border-rose-100",info:"bg-sky-50 text-sky-600 border-sky-100",warning:"bg-amber-50 text-amber-600 border-amber-100",greeting:"bg-emerald-50 text-emerald-600 border-emerald-100",approval_request:"bg-orange-50 text-orange-600 border-orange-100 shadow-[0_0_10px_rgba(249,115,22,0.1)]"},i=t[n]||Fr,s=r[n]||"bg-gray-50 text-gray-500 border-gray-100";return f.jsx("div",{className:`flex-shrink-0 p-2 rounded-xl border ${s} transition-colors group-hover:scale-110 duration-300`,children:f.jsx(i,{className:e})})},vs=({isOpen:n,onClose:e,isMobile:t=!1})=>{const{user:r}=De(),{notifications:i,unreadCount:s,markAsRead:o,markAllAsRead:a}=Cn(),d=Jn(),[u,m]=Z.useState(1),[p,h]=Z.useState(5),[y,v]=Z.useState([]),[_,x]=Z.useState([]),[b,w]=Z.useState([]),[A,S]=Z.useState([]),[C,N]=Z.useState([]),[D,V]=Z.useState({unlocks:!1,leaves:!1,claims:!1,finance:!1,invoices:!1,general:!1,violations:!1}),O=E=>{V(q=>({...q,[E]:!q[E]}))},[W,ne]=Z.useState(null),se=Z.useRef(null),J=Z.useCallback(async()=>{if(!(!r||r.role==="field_staff"||r.role==="unverified"))try{const E=(r.role||"").toLowerCase(),q=["admin","super_admin","developer","management"].includes(E),ee=["hr","hr_ops"].includes(E),he=["finance_manager"].includes(E);console.log("[Approvals] Fetching for role:",E,"| isSuperAdmin:",q,"| isHR:",ee,"| isFinance:",he,"| userId:",r.id);let me;q?me=Promise.all([B.getLeaveRequests({status:"pending_manager_approval"}),B.getLeaveRequests({status:"pending_hr_confirmation"})]).then(([Je,yt])=>({data:[...Je.data,...yt.data]})):ee?me=Promise.all([B.getLeaveRequests({status:"pending_manager_approval",forApproverId:r.id}),B.getLeaveRequests({status:"pending_hr_confirmation"})]).then(([Je,yt])=>({data:[...Je.data,...yt.data]})):me=B.getLeaveRequests({status:"pending_manager_approval",forApproverId:r.id});const Se=q||he?void 0:r.id,[be,ae,le,ve,Me]=await Promise.allSettled([B.getAttendanceUnlockRequests(q?void 0:r.id),me,B.getExtraWorkLogs({status:"Pending",managerId:q?void 0:r.id}),B.getPendingFinanceRecords(Se),B.getSiteInvoiceRecords(Se)]);console.log("[Approvals] Results:",{unlocks:be.status==="fulfilled"?`${be.value.length} items`:`FAILED: ${be.reason}`,leaves:ae.status==="fulfilled"?`${ae.value.data.length} items`:`FAILED: ${ae.reason}`,claims:le.status==="fulfilled"?`${le.value.data.length} items`:`FAILED: ${le.reason}`,finance:ve.status==="fulfilled"?`${ve.value.length} items`:`FAILED: ${ve.reason}`,invoices:Me.status==="fulfilled"?`${Me.value.length} items`:`FAILED: ${Me.reason}`});let qe=[],je=[],tn=[],Dt=[],nn=[];if(be.status==="fulfilled"&&(qe=be.value.filter(Je=>Je.userId!==r.id),v(qe)),ae.status==="fulfilled"&&(je=ae.value.data.filter(Je=>Je.userId!==r.id),x(je)),le.status==="fulfilled"&&(tn=le.value.data.filter(Je=>Je.userId!==r.id),w(tn)),ve.status==="fulfilled"&&(Dt=ve.value.filter(Je=>Je.createdBy!==r.id),S(Dt)),Me.status==="fulfilled"){const Je=new Date().toISOString().split("T")[0];nn=(Me.value||[]).filter(yt=>!yt.invoiceSentDate&&yt.invoiceSharingTentativeDate&&yt.invoiceSharingTentativeDate<=Je),N(nn)}}catch(E){console.error("Error fetching pending approvals:",E)}},[r]);Z.useEffect(()=>{n&&J()},[n,J]);const ie=async(E,q)=>{ne(E);try{await B.respondToUnlockRequest(E,q),v(ee=>ee.filter(he=>he.id!==E))}catch(ee){console.error("Error responding to request:",ee)}finally{ne(null)}},pe=async(E,q)=>{ne(E);try{q==="approve"?await B.approveLeaveRequest(E,r.id):q==="reject"?await B.rejectLeaveRequest(E,r.id):q==="confirm"&&await B.confirmLeaveByHR(E,r.id),x(ee=>ee.filter(he=>he.id!==E))}catch(ee){console.error("Error responding to leave request:",ee)}finally{ne(null)}},_e=async(E,q)=>{ne(E);try{q==="approve"?await B.approveExtraWorkClaim(E,r.id):q==="reject"&&await B.rejectExtraWorkClaim(E,r.id,"Rejected from notifications"),w(ee=>ee.filter(he=>he.id!==E))}catch(ee){console.error("Error responding to claim:",ee)}finally{ne(null)}},Ne=async(E,q)=>{ne(E);try{await B.respondToFinanceRecord(E,q),S(ee=>ee.filter(he=>he.id!==E))}catch(ee){console.error("Error responding to finance record:",ee)}finally{ne(null)}};Z.useEffect(()=>{se.current&&se.current.scrollTo({top:0,behavior:"smooth"})},[u]);const Pe=E=>{o(E.id),E.linkTo&&d(E.linkTo),window.innerWidth<768&&e()},L=U.useMemo(()=>{const E=[{title:"Today",items:[]},{title:"Yesterday",items:[]},{title:"Earlier",items:[]}],q=(u-1)*p;return i.filter(me=>me.type!=="security"&&!me.message.includes("Field attendance violation")).slice(q,q+p).forEach(me=>{const Se=bt(me.createdAt);Ud(Se)?E[0].items.push(me):qd(Se)?E[1].items.push(me):E[2].items.push(me)}),E.filter(me=>me.items.length>0)},[i,u,p]),I=i.filter(E=>E.type!=="security"&&!E.message.includes("Field attendance violation")).length,$=Math.ceil(I/p);return n?f.jsxs("div",{className:`h-full w-full flex flex-col animate-slide-in-right ${t?"bg-[#0A3D2E]":"bg-white"}`,children:[f.jsxs("div",{className:`flex items-center justify-between px-6 pt-6 pb-5 border-b ${t?"bg-[#0A3D2E] border-white/10":"bg-white border-gray-100"}`,children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h4",{className:`font-bold text-xl ${t?"text-white":"text-gray-900"}`,children:"Notifications"}),s>0&&f.jsxs("span",{className:`px-2 py-0.5 text-xs rounded-full font-bold ${t?"bg-accent text-[#041b0f] shadow-[0_0_10px_rgba(34,197,94,0.2)]":"bg-accent/10 text-accent border border-accent/20"}`,children:[s," New"]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[s>0&&f.jsx("button",{onClick:()=>a(),className:`text-xs font-bold px-2 py-1 rounded-lg transition-colors ${t?"text-accent hover:bg-white/5":"text-accent hover:bg-accent/5"}`,children:"Mark all read"}),f.jsx("button",{onClick:e,className:`p-2 rounded-xl transition-all ${t?"text-white/70 hover:text-white hover:bg-white/10":"text-muted hover:text-primary-text hover:bg-page"}`,children:f.jsx(_r,{className:"h-5 w-5"})})]})]}),f.jsxs("div",{ref:se,className:`flex-1 overflow-y-auto custom-scrollbar ${t?"bg-[#0A3D2E]":"bg-white"}`,children:[(y.length>0||_.length>0||b.length>0||A.length>0)&&f.jsxs("div",{className:`border-b ${t?"border-white/10 bg-gradient-to-b from-white/5 to-transparent":"border-gray-100 bg-amber-50/30"}`,children:[f.jsxs("div",{className:"px-6 py-4 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:`p-1.5 rounded-lg ${t?"bg-amber-500/20 text-amber-500 shadow-[0_0_10px_rgba(245,158,11,0.2)]":"bg-amber-100 text-amber-700"}`,children:f.jsx(ti,{className:"w-3.5 h-3.5"})}),f.jsx("h5",{className:`text-[11px] font-black uppercase tracking-widest ${t?"text-white/90":"text-amber-900"}`,children:"Pending Approvals"})]}),f.jsx("span",{className:`text-[10px] font-bold px-2.5 py-0.5 rounded-full ${t?"bg-white/10 text-white border border-white/5":"bg-amber-100 text-amber-700"}`,children:y.length+_.length+b.length+A.length})]}),f.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[i.some(E=>E.type==="security"||E.message.includes("Field attendance violation"))&&f.jsxs("div",{className:`group rounded-2xl overflow-hidden transition-all duration-300 border ${t?"border-red-500/30 bg-red-500/5":"border-red-100 bg-red-50/10 hover:shadow-md"}`,children:[f.jsxs("button",{onClick:()=>O("violations"),className:"w-full p-3 flex items-center justify-between bg-transparent",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-xl flex items-center justify-center ${t?"bg-red-500/20 text-red-500 shadow-[0_0_10px_rgba(239,68,68,0.2)]":"bg-red-100 text-red-600"}`,children:f.jsx(Bn,{className:"w-4 h-4"})}),f.jsxs("div",{className:"text-left",children:[f.jsx("p",{className:`text-xs font-bold ${t?"text-white":"text-gray-900"}`,children:"Security Violations"}),f.jsx("p",{className:`text-[10px] ${t?"text-red-400":"text-red-500"}`,children:"Urgent Attention Need"})]})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:`flex h-5 min-w-[20px] px-1.5 items-center justify-center rounded-full text-[10px] font-bold ${t?"bg-red-500 text-white shadow-[0_0_10px_rgba(239,68,68,0.4)]":"bg-red-100 text-red-700"}`,children:i.filter(E=>E.type==="security"||E.message.includes("Field attendance violation")).length}),D.violations?f.jsx(Lt,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`}):f.jsx(Et,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`})]})]}),D.violations&&f.jsxs("div",{className:`p-3 space-y-3 border-t ${t?"border-red-500/10":"border-red-100"}`,children:[f.jsxs("div",{className:"flex items-center gap-2 px-1 py-1",children:[f.jsx(Ze,{className:"w-3.5 h-3.5 text-red-500 animate-pulse"}),f.jsx("span",{className:`text-[10px] font-black uppercase tracking-wider ${t?"text-red-400":"text-red-700"}`,children:"Priority Warning: Escalated Violations"})]}),i.filter(E=>E.type==="security"||E.message.includes("Field attendance violation")).map(E=>f.jsx("div",{onClick:()=>Pe(E),className:`rounded-xl p-3 border cursor-pointer transition-all hover:scale-[1.02] ${t?"bg-red-950/20 border-red-500/20":"bg-white border-red-100 shadow-sm"}`,children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"p-1.5 rounded-lg bg-red-100 text-red-600",children:f.jsx(Bn,{className:"w-3 h-3"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:`text-[11px] leading-relaxed mb-2 ${t?"text-white/90":"text-gray-800"}`,children:E.message}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("span",{className:`text-[9px] flex items-center gap-1 ${t?"text-white/40":"text-red-700/60"}`,children:[f.jsx(ti,{className:"h-2.5 w-2.5"}),ni(bt(E.createdAt),{addSuffix:!0})]}),!E.isRead&&f.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.5)]"})]})]})]})},E.id))]})]}),y.length>0&&f.jsxs("div",{className:`group rounded-2xl overflow-hidden transition-all duration-300 border ${t?"border-white/10 bg-transparent":"border-emerald-100 bg-white hover:shadow-md"}`,children:[f.jsxs("button",{onClick:()=>O("unlocks"),className:"w-full p-3 flex items-center justify-between bg-transparent",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-xl flex items-center justify-center ${t?"bg-emerald-500/20 text-emerald-400":"bg-emerald-100 text-emerald-600"}`,children:f.jsx(tc,{className:"w-4 h-4"})}),f.jsxs("div",{className:"text-left",children:[f.jsx("p",{className:`text-xs font-bold ${t?"text-white":"text-gray-900"}`,children:"Punch In Requests"}),f.jsx("p",{className:`text-[10px] ${t?"text-white/50":"text-gray-500"}`,children:"Approvals needed"})]})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:`flex h-5 min-w-[20px] px-1.5 items-center justify-center rounded-full text-[10px] font-bold ${t?"bg-emerald-500 text-black shadow-[0_0_10px_rgba(16,185,129,0.4)]":"bg-emerald-100 text-emerald-700"}`,children:y.length}),D.unlocks?f.jsx(Lt,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`}):f.jsx(Et,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`})]})]}),D.unlocks&&f.jsxs("div",{className:`p-3 space-y-3 border-t ${t?"border-white/5":"border-emerald-100/50"}`,children:[f.jsxs("div",{className:"flex items-center gap-2 px-1 py-1",children:[f.jsx(Ze,{className:"w-3.5 h-3.5 text-amber-500 animate-pulse"}),f.jsx("span",{className:`text-[10px] font-black uppercase tracking-wider ${t?"text-amber-400":"text-amber-700"}`,children:"Attention: Approval Required"})]}),y.map(E=>f.jsxs("div",{className:`rounded-xl p-3 border ${t?"bg-black/20 border-white/5":"bg-emerald-50/30 border-emerald-100"}`,children:[f.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[f.jsx(Uc,{photoUrl:E.userPhoto,seed:E.userId,className:"absolute inset-0 w-8 h-8 rounded-lg"}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("p",{className:`text-xs font-bold truncate ${t?"text-white":"text-gray-900"}`,children:E.userName}),f.jsx("span",{className:"text-[8px] font-black uppercase px-1.5 py-0.5 rounded bg-emerald-500/10 text-emerald-500 border border-emerald-500/20",children:"Unlock"})]}),f.jsx("p",{className:`text-[9px] ${t?"text-white/50":"text-emerald-700/60"}`,children:ni(bt(E.requestedAt),{addSuffix:!0})})]})]}),f.jsx("div",{className:`rounded-lg p-2.5 border mb-3 ${t?"bg-black/20 border-white/5":"bg-white border-emerald-100/50"}`,children:f.jsxs("p",{className:`text-[11px] italic leading-relaxed ${t?"text-white/70":"text-gray-700"}`,children:['"',E.reason,'"']})}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs($e,{size:"sm",disabled:W===E.id,className:"flex-1 bg-emerald-600 hover:bg-emerald-700 border-none text-[9px] uppercase font-bold h-8 shadow-lg shadow-emerald-900/20",onClick:()=>ie(E.id,"approved"),children:[f.jsx(Pn,{className:"w-3 h-3 mr-1"})," Approve"]}),f.jsxs($e,{size:"sm",variant:"outline",disabled:W===E.id,className:`flex-1 text-[9px] uppercase font-bold h-8 ${t?"border-white/10 text-white hover:bg-white/5":"border-emerald-200 text-emerald-700 hover:bg-emerald-50"}`,onClick:()=>ie(E.id,"rejected"),children:[f.jsx(Mn,{className:"w-3 h-3 mr-1"})," Reject"]})]})]},E.id))]})]}),_.length>0&&f.jsxs("div",{className:`group rounded-2xl overflow-hidden transition-all duration-300 border ${t?"border-white/10 bg-transparent":"border-orange-100 bg-white hover:shadow-md"}`,children:[f.jsxs("button",{onClick:()=>O("leaves"),className:"w-full p-3 flex items-center justify-between bg-transparent",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-xl flex items-center justify-center ${t?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-600"}`,children:f.jsx(Bi,{className:"w-4 h-4"})}),f.jsxs("div",{className:"text-left",children:[f.jsx("p",{className:`text-xs font-bold ${t?"text-white":"text-gray-900"}`,children:"Leave Requests"}),f.jsx("p",{className:`text-[10px] ${t?"text-white/50":"text-gray-500"}`,children:"Approvals needed"})]})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:`flex h-5 min-w-[20px] px-1.5 items-center justify-center rounded-full text-[10px] font-bold ${t?"bg-orange-500 text-black shadow-[0_0_10px_rgba(249,115,22,0.4)]":"bg-orange-100 text-orange-700"}`,children:_.length}),D.leaves?f.jsx(Lt,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`}):f.jsx(Et,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`})]})]}),D.leaves&&f.jsxs("div",{className:`p-3 space-y-3 border-t ${t?"border-white/5":"border-orange-100/50"}`,children:[f.jsxs("div",{className:"flex items-center gap-2 px-1 py-1",children:[f.jsx(Ze,{className:"w-3.5 h-3.5 text-amber-500 animate-pulse"}),f.jsx("span",{className:`text-[10px] font-black uppercase tracking-wider ${t?"text-amber-400":"text-amber-700"}`,children:"Attention: Leave Verification"})]}),_.map(E=>f.jsxs("div",{className:`rounded-xl p-3 border ${t?"bg-black/20 border-white/5":"bg-orange-50/30 border-orange-100"}`,children:[f.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[f.jsxs("div",{className:"w-8 h-8 rounded-lg bg-orange-100 flex items-center justify-center font-bold text-orange-700 overflow-hidden relative text-xs",children:[E.userName.charAt(0),f.jsx(Bi,{className:"w-4 h-4"})]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("p",{className:`text-xs font-bold truncate ${t?"text-white":"text-gray-900"}`,children:E.userName}),f.jsx("span",{className:"text-[8px] font-black uppercase px-1.5 py-0.5 rounded bg-orange-500/10 text-orange-500 border border-orange-500/20",children:E.leaveType})]}),f.jsxs("p",{className:`text-[9px] ${t?"text-white/50":"text-orange-700/60"}`,children:[we(bt(E.startDate),"dd MMM")," - ",we(bt(E.endDate),"dd MMM")]})]})]}),f.jsx("div",{className:`rounded-lg p-2.5 border mb-3 ${t?"bg-black/20 border-white/5":"bg-white border-orange-100/50"}`,children:f.jsxs("p",{className:`text-[11px] italic leading-relaxed ${t?"text-white/70":"text-gray-700"}`,children:['"',E.reason,'"']})}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs($e,{size:"sm",disabled:W===E.id,className:"flex-1 bg-orange-600 hover:bg-orange-700 border-none text-[9px] uppercase font-bold h-8 shadow-lg shadow-orange-900/20",onClick:()=>pe(E.id,E.status==="pending_hr_confirmation"?"confirm":"approve"),children:[f.jsx(Pn,{className:"w-3 h-3 mr-1"})," ",E.status==="pending_hr_confirmation"?"Confirm":"Approve"]}),f.jsxs($e,{size:"sm",variant:"outline",disabled:W===E.id,className:`flex-1 text-[9px] uppercase font-bold h-8 ${t?"border-white/10 text-white hover:bg-white/5":"border-orange-200 text-orange-700 hover:bg-orange-50"}`,onClick:()=>pe(E.id,"reject"),children:[f.jsx(Mn,{className:"w-3 h-3 mr-1"})," Reject"]})]})]},E.id))]})]}),b.length>0&&f.jsxs("div",{className:`group rounded-2xl overflow-hidden transition-all duration-300 border ${t?"border-white/10 bg-transparent":"border-blue-100 bg-white hover:shadow-md"}`,children:[f.jsxs("button",{onClick:()=>O("claims"),className:"w-full p-3 flex items-center justify-between bg-transparent",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-xl flex items-center justify-center ${t?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-600"}`,children:f.jsx(Gi,{className:"w-4 h-4"})}),f.jsxs("div",{className:"text-left",children:[f.jsx("p",{className:`text-xs font-bold ${t?"text-white":"text-gray-900"}`,children:"Extra Work Claims"}),f.jsx("p",{className:`text-[10px] ${t?"text-white/50":"text-gray-500"}`,children:"Review claims"})]})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:`flex h-5 min-w-[20px] px-1.5 items-center justify-center rounded-full text-[10px] font-bold ${t?"bg-blue-500 text-black shadow-[0_0_10px_rgba(59,130,246,0.4)]":"bg-blue-100 text-blue-700"}`,children:b.length}),D.claims?f.jsx(Lt,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`}):f.jsx(Et,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`})]})]}),D.claims&&f.jsxs("div",{className:`p-3 space-y-3 border-t ${t?"border-white/5":"border-blue-100/50"}`,children:[f.jsxs("div",{className:"flex items-center gap-2 px-1 py-1",children:[f.jsx(Ze,{className:"w-3.5 h-3.5 text-amber-500 animate-pulse"}),f.jsx("span",{className:`text-[10px] font-black uppercase tracking-wider ${t?"text-amber-400":"text-amber-700"}`,children:"Attention: Extra Work Review"})]}),b.map(E=>f.jsxs("div",{className:`rounded-xl p-3 border ${t?"bg-black/20 border-white/5":"bg-blue-50/30 border-blue-100"}`,children:[f.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[f.jsxs("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center font-bold text-blue-700 overflow-hidden relative text-xs",children:[E.userName.charAt(0),f.jsx(Gi,{className:"w-4 h-4"})]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("p",{className:`text-xs font-bold truncate ${t?"text-white":"text-gray-900"}`,children:E.userName}),f.jsx("span",{className:"text-[8px] font-black uppercase px-1.5 py-0.5 rounded bg-blue-500/10 text-blue-500 border border-blue-500/20",children:E.claimType})]}),f.jsx("p",{className:`text-[9px] ${t?"text-white/50":"text-blue-700/60"}`,children:we(bt(E.workDate),"dd MMM yyyy")})]})]}),f.jsx("div",{className:`rounded-lg p-2.5 border mb-3 ${t?"bg-black/20 border-white/5":"bg-white border-blue-100/50"}`,children:f.jsxs("p",{className:`text-[11px] italic leading-relaxed ${t?"text-white/70":"text-gray-700"}`,children:['"',E.reason,'"']})}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs($e,{size:"sm",disabled:W===E.id,className:"flex-1 bg-blue-600 hover:bg-blue-700 border-none text-[9px] uppercase font-bold h-8 shadow-lg shadow-blue-900/20",onClick:()=>_e(E.id,"approve"),children:[f.jsx(Pn,{className:"w-3 h-3 mr-1"})," Approve"]}),f.jsxs($e,{size:"sm",variant:"outline",disabled:W===E.id,className:`flex-1 text-[9px] uppercase font-bold h-8 ${t?"border-white/10 text-white hover:bg-white/5":"border-blue-200 text-blue-700 hover:bg-blue-50"}`,onClick:()=>_e(E.id,"reject"),children:[f.jsx(Mn,{className:"w-3 h-3 mr-1"})," Reject"]})]})]},E.id))]})]}),C.length>0&&f.jsxs("div",{className:`group rounded-2xl overflow-hidden transition-all duration-300 border ${t?"border-white/10 bg-transparent":"border-amber-100 bg-white hover:shadow-md"}`,children:[f.jsxs("button",{onClick:()=>O("invoices"),className:"w-full p-3 flex items-center justify-between bg-transparent",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-xl flex items-center justify-center ${t?"bg-amber-500/20 text-amber-400":"bg-amber-100 text-amber-600"}`,children:f.jsx(Ln,{className:"w-4 h-4"})}),f.jsxs("div",{className:"text-left",children:[f.jsx("p",{className:`text-xs font-bold ${t?"text-white":"text-gray-900"}`,children:"Invoice Alerts"}),f.jsx("p",{className:`text-[10px] ${t?"text-white/50":"text-gray-500"}`,children:"Due for sharing"})]})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:`flex h-5 min-w-[20px] px-1.5 items-center justify-center rounded-full text-[10px] font-bold ${t?"bg-amber-500 text-black shadow-[0_0_10px_rgba(245,158,11,0.4)]":"bg-amber-100 text-amber-700"}`,children:C.length}),D.invoices?f.jsx(Lt,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`}):f.jsx(Et,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`})]})]}),D.invoices&&f.jsxs("div",{className:`p-3 space-y-3 border-t ${t?"border-white/5":"border-amber-100/50"}`,children:[f.jsxs("div",{className:"flex items-center gap-2 px-1 py-1",children:[f.jsx(Ze,{className:"w-3.5 h-3.5 text-amber-500 animate-pulse"}),f.jsx("span",{className:`text-[10px] font-black uppercase tracking-wider ${t?"text-amber-400":"text-amber-700"}`,children:"Warning: Invoices Due for Sharing"})]}),C.map(E=>f.jsxs("div",{className:`rounded-xl p-3 border ${t?"bg-black/20 border-white/5":"bg-amber-50/30 border-amber-100"}`,children:[f.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[f.jsxs("div",{className:"w-8 h-8 rounded-lg bg-amber-100 flex items-center justify-center font-bold text-amber-700 overflow-hidden relative text-xs",children:[E.siteName.charAt(0),f.jsx(Ln,{className:"w-4 h-4"})]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("p",{className:`text-xs font-bold truncate ${t?"text-white":"text-gray-900"}`,children:E.siteName}),f.jsx("span",{className:"text-[8px] font-black uppercase px-1.5 py-0.5 rounded bg-amber-500/10 text-amber-500 border border-amber-500/20",children:"Due"})]}),f.jsxs("p",{className:`text-[9px] ${t?"text-white/50":"text-amber-700/60"}`,children:["Tentative: ",E.invoiceSharingTentativeDate?we(bt(E.invoiceSharingTentativeDate),"dd MMM yyyy"):"N/A"]})]})]}),f.jsx($e,{size:"sm",className:"w-full bg-amber-600 hover:bg-amber-700 border-none text-[9px] uppercase font-bold h-8 shadow-lg shadow-amber-900/20",onClick:()=>{d("/finance?tab=attendance"),e()},children:"View Tracker"})]},E.id))]})]}),A.length>0&&f.jsxs("div",{className:`group rounded-2xl overflow-hidden transition-all duration-300 border ${t?"border-white/10 bg-transparent":"border-rose-100 bg-white hover:shadow-md"}`,children:[f.jsxs("button",{onClick:()=>O("finance"),className:"w-full p-3 flex items-center justify-between bg-transparent",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-xl flex items-center justify-center ${t?"bg-rose-500/20 text-rose-400":"bg-rose-100 text-rose-600"}`,children:f.jsx(Ln,{className:"w-4 h-4"})}),f.jsxs("div",{className:"text-left",children:[f.jsx("p",{className:`text-xs font-bold ${t?"text-white":"text-gray-900"}`,children:"Tracker Updates"}),f.jsx("p",{className:`text-[10px] ${t?"text-white/50":"text-gray-500"}`,children:"Review updates"})]})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:`flex h-5 min-w-[20px] px-1.5 items-center justify-center rounded-full text-[10px] font-bold ${t?"bg-rose-500 text-black shadow-[0_0_10px_rgba(244,63,94,0.4)]":"bg-rose-100 text-rose-700"}`,children:A.length}),D.finance?f.jsx(Lt,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`}):f.jsx(Et,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`})]})]}),D.finance&&f.jsxs("div",{className:`p-3 space-y-3 border-t ${t?"border-white/5":"border-rose-100/50"}`,children:[f.jsxs("div",{className:"flex items-center gap-2 px-1 py-1",children:[f.jsx(Ze,{className:"w-3.5 h-3.5 text-amber-500 animate-pulse"}),f.jsx("span",{className:`text-[10px] font-black uppercase tracking-wider ${t?"text-amber-400":"text-amber-700"}`,children:"Attention: Tracker Approval Required"})]}),A.map(E=>f.jsxs("div",{className:`rounded-xl p-3 border ${t?"bg-black/20 border-white/5":"bg-rose-50/30 border-rose-100"}`,children:[f.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[f.jsxs("div",{className:"w-8 h-8 rounded-lg bg-rose-100 flex items-center justify-center font-bold text-rose-700 overflow-hidden relative text-xs",children:[E.createdByName?.charAt(0)||"F",f.jsx(Ln,{className:"w-4 h-4"})]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("p",{className:`text-xs font-bold truncate ${t?"text-white":"text-gray-900"}`,children:E.createdByName}),f.jsx("span",{className:"text-[8px] font-black uppercase px-1.5 py-0.5 rounded bg-rose-500/10 text-rose-500 border border-rose-500/20",children:"Tracker"})]}),f.jsxs("div",{className:"flex items-center justify-between mt-0.5",children:[f.jsxs("p",{className:`text-[9px] ${t?"text-white/50":"text-rose-700/60"}`,children:[E.createdByRole?f.jsx("span",{className:"uppercase tracking-tighter mr-2",children:E.createdByRole.replace("_"," ")}):null,E.createdAt&&we(bt(E.createdAt),"dd MMM, hh:mm a")]}),f.jsxs("span",{className:"text-[10px] font-bold text-gray-900",children:["",(E.totalBilledAmount||E.billedAmount+E.billedManagementFee).toLocaleString()]})]})]})]}),f.jsxs("div",{className:`rounded-lg p-2.5 border mb-3 ${t?"bg-black/20 border-white/5":"bg-white border-rose-100/50"}`,children:[f.jsx("p",{className:`text-[11px] font-bold ${t?"text-white/90":"text-gray-900"}`,children:E.siteName}),f.jsx("p",{className:`text-[10px] italic leading-relaxed ${t?"text-white/70":"text-gray-600"}`,children:E.remarks||"No remarks provided"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs($e,{size:"sm",disabled:W===E.id,className:"flex-1 bg-rose-600 hover:bg-rose-700 border-none text-[9px] uppercase font-bold h-8 shadow-lg shadow-rose-900/20",onClick:()=>Ne(E.id,"approved"),children:[f.jsx(Pn,{className:"w-3 h-3 mr-1"})," Approve"]}),f.jsxs($e,{size:"sm",variant:"outline",disabled:W===E.id,className:`flex-1 text-[9px] uppercase font-bold h-8 ${t?"border-white/10 text-white hover:bg-white/5":"border-rose-200 text-rose-700 hover:bg-rose-50"}`,onClick:()=>Ne(E.id,"rejected"),children:[f.jsx(Mn,{className:"w-3 h-3 mr-1"})," Reject"]})]})]},E.id))]})]})]})]}),f.jsxs("div",{className:`border-b border-t mt-4 px-6 py-4 flex items-center justify-between cursor-pointer ${t?"border-white/10 bg-white/5":"border-gray-100 bg-gray-50"}`,onClick:()=>O("general"),children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:`p-1.5 rounded-lg ${t?"bg-sky-500/20 text-sky-400":"bg-sky-100 text-sky-700"}`,children:f.jsx(Fr,{className:"w-3.5 h-3.5"})}),f.jsx("h5",{className:`text-[11px] font-black uppercase tracking-widest ${t?"text-white/90":"text-sky-900"}`,children:"Recent Updates"})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:`text-[10px] font-bold px-2.5 py-0.5 rounded-full ${t?"bg-white/10 text-white":"bg-sky-100 text-sky-700"}`,children:I}),D.general?f.jsx(Lt,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`}):f.jsx(Et,{className:`w-4 h-4 ${t?"text-white/50":"text-gray-400"}`})]})]}),D.general&&f.jsx(f.Fragment,{children:L.length>0?f.jsx("div",{className:`divide-y pt-2 ${t?"divide-white/5":"divide-gray-50"}`,children:L.map(E=>f.jsxs("div",{className:"pb-4",children:[f.jsx("div",{className:`px-6 py-3 ${t?"bg-white/5":"bg-gray-50/50"}`,children:f.jsxs("h5",{className:`text-[10px] font-black uppercase tracking-[0.15em] flex items-center gap-2 ${t?"text-white/50":"text-muted/60"}`,children:[f.jsx("div",{className:"w-1 h-3 bg-accent/40 rounded-full"}),E.title]})}),f.jsx("div",{className:`divide-y ${t?"divide-white/5":"divide-gray-50"}`,children:E.items.map(q=>f.jsxs("div",{onClick:()=>Pe(q),className:`group relative flex items-start gap-4 px-6 py-4 cursor-pointer transition-all duration-300 ${q.isRead?t?"hover:bg-white/5":"hover:bg-gray-50":t?"bg-white/5 hover:bg-white/10":"bg-accent/5 hover:bg-accent/10"}`,children:[!q.isRead&&f.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-10 bg-accent rounded-r-full"}),f.jsx(Ow,{type:q.type,size:"h-4 w-4"}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:`text-sm leading-relaxed mb-1.5 ${q.isRead?t?"text-white/70 font-normal":"text-gray-600 font-normal":t?"text-white font-semibold":"text-gray-900 font-semibold"}`,children:q.message}),f.jsxs("span",{className:`text-[11px] flex items-center gap-1 ${t?"text-white/50":"text-muted"}`,children:[f.jsx(ti,{className:"h-3 w-3"}),ni(bt(q.createdAt),{addSuffix:!0})]})]}),f.jsx("button",{className:`opacity-0 group-hover:opacity-100 p-1.5 rounded-lg transition-all ${t?"text-white/50 hover:text-white":"text-muted hover:text-accent"}`,onClick:ee=>{ee.stopPropagation(),o(q.id)},children:f.jsx(Hi,{className:"h-4 w-4"})})]},q.id))})]},E.title))}):f.jsxs("div",{className:"flex flex-col items-center justify-center py-24 text-center px-10",children:[f.jsxs("div",{className:"relative mb-6",children:[f.jsx("div",{className:`w-20 h-20 rounded-3xl flex items-center justify-center rotate-6 ${t?"bg-white/5":"bg-gray-50"}`,children:f.jsx(td,{className:`h-10 w-10 ${t?"text-white/10":"text-gray-200"}`})}),f.jsx("div",{className:`absolute -bottom-2 -right-2 w-10 h-10 rounded-2xl shadow-lg border flex items-center justify-center -rotate-6 ${t?"bg-[#0A3D2E] border-white/10":"bg-white border-gray-100"}`,children:f.jsx(Hi,{className:"h-5 w-5 text-accent"})})]}),f.jsx("h5",{className:`font-bold text-lg mb-2 ${t?"text-white":"text-gray-900"}`,children:"No notifications"}),f.jsx("p",{className:`text-sm ${t?"text-white/40":"text-gray-400"}`,children:"You're all caught up!"})]})})]}),i.length>0&&f.jsx("div",{className:`px-6 py-6 border-t ${t?"bg-[#0A3D2E] border-white/10":"bg-gray-50 border-gray-100"}`,children:f.jsx("div",{className:"flex flex-col gap-6",children:f.jsxs("div",{className:"flex flex-col items-center gap-8",children:[f.jsxs("div",{className:"flex flex-col items-center gap-3 w-full",children:[f.jsx("span",{className:`text-[10px] font-black uppercase tracking-[0.2em] ${t?"text-white/40":"text-muted/60"}`,children:"Items per page"}),f.jsx("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:[5,10,15,20,50].map(E=>f.jsx("button",{onClick:()=>{h(E),m(1)},className:`min-w-[48px] h-10 px-3 rounded-2xl text-xs font-bold transition-all duration-300 border ${p===E?"bg-accent text-white border-accent shadow-[0_4px_12px_rgba(34,197,94,0.3)]":t?"bg-white/5 text-white/50 border-white/10 hover:bg-white/10 hover:text-white":"bg-white text-gray-600 border-gray-200 hover:border-accent hover:text-accent"}`,children:E},E))})]}),$>1&&f.jsxs("div",{className:"flex flex-col items-center gap-3 w-full",children:[f.jsx("span",{className:`text-[10px] font-black uppercase tracking-[0.2em] ${t?"text-white/40":"text-muted/60"}`,children:"Navigation"}),f.jsxs("div",{className:"flex items-center justify-center gap-6",children:[f.jsx($e,{variant:"secondary",size:"sm",onClick:()=>m(E=>Math.max(1,E-1)),disabled:u===1,className:`!p-2 h-10 w-10 !rounded-xl ${t?"bg-white/5 text-white border-white/10 hover:bg-white/10 disabled:opacity-20":"bg-white border-gray-100 disabled:opacity-40"}`,children:f.jsx(nd,{className:"h-5 w-5"})}),f.jsxs("div",{className:`flex items-baseline gap-2 ${t?"text-white":"text-gray-900"}`,children:[f.jsx("span",{className:"text-lg font-black tracking-wider",children:u}),f.jsx("span",{className:"text-[10px] font-bold text-muted/40 uppercase",children:"of"}),f.jsx("span",{className:"text-lg font-black tracking-wider",children:$})]}),f.jsx($e,{variant:"secondary",size:"sm",onClick:()=>m(E=>Math.min($,E+1)),disabled:u===$,className:`!p-2 h-10 w-10 !rounded-xl ${t?"bg-white/5 text-white border-white/10 hover:bg-white/10 disabled:opacity-20":"bg-white border-gray-100 disabled:opacity-40"}`,children:f.jsx(nc,{className:"h-5 w-5"})})]})]}),f.jsx("div",{className:"w-full pt-2",children:f.jsx($e,{className:`w-full py-4 rounded-2xl text-sm font-black uppercase tracking-[0.15em] shadow-lg transition-all duration-300 active:scale-[0.98] ${t?"bg-accent text-[#041b0f] hover:bg-accent/90 shadow-accent/20":"bg-accent text-white hover:bg-accent-dark shadow-accent/10"}`,children:"All Notifications"})})]})})})]}):null},Vw=({message:n,type:e,onDismiss:t})=>{U.useEffect(()=>{const o=setTimeout(()=>{t()},5e3);return()=>{clearTimeout(o)}},[t]);const r=()=>{switch(e){case"success":return{bgColor:"bg-green-500",Icon:Pn};case"error":return{bgColor:"bg-red-500",Icon:Mn};case"info":return{bgColor:"bg-blue-500",Icon:vr};case"warning":return{bgColor:"bg-amber-500",Icon:Ze};default:return{bgColor:"bg-gray-800",Icon:vr}}},{bgColor:i,Icon:s}=r();return f.jsxs("div",{className:`fixed top-5 right-5 z-50 flex items-center p-4 rounded-lg text-white shadow-lg ${i}`,children:[f.jsx(s,{className:"h-6 w-6 mr-3"}),f.jsx("span",{className:"text-sm font-medium",children:n}),f.jsx("button",{onClick:t,className:"ml-4 -mr-2 p-1.5 rounded-md hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white",children:f.jsx(_r,{className:"h-5 w-5"})})]})},Uw=()=>{const{isOnBreak:n,lastBreakInTime:e,breakLimit:t}=De(),[r,i]=U.useState(null),s=U.useRef(null),o=U.useRef(Date.now()),a=U.useRef(!1);U.useEffect(()=>{Xe.isNativePlatform()&&ut.requestPermissions()},[]);const d=()=>{try{s.current||(s.current=new(window.AudioContext||window.webkitAudioContext));const u=s.current,m=u.createOscillator(),p=u.createGain();m.type="sine",m.frequency.setValueAtTime(880,u.currentTime),p.gain.setValueAtTime(.1,u.currentTime),p.gain.exponentialRampToValueAtTime(.01,u.currentTime+.5),m.connect(p),p.connect(u.destination),m.start(),m.stop(u.currentTime+.5)}catch(u){console.warn("Failed to play alert sound:",u)}};return U.useEffect(()=>{n?(async()=>{if(!(!Xe.isNativePlatform()||!n||!e))try{await ut.cancel({notifications:[{id:1005}]});const h=new Date(e),y=new Date(h.getTime()+t*6e4);y>new Date&&(await ut.schedule({notifications:[{title:"  Break Warning",body:` Your ${t} min break is over! Please Break Out and resume work `,id:1005,schedule:{at:y},sound:"beep.wav",extra:null}]}),console.log(`Scheduled proactive break reminder for ${y.toLocaleTimeString()}`))}catch(h){console.error("Failed to schedule proactive break reminder:",h)}})():(async()=>{if(Xe.isNativePlatform())try{await ut.cancel({notifications:[{id:1005}]}),console.log("Cancelled proactive break reminder")}catch(h){console.error("Failed to cancel break reminder:",h)}})()},[n,e,t]),U.useEffect(()=>{let u;if(n&&e){const m=()=>{const p=new Date,h=new Date(e),y=Wt(p,h);if(y>=t){const v=`Break Warning: You've been on break for ${y} minutes. Please Break Out now!`;i({message:v,type:"error"}),d(),Xe.isNativePlatform()&&!a.current&&(ut.schedule({notifications:[{title:"  Break Warning",body:` You are taking a long break! (${y} mins). Please Break Out to resume work `,id:o.current,schedule:{at:new Date(Date.now()+500)},sound:"beep.wav",extra:null}]}),a.current=!0)}};u=setInterval(m,6e4),m()}else i(null),a.current=!1;return()=>{u&&clearInterval(u)}},[n,e,t]),r?f.jsx("div",{className:"fixed top-4 right-4 z-[9999] animate-in fade-in slide-in-from-top-4 duration-300",children:f.jsx(Vw,{message:r.message,type:r.type,onDismiss:()=>i(null)})}):null},qw=[{to:"/verification/dashboard",label:"All Submissions",icon:id,permission:"view_all_submissions"},{to:"/developer/api",label:"API Settings",icon:sd,permission:"view_developer_settings"},{to:"/attendance/dashboard",label:"Attendance",icon:Bi,permission:"view_own_attendance"},{to:"/hr/attendance-settings",label:"Attendance Rules",icon:od,permission:"manage_attendance_rules"},{to:"/hr/notification-management",label:"Notifications Control",icon:Fr,permission:"manage_attendance_rules"},{to:"/support",label:"Backend Support",icon:ad,permission:"access_support_desk"},{to:"/hr/entity-management",label:"Client Management",icon:ld,permission:"view_entity_management"},{to:"/hr/enrollment-rules",label:"Enrollment Rules",icon:zi,permission:"manage_enrollment_rules"},{to:"/hr/policies-and-insurance",label:"Policies & Insurance",icon:cd,permission:"manage_policies"},{to:"/billing/summary",label:"Invoice Summary",icon:ud,permission:"view_invoice_summary"},{to:"/billing/cost-analysis",label:"Verification Costing",icon:Ln,permission:"view_verification_costing"},{to:"/finance?tab=attendance",label:"Tracker",icon:dd,permission:"view_attendance_tracker"},{to:"/admin/approval-workflow",label:"Leave Approval Settings",icon:fd,permission:"manage_approval_workflow"},{to:"/hr/leave-management",label:"Leave Management",icon:md,permission:"manage_leave_requests"},{to:"/admin/modules",label:"Module Management",icon:pd,permission:"manage_modules"},{to:"/onboarding",label:"New Enrollment",icon:rc,permission:"create_enrollment"},{to:"/operations/dashboard",label:"Operations",icon:hd,permission:"view_operations_dashboard"},{to:"/my-team",label:"My Team",icon:io,permission:"view_my_team"},{to:"/my-team/field-reports",label:"Field Reports",icon:Gi,permission:"view_field_reports"},{to:"/profile",label:"My Account",icon:Ls,permission:"view_profile"},{to:"/admin/roles",label:"Role Management",icon:so,permission:"manage_roles_and_permissions"},{to:"/site/dashboard",label:"Site Dashboard",icon:ic,permission:"view_site_dashboard"},{to:"/admin/sites",label:"Site Management",icon:gd,permission:"manage_sites"},{to:"/tasks",label:"Task Management",icon:sc,permission:"manage_tasks"},{to:"/uniforms",label:"Uniform Management",icon:yd,permission:"manage_uniforms"},{to:"/admin/users",label:"User Management",icon:io,permission:"manage_users"},{to:"/admin/devices",label:"Biometric Devices",icon:_d,permission:"manage_biometric_devices"},{to:"/hr/field-staff-tracking",label:"User Activity Tracking",icon:vd,permission:"view_field_staff_tracking"},{to:"/hr/locations",label:"Geo Locations",icon:tc,permission:"manage_geo_locations"},{to:"/attendance/locations",label:"My Locations",icon:wd,permission:"view_my_locations"},{to:"/settings/devices",label:"Linked Devices",icon:wr,permission:"view_profile"},{to:"/admin/device-approvals",label:"Device Approvals",icon:so,permission:"manage_users"}],jw=Z.memo(({isCollapsed:n,onLinkClick:e,onExpand:t,hideHeader:r=!1,mode:i="light",isMobile:s=!1})=>{const{user:o}=De(),{permissions:a}=En(),d=U.useMemo(()=>{if(!o||!a)return[];const p=o.roleId?.toLowerCase()||"",h=o.role?.toLowerCase()||"",y=h.replace(/\s+/g,"_");return a[p]||a[h]||a[y]||a[o.role]||[]},[o,a]),u=U.useMemo(()=>o?qw.filter(p=>Bs(o.role)||d.includes(p.permission)).sort((p,h)=>p.label.localeCompare(h.label)):[],[o,d]),m=U.useCallback(p=>{if(n&&t){p.preventDefault(),t();return}},[n,t,e]);return f.jsxs("div",{className:"flex flex-col",children:[r&&n&&f.jsx("div",{className:"p-4 border-b border-[#1f3d2b] bg-[#041b0f] flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",children:f.jsxs("button",{onClick:()=>window.location.href="/#/profile",className:"btn-icon inline-flex items-center justify-center p-2 rounded-md text-white hover:bg-white/10 focus:outline-none","aria-label":"Go to profile page",children:[f.jsx("span",{className:"sr-only",children:"Go to profile"}),f.jsx(xd,{className:"block h-6 w-6"})]})}),r&&!n&&f.jsx("div",{className:"p-4 border-b border-[#1f3d2b] bg-[#041b0f] flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0"}),!r&&f.jsx("div",{className:`p-4 border-b flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0 ${i==="dark"?"bg-[#041b0f] border-[#1f3d2b]":"bg-white border-gray-200"}`,children:n?f.jsx("div",{className:"h-8 w-8 overflow-hidden",children:f.jsx(Qt,{className:"h-8 max-w-none object-left object-cover"})}):f.jsx(Qt,{})}),f.jsx("nav",{className:"px-3 py-4 space-y-1.5",children:u.map(p=>f.jsx(ac,{to:p.to,onClick:m,className:({isActive:h})=>`group flex items-center px-3 py-3 rounded-xl text-sm font-medium transition-all duration-200 ease-in-out ${n?"justify-center":""} ${i==="light"?h?"text-white shadow-sm border":"text-gray-500 hover:bg-gray-50 hover:text-gray-900":h?"bg-[#1c3a23] text-white shadow-sm border border-white/5":"text-white hover:bg-white/5 hover:text-white/90"}`,style:({isActive:h})=>h?i==="light"?{backgroundColor:"#006B3F",borderColor:"#005632"}:{}:{},title:p.label,children:({isActive:h})=>f.jsxs(f.Fragment,{children:[f.jsx(p.icon,{className:`h-5 w-5 flex-shrink-0 transition-colors duration-200 ${i==="light"?h?"text-white":"text-gray-400 group-hover:text-gray-600":h?"text-white":"text-white group-hover:text-white"} ${n?"":"mr-3"}`}),!n&&f.jsx("span",{children:p.label})]})},p.to))})]})}),Bw=()=>{const{user:n}=De(),{fetchNotifications:e,isPanelOpen:t,setIsPanelOpen:r}=Cn(),{permissions:i}=En(),{autoScrollOnHover:s}=Lw();Ut();const{isMobile:o,isTablet:a,isDesktop:d}=Gr(),u=U.useRef(null),m=U.useRef(null),[p,h]=U.useState(d),[y,v]=U.useState(0),[_,x]=U.useState(!1),b=U.useRef(null);U.useEffect(()=>{h(d)},[d]);const w=U.useCallback(()=>{o||(b.current&&clearTimeout(b.current),b.current=setTimeout(()=>{h(!0)},50))},[o]),A=U.useCallback(()=>{o||(b.current&&clearTimeout(b.current),h(!1))},[o]),S=U.useCallback(()=>{m.current!==null&&(clearInterval(m.current),m.current=null)},[]),C=U.useCallback(N=>{S();const D=u.current;if(!D)return;const V=()=>{D.scrollBy({top:N==="up"?-window.innerHeight*.8:window.innerHeight*.8,behavior:"smooth"})};V(),m.current=window.setInterval(V,300)},[S]);return U.useEffect(()=>{const N=()=>{const V=u.current;V&&(x(V.scrollHeight>V.clientHeight),v(V.scrollTop))},D=u.current;return D?.addEventListener("scroll",N,{passive:!0}),window.addEventListener("resize",N),N(),()=>{D?.removeEventListener("scroll",N),window.removeEventListener("resize",N),S()}},[S]),U.useEffect(()=>{if(n){e();const N=Cn.getState().subscribeToNotifications();return()=>N()}},[n,e]),n?f.jsxs("div",{className:`flex min-h-screen overflow-hidden ${o?"bg-[#041b0f]":"bg-page"} ${o?"":"p-4 md:p-4 lg:p-8 gap-4 md:gap-4 lg:gap-8"}`,children:[o&&!p&&f.jsx("div",{className:"fixed inset-0 bg-black/50 z-[45] transition-opacity duration-300",onClick:()=>h(!0)}),(o||a)&&t&&f.jsx("div",{className:"fixed inset-0 bg-black/50 z-[95] transition-opacity duration-300",onClick:()=>r(!1)}),f.jsxs("aside",{onMouseEnter:w,onMouseLeave:A,className:`flex flex-col flex-shrink-0 transition-[width] duration-300 cubic-bezier(0.4,0,0.2,1) will-change-[width] ${o||a?p?"w-64":"w-16":p?"w-72":"w-16"} ${o?"bg-[#041b0f]":"bg-white border-r border-gray-200/60"} ${o?"fixed left-0 top-0 bottom-0 z-50":""}`,children:[f.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:f.jsx(jw,{isCollapsed:!p,mode:o?"dark":"light",onLinkClick:()=>h(!1),onExpand:()=>h(!0),hideHeader:o,isMobile:o})}),f.jsx("div",{className:`flex-shrink-0 px-2 pt-2 mt-auto flex items-center ${o?"border-t border-transparent":"border-t border-border"}`,children:f.jsx("button",{onClick:()=>h(!p),className:`flex-1 flex items-center justify-center p-2 rounded-lg transition-colors ${o?"text-white/70 hover:bg-white/10":"text-muted hover:bg-page"}`,title:p?"Collapse sidebar":"Expand sidebar",children:p?f.jsx(Cd,{className:"h-5 w-5"}):f.jsx(bd,{className:"h-5 w-5"})})})]}),f.jsxs("div",{className:`flex-1 flex flex-col ${o?"bg-[#041b0f]":"bg-gray-50/50"} ${o&&!p?"ml-16":""}`,children:[f.jsx(qc,{}),f.jsx(Uw,{}),f.jsx("main",{ref:u,className:`flex-1 overflow-y-auto ${o?"bg-[#041b0f]":"bg-page"}`,children:f.jsx("div",{className:`${a?"p-1":"p-4"}`,children:f.jsx(Or,{})})})]}),d&&t&&f.jsx("aside",{className:"w-[400px] flex-shrink-0 bg-white border-l border-gray-200/60 rounded-3xl overflow-hidden shadow-sm animate-slide-in-right",children:f.jsx(vs,{isOpen:t,onClose:()=>r(!1),isMobile:!1})}),(o||a)&&t&&f.jsx("div",{className:`fixed inset-y-0 right-0 z-[100] animate-slide-in-right ${o?"w-full":"w-[400px]"}`,children:f.jsx(vs,{isOpen:t,onClose:()=>r(!1),isMobile:o})}),_&&!o&&f.jsxs("div",{className:"fixed bottom-8 right-8 z-50 flex flex-col gap-2 no-print",children:[f.jsx($e,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:s?()=>C("up"):void 0,onMouseLeave:S,onMouseDown:()=>C("up"),onMouseUp:S,onTouchStart:()=>C("up"),onTouchEnd:S,disabled:y<=0,"aria-label":"Scroll Up",children:f.jsx(Lt,{className:"h-5 w-5"})}),f.jsx($e,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:s?()=>C("down"):void 0,onMouseLeave:S,onMouseDown:()=>C("down"),onMouseUp:S,onTouchStart:()=>C("down"),onTouchEnd:S,disabled:u.current?Math.ceil(u.current.clientHeight+y)>=u.current.scrollHeight:!1,"aria-label":"Scroll Down",children:f.jsx(Et,{className:"h-5 w-5"})})]})]}):f.jsx(kt,{to:"/auth/login",replace:!0})},Gw=()=>{const{user:n}=De(),{permissions:e}=En();if(!n)return null;const r=(()=>{if(!n||!e)return[];const s=n.roleId?.toLowerCase()||"",o=n.role?.toLowerCase()||"",a=o.replace(/\s+/g,"_");return e[s]||e[o]||e[a]||e[n.role]||[]})(),i=[{to:"/mobile-home",label:"Home",icon:ic,show:r.includes("view_mobile_nav_home")},{to:"/attendance/dashboard",label:"Attendance",icon:Td,show:r.includes("view_mobile_nav_attendance")},{to:"/tasks",label:"Tasks",icon:sc,show:r.includes("view_mobile_nav_tasks")},{to:"/profile",label:"Profile",icon:Ls,show:r.includes("view_mobile_nav_profile")}];return f.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-[#041b0f] border-t border-[#1f3d2b] z-40",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:f.jsx("div",{className:"flex justify-around items-center h-16",children:i.filter(s=>s.show).map(s=>f.jsxs(ac,{to:s.to,className:({isActive:o})=>`flex flex-col items-center justify-center flex-1 h-full transition-colors ${o?"text-[#22c55e]":"text-gray-400"}`,children:[f.jsx(s.icon,{className:"w-6 h-6"}),f.jsx("span",{className:"text-xs mt-1",children:s.label})]},s.to))})})},Hw=()=>{const n=Ut(),{fetchNotifications:e,isPanelOpen:t,setIsPanelOpen:r}=Cn(),{user:i}=De(),[s,o]=U.useState(!0),a=U.useRef(0),d=U.useRef(!1);return U.useEffect(()=>{const u=()=>{d.current||(window.requestAnimationFrame(()=>{const m=window.scrollY;m<a.current||m<10?o(!0):m>a.current&&m>10&&o(!1),a.current=m,d.current=!1}),d.current=!0)};return window.addEventListener("scroll",u,{passive:!0}),()=>window.removeEventListener("scroll",u)},[]),U.useEffect(()=>{i&&e()},[i,e]),f.jsxs("div",{className:"flex flex-col min-h-screen bg-[#041b0f]",children:[!n.pathname.startsWith("/leaves/apply")&&!n.pathname.startsWith("/onboarding/aadhaar-scan")&&!n.pathname.startsWith("/finance/attendance/add")&&!n.pathname.startsWith("/finance/attendance/edit")&&!n.pathname.startsWith("/finance/site-tracker/add")&&!n.pathname.startsWith("/finance/site-tracker/edit")&&f.jsx("div",{className:`sticky top-0 z-50 transition-transform duration-200 ${s?"translate-y-0":"-translate-y-full"}`,children:f.jsx(qc,{})}),f.jsx("main",{className:"flex-1 overflow-y-auto px-4 pt-2",style:{paddingBottom:n.pathname.includes("/add")||n.pathname.includes("/edit")?"env(safe-area-inset-bottom)":"calc(9.1rem + env(safe-area-inset-bottom))"},children:f.jsx(Or,{})}),!n.pathname.includes("/add")&&!n.pathname.includes("/edit")&&f.jsx(Gw,{}),t&&f.jsx("div",{className:"fixed inset-0 z-[100] animate-slide-in-right",children:f.jsx(vs,{isOpen:t,onClose:()=>r(!1),isMobile:!0})})]})},zw=["https://picsum.photos/seed/corporate_campus/1200/900","https://picsum.photos/seed/luxury_complex/1200/900","https://picsum.photos/seed/office_interior/1200/900","https://picsum.photos/seed/landscaping/1200/900","https://picsum.photos/seed/lobby_design/1200/900"],vl=gt(Sn((n,e)=>({backgroundImages:zw,addBackgroundImage:t=>{const r=e();return r.backgroundImages.includes(t)?!1:(n({backgroundImages:[...r.backgroundImages,t]}),!0)},removeBackgroundImage:t=>n(r=>({backgroundImages:r.backgroundImages.filter((i,s)=>s!==t)}))}),{name:"paradigm-auth-layout-settings",storage:en(()=>localStorage)})),Ww=({isOpen:n,onClose:e})=>{const{deferredPrompt:t,clearDeferredPrompt:r}=Vc(),[i,s]=U.useState(!1),[o,a]=U.useState(null);if(!n)return null;const d=async m=>{if(a(m),m==="ios"){s(!0),a(null);return}if(m==="android"){await new Promise(p=>setTimeout(p,800)),window.location.href="/Paradigm Office.apk",setTimeout(()=>{a(null),e()},1e3);return}if(t){t.prompt();const{outcome:p}=await t.userChoice;console.log(`User response to the install prompt: ${p}`),r(),a(null),e()}else a(null),window.alert('To install the app, look for the "Install" or "Add to Home Screen" option in your browser menu.')},u=[{id:"android",name:"Android App",icon:wr,description:"Install directly on your Android device for a native experience.",action:"Install Now",color:"bg-green-600"},{id:"ios",name:"iOS App",icon:Ad,description:"Add to your iPhone or iPad home screen.",action:"View Guide",color:"bg-zinc-800"},{id:"windows",name:"Web / Desktop",icon:Ji,description:"Run as a desktop application on Windows or macOS.",action:"Install App",color:"bg-blue-600"}];return i?f.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in",children:f.jsxs("div",{className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-3xl shadow-2xl overflow-hidden animate-scale-in",children:[f.jsxs("div",{className:"p-6 border-b border-gray-100 dark:border-zinc-800 flex items-center justify-between",children:[f.jsx("button",{onClick:()=>s(!1),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-zinc-800 transition-colors",children:f.jsx(nc,{className:"w-5 h-5 rotate-180"})}),f.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"iOS Install Guide"}),f.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-zinc-800 transition-colors",children:f.jsx(_r,{className:"w-5 h-5 text-gray-400"})})]}),f.jsxs("div",{className:"p-6 space-y-8",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-emerald-100 dark:bg-emerald-900/30 rounded-xl flex items-center justify-center text-emerald-600 dark:text-emerald-400 font-bold",children:"1"}),f.jsxs("div",{children:[f.jsxs("h3",{className:"font-bold text-gray-900 dark:text-white flex items-center gap-2",children:["Tap Share icon ",f.jsx(Sd,{className:"w-4 h-4"})]}),f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Look for the share button in Safari's bottom toolbar."})]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-emerald-100 dark:bg-emerald-900/30 rounded-xl flex items-center justify-center text-emerald-600 dark:text-emerald-400 font-bold",children:"2"}),f.jsxs("div",{children:[f.jsxs("h3",{className:"font-bold text-gray-900 dark:text-white flex items-center gap-2",children:['"Add to Home Screen" ',f.jsx(Ed,{className:"w-4 h-4"})]}),f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:'Scroll down the share menu and select the "Add to Home Screen" option.'})]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-emerald-100 dark:bg-emerald-900/30 rounded-xl flex items-center justify-center text-emerald-600 dark:text-emerald-400 font-bold",children:"3"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:"Confirm & Launch"}),f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:'Tap "Add" in the top right corner. The app will appear on your home screen.'})]})]}),f.jsx($e,{variant:"primary",className:"w-full !rounded-2xl h-14 !bg-emerald-600 hover:!bg-emerald-700 !border-none !text-lg shadow-lg shadow-emerald-500/20",onClick:e,children:"Got it!"})]})]})}):f.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4 bg-black/95 md:bg-black/90 backdrop-blur-xl animate-fade-in shadow-[inset_0_0_100px_rgba(0,0,0,0.5)]",children:f.jsxs("div",{className:"bg-white dark:bg-zinc-950 w-full max-w-2xl rounded-[2.5rem] shadow-2xl overflow-hidden animate-scale-in border border-gray-200 dark:border-zinc-800/50",children:[f.jsx("div",{className:"absolute inset-0 bg-white dark:bg-zinc-950 -z-10"})," ",f.jsxs("div",{className:"relative p-8 lg:p-10 text-center",children:[f.jsx("button",{onClick:e,className:"absolute right-8 top-8 p-2.5 rounded-2xl bg-gray-100/50 dark:bg-zinc-800/50 hover:bg-gray-200 dark:hover:bg-zinc-700 transition-all border border-black/5 dark:border-white/5",children:f.jsx(_r,{className:"w-5 h-5 text-gray-500"})}),f.jsx("div",{className:"w-20 h-20 bg-emerald-100 dark:bg-emerald-900/40 rounded-[2rem] flex items-center justify-center mx-auto mb-6 shadow-inner animate-bounce-subtle",children:f.jsx(Wi,{className:"w-10 h-10 text-emerald-600 dark:text-emerald-400"})}),f.jsx("h2",{className:"text-3xl lg:text-4xl font-[900] text-gray-900 dark:text-white tracking-tight",children:"Download Paradigm Office App"}),f.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-3 text-lg font-medium opacity-80",children:"Experience the next generation of staff tracking."})]}),f.jsx("div",{className:"p-8 lg:p-10 pt-0 grid gap-5",children:u.map(m=>{const p=o===m.id,h=o!==null&&o!==m.id;return f.jsxs("div",{onClick:()=>!o&&d(m.id),className:`group relative flex items-center gap-6 p-6 rounded-[2rem] bg-gray-50 dark:bg-zinc-800/50 border border-gray-100 dark:border-white/5 transition-all duration-500 ${h?"opacity-50 cursor-not-allowed":"hover:border-emerald-500/50 hover:bg-emerald-500/[0.04] dark:hover:bg-emerald-500/[0.1] cursor-pointer"}`,children:[f.jsx("div",{className:`flex-shrink-0 w-16 h-16 ${m.color} rounded-[1.25rem] flex items-center justify-center text-white shadow-xl shadow-emerald-500/20 ${!h&&"group-hover:scale-110 group-hover:rotate-3"} transition-all duration-500`,children:f.jsx(m.icon,{className:"w-8 h-8"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-1",children:m.name}),f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium opacity-70",children:m.description})]}),f.jsx("div",{className:`flex items-center gap-2 px-6 py-3 ${p?"bg-emerald-700":"bg-emerald-600"} ${!h&&"group-hover:bg-emerald-500"} text-white rounded-2xl font-bold shadow-lg shadow-emerald-500/20 transition-all duration-300`,children:p?f.jsxs(f.Fragment,{children:[f.jsx(kd,{className:"w-5 h-5 animate-spin"}),f.jsx("span",{className:"hidden sm:inline",children:"Loading..."})]}):f.jsxs(f.Fragment,{children:[m.id==="ios"?f.jsx(Id,{className:"w-5 h-5"}):f.jsx(Wi,{className:"w-5 h-5"}),f.jsx("span",{className:"hidden sm:inline",children:m.action})]})})]},m.id)})}),f.jsxs("div",{className:"p-8 lg:mx-10 lg:mb-10 bg-emerald-50/50 dark:bg-emerald-900/5 rounded-3xl flex items-start gap-4 border border-emerald-100/50 dark:border-emerald-500/10",children:[f.jsx("div",{className:"p-3 bg-emerald-100 dark:bg-emerald-900/30 rounded-2xl text-emerald-600 dark:text-emerald-400",children:f.jsx(vr,{className:"w-6 h-6"})}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-base font-bold text-gray-900 dark:text-white",children:"Smart Offline Sync"}),f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 font-medium leading-relaxed opacity-80",children:"Our native app keeps you productive even deep in the field. Records are saved locally and synced automatically when signal returns."})]})]})]})})},Jw=()=>{const{backgroundImages:n}=vl(),[e,t]=U.useState(0),[r,i]=U.useState(!1),s=Ut();U.useEffect(()=>{if(n.length>1){const d=setInterval(()=>{t(u=>(u+1)%n.length)},5e3);return()=>clearInterval(d)}},[n.length]);const o=U.useMemo(()=>n&&n.length>0?n:["https://picsum.photos/seed/default_fallback_1/1200/900"],[n]),a=U.useMemo(()=>s.pathname.includes("signup")?{title:"Create an Account",subtitle:"Join our platform to get started."}:s.pathname.includes("forgot-password")?{title:"Forgot Password?",subtitle:"No worries, we'll send you reset instructions."}:s.pathname.includes("update-password")?{title:"Set a New Password",subtitle:"Please enter your new password."}:s.pathname.includes("logout")?{title:"Log Out",subtitle:"Are you sure you want to log out? You will need to sign in again to access your account."}:{title:"Sign In",subtitle:"Enter your credentials to access your account."},[s.pathname]);return f.jsxs("div",{className:"min-h-screen font-sans flex items-center justify-center bg-page relative",children:[f.jsxs("div",{className:"fixed inset-0 w-full h-full",children:[o.map((d,u)=>f.jsx("img",{src:d,alt:`Background ${u+1}`,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 ease-in-out ${u===e?"opacity-100":"opacity-0"}`,onError:m=>{const p=m.target;p.style.display="none",d.includes("picsum.photos")||setTimeout(()=>{vl.getState().removeBackgroundImage(u)},0)}},u)),f.jsx("div",{className:"absolute inset-0 bg-black/30"})," "]}),f.jsx("div",{className:"relative w-full max-w-2xl lg:max-w-3xl xl:max-w-4xl p-4",children:f.jsxs("div",{className:"auth-card-container glass-mobile w-full grid md:grid-cols-2 rounded-2xl shadow-2xl overflow-hidden md:backdrop-blur-none md:bg-[#0d2c18] border border-[#041b0f] md:border-white/10",children:[f.jsxs("div",{className:"hidden md:flex flex-col justify-between p-6 lg:p-10 xl:p-16 bg-gradient-to-br from-black/40 to-black/70",children:[f.jsxs("div",{children:[f.jsx(Qt,{className:"h-8 lg:h-12 xl:h-14"}),f.jsx("h1",{className:"text-xl lg:text-2xl xl:text-4xl font-bold text-white mt-6 lg:mt-8 leading-tight drop-shadow-lg",children:"Welcome to the Future of Onboarding."}),f.jsx("p",{className:"text-white/80 mt-4 max-w-md drop-shadow-lg text-xs lg:text-sm xl:text-base",children:"Streamlining the journey for every new member of the Paradigm family."})]}),f.jsx("div",{children:f.jsxs("p",{className:"text-white/50 text-[10px] lg:text-xs mt-4",children:[" ",new Date().getFullYear()," Paradigm Services. All rights reserved."]})})]}),f.jsx("div",{className:"p-6 lg:p-10 xl:p-16 flex flex-col justify-center bg-[#050505]/85 backdrop-blur-xl border-l border-white/10",children:f.jsxs("div",{className:"w-full max-w-md mx-auto",children:[f.jsx("div",{className:"md:hidden flex justify-center mb-8",children:f.jsx(Qt,{className:"h-12"})}),f.jsx("h2",{className:"text-xl lg:text-2xl xl:text-3xl font-bold text-white mb-2",children:a.title}),f.jsx("p",{className:"text-gray-300 mb-4 lg:mb-6 xl:mb-8 text-xs lg:text-sm xl:text-base",children:a.subtitle}),f.jsx(Or,{})]})})]})}),f.jsx("button",{onClick:()=>i(!0),className:"fixed bottom-6 right-6 w-16 h-16 bg-emerald-500 text-white rounded-2xl shadow-xl shadow-emerald-500/20 hover:bg-emerald-600 hover:scale-105 active:scale-95 transition-all duration-300 flex items-center justify-center z-50 group border border-white/20",title:"Download App",children:f.jsx(Wi,{className:"w-8 h-8 group-hover:bounce text-white"})}),f.jsx(Ww,{isOpen:r,onClose:()=>i(!1)})]})};function Yw(){const[n,e]=U.useState({isSecure:!0,issues:[],developerModeEnabled:!1,locationSpoofingDetected:!1});return U.useEffect(()=>{const t=()=>{const i=[];let s=!1,o=!1;("geolocation"in navigator,!1)&&(o=!0,i.push("Location spoofing detected. Please disable location mocking apps to continue."));const d=i.length===0;e({isSecure:d,issues:i,developerModeEnabled:s,locationSpoofingDetected:o})};t();const r=setInterval(t,2e3);return window.addEventListener("resize",t),()=>{clearInterval(r),window.removeEventListener("resize",t)}},[]),n}const Kw=({issues:n,onDismiss:e})=>{const[t,r]=U.useState(!1);return U.useEffect(()=>{const i=()=>{r(window.innerWidth<768)};return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),t?f.jsx("div",{className:"fixed inset-0 z-50 bg-white overflow-y-auto",children:f.jsxs("div",{className:"min-h-screen p-4 flex flex-col",children:[f.jsx("div",{className:"flex justify-center mt-8 mb-6",children:f.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:f.jsx(Bn,{className:"w-8 h-8 text-red-600"})})}),f.jsx("h2",{className:"text-xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),f.jsxs("div",{className:"space-y-3 mb-4",children:[f.jsx("p",{className:"text-gray-700 text-center text-sm",children:"Access to this application has been temporarily blocked for security reasons:"}),f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:f.jsx("ul",{className:"space-y-2",children:n.map((i,s)=>f.jsxs("li",{className:"flex items-start gap-2 text-xs text-red-800",children:[f.jsx(Ze,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),f.jsx("span",{children:i})]},s))})})]}),f.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[f.jsx("h3",{className:"font-semibold text-blue-900 mb-2 text-sm",children:"To continue:"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs text-blue-800",children:[f.jsx("li",{children:"Close browser developer tools (F12)"}),f.jsx("li",{children:"Disable any location spoofing apps or extensions"}),f.jsx("li",{children:"Refresh this page"})]})]}),f.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:f.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&f.jsx($e,{onClick:e,variant:"outline",className:"w-full mt-auto",size:"sm",children:"I Understand"})]})}):f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:f.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 animate-in fade-in zoom-in duration-300",children:[f.jsx("div",{className:"flex justify-center mb-6",children:f.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center",children:f.jsx(Bn,{className:"w-10 h-10 text-red-600"})})}),f.jsx("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),f.jsxs("div",{className:"space-y-3 mb-6",children:[f.jsx("p",{className:"text-gray-700 text-center",children:"Access to this application has been temporarily blocked for security reasons:"}),f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:f.jsx("ul",{className:"space-y-2",children:n.map((i,s)=>f.jsxs("li",{className:"flex items-start gap-2 text-sm text-red-800",children:[f.jsx(Ze,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),f.jsx("span",{children:i})]},s))})})]}),f.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[f.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"To continue:"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[f.jsx("li",{children:"Close browser developer tools (F12)"}),f.jsx("li",{children:"Disable any location spoofing apps or extensions"}),f.jsx("li",{children:"Refresh this page"})]})]}),f.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6",children:f.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&f.jsx($e,{onClick:e,variant:"outline",className:"w-full",children:"I Understand"})]})})},jn=Vr("Device",{web:()=>F(()=>import("./web-DFsgDsj2.js"),__vite__mapDeps([5,4,2,1])).then(n=>new n.DeviceWeb)}),Zw=Vr("App",{web:()=>F(()=>import("./web-DdzKuLpu.js"),__vite__mapDeps([6,4,2,1])).then(n=>new n.AppWeb)}),Xw=Vr("Network",{web:()=>F(()=>import("./web-DfiROD5f.js"),__vite__mapDeps([7,4,2,1])).then(n=>new n.NetworkWeb)});async function Hr(){try{const n=await jn.getInfo();if(n.platform==="android")return"android";if(n.platform==="ios")return"ios";const e=navigator.userAgent.toLowerCase();return e.includes("android")?"android":e.includes("iphone")||e.includes("ipad")?"ios":"web"}catch{const e=navigator.userAgent.toLowerCase();return e.includes("android")?"android":e.includes("iphone")||e.includes("ipad")?"ios":"web"}}async function jc(){return await Hr()==="web"?await Bc():await Qw()}async function Qw(){try{const n=await jn.getInfo(),e=await jn.getId(),t=await jn.getBatteryInfo(),r=await Xw.getStatus();let i={};try{i=await Zw.getInfo()}catch{}const s={platform:n.platform,os:n.operatingSystem,osVersion:n.osVersion,deviceModel:n.model,manufacturer:n.manufacturer,uuid:e.identifier,androidId:n.platform==="android"?e.identifier:void 0,userAgent:navigator.userAgent,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,batteryLevel:t.batteryLevel,isCharging:t.isCharging,connectionType:r.connectionType,appVersion:i.version||"1.0.0",hardwareModel:n.model,screenResolution:`${window.screen.width}x${window.screen.height}`,colorDepth:window.screen.colorDepth,canvas:Gc(),webgl:Hc()},o=(s.deviceModel||"").toUpperCase(),a=(s.manufacturer||"").toLowerCase();if(!s.deviceModel||o==="K"||o==="UNKNOWN"||o.includes("ANDROID")||a.includes("google inc")||a==="unknown"){const u=zc(navigator.userAgent);if(u){s.hardwareModel=u,s.deviceModel=u;const m=navigator.userAgent.toLowerCase();(a.includes("google inc")||a==="unknown"||!a)&&(u.startsWith("SM-")||u.startsWith("GT-")||m.includes("samsung")?s.manufacturer="Samsung":u.startsWith("Pixel")||m.includes("pixel")?s.manufacturer="Google":u.startsWith("ONEPLUS")||m.includes("oneplus")?s.manufacturer="OnePlus":u.startsWith("CPH")||m.includes("oppo")?s.manufacturer="Oppo":u.startsWith("M21")||m.includes("xiaomi")||m.includes("redmi")?s.manufacturer="Xiaomi":m.includes("moto")||m.includes("motorola")?s.manufacturer="Motorola":m.includes("huawei")&&(s.manufacturer="Huawei"))}else s.hardwareModel="Android Device",s.deviceModel="Android Device",(a.includes("google inc")||a==="unknown")&&(s.manufacturer="Android")}s.os==="android"&&(s.os="Android"),s.os==="ios"&&(s.os="iOS");try{const m=await(await fetch("https://api.ipify.org?format=json")).json();m.ip&&(s.ipAddress=m.ip)}catch{}return s}catch(n){return console.error("Error getting mobile device info:",n),{userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language}}}async function Bc(){const n={userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,screenResolution:`${window.screen.width}x${window.screen.height}`,colorDepth:window.screen.colorDepth,appVersion:"1.0.0"},e=navigator.userAgent;if(e.includes("Chrome")&&!e.includes("Edg")){n.browser="Chrome";const t=e.match(/Chrome\/([\d.]+)/);t&&(n.browserVersion=t[1])}else if(e.includes("Safari")&&!e.includes("Chrome")){n.browser="Safari";const t=e.match(/Version\/([\d.]+)/);t&&(n.browserVersion=t[1])}else if(e.includes("Firefox")){n.browser="Firefox";const t=e.match(/Firefox\/([\d.]+)/);t&&(n.browserVersion=t[1])}else if(e.includes("Edg")){n.browser="Edge";const t=e.match(/Edg\/([\d.]+)/);t&&(n.browserVersion=t[1])}if(e.includes("Android")){n.os="Android";const t=zc(e);t&&(n.hardwareModel=t,n.deviceModel=t)}else e.includes("iOS")||e.includes("iPhone")||e.includes("iPad")?n.os="iOS":e.includes("Windows")||navigator.platform.includes("Win")?n.os="Windows":e.includes("Mac")||navigator.platform.includes("Mac")?n.os="macOS":(e.includes("Linux")||navigator.platform.includes("Linux"))&&(n.os="Linux");if(navigator.userAgentData&&typeof navigator.userAgentData.getHighEntropyValues=="function")try{const t=await navigator.userAgentData.getHighEntropyValues(["model","platformVersion","fullVersionList","architecture"]);t.model&&(n.deviceModel=t.model),t.architecture&&(n.platform=`${t.architecture} architecture`),(n.os==="macOS"||n.os==="iOS")&&(n.manufacturer="Apple"),n.os}catch(t){console.warn("Could not get high entropy hints",t)}n.fonts=nx(),n.plugins=Array.from(navigator.plugins||[]).map(t=>t.name),n.canvas=Gc(),n.webgl=Hc();try{const r=await(await fetch("https://api.ipify.org?format=json")).json();r.ip&&(n.ipAddress=r.ip)}catch{}return n}async function ex(){const n=await Hr(),e="paradigm_device_id";try{const{value:s}=await Ve.get({key:e});if(s)return s.toLowerCase()}catch(s){console.error("Error reading from Preferences:",s)}const t=localStorage.getItem(e);if(t){const s=t.toLowerCase();try{await Ve.set({key:e,value:s})}catch{}return s}if(n!=="web"){try{const o=await jn.getId();if(o.identifier){const a=o.identifier.toLowerCase();return await Ve.set({key:e,value:a}),a}}catch(o){console.error("Error getting native ID:",o)}return`mob-${Date.now()}-${Math.random().toString(36).slice(2,7)}`}const i=(await tx()).toLowerCase();try{await Ve.set({key:e,value:i})}catch{}return localStorage.setItem(e,i),i}async function tx(){const n=await Bc(),e=[navigator.userAgent,navigator.language,navigator.platform,String(window.screen.width),String(window.screen.height),String(window.screen.colorDepth),new Date().getTimezoneOffset(),n.canvas||"",n.webgl||"",n.hardwareModel||"",n.deviceModel||"",navigator.hardwareConcurrency||"unknown",navigator.deviceMemory||"unknown"];return rx(e.join("|"))}let an=null,zt=null;function Gc(){if(an!==null)return an;try{const n=document.createElement("canvas"),e=n.getContext("2d");if(!e)return an="","";const t="Paradigm Device Fingerprint ";return e.textBaseline="top",e.font='14px "Arial"',e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText(t,2,15),e.fillStyle="rgba(102, 204, 0, 0.7)",e.fillText(t,4,17),an=n.toDataURL().substring(0,50),an}catch{return an="",""}}function Hc(){if(zt!==null)return zt;try{const n=document.createElement("canvas"),e=n.getContext("webgl")||n.getContext("experimental-webgl");if(!e)return zt="","";const t=e.getExtension("WEBGL_debug_renderer_info");if(!t)return zt="","";const r=e.getParameter(t.UNMASKED_VENDOR_WEBGL),i=e.getParameter(t.UNMASKED_RENDERER_WEBGL);return zt=`${r}|${i}`.substring(0,50),zt}catch{return zt="",""}}function nx(){const n=["monospace","sans-serif","serif"],e=["Arial","Verdana","Times New Roman","Courier New","Georgia","Palatino","Garamond","Bookman","Comic Sans MS","Trebuchet MS","Impact","Lucida Console"],t=[],i=document.createElement("canvas").getContext("2d");if(!i)return t;for(const s of e){let o=!1;for(const a of n){i.font=`12px "${s}", ${a}`;const d=i.measureText("mmmmmmmmmmlli").width;i.font=`12px ${a}`;const u=i.measureText("mmmmmmmmmmlli").width;if(d!==u){o=!0;break}}o&&t.push(s)}return t}function rx(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e=(e<<5)-e+r,e=e&e}return Math.abs(e).toString(36)}function zc(n){const e=n.match(/\(([^)]+)\)/);if(e&&e[1]){const t=e[1].split(";");for(let r=t.length-1;r>=0;r--){let i=t[r].trim();i.includes("Build/")&&(i=i.split("Build/")[0].trim()),i.includes("build/")&&(i=i.split("build/")[0].trim()),i.includes("Build")&&(i=i.split("Build")[0].trim()),i.includes("build")&&(i=i.split("build")[0].trim());const s=i.toLowerCase();if(!(s.startsWith("android")&&/\d/.test(i))&&!s.includes("linux")&&!s.includes("wv")&&!s.includes("version")&&i.length>2&&i.length<35)return i}}return null}function wl(n){if(!n||n==="K"||n==="unknown"||n.includes("Android SDK"))return"Android Device";const t=n.toUpperCase().split(" ").filter(r=>!["WV","BUILD","VERSION","RELEASE"].includes(r)).join(" ");return t.includes("SM-F936")||t.includes("F936")?"Samsung Fold 4":t.includes("SM-F946")||t.includes("F946")?"Samsung Fold 5":t.includes("SM-F721")||t.includes("F721")?"Samsung Flip 4":t.includes("SM-F731")||t.includes("F731")?"Samsung Flip 5":t.includes("SM-S901")?"Samsung S22":t.includes("SM-S911")?"Samsung S23":t.includes("SM-S921")?"Samsung S24":t.includes("SM-S908")?"Samsung S22 Ultra":t.includes("SM-S918")?"Samsung S23 Ultra":t.includes("SM-S928")?"Samsung S24 Ultra":t.includes("SM-G98")?"Samsung S20":t.includes("SM-G99")?"Samsung S21":t.includes("PIXEL 4")?"Google Pixel 4":t.includes("PIXEL 5")?"Google Pixel 5":t.includes("PIXEL 6")?"Google Pixel 6":t.includes("PIXEL 7")?"Google Pixel 7":t.includes("PIXEL 8")?"Google Pixel 8":n}async function ix(){const n=await Hr(),e=await jc();if(n==="web"){const t=e.browser||"Browser",r=e.os||e.platform||"Unknown OS",i=e.hardwareModel||e.deviceModel;return r==="Android"&&i?`${wl(i)} (${t})`:r==="iOS"&&i?`${i} (${t})`:`${t} on ${r}`}else{let t=e.deviceModel||"",r=e.manufacturer||"";(r.includes("Mozilla")||r.toLowerCase().includes("unknown"))&&(r=""),r==="Google Inc"&&(r="Google"),(t.includes("Mozilla")||t.length>30||t.toLowerCase().includes("unknown"))&&(t="");const i=e.hardwareModel;if(n==="android"){let s="";const o=i||t;if(o){const a=wl(o);r&&!a.toLowerCase().includes(r.toLowerCase())?s=`${r} ${a}`:s=a}else r?s=`${r} Android`:s="Android Device";return s.length<=2?`Android ${s}`:s}else{let s="";return t&&r?s=r.toLowerCase().includes(t.toLowerCase())?t:`${r} ${t}`:t?s=t:r?s=`${r} iOS`:i?s=`${i} iOS`:s="iOS Device",s.length<=2?`iOS ${s}`:s}}}async function Gs(n){try{const{data:e,error:t}=await g.from("settings").select("attendance_settings").eq("id","singleton").single();if(t)throw t;const r=B.toCamelCase(e?.attendance_settings||{}),i=(n||"").toLowerCase();if(i==="admin"||i==="developer"){const o=r.admin;return o&&o.deviceLimits?o.deviceLimits:{web:5,android:5,ios:5}}if(["management","hr_ops","finance_manager","gm","ceo","director"].includes(i)){const o=r.management;return o&&o.deviceLimits?o.deviceLimits:{web:5,android:5,ios:5}}if(["field_staff","field_manager","field_executive"].includes(i)){const o=r.field;if(o&&o.deviceLimits)return o.deviceLimits}if(["site_staff","site_manager","security_guard"].includes(i)){const o=r.site;if(o&&o.deviceLimits)return o.deviceLimits}const s=r.office;return s&&s.deviceLimits?s.deviceLimits:{web:1,android:1,ios:1}}catch(e){return console.error("Error getting device limits:",e),{web:1,android:1,ios:1}}}async function ws(){const n=await ex(),e=await jc(),t=await Hr(),r=await ix();return{deviceIdentifier:n,deviceInfo:e,deviceType:t,deviceName:r}}async function Wc(n){try{const{data:e,error:t}=await g.from("user_devices").select(`
        *,
        approver:approved_by_id(name)
      `).eq("user_id",n).order("registered_at",{ascending:!1});if(t)throw t;return(e||[]).map(r=>({...r,userId:r.user_id,deviceType:r.device_type,deviceIdentifier:r.device_identifier,deviceName:r.device_name,deviceInfo:r.device_info||{},registeredAt:r.registered_at,lastUsedAt:r.last_used_at,approvedById:r.approved_by_id,approvedByName:r.approver?.name,approvedAt:r.approved_at,createdAt:r.created_at,updatedAt:r.updated_at}))}catch(e){throw console.error("Error fetching user devices:",e),e}}async function Hs(n,e){try{const{count:t,error:r}=await g.from("user_devices").select("*",{count:"exact",head:!0}).eq("user_id",n).eq("device_type",e).eq("status","active");if(r)throw r;return t||0}catch(t){return console.error("Error counting devices:",t),0}}async function Jc(n,e){try{const{data:t,error:r}=await g.from("user_devices").select("*").eq("user_id",n).ilike("device_identifier",e).order("last_used_at",{ascending:!1}).limit(1);if(r)throw r;const i=t&&t.length>0?t[0]:null;if(!i)return{authorized:!1,status:"not_found"};const s={...i,userId:i.user_id,deviceType:i.device_type,deviceIdentifier:i.device_identifier,deviceName:i.device_name,deviceInfo:i.device_info||{},registeredAt:i.registered_at,lastUsedAt:i.last_used_at,approvedById:i.approved_by_id,approvedAt:i.approved_at,createdAt:i.created_at,updatedAt:i.updated_at};return{authorized:s.status==="active",device:s,status:s.status}}catch(t){return console.error("Error checking device authorization:",t),{authorized:!1,status:"not_found"}}}async function Yc(n,e,t,r,i,s){try{const o=t.toLowerCase(),a=await Jc(n,o);if(a.device)if(a.status==="active"){const p=a.device.lastUsedAt?new Date(a.device.lastUsedAt).getTime():0,h=new Date().getTime(),y=3600*1e3;if(h-p>y)try{await B.sendDeviceChangeAlert(n,"","Previous Session",i)}catch(v){console.warn("Failed to send device switch alert:",v)}return await g.from("user_devices").update({last_used_at:new Date().toISOString(),device_info:s}).eq("id",a.device.id),{success:!0,device:a.device,requiresApproval:!1,message:"Device already registered and active"}}else{if(a.status==="pending")return{success:!1,requiresApproval:!0,message:"Device registration is pending approval"};if(a.status==="revoked")return{success:!1,requiresApproval:!0,message:"This device was previously revoked. Please contact admin or request re-activation."}}const d=await Gs(e),u=await Hs(n,r),m=d[r];if(u<m){const{data:p,error:h}=await g.from("user_devices").insert({user_id:n,device_type:r,device_identifier:o,device_name:i,device_info:s,status:"active",approved_by_id:n,approved_at:new Date().toISOString()}).select().single();if(h)throw h;await Xc(n,p.id,"registration",s);try{await B.sendDeviceChangeAlert(n,"","None (New)",i)}catch(y){console.warn("Failed to send device change alert:",y)}return{success:!0,device:{...p,userId:p.user_id,deviceType:p.device_type,deviceIdentifier:p.device_identifier,deviceName:p.device_name,deviceInfo:p.device_info||{},registeredAt:p.registered_at,lastUsedAt:p.last_used_at,approvedById:p.approved_by_id,approvedAt:p.approved_at,createdAt:p.created_at,updatedAt:p.updated_at},requiresApproval:!1,message:"Device registered successfully"}}else return{success:!1,requiresApproval:!0,message:`Device limit of ${m} reached for your role. Please request access to use this device.`}}catch(o){throw console.error("Error registering device:",o),o}}async function Kc(n,e,t,r,i){try{const{data:s}=await g.from("device_change_requests").select("*").eq("user_id",n).eq("device_identifier",t).eq("status","pending").maybeSingle();if(s)return{...s,userId:s.user_id,deviceType:s.device_type,deviceIdentifier:s.device_identifier,deviceName:s.device_name,deviceInfo:s.device_info||{},requestedAt:s.requested_at,reviewedById:s.reviewed_by_id,reviewedAt:s.reviewed_at,rejectionReason:s.rejection_reason,reportingManagerNotified:s.reporting_manager_notified,createdAt:s.created_at,updatedAt:s.updated_at};const{data:o,error:a}=await g.from("device_change_requests").insert({user_id:n,device_type:e,device_identifier:t,device_name:r,device_info:i,status:"pending"}).select().single();if(a)throw a;return await ux(o.id,n),{...o,userId:o.user_id,deviceType:o.device_type,deviceIdentifier:o.device_identifier,deviceName:o.device_name,deviceInfo:o.device_info||{},requestedAt:o.requested_at,reviewedById:o.reviewed_by_id,reviewedAt:o.reviewed_at,rejectionReason:o.rejection_reason,reportingManagerNotified:o.reporting_manager_notified,createdAt:o.created_at,updatedAt:o.updated_at}}catch(s){throw console.error("Error creating device change request:",s),s}}async function sx(){try{const{data:n,error:e}=await g.from("device_change_requests").select(`
        *,
        user:user_id(name, photo_url, role_id, reporting_manager_id),
        reviewer:reviewed_by_id(name)
      `).eq("status","pending").order("requested_at",{ascending:!1});if(e)throw e;return await Promise.all((n||[]).map(async r=>{let i;if(r.user?.reporting_manager_id){const{data:o}=await g.from("users").select("name").eq("id",r.user.reporting_manager_id).single();i=o?.name}const s=await Hs(r.user_id,r.device_type);return{...r,userId:r.user_id,userName:r.user?.name,userPhotoUrl:r.user?.photo_url,reportingManagerName:i,deviceType:r.device_type,deviceIdentifier:r.device_identifier,deviceName:r.device_name,deviceInfo:r.device_info||{},requestedAt:r.requested_at,reviewedById:r.reviewed_by_id,reviewedByName:r.reviewer?.name,reviewedAt:r.reviewed_at,rejectionReason:r.rejection_reason,reportingManagerNotified:r.reporting_manager_notified,createdAt:r.created_at,updatedAt:r.updated_at,currentDeviceCount:s}}))}catch(n){throw console.error("Error fetching pending requests:",n),n}}async function ox(n,e){try{const{data:t,error:r}=await g.from("device_change_requests").select("*").eq("id",n).single();if(r)throw r;if(!t)throw new Error("Request not found");const{data:i}=await g.from("user_devices").select("id").eq("user_id",t.user_id).eq("device_identifier",t.device_identifier).single();let s;if(i){const{data:a,error:d}=await g.from("user_devices").update({status:"active",device_name:t.device_name,device_info:t.device_info,approved_by_id:e,approved_at:new Date().toISOString(),last_used_at:new Date().toISOString()}).eq("id",i.id).select().single();if(d)throw d;s=a}else{const{data:a,error:d}=await g.from("user_devices").insert({user_id:t.user_id,device_type:t.device_type,device_identifier:t.device_identifier,device_name:t.device_name,device_info:t.device_info,status:"active",approved_by_id:e,approved_at:new Date().toISOString()}).select().single();if(d)throw d;s=a}const{error:o}=await g.from("device_change_requests").update({status:"approved",reviewed_by_id:e,reviewed_at:new Date().toISOString()}).eq("id",n);if(o)throw o;return await dx(t.user_id,t.device_name,e),{success:!0,device:{...s,userId:s.user_id,deviceType:s.device_type,deviceIdentifier:s.device_identifier,deviceName:s.device_name,deviceInfo:s.device_info||{},registeredAt:s.registered_at,lastUsedAt:s.last_used_at,approvedById:s.approved_by_id,approvedAt:s.approved_at,createdAt:s.created_at,updatedAt:s.updated_at}}}catch(t){throw console.error("Error approving device:",t),t}}async function ax(n,e,t){try{const{data:r,error:i}=await g.from("device_change_requests").select("*").eq("id",n).single();if(i)throw i;const{error:s}=await g.from("device_change_requests").update({status:"rejected",reviewed_by_id:e,reviewed_at:new Date().toISOString(),rejection_reason:t}).eq("id",n);if(s)throw s;return r&&await fx(r.user_id,r.device_name,t),{success:!0}}catch(r){throw console.error("Error rejecting device:",r),r}}async function Zc(n){try{const{error:e}=await g.from("user_devices").update({status:"revoked"}).eq("id",n);if(e)throw e;return{success:!0}}catch(e){throw console.error("Error revoking device:",e),e}}async function lx(n){try{const{error:e}=await g.from("user_devices").delete().eq("id",n);if(e)throw e;return{success:!0}}catch(e){throw console.error("Error deleting device:",e),e}}async function cx(n){try{await g.from("user_devices").update({last_used_at:new Date().toISOString()}).eq("id",n)}catch(e){console.error("Error updating device last used:",e)}}async function Xc(n,e,t,r,i){try{await g.from("device_activity_logs").insert({user_id:n,device_id:e,activity_type:t,device_info:r||{},ip_address:i})}catch(s){console.error("Error logging device activity:",s)}}async function ux(n,e){try{const{data:t}=await g.from("users").select("name, reporting_manager_id").eq("id",e).single();if(!t||!t.reporting_manager_id)return;await B.createNotification({userId:t.reporting_manager_id,title:" Device Access Request",message:`${t.name} has exceeded their device limit and requested access for a new device.`,type:"approval_request",link:"/user-management"})}catch(t){console.error("Error notifying device change request:",t)}}async function dx(n,e,t){try{await B.createNotification({userId:n,title:" Device Approved",message:`Your device "${e}" has been approved for use.`,type:"info"})}catch(r){console.error("Error notifying device approved:",r)}}async function fx(n,e,t){try{await B.createNotification({userId:n,title:" Device Request Rejected",message:`Your request for device "${e}" was rejected. Reason: ${t}`,type:"security"})}catch(r){console.error("Error notifying device rejected:",r)}}const mT=Object.freeze(Object.defineProperty({__proto__:null,approveDeviceRequest:ox,createDeviceChangeRequest:Kc,deleteDevice:lx,getActiveDeviceCount:Hs,getCurrentDevice:ws,getDeviceLimits:Gs,getPendingDeviceRequests:sx,getUserDevices:Wc,isDeviceAuthorized:Jc,logDeviceActivity:Xc,registerDevice:Yc,rejectDeviceRequest:ax,revokeDevice:Zc,updateDeviceLastUsed:cx},Symbol.toStringTag,{value:"Module"})),mx=({userId:n,deviceName:e,deviceType:t,status:r,onRequestAccess:i,onLogout:s,isRequestingAccess:o=!1,limits:a={web:1,android:1,ios:1},customMessage:d})=>{const[u,m]=U.useState([]),[p,h]=U.useState(!1);U.useEffect(()=>{(r==="limit_reached"||r==="not_found"||r==="pending")&&y()},[n,r]);const y=async()=>{try{h(!0);const w=(await Wc(n)).filter(C=>C.status==="active"),A=[],S=new Set;w.forEach(C=>{S.has(C.deviceIdentifier)||(A.push(C),S.add(C.deviceIdentifier))}),m(A)}catch(b){console.error("Error loading devices in dialog:",b)}finally{h(!1)}},v=async b=>{if(window.confirm("Remove this device and free up a slot?"))try{await Zc(b),await y()}catch{alert("Failed to remove device")}},x=(()=>{switch(r){case"not_found":return{title:"Device Not Registered",description:d||"This device is not registered for your account. Please check your registered devices or request access.",actionText:"Request Access",showRequestButton:!0};case"limit_reached":return{title:"Device Limit Reached",description:d||`You have reached your limit of authorized ${t} sessions. You can remove an older device below to continue, or request a limit increase from your manager.`,actionText:"Request Access",showRequestButton:!0};case"pending":return{title:"Approval Pending",description:d||f.jsxs(f.Fragment,{children:["You have a limit of 2 devices only. Use if you need to add one more device then remove one and continue with your limit or wait for management approval.",f.jsx("br",{}),f.jsx("br",{}),"If more devices need to be added, an administrator needs to give permission."]}),actionText:"Waiting for Approval",showRequestButton:!1};case"revoked":return{title:"Device Access Revoked",description:d||"Access from this device has been revoked. You can request access again if this was a mistake.",actionText:"Request Access",showRequestButton:!0};default:return{title:"Unauthorized Device",description:d||"You cannot access the application from this device.",actionText:"",showRequestButton:!1}}})();return f.jsxs("div",{className:"device-warning-overlay",children:[f.jsxs("div",{className:"device-warning-bg-blobs",children:[f.jsx("div",{className:"blob blob-1"}),f.jsx("div",{className:"blob blob-2"}),f.jsx("div",{className:"blob blob-3"})]}),f.jsxs("div",{className:"device-warning-card animate-fade-in-scale",children:[f.jsxs("div",{className:"device-warning-header",children:[f.jsx("div",{className:`device-warning-icon-wrapper status-${r}`,children:f.jsx(Ze,{size:32})}),f.jsx("h1",{className:"device-warning-title",children:x.title})]}),f.jsxs("div",{className:"device-warning-content",children:[f.jsxs("div",{className:"device-info-hero",children:[f.jsx("div",{className:"device-type-icon",children:t==="web"?f.jsx(Ji,{size:24}):f.jsx(wr,{size:24})}),f.jsxs("div",{className:"device-info-text",children:[f.jsx("span",{className:"device-label",children:"CURRENT DEVICE"}),f.jsx("p",{className:"device-name",title:e,children:e.length>40?`${e.substring(0,37)}...`:e}),f.jsx("span",{className:"device-type-tag",children:t==="web"?"Web Session":`${t.charAt(0).toUpperCase()+t.slice(1)} Session`})]})]}),f.jsx("p",{className:"device-warning-description",children:x.description}),f.jsxs("div",{className:"device-active-section",children:[f.jsxs("div",{className:"dw-section-header",children:[f.jsxs("h3",{children:["Active ",t==="web"?"Web":`${t.charAt(0).toUpperCase()+t.slice(1)}`," Devices"]}),f.jsxs("span",{className:"dw-limit-indicator",children:[u.filter(b=>b.deviceType===t).length," / ",a[t]]})]}),p?f.jsxs("div",{className:"loading-state",children:[f.jsx("div",{className:"spinner-small"}),f.jsx("span",{children:"Syncing devices..."})]}):u.filter(b=>b.deviceType===t).length>0?f.jsx("div",{className:"dw-device-grid",children:u.filter(b=>b.deviceType===t).map(b=>f.jsxs("div",{className:"dw-device-card",children:[f.jsx("div",{className:"dw-device-card-icon",children:t==="web"?f.jsx(Ji,{size:20}):f.jsx(wr,{size:20})}),f.jsxs("div",{className:"dw-device-card-info",children:[f.jsx("span",{className:"dw-device-card-name",title:b.deviceName,children:b.deviceName.length>30?`${b.deviceName.substring(0,27)}...`:b.deviceName}),f.jsx("span",{className:"dw-status-active",children:"Active"})]}),f.jsx("button",{onClick:()=>v(b.id),className:"dw-btn-remove-compact",children:"Remove"})]},b.id))}):f.jsx("div",{className:"empty-state-mini",children:f.jsxs("p",{children:["No other active ",t," devices."]})})]})]}),f.jsxs("div",{className:"device-warning-footer",children:[x.showRequestButton&&f.jsx("button",{className:"action-button-primary",onClick:i,disabled:o,children:o?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"spinner-small"}),f.jsx("span",{children:"Requesting..."})]}):f.jsxs(f.Fragment,{children:[f.jsx(Nd,{size:18}),f.jsx("span",{children:x.actionText})]})}),f.jsxs("button",{className:"action-button-primary action-button-logout",onClick:s,children:[f.jsx(ec,{size:18}),f.jsx("span",{children:"Logout"})]})]})]})]})},px=({children:n})=>{const{user:e}=De(),t=Yw(),[r,i]=U.useState(!1),[s,o]=U.useState("checking"),[a,d]=U.useState(null),[u,m]=U.useState(""),[p,h]=U.useState({web:1,android:1,ios:1}),[y,v]=U.useState(!1),_=U.useRef(null),x=e&&e.role==="developer";U.useEffect(()=>{if(e&&!x&&!t.isSecure&&!r){const w=t.developerModeEnabled?"developer_mode":"location_spoofing";B.sendSecurityAlert(e.id,e.name,w,void 0).catch(A=>console.error("Failed to send security alert:",A)),i(!0)}},[e,t,r,x]),U.useEffect(()=>{(async()=>{if(e&&_.current!==e.id)try{const[{deviceIdentifier:A,deviceType:S,deviceName:C,deviceInfo:N},D]=await Promise.all([ws(),Gs(e.role)]);h(D);const V=await Yc(e.id,e.role,A,S,C,N);V.success?(o("authorized"),_.current=e.id):V.request?(o("pending"),d({id:V.request.id,name:C,type:S}),m(V.message)):V.requiresApproval?(o("limit_reached"),d({id:"",name:C,type:S}),m(V.message)):(o("revoked"),d({id:"",name:C,type:S}),m(V.message||"Unable to register device. Please try again."))}catch(A){console.error("Device validation failed:",A),o("authorized"),_.current=e.id}})()},[e?.id]);const b=async()=>{if(e)try{v(!0);const{deviceIdentifier:w,deviceType:A,deviceName:S,deviceInfo:C}=await ws();await Kc(e.id,A,w,S,C),o("pending"),m("Your device access request has been submitted. Please wait for admin/HR approval.")}catch(w){console.error("Failed to request access:",w),w?.message?.includes("duplicate")||w?.code==="23505"?(o("pending"),m("You already have a pending request. Please wait for admin/HR approval.")):m("Failed to submit request. Please try again.")}finally{v(!1)}};return e&&!x&&!t.isSecure?f.jsx(Kw,{issues:t.issues}):e&&s!=="authorized"&&s!=="checking"?e.role==="developer"?f.jsx(f.Fragment,{children:n}):f.jsx(mx,{userId:e.id,status:s,deviceName:a?.name||"Unknown Device",deviceType:a?.type||"web",limits:p,customMessage:u,isRequestingAccess:y,onLogout:()=>De.getState().logout(),onRequestAccess:b}):e&&s==="checking"&&e.role!=="developer"?f.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-gray-50",children:f.jsxs("div",{className:"flex flex-col items-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary mb-4"}),f.jsx("p",{className:"text-gray-500 font-medium",children:"Verifying device..."})]})}):f.jsx(f.Fragment,{children:n})},hx=({onComplete:n})=>{const[e,t]=U.useState(!0);return U.useEffect(()=>{if(!Xe.isNativePlatform()){n();return}(async()=>{try{(await At.checkPermissions()).location!=="granted"&&await At.requestPermissions(),(await oo.checkPermissions()).camera!=="granted"&&await oo.requestPermissions();try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(a=>a.stop())}catch(o){console.warn("Microphone prompt skipped or denied",o)}}catch(i){console.error("Sequential permission request failed",i)}finally{t(!1),n()}})()},[n]),f.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white p-6 text-center animate-pulse",children:[f.jsx("div",{className:"splash-logo mb-8",children:f.jsx(Qt,{className:"h-16"})}),f.jsx("div",{className:"text-gray-500 font-medium",children:"Setting up secure environment..."}),f.jsx("p",{className:"text-xs text-gray-400 mt-4",children:"Please allow required permissions when prompted."})]})},gx=()=>{const[n,e]=U.useState(!1),t=()=>{e(!0)};return n?f.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white p-4",children:[f.jsx("div",{className:"splash-logo",children:f.jsx(Qt,{className:"h-16 mb-8"})}),f.jsx("p",{className:"text-gray-600",children:"Loading Application..."})]}):f.jsx(hx,{onComplete:t})};var Kn=n=>n.type==="checkbox",Jt=n=>n instanceof Date,Ke=n=>n==null;const Qc=n=>typeof n=="object";var Oe=n=>!Ke(n)&&!Array.isArray(n)&&Qc(n)&&!Jt(n),eu=n=>Oe(n)&&n.target?Kn(n.target)?n.target.checked:n.target.value:n,yx=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,tu=(n,e)=>n.has(yx(e)),_x=n=>{const e=n.constructor&&n.constructor.prototype;return Oe(e)&&e.hasOwnProperty("isPrototypeOf")},zs=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ke(n){let e;const t=Array.isArray(n),r=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(!(zs&&(n instanceof Blob||r))&&(t||Oe(n)))if(e=t?[]:Object.create(Object.getPrototypeOf(n)),!t&&!_x(n))e=n;else for(const i in n)n.hasOwnProperty(i)&&(e[i]=ke(n[i]));else return n;return e}var zr=n=>/^\w*$/.test(n),Ae=n=>n===void 0,Wr=n=>Array.isArray(n)?n.filter(Boolean):[],Ws=n=>Wr(n.replace(/["|']|\]/g,"").split(/\.|\[/)),z=(n,e,t)=>{if(!e||!Oe(n))return t;const r=(zr(e)?[e]:Ws(e)).reduce((i,s)=>Ke(i)?i:i[s],n);return Ae(r)||r===n?Ae(n[e])?t:n[e]:r},rt=n=>typeof n=="boolean",xe=(n,e,t)=>{let r=-1;const i=zr(e)?[e]:Ws(e),s=i.length,o=s-1;for(;++r<s;){const a=i[r];let d=t;if(r!==o){const u=n[a];d=Oe(u)||Array.isArray(u)?u:isNaN(+i[r+1])?{}:[]}if(a==="__proto__"||a==="constructor"||a==="prototype")return;n[a]=d,n=n[a]}};const Rr={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},ot={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ct={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},nu=Z.createContext(null);nu.displayName="HookFormContext";const Jr=()=>Z.useContext(nu);var ru=(n,e,t,r=!0)=>{const i={defaultValues:e._defaultValues};for(const s in n)Object.defineProperty(i,s,{get:()=>{const o=s;return e._proxyFormState[o]!==ot.all&&(e._proxyFormState[o]=!r||ot.all),t&&(t[o]=!0),n[o]}});return i};const Yr=typeof window<"u"?Z.useLayoutEffect:Z.useEffect;function vx(n){const e=Jr(),{control:t=e.control,disabled:r,name:i,exact:s}=n||{},[o,a]=Z.useState(t._formState),d=Z.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return Yr(()=>t._subscribe({name:i,formState:d.current,exact:s,callback:u=>{!r&&a({...t._formState,...u})}}),[i,r,s]),Z.useEffect(()=>{d.current.isValid&&t._setValid(!0)},[t]),Z.useMemo(()=>ru(o,t,d.current,!1),[o,t])}var it=n=>typeof n=="string",xs=(n,e,t,r,i)=>it(n)?(r&&e.watch.add(n),z(t,n,i)):Array.isArray(n)?n.map(s=>(r&&e.watch.add(s),z(t,s))):(r&&(e.watchAll=!0),t),bs=n=>Ke(n)||!Qc(n);function dt(n,e,t=new WeakSet){if(bs(n)||bs(e))return n===e;if(Jt(n)&&Jt(e))return n.getTime()===e.getTime();const r=Object.keys(n),i=Object.keys(e);if(r.length!==i.length)return!1;if(t.has(n)||t.has(e))return!0;t.add(n),t.add(e);for(const s of r){const o=n[s];if(!i.includes(s))return!1;if(s!=="ref"){const a=e[s];if(Jt(o)&&Jt(a)||Oe(o)&&Oe(a)||Array.isArray(o)&&Array.isArray(a)?!dt(o,a,t):o!==a)return!1}}return!0}function wx(n){const e=Jr(),{control:t=e.control,name:r,defaultValue:i,disabled:s,exact:o,compute:a}=n||{},d=Z.useRef(i),u=Z.useRef(a),m=Z.useRef(void 0),p=Z.useRef(t),h=Z.useRef(r);u.current=a;const[y,v]=Z.useState(()=>{const S=t._getWatch(r,d.current);return u.current?u.current(S):S}),_=Z.useCallback(S=>{const C=xs(r,t._names,S||t._formValues,!1,d.current);return u.current?u.current(C):C},[t._formValues,t._names,r]),x=Z.useCallback(S=>{if(!s){const C=xs(r,t._names,S||t._formValues,!1,d.current);if(u.current){const N=u.current(C);dt(N,m.current)||(v(N),m.current=N)}else v(C)}},[t._formValues,t._names,s,r]);Yr(()=>((p.current!==t||!dt(h.current,r))&&(p.current=t,h.current=r,x()),t._subscribe({name:r,formState:{values:!0},exact:o,callback:S=>{x(S.values)}})),[t,o,r,x]),Z.useEffect(()=>t._removeUnmounted());const b=p.current!==t,w=h.current,A=Z.useMemo(()=>{if(s)return null;const S=!b&&!dt(w,r);return b||S?_():null},[s,b,r,w,_]);return A!==null?A:y}function xx(n){const e=Jr(),{name:t,disabled:r,control:i=e.control,shouldUnregister:s,defaultValue:o}=n,a=tu(i._names.array,t),d=Z.useMemo(()=>z(i._formValues,t,z(i._defaultValues,t,o)),[i,t,o]),u=wx({control:i,name:t,defaultValue:d,exact:!0}),m=vx({control:i,name:t,exact:!0}),p=Z.useRef(n),h=Z.useRef(void 0),y=Z.useRef(i.register(t,{...n.rules,value:u,...rt(n.disabled)?{disabled:n.disabled}:{}}));p.current=n;const v=Z.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!z(m.errors,t)},isDirty:{enumerable:!0,get:()=>!!z(m.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!z(m.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!z(m.validatingFields,t)},error:{enumerable:!0,get:()=>z(m.errors,t)}}),[m,t]),_=Z.useCallback(A=>y.current.onChange({target:{value:eu(A),name:t},type:Rr.CHANGE}),[t]),x=Z.useCallback(()=>y.current.onBlur({target:{value:z(i._formValues,t),name:t},type:Rr.BLUR}),[t,i._formValues]),b=Z.useCallback(A=>{const S=z(i._fields,t);S&&A&&(S._f.ref={focus:()=>A.focus&&A.focus(),select:()=>A.select&&A.select(),setCustomValidity:C=>A.setCustomValidity(C),reportValidity:()=>A.reportValidity()})},[i._fields,t]),w=Z.useMemo(()=>({name:t,value:u,...rt(r)||m.disabled?{disabled:m.disabled||r}:{},onChange:_,onBlur:x,ref:b}),[t,r,m.disabled,_,x,b,u]);return Z.useEffect(()=>{const A=i._options.shouldUnregister||s,S=h.current;S&&S!==t&&!a&&i.unregister(S),i.register(t,{...p.current.rules,...rt(p.current.disabled)?{disabled:p.current.disabled}:{}});const C=(N,D)=>{const V=z(i._fields,N);V&&V._f&&(V._f.mount=D)};if(C(t,!0),A){const N=ke(z(i._options.defaultValues,t,p.current.defaultValue));xe(i._defaultValues,t,N),Ae(z(i._formValues,t))&&xe(i._formValues,t,N)}return!a&&i.register(t),h.current=t,()=>{(a?A&&!i._state.action:A)?i.unregister(t):C(t,!1)}},[t,i,a,s]),Z.useEffect(()=>{i._setDisabledField({disabled:r,name:t})},[r,t,i]),Z.useMemo(()=>({field:w,formState:m,fieldState:v}),[w,m,v])}const pT=n=>n.render(xx(n));var iu=(n,e,t,r,i)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[r]:i||!0}}:{},et=n=>Array.isArray(n)?n:[n],xl=()=>{let n=[];return{get observers(){return n},next:i=>{for(const s of n)s.next&&s.next(i)},subscribe:i=>(n.push(i),{unsubscribe:()=>{n=n.filter(s=>s!==i)}}),unsubscribe:()=>{n=[]}}};function su(n,e){const t={};for(const r in n)if(n.hasOwnProperty(r)){const i=n[r],s=e[r];if(i&&Oe(i)&&s){const o=su(i,s);Oe(o)&&(t[r]=o)}else n[r]&&(t[r]=s)}return t}var Ge=n=>Oe(n)&&!Object.keys(n).length,Js=n=>n.type==="file",ft=n=>typeof n=="function",Dr=n=>{if(!zs)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},ou=n=>n.type==="select-multiple",Ys=n=>n.type==="radio",bx=n=>Ys(n)||Kn(n),Ni=n=>Dr(n)&&n.isConnected;function Cx(n,e){const t=e.slice(0,-1).length;let r=0;for(;r<t;)n=Ae(n)?r++:n[e[r++]];return n}function Tx(n){for(const e in n)if(n.hasOwnProperty(e)&&!Ae(n[e]))return!1;return!0}function Le(n,e){const t=Array.isArray(e)?e:zr(e)?[e]:Ws(e),r=t.length===1?n:Cx(n,t),i=t.length-1,s=t[i];return r&&delete r[s],i!==0&&(Oe(r)&&Ge(r)||Array.isArray(r)&&Tx(r))&&Le(n,t.slice(0,-1)),n}var Sx=n=>{for(const e in n)if(ft(n[e]))return!0;return!1};function au(n){return Array.isArray(n)||Oe(n)&&!Sx(n)}function Cs(n,e={}){for(const t in n)au(n[t])?(e[t]=Array.isArray(n[t])?[]:{},Cs(n[t],e[t])):Ae(n[t])||(e[t]=!0);return e}function dn(n,e,t){t||(t=Cs(e));for(const r in n)au(n[r])?Ae(e)||bs(t[r])?t[r]=Cs(n[r],Array.isArray(n[r])?[]:{}):dn(n[r],Ke(e)?{}:e[r],t[r]):t[r]=!dt(n[r],e[r]);return t}const bl={value:!1,isValid:!1},Cl={value:!0,isValid:!0};var lu=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!Ae(n[0].attributes.value)?Ae(n[0].value)||n[0].value===""?Cl:{value:n[0].value,isValid:!0}:Cl:bl}return bl},cu=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:r})=>Ae(n)?n:e?n===""?NaN:n&&+n:t&&it(n)?new Date(n):r?r(n):n;const Tl={isValid:!1,value:null};var uu=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Tl):Tl;function Sl(n){const e=n.ref;return Js(e)?e.files:Ys(e)?uu(n.refs).value:ou(e)?[...e.selectedOptions].map(({value:t})=>t):Kn(e)?lu(n.refs).value:cu(Ae(e.value)?n.ref.value:e.value,n)}var Ex=(n,e,t,r)=>{const i={};for(const s of n){const o=z(e,s);o&&xe(i,s,o._f)}return{criteriaMode:t,names:[...n],fields:i,shouldUseNativeValidation:r}},Pr=n=>n instanceof RegExp,Dn=n=>Ae(n)?n:Pr(n)?n.source:Oe(n)?Pr(n.value)?n.value.source:n.value:n,pn=n=>({isOnSubmit:!n||n===ot.onSubmit,isOnBlur:n===ot.onBlur,isOnChange:n===ot.onChange,isOnAll:n===ot.all,isOnTouch:n===ot.onTouched});const El="AsyncFunction";var Ax=n=>!!n&&!!n.validate&&!!(ft(n.validate)&&n.validate.constructor.name===El||Oe(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===El)),kx=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),Ts=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(r=>n.startsWith(r)&&/^\.\w+/.test(n.slice(r.length))));const gn=(n,e,t,r)=>{for(const i of t||Object.keys(n)){const s=z(n,i);if(s){const{_f:o,...a}=s;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],i)&&!r)return!0;if(o.ref&&e(o.ref,o.name)&&!r)return!0;if(gn(a,e))break}else if(Oe(a)&&gn(a,e))break}}};function Al(n,e,t){const r=z(n,t);if(r||zr(t))return{error:r,name:t};const i=t.split(".");for(;i.length;){const s=i.join("."),o=z(e,s),a=z(n,s);if(o&&!Array.isArray(o)&&t!==s)return{name:t};if(a&&a.type)return{name:s,error:a};if(a&&a.root&&a.root.type)return{name:`${s}.root`,error:a.root};i.pop()}return{name:t}}var Ix=(n,e,t,r)=>{t(n);const{name:i,...s}=n;return Ge(s)||Object.keys(s).length>=Object.keys(e).length||Object.keys(s).find(o=>e[o]===(!r||ot.all))},Nx=(n,e,t)=>!n||!e||n===e||et(n).some(r=>r&&(t?r===e:r.startsWith(e)||e.startsWith(r))),Rx=(n,e,t,r,i)=>i.isOnAll?!1:!t&&i.isOnTouch?!(e||n):(t?r.isOnBlur:i.isOnBlur)?!n:(t?r.isOnChange:i.isOnChange)?n:!0,Dx=(n,e)=>!Wr(z(n,e)).length&&Le(n,e),du=(n,e,t)=>{const r=et(z(n,t));return xe(r,"root",e[t]),xe(n,t,r),n};function kl(n,e,t="validate"){if(it(n)||Array.isArray(n)&&n.every(it)||rt(n)&&!n)return{type:t,message:it(n)?n:"",ref:e}}var ln=n=>Oe(n)&&!Pr(n)?n:{value:n,message:""},Ss=async(n,e,t,r,i,s)=>{const{ref:o,refs:a,required:d,maxLength:u,minLength:m,min:p,max:h,pattern:y,validate:v,name:_,valueAsNumber:x,mount:b}=n._f,w=z(t,_);if(!b||e.has(_))return{};const A=a?a[0]:o,S=se=>{i&&A.reportValidity&&(A.setCustomValidity(rt(se)?"":se||""),A.reportValidity())},C={},N=Ys(o),D=Kn(o),V=N||D,O=(x||Js(o))&&Ae(o.value)&&Ae(w)||Dr(o)&&o.value===""||w===""||Array.isArray(w)&&!w.length,W=iu.bind(null,_,r,C),ne=(se,J,ie,pe=Ct.maxLength,_e=Ct.minLength)=>{const Ne=se?J:ie;C[_]={type:se?pe:_e,message:Ne,ref:o,...W(se?pe:_e,Ne)}};if(s?!Array.isArray(w)||!w.length:d&&(!V&&(O||Ke(w))||rt(w)&&!w||D&&!lu(a).isValid||N&&!uu(a).isValid)){const{value:se,message:J}=it(d)?{value:!!d,message:d}:ln(d);if(se&&(C[_]={type:Ct.required,message:J,ref:A,...W(Ct.required,J)},!r))return S(J),C}if(!O&&(!Ke(p)||!Ke(h))){let se,J;const ie=ln(h),pe=ln(p);if(!Ke(w)&&!isNaN(w)){const _e=o.valueAsNumber||w&&+w;Ke(ie.value)||(se=_e>ie.value),Ke(pe.value)||(J=_e<pe.value)}else{const _e=o.valueAsDate||new Date(w),Ne=I=>new Date(new Date().toDateString()+" "+I),Pe=o.type=="time",L=o.type=="week";it(ie.value)&&w&&(se=Pe?Ne(w)>Ne(ie.value):L?w>ie.value:_e>new Date(ie.value)),it(pe.value)&&w&&(J=Pe?Ne(w)<Ne(pe.value):L?w<pe.value:_e<new Date(pe.value))}if((se||J)&&(ne(!!se,ie.message,pe.message,Ct.max,Ct.min),!r))return S(C[_].message),C}if((u||m)&&!O&&(it(w)||s&&Array.isArray(w))){const se=ln(u),J=ln(m),ie=!Ke(se.value)&&w.length>+se.value,pe=!Ke(J.value)&&w.length<+J.value;if((ie||pe)&&(ne(ie,se.message,J.message),!r))return S(C[_].message),C}if(y&&!O&&it(w)){const{value:se,message:J}=ln(y);if(Pr(se)&&!w.match(se)&&(C[_]={type:Ct.pattern,message:J,ref:o,...W(Ct.pattern,J)},!r))return S(J),C}if(v){if(ft(v)){const se=await v(w,t),J=kl(se,A);if(J&&(C[_]={...J,...W(Ct.validate,J.message)},!r))return S(J.message),C}else if(Oe(v)){let se={};for(const J in v){if(!Ge(se)&&!r)break;const ie=kl(await v[J](w,t),A,J);ie&&(se={...ie,...W(J,ie.message)},S(ie.message),r&&(C[_]=se))}if(!Ge(se)&&(C[_]={ref:A,...se},!r))return C}}return S(!0),C};const Px={mode:ot.onSubmit,reValidateMode:ot.onChange,shouldFocusError:!0};function Mx(n={}){let e={...Px,...n},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:ft(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},i=Oe(e.defaultValues)||Oe(e.values)?ke(e.defaultValues||e.values)||{}:{},s=e.shouldUnregister?{}:ke(i),o={action:!1,mount:!1,watch:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},d,u=0;const m={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let p={...m};const h={array:xl(),state:xl()},y=e.criteriaMode===ot.all,v=T=>k=>{clearTimeout(u),u=setTimeout(T,k)},_=async T=>{if(!e.disabled&&(m.isValid||p.isValid||T)){const k=e.resolver?Ge((await D()).errors):await O(r,!0);k!==t.isValid&&h.state.next({isValid:k})}},x=(T,k)=>{!e.disabled&&(m.isValidating||m.validatingFields||p.isValidating||p.validatingFields)&&((T||Array.from(a.mount)).forEach(P=>{P&&(k?xe(t.validatingFields,P,k):Le(t.validatingFields,P))}),h.state.next({validatingFields:t.validatingFields,isValidating:!Ge(t.validatingFields)}))},b=(T,k=[],P,Q,Y=!0,H=!0)=>{if(Q&&P&&!e.disabled){if(o.action=!0,H&&Array.isArray(z(r,T))){const oe=P(z(r,T),Q.argA,Q.argB);Y&&xe(r,T,oe)}if(H&&Array.isArray(z(t.errors,T))){const oe=P(z(t.errors,T),Q.argA,Q.argB);Y&&xe(t.errors,T,oe),Dx(t.errors,T)}if((m.touchedFields||p.touchedFields)&&H&&Array.isArray(z(t.touchedFields,T))){const oe=P(z(t.touchedFields,T),Q.argA,Q.argB);Y&&xe(t.touchedFields,T,oe)}(m.dirtyFields||p.dirtyFields)&&(t.dirtyFields=dn(i,s)),h.state.next({name:T,isDirty:ne(T,k),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else xe(s,T,k)},w=(T,k)=>{xe(t.errors,T,k),h.state.next({errors:t.errors})},A=T=>{t.errors=T,h.state.next({errors:t.errors,isValid:!1})},S=(T,k,P,Q)=>{const Y=z(r,T);if(Y){const H=z(s,T,Ae(P)?z(i,T):P);Ae(H)||Q&&Q.defaultChecked||k?xe(s,T,k?H:Sl(Y._f)):ie(T,H),o.mount&&_()}},C=(T,k,P,Q,Y)=>{let H=!1,oe=!1;const Te={name:T};if(!e.disabled){if(!P||Q){(m.isDirty||p.isDirty)&&(oe=t.isDirty,t.isDirty=Te.isDirty=ne(),H=oe!==Te.isDirty);const Ee=dt(z(i,T),k);oe=!!z(t.dirtyFields,T),Ee?Le(t.dirtyFields,T):xe(t.dirtyFields,T,!0),Te.dirtyFields=t.dirtyFields,H=H||(m.dirtyFields||p.dirtyFields)&&oe!==!Ee}if(P){const Ee=z(t.touchedFields,T);Ee||(xe(t.touchedFields,T,P),Te.touchedFields=t.touchedFields,H=H||(m.touchedFields||p.touchedFields)&&Ee!==P)}H&&Y&&h.state.next(Te)}return H?Te:{}},N=(T,k,P,Q)=>{const Y=z(t.errors,T),H=(m.isValid||p.isValid)&&rt(k)&&t.isValid!==k;if(e.delayError&&P?(d=v(()=>w(T,P)),d(e.delayError)):(clearTimeout(u),d=null,P?xe(t.errors,T,P):Le(t.errors,T)),(P?!dt(Y,P):Y)||!Ge(Q)||H){const oe={...Q,...H&&rt(k)?{isValid:k}:{},errors:t.errors,name:T};t={...t,...oe},h.state.next(oe)}},D=async T=>{x(T,!0);const k=await e.resolver(s,e.context,Ex(T||a.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return x(T),k},V=async T=>{const{errors:k}=await D(T);if(T)for(const P of T){const Q=z(k,P);Q?xe(t.errors,P,Q):Le(t.errors,P)}else t.errors=k;return k},O=async(T,k,P={valid:!0})=>{for(const Q in T){const Y=T[Q];if(Y){const{_f:H,...oe}=Y;if(H){const Te=a.array.has(H.name),Ee=Y._f&&Ax(Y._f);Ee&&m.validatingFields&&x([H.name],!0);const st=await Ss(Y,a.disabled,s,y,e.shouldUseNativeValidation&&!k,Te);if(Ee&&m.validatingFields&&x([H.name]),st[H.name]&&(P.valid=!1,k))break;!k&&(z(st,H.name)?Te?du(t.errors,st,H.name):xe(t.errors,H.name,st[H.name]):Le(t.errors,H.name))}!Ge(oe)&&await O(oe,k,P)}}return P.valid},W=()=>{for(const T of a.unMount){const k=z(r,T);k&&(k._f.refs?k._f.refs.every(P=>!Ni(P)):!Ni(k._f.ref))&&Se(T)}a.unMount=new Set},ne=(T,k)=>!e.disabled&&(T&&k&&xe(s,T,k),!dt(I(),i)),se=(T,k,P)=>xs(T,a,{...o.mount?s:Ae(k)?i:it(T)?{[T]:k}:k},P,k),J=T=>Wr(z(o.mount?s:i,T,e.shouldUnregister?z(i,T,[]):[])),ie=(T,k,P={})=>{const Q=z(r,T);let Y=k;if(Q){const H=Q._f;H&&(!H.disabled&&xe(s,T,cu(k,H)),Y=Dr(H.ref)&&Ke(k)?"":k,ou(H.ref)?[...H.ref.options].forEach(oe=>oe.selected=Y.includes(oe.value)):H.refs?Kn(H.ref)?H.refs.forEach(oe=>{(!oe.defaultChecked||!oe.disabled)&&(Array.isArray(Y)?oe.checked=!!Y.find(Te=>Te===oe.value):oe.checked=Y===oe.value||!!Y)}):H.refs.forEach(oe=>oe.checked=oe.value===Y):Js(H.ref)?H.ref.value="":(H.ref.value=Y,H.ref.type||h.state.next({name:T,values:ke(s)})))}(P.shouldDirty||P.shouldTouch)&&C(T,Y,P.shouldTouch,P.shouldDirty,!0),P.shouldValidate&&L(T)},pe=(T,k,P)=>{for(const Q in k){if(!k.hasOwnProperty(Q))return;const Y=k[Q],H=T+"."+Q,oe=z(r,H);(a.array.has(T)||Oe(Y)||oe&&!oe._f)&&!Jt(Y)?pe(H,Y,P):ie(H,Y,P)}},_e=(T,k,P={})=>{const Q=z(r,T),Y=a.array.has(T),H=ke(k);xe(s,T,H),Y?(h.array.next({name:T,values:ke(s)}),(m.isDirty||m.dirtyFields||p.isDirty||p.dirtyFields)&&P.shouldDirty&&h.state.next({name:T,dirtyFields:dn(i,s),isDirty:ne(T,H)})):Q&&!Q._f&&!Ke(H)?pe(T,H,P):ie(T,H,P),Ts(T,a)&&h.state.next({...t,name:T}),h.state.next({name:o.mount?T:void 0,values:ke(s)})},Ne=async T=>{o.mount=!0;const k=T.target;let P=k.name,Q=!0;const Y=z(r,P),H=Ee=>{Q=Number.isNaN(Ee)||Jt(Ee)&&isNaN(Ee.getTime())||dt(Ee,z(s,P,Ee))},oe=pn(e.mode),Te=pn(e.reValidateMode);if(Y){let Ee,st;const Zn=k.type?Sl(Y._f):eu(T),Pt=T.type===Rr.BLUR||T.type===Rr.FOCUS_OUT,Ku=!kx(Y._f)&&!e.resolver&&!z(t.errors,P)&&!Y._f.deps||Rx(Pt,z(t.touchedFields,P),t.isSubmitted,Te,oe),Qr=Ts(P,a,Pt);xe(s,P,Zn),Pt?(!k||!k.readOnly)&&(Y._f.onBlur&&Y._f.onBlur(T),d&&d(0)):Y._f.onChange&&Y._f.onChange(T);const ei=C(P,Zn,Pt),Zu=!Ge(ei)||Qr;if(!Pt&&h.state.next({name:P,type:T.type,values:ke(s)}),Ku)return(m.isValid||p.isValid)&&(e.mode==="onBlur"?Pt&&_():Pt||_()),Zu&&h.state.next({name:P,...Qr?{}:ei});if(!Pt&&Qr&&h.state.next({...t}),e.resolver){const{errors:no}=await D([P]);if(H(Zn),Q){const Xu=Al(t.errors,r,P),ro=Al(no,r,Xu.name||P);Ee=ro.error,P=ro.name,st=Ge(no)}}else x([P],!0),Ee=(await Ss(Y,a.disabled,s,y,e.shouldUseNativeValidation))[P],x([P]),H(Zn),Q&&(Ee?st=!1:(m.isValid||p.isValid)&&(st=await O(r,!0)));Q&&(Y._f.deps&&(!Array.isArray(Y._f.deps)||Y._f.deps.length>0)&&L(Y._f.deps),N(P,st,Ee,ei))}},Pe=(T,k)=>{if(z(t.errors,k)&&T.focus)return T.focus(),1},L=async(T,k={})=>{let P,Q;const Y=et(T);if(e.resolver){const H=await V(Ae(T)?T:Y);P=Ge(H),Q=T?!Y.some(oe=>z(H,oe)):P}else T?(Q=(await Promise.all(Y.map(async H=>{const oe=z(r,H);return await O(oe&&oe._f?{[H]:oe}:oe)}))).every(Boolean),!(!Q&&!t.isValid)&&_()):Q=P=await O(r);return h.state.next({...!it(T)||(m.isValid||p.isValid)&&P!==t.isValid?{}:{name:T},...e.resolver||!T?{isValid:P}:{},errors:t.errors}),k.shouldFocus&&!Q&&gn(r,Pe,T?Y:a.mount),Q},I=(T,k)=>{let P={...o.mount?s:i};return k&&(P=su(k.dirtyFields?t.dirtyFields:t.touchedFields,P)),Ae(T)?P:it(T)?z(P,T):T.map(Q=>z(P,Q))},$=(T,k)=>({invalid:!!z((k||t).errors,T),isDirty:!!z((k||t).dirtyFields,T),error:z((k||t).errors,T),isValidating:!!z(t.validatingFields,T),isTouched:!!z((k||t).touchedFields,T)}),E=T=>{T&&et(T).forEach(k=>Le(t.errors,k)),h.state.next({errors:T?t.errors:{}})},q=(T,k,P)=>{const Q=(z(r,T,{_f:{}})._f||{}).ref,Y=z(t.errors,T)||{},{ref:H,message:oe,type:Te,...Ee}=Y;xe(t.errors,T,{...Ee,...k,ref:Q}),h.state.next({name:T,errors:t.errors,isValid:!1}),P&&P.shouldFocus&&Q&&Q.focus&&Q.focus()},ee=(T,k)=>ft(T)?h.state.subscribe({next:P=>"values"in P&&T(se(void 0,k),P)}):se(T,k,!0),he=T=>h.state.subscribe({next:k=>{Nx(T.name,k.name,T.exact)&&Ix(k,T.formState||m,nn,T.reRenderRoot)&&T.callback({values:{...s},...t,...k,defaultValues:i})}}).unsubscribe,me=T=>(o.mount=!0,p={...p,...T.formState},he({...T,formState:p})),Se=(T,k={})=>{for(const P of T?et(T):a.mount)a.mount.delete(P),a.array.delete(P),k.keepValue||(Le(r,P),Le(s,P)),!k.keepError&&Le(t.errors,P),!k.keepDirty&&Le(t.dirtyFields,P),!k.keepTouched&&Le(t.touchedFields,P),!k.keepIsValidating&&Le(t.validatingFields,P),!e.shouldUnregister&&!k.keepDefaultValue&&Le(i,P);h.state.next({values:ke(s)}),h.state.next({...t,...k.keepDirty?{isDirty:ne()}:{}}),!k.keepIsValid&&_()},be=({disabled:T,name:k})=>{(rt(T)&&o.mount||T||a.disabled.has(k))&&(T?a.disabled.add(k):a.disabled.delete(k))},ae=(T,k={})=>{let P=z(r,T);const Q=rt(k.disabled)||rt(e.disabled);return xe(r,T,{...P||{},_f:{...P&&P._f?P._f:{ref:{name:T}},name:T,mount:!0,...k}}),a.mount.add(T),P?be({disabled:rt(k.disabled)?k.disabled:e.disabled,name:T}):S(T,!0,k.value),{...Q?{disabled:k.disabled||e.disabled}:{},...e.progressive?{required:!!k.required,min:Dn(k.min),max:Dn(k.max),minLength:Dn(k.minLength),maxLength:Dn(k.maxLength),pattern:Dn(k.pattern)}:{},name:T,onChange:Ne,onBlur:Ne,ref:Y=>{if(Y){ae(T,k),P=z(r,T);const H=Ae(Y.value)&&Y.querySelectorAll&&Y.querySelectorAll("input,select,textarea")[0]||Y,oe=bx(H),Te=P._f.refs||[];if(oe?Te.find(Ee=>Ee===H):H===P._f.ref)return;xe(r,T,{_f:{...P._f,...oe?{refs:[...Te.filter(Ni),H,...Array.isArray(z(i,T))?[{}]:[]],ref:{type:H.type,name:T}}:{ref:H}}}),S(T,!1,void 0,H)}else P=z(r,T,{}),P._f&&(P._f.mount=!1),(e.shouldUnregister||k.shouldUnregister)&&!(tu(a.array,T)&&o.action)&&a.unMount.add(T)}}},le=()=>e.shouldFocusError&&gn(r,Pe,a.mount),ve=T=>{rt(T)&&(h.state.next({disabled:T}),gn(r,(k,P)=>{const Q=z(r,P);Q&&(k.disabled=Q._f.disabled||T,Array.isArray(Q._f.refs)&&Q._f.refs.forEach(Y=>{Y.disabled=Q._f.disabled||T}))},0,!1))},Me=(T,k)=>async P=>{let Q;P&&(P.preventDefault&&P.preventDefault(),P.persist&&P.persist());let Y=ke(s);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:H,values:oe}=await D();t.errors=H,Y=ke(oe)}else await O(r);if(a.disabled.size)for(const H of a.disabled)Le(Y,H);if(Le(t.errors,"root"),Ge(t.errors)){h.state.next({errors:{}});try{await T(Y,P)}catch(H){Q=H}}else k&&await k({...t.errors},P),le(),setTimeout(le);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ge(t.errors)&&!Q,submitCount:t.submitCount+1,errors:t.errors}),Q)throw Q},qe=(T,k={})=>{z(r,T)&&(Ae(k.defaultValue)?_e(T,ke(z(i,T))):(_e(T,k.defaultValue),xe(i,T,ke(k.defaultValue))),k.keepTouched||Le(t.touchedFields,T),k.keepDirty||(Le(t.dirtyFields,T),t.isDirty=k.defaultValue?ne(T,ke(z(i,T))):ne()),k.keepError||(Le(t.errors,T),m.isValid&&_()),h.state.next({...t}))},je=(T,k={})=>{const P=T?ke(T):i,Q=ke(P),Y=Ge(T),H=Y?i:Q;if(k.keepDefaultValues||(i=P),!k.keepValues){if(k.keepDirtyValues){const oe=new Set([...a.mount,...Object.keys(dn(i,s))]);for(const Te of Array.from(oe))z(t.dirtyFields,Te)?xe(H,Te,z(s,Te)):_e(Te,z(H,Te))}else{if(zs&&Ae(T))for(const oe of a.mount){const Te=z(r,oe);if(Te&&Te._f){const Ee=Array.isArray(Te._f.refs)?Te._f.refs[0]:Te._f.ref;if(Dr(Ee)){const st=Ee.closest("form");if(st){st.reset();break}}}}if(k.keepFieldsRef)for(const oe of a.mount)_e(oe,z(H,oe));else r={}}s=e.shouldUnregister?k.keepDefaultValues?ke(i):{}:ke(H),h.array.next({values:{...H}}),h.state.next({values:{...H}})}a={mount:k.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!m.isValid||!!k.keepIsValid||!!k.keepDirtyValues||!e.shouldUnregister&&!Ge(H),o.watch=!!e.shouldUnregister,h.state.next({submitCount:k.keepSubmitCount?t.submitCount:0,isDirty:Y?!1:k.keepDirty?t.isDirty:!!(k.keepDefaultValues&&!dt(T,i)),isSubmitted:k.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:Y?{}:k.keepDirtyValues?k.keepDefaultValues&&s?dn(i,s):t.dirtyFields:k.keepDefaultValues&&T?dn(i,T):k.keepDirty?t.dirtyFields:{},touchedFields:k.keepTouched?t.touchedFields:{},errors:k.keepErrors?t.errors:{},isSubmitSuccessful:k.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},tn=(T,k)=>je(ft(T)?T(s):T,k),Dt=(T,k={})=>{const P=z(r,T),Q=P&&P._f;if(Q){const Y=Q.refs?Q.refs[0]:Q.ref;Y.focus&&(Y.focus(),k.shouldSelect&&ft(Y.select)&&Y.select())}},nn=T=>{t={...t,...T}},yt={control:{register:ae,unregister:Se,getFieldState:$,handleSubmit:Me,setError:q,_subscribe:he,_runSchema:D,_focusError:le,_getWatch:se,_getDirty:ne,_setValid:_,_setFieldArray:b,_setDisabledField:be,_setErrors:A,_getFieldArray:J,_reset:je,_resetDefaultValues:()=>ft(e.defaultValues)&&e.defaultValues().then(T=>{tn(T,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:W,_disableForm:ve,_subjects:h,_proxyFormState:m,get _fields(){return r},get _formValues(){return s},get _state(){return o},set _state(T){o=T},get _defaultValues(){return i},get _names(){return a},set _names(T){a=T},get _formState(){return t},get _options(){return e},set _options(T){e={...e,...T}}},subscribe:me,trigger:L,register:ae,handleSubmit:Me,watch:ee,setValue:_e,getValues:I,reset:tn,resetField:qe,clearErrors:E,unregister:Se,setError:q,setFocus:Dt,getFieldState:$};return{...yt,formControl:yt}}var Mt=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const n=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=(Math.random()*16+n)%16|0;return(e=="x"?t:t&3|8).toString(16)})},Ri=(n,e,t={})=>t.shouldFocus||Ae(t.shouldFocus)?t.focusName||`${n}.${Ae(t.focusIndex)?e:t.focusIndex}.`:"",Di=(n,e)=>[...n,...et(e)],Pi=n=>Array.isArray(n)?n.map(()=>{}):void 0;function Mi(n,e,t){return[...n.slice(0,e),...et(t),...n.slice(e)]}var Li=(n,e,t)=>Array.isArray(n)?(Ae(n[t])&&(n[t]=void 0),n.splice(t,0,n.splice(e,1)[0]),n):[],$i=(n,e)=>[...et(e),...et(n)];function Lx(n,e){let t=0;const r=[...n];for(const i of e)r.splice(i-t,1),t++;return Wr(r).length?r:[]}var Fi=(n,e)=>Ae(e)?[]:Lx(n,et(e).sort((t,r)=>t-r)),Oi=(n,e,t)=>{[n[e],n[t]]=[n[t],n[e]]},Il=(n,e,t)=>(n[e]=t,n);function hT(n){const e=Jr(),{control:t=e.control,name:r,keyName:i="id",shouldUnregister:s,rules:o}=n,[a,d]=Z.useState(t._getFieldArray(r)),u=Z.useRef(t._getFieldArray(r).map(Mt)),m=Z.useRef(!1);t._names.array.add(r),Z.useMemo(()=>o&&a.length>=0&&t.register(r,o),[t,r,a.length,o]),Yr(()=>t._subjects.array.subscribe({next:({values:S,name:C})=>{if(C===r||!C){const N=z(S,r);Array.isArray(N)&&(d(N),u.current=N.map(Mt))}}}).unsubscribe,[t,r]);const p=Z.useCallback(S=>{m.current=!0,t._setFieldArray(r,S)},[t,r]),h=(S,C)=>{const N=et(ke(S)),D=Di(t._getFieldArray(r),N);t._names.focus=Ri(r,D.length-1,C),u.current=Di(u.current,N.map(Mt)),p(D),d(D),t._setFieldArray(r,D,Di,{argA:Pi(S)})},y=(S,C)=>{const N=et(ke(S)),D=$i(t._getFieldArray(r),N);t._names.focus=Ri(r,0,C),u.current=$i(u.current,N.map(Mt)),p(D),d(D),t._setFieldArray(r,D,$i,{argA:Pi(S)})},v=S=>{const C=Fi(t._getFieldArray(r),S);u.current=Fi(u.current,S),p(C),d(C),!Array.isArray(z(t._fields,r))&&xe(t._fields,r,void 0),t._setFieldArray(r,C,Fi,{argA:S})},_=(S,C,N)=>{const D=et(ke(C)),V=Mi(t._getFieldArray(r),S,D);t._names.focus=Ri(r,S,N),u.current=Mi(u.current,S,D.map(Mt)),p(V),d(V),t._setFieldArray(r,V,Mi,{argA:S,argB:Pi(C)})},x=(S,C)=>{const N=t._getFieldArray(r);Oi(N,S,C),Oi(u.current,S,C),p(N),d(N),t._setFieldArray(r,N,Oi,{argA:S,argB:C},!1)},b=(S,C)=>{const N=t._getFieldArray(r);Li(N,S,C),Li(u.current,S,C),p(N),d(N),t._setFieldArray(r,N,Li,{argA:S,argB:C},!1)},w=(S,C)=>{const N=ke(C),D=Il(t._getFieldArray(r),S,N);u.current=[...D].map((V,O)=>!V||O===S?Mt():u.current[O]),p(D),d([...D]),t._setFieldArray(r,D,Il,{argA:S,argB:N},!0,!1)},A=S=>{const C=et(ke(S));u.current=C.map(Mt),p([...C]),d([...C]),t._setFieldArray(r,[...C],N=>N,{},!0,!1)};return Z.useEffect(()=>{if(t._state.action=!1,Ts(r,t._names)&&t._subjects.state.next({...t._formState}),m.current&&(!pn(t._options.mode).isOnSubmit||t._formState.isSubmitted)&&!pn(t._options.reValidateMode).isOnSubmit)if(t._options.resolver)t._runSchema([r]).then(S=>{const C=z(S.errors,r),N=z(t._formState.errors,r);(N?!C&&N.type||C&&(N.type!==C.type||N.message!==C.message):C&&C.type)&&(C?xe(t._formState.errors,r,C):Le(t._formState.errors,r),t._subjects.state.next({errors:t._formState.errors}))});else{const S=z(t._fields,r);S&&S._f&&!(pn(t._options.reValidateMode).isOnSubmit&&pn(t._options.mode).isOnSubmit)&&Ss(S,t._names.disabled,t._formValues,t._options.criteriaMode===ot.all,t._options.shouldUseNativeValidation,!0).then(C=>!Ge(C)&&t._subjects.state.next({errors:du(t._formState.errors,C,r)}))}t._subjects.state.next({name:r,values:ke(t._formValues)}),t._names.focus&&gn(t._fields,(S,C)=>{if(t._names.focus&&C.startsWith(t._names.focus)&&S.focus)return S.focus(),1}),t._names.focus="",t._setValid(),m.current=!1},[a,r,t]),Z.useEffect(()=>(!z(t._formValues,r)&&t._setFieldArray(r),()=>{const S=(C,N)=>{const D=z(t._fields,C);D&&D._f&&(D._f.mount=N)};t._options.shouldUnregister||s?t.unregister(r):S(r,!1)}),[r,t,i,s]),{swap:Z.useCallback(x,[p,r,t]),move:Z.useCallback(b,[p,r,t]),prepend:Z.useCallback(y,[p,r,t]),append:Z.useCallback(h,[p,r,t]),remove:Z.useCallback(v,[p,r,t]),insert:Z.useCallback(_,[p,r,t]),update:Z.useCallback(w,[p,r,t]),replace:Z.useCallback(A,[p,r,t]),fields:Z.useMemo(()=>a.map((S,C)=>({...S,[i]:u.current[C]||Mt()})),[a,i])}}function $x(n={}){const e=Z.useRef(void 0),t=Z.useRef(void 0),[r,i]=Z.useState({isDirty:!1,isValidating:!1,isLoading:ft(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:ft(n.defaultValues)?void 0:n.defaultValues});if(!e.current)if(n.formControl)e.current={...n.formControl,formState:r},n.defaultValues&&!ft(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions);else{const{formControl:o,...a}=Mx(n);e.current={...a,formState:r}}const s=e.current.control;return s._options=n,Yr(()=>{const o=s._subscribe({formState:s._proxyFormState,callback:()=>i({...s._formState}),reRenderRoot:!0});return i(a=>({...a,isReady:!0})),s._formState.isReady=!0,o},[s]),Z.useEffect(()=>s._disableForm(n.disabled),[s,n.disabled]),Z.useEffect(()=>{n.mode&&(s._options.mode=n.mode),n.reValidateMode&&(s._options.reValidateMode=n.reValidateMode)},[s,n.mode,n.reValidateMode]),Z.useEffect(()=>{n.errors&&(s._setErrors(n.errors),s._focusError())},[s,n.errors]),Z.useEffect(()=>{n.shouldUnregister&&s._subjects.state.next({values:s._getWatch()})},[s,n.shouldUnregister]),Z.useEffect(()=>{if(s._proxyFormState.isDirty){const o=s._getDirty();o!==r.isDirty&&s._subjects.state.next({isDirty:o})}},[s,r.isDirty]),Z.useEffect(()=>{n.values&&!dt(n.values,t.current)?(s._reset(n.values,{keepFieldsRef:!0,...s._options.resetOptions}),t.current=n.values,i(o=>({...o}))):s._resetDefaultValues()},[s,n.values]),Z.useEffect(()=>{s._state.mount||(s._setValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),e.current.formState=ru(r,s),e.current}const Nl=(n,e,t)=>{if(n&&"reportValidity"in n){const r=z(t,e);n.setCustomValidity(r&&r.message||""),n.reportValidity()}},fu=(n,e)=>{for(const t in e.fields){const r=e.fields[t];r&&r.ref&&"reportValidity"in r.ref?Nl(r.ref,t,n):r.refs&&r.refs.forEach(i=>Nl(i,t,n))}},Fx=(n,e)=>{e.shouldUseNativeValidation&&fu(n,e);const t={};for(const r in n){const i=z(e.fields,r),s=Object.assign(n[r]||{},{ref:i&&i.ref});if(Ox(e.names||Object.keys(n),r)){const o=Object.assign({},z(t,r));xe(o,"root",s),xe(t,r,o)}else xe(t,r,s)}return t},Ox=(n,e)=>n.some(t=>t.startsWith(e+"."));function Vx(n,e,t){return e===void 0&&(e={}),t===void 0&&(t={}),function(r,i,s){try{return Promise.resolve((function(o,a){try{var d=(e.context,Promise.resolve(n[t.mode==="sync"?"validateSync":"validate"](r,Object.assign({abortEarly:!1},e,{context:i}))).then(function(u){return s.shouldUseNativeValidation&&fu({},s),{values:t.raw?r:u,errors:{}}}))}catch(u){return a(u)}return d&&d.then?d.then(void 0,a):d})(0,function(o){if(!o.inner)throw o;return{values:{},errors:Fx((a=o,d=!s.shouldUseNativeValidation&&s.criteriaMode==="all",(a.inner||[]).reduce(function(u,m){if(u[m.path]||(u[m.path]={message:m.message,type:m.type}),d){var p=u[m.path].types,h=p&&p[m.type];u[m.path]=iu(m.path,d,u,m.type,h?[].concat(h,m.message):m.message)}return u},{})),s)};var a,d}))}catch(o){return Promise.reject(o)}}}var Vi,Rl;function Ux(){if(Rl)return Vi;Rl=1;function n(b){this._maxSize=b,this.clear()}n.prototype.clear=function(){this._size=0,this._values=Object.create(null)},n.prototype.get=function(b){return this._values[b]},n.prototype.set=function(b,w){return this._size>=this._maxSize&&this.clear(),b in this._values||this._size++,this._values[b]=w};var e=/[^.^\]^[]+|(?=\[\]|\.\.)/g,t=/^\d+$/,r=/^\d/,i=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,s=/^\s*(['"]?)(.*?)(\1)\s*$/,o=512,a=new n(o),d=new n(o),u=new n(o);Vi={Cache:n,split:p,normalizePath:m,setter:function(b){var w=m(b);return d.get(b)||d.set(b,function(S,C){for(var N=0,D=w.length,V=S;N<D-1;){var O=w[N];if(O==="__proto__"||O==="constructor"||O==="prototype")return S;V=V[w[N++]]}V[w[N]]=C})},getter:function(b,w){var A=m(b);return u.get(b)||u.set(b,function(C){for(var N=0,D=A.length;N<D;)if(C!=null||!w)C=C[A[N++]];else return;return C})},join:function(b){return b.reduce(function(w,A){return w+(y(A)||t.test(A)?"["+A+"]":(w?".":"")+A)},"")},forEach:function(b,w,A){h(Array.isArray(b)?b:p(b),w,A)}};function m(b){return a.get(b)||a.set(b,p(b).map(function(w){return w.replace(s,"$2")}))}function p(b){return b.match(e)||[""]}function h(b,w,A){var S=b.length,C,N,D,V;for(N=0;N<S;N++)C=b[N],C&&(x(C)&&(C='"'+C+'"'),V=y(C),D=!V&&/^\d+$/.test(C),w.call(A,C,V,D,N,b))}function y(b){return typeof b=="string"&&b&&["'",'"'].indexOf(b.charAt(0))!==-1}function v(b){return b.match(r)&&!b.match(t)}function _(b){return i.test(b)}function x(b){return!y(b)&&(v(b)||_(b))}return Vi}var Yt=Ux(),Ui,Dl;function qx(){if(Dl)return Ui;Dl=1;const n=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,e=m=>m.match(n)||[],t=m=>m[0].toUpperCase()+m.slice(1),r=(m,p)=>e(m).join(p).toLowerCase(),i=m=>e(m).reduce((p,h)=>`${p}${p?h[0].toUpperCase()+h.slice(1).toLowerCase():h.toLowerCase()}`,"");return Ui={words:e,upperFirst:t,camelCase:i,pascalCase:m=>t(i(m)),snakeCase:m=>r(m,"_"),kebabCase:m=>r(m,"-"),sentenceCase:m=>t(r(m," ")),titleCase:m=>e(m).map(t).join(" ")},Ui}var qi=qx(),sr={exports:{}},Pl;function jx(){if(Pl)return sr.exports;Pl=1,sr.exports=function(i){return n(e(i),i)},sr.exports.array=n;function n(i,s){var o=i.length,a=new Array(o),d={},u=o,m=t(s),p=r(i);for(s.forEach(function(y){if(!p.has(y[0])||!p.has(y[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});u--;)d[u]||h(i[u],u,new Set);return a;function h(y,v,_){if(_.has(y)){var x;try{x=", node was:"+JSON.stringify(y)}catch{x=""}throw new Error("Cyclic dependency"+x)}if(!p.has(y))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(y));if(!d[v]){d[v]=!0;var b=m.get(y)||new Set;if(b=Array.from(b),v=b.length){_.add(y);do{var w=b[--v];h(w,p.get(w),_)}while(v);_.delete(y)}a[--o]=y}}}function e(i){for(var s=new Set,o=0,a=i.length;o<a;o++){var d=i[o];s.add(d[0]),s.add(d[1])}return Array.from(s)}function t(i){for(var s=new Map,o=0,a=i.length;o<a;o++){var d=i[o];s.has(d[0])||s.set(d[0],new Set),s.has(d[1])||s.set(d[1],new Set),s.get(d[0]).add(d[1])}return s}function r(i){for(var s=new Map,o=0,a=i.length;o<a;o++)s.set(i[o],o);return s}return sr.exports}var Bx=jx();const Gx=oc(Bx),Hx=Object.prototype.toString,zx=Error.prototype.toString,Wx=RegExp.prototype.toString,Jx=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",Yx=/^Symbol\((.*)\)(.*)$/;function Kx(n){return n!=+n?"NaN":n===0&&1/n<0?"-0":""+n}function Ml(n,e=!1){if(n==null||n===!0||n===!1)return""+n;const t=typeof n;if(t==="number")return Kx(n);if(t==="string")return e?`"${n}"`:n;if(t==="function")return"[Function "+(n.name||"anonymous")+"]";if(t==="symbol")return Jx.call(n).replace(Yx,"Symbol($1)");const r=Hx.call(n).slice(8,-1);return r==="Date"?isNaN(n.getTime())?""+n:n.toISOString(n):r==="Error"||n instanceof Error?"["+zx.call(n)+"]":r==="RegExp"?Wx.call(n):null}function It(n,e){let t=Ml(n,e);return t!==null?t:JSON.stringify(n,function(r,i){let s=Ml(this[r],e);return s!==null?s:i},2)}function mu(n){return n==null?[]:[].concat(n)}let pu,hu,gu,Zx=/\$\{\s*(\w+)\s*\}/g;pu=Symbol.toStringTag;class Ll{constructor(e,t,r,i){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[pu]="Error",this.name="ValidationError",this.value=t,this.path=r,this.type=i,this.errors=[],this.inner=[],mu(e).forEach(s=>{if(ze.isError(s)){this.errors.push(...s.errors);const o=s.inner.length?s.inner:[s];this.inner.push(...o)}else this.errors.push(s)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}hu=Symbol.hasInstance;gu=Symbol.toStringTag;class ze extends Error{static formatError(e,t){const r=t.label||t.path||"this";return t=Object.assign({},t,{path:r,originalPath:t.path}),typeof e=="string"?e.replace(Zx,(i,s)=>It(t[s])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,r,i,s){const o=new Ll(e,t,r,i);if(s)return o;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[gu]="Error",this.name=o.name,this.message=o.message,this.type=o.type,this.value=o.value,this.path=o.path,this.errors=o.errors,this.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(this,ze)}static[hu](e){return Ll[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let _t={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:n,type:e,value:t,originalValue:r})=>{const i=r!=null&&r!==t?` (cast from the value \`${It(r,!0)}\`).`:".";return e!=="mixed"?`${n} must be a \`${e}\` type, but the final value was: \`${It(t,!0)}\``+i:`${n} must match the configured type. The validated value was: \`${It(t,!0)}\``+i}},Ye={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},$t={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},Es={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},As={isValue:"${path} field must be ${value}"},pr={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},hr={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},Xx={notType:n=>{const{path:e,value:t,spec:r}=n,i=r.types.length;if(Array.isArray(t)){if(t.length<i)return`${e} tuple value has too few items, expected a length of ${i} but got ${t.length} for value: \`${It(t,!0)}\``;if(t.length>i)return`${e} tuple value has too many items, expected a length of ${i} but got ${t.length} for value: \`${It(t,!0)}\``}return ze.formatError(_t.notType,n)}};Object.assign(Object.create(null),{mixed:_t,string:Ye,number:$t,date:Es,object:pr,array:hr,boolean:As,tuple:Xx});const Kr=n=>n&&n.__isYupSchema__;class Mr{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:r,then:i,otherwise:s}=t,o=typeof r=="function"?r:(...a)=>a.every(d=>d===r);return new Mr(e,(a,d)=>{var u;let m=o(...a)?i:s;return(u=m?.(d))!=null?u:d})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let r=this.refs.map(s=>s.getValue(t?.value,t?.parent,t?.context)),i=this.fn(r,e,t);if(i===void 0||i===e)return e;if(!Kr(i))throw new TypeError("conditions must return a schema object");return i.resolve(t)}}const or={context:"$",value:"."};function gT(n,e){return new Bt(n,e)}class Bt{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===or.context,this.isValue=this.key[0]===or.value,this.isSibling=!this.isContext&&!this.isValue;let r=this.isContext?or.context:this.isValue?or.value:"";this.path=this.key.slice(r.length),this.getter=this.path&&Yt.getter(this.path,!0),this.map=t.map}getValue(e,t,r){let i=this.isContext?r:this.isValue?e:t;return this.getter&&(i=this.getter(i||{})),this.map&&(i=this.map(i)),i}cast(e,t){return this.getValue(e,t?.parent,t?.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}Bt.prototype.__isYupRef=!0;const mt=n=>n==null;function cn(n){function e({value:t,path:r="",options:i,originalValue:s,schema:o},a,d){const{name:u,test:m,params:p,message:h,skipAbsent:y}=n;let{parent:v,context:_,abortEarly:x=o.spec.abortEarly,disableStackTrace:b=o.spec.disableStackTrace}=i;const w={value:t,parent:v,context:_};function A(ne={}){const se=yu(Object.assign({value:t,originalValue:s,label:o.spec.label,path:ne.path||r,spec:o.spec,disableStackTrace:ne.disableStackTrace||b},p,ne.params),w),J=new ze(ze.formatError(ne.message||h,se),t,se.path,ne.type||u,se.disableStackTrace);return J.params=se,J}const S=x?a:d;let C={path:r,parent:v,type:u,from:i.from,createError:A,resolve(ne){return _u(ne,w)},options:i,originalValue:s,schema:o};const N=ne=>{ze.isError(ne)?S(ne):ne?d(null):S(A())},D=ne=>{ze.isError(ne)?S(ne):a(ne)};if(y&&mt(t))return N(!0);let O;try{var W;if(O=m.call(C,t,C),typeof((W=O)==null?void 0:W.then)=="function"){if(i.sync)throw new Error(`Validation test of type: "${C.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(O).then(N,D)}}catch(ne){D(ne);return}N(O)}return e.OPTIONS=n,e}function yu(n,e){if(!n)return n;for(const t of Object.keys(n))n[t]=_u(n[t],e);return n}function _u(n,e){return Bt.isRef(n)?n.getValue(e.value,e.parent,e.context):n}function Qx(n,e,t,r=t){let i,s,o;return e?(Yt.forEach(e,(a,d,u)=>{let m=d?a.slice(1,a.length-1):a;n=n.resolve({context:r,parent:i,value:t});let p=n.type==="tuple",h=u?parseInt(m,10):0;if(n.innerType||p){if(p&&!u)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(t&&h>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${a}, in the path: ${e}. because there is no value at that index. `);i=t,t=t&&t[h],n=p?n.spec.types[h]:n.innerType}if(!u){if(!n.fields||!n.fields[m])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${o} which is a type: "${n.type}")`);i=t,t=t&&t[m],n=n.fields[m]}s=m,o=d?"["+a+"]":"."+a}),{schema:n,parent:i,parentPath:s}):{parent:i,parentPath:e,schema:n}}class Lr extends Set{describe(){const e=[];for(const t of this.values())e.push(Bt.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const r of this.values())t.push(e(r));return t}clone(){return new Lr(this.values())}merge(e,t){const r=this.clone();return e.forEach(i=>r.add(i)),t.forEach(i=>r.delete(i)),r}}function hn(n,e=new Map){if(Kr(n)||!n||typeof n!="object")return n;if(e.has(n))return e.get(n);let t;if(n instanceof Date)t=new Date(n.getTime()),e.set(n,t);else if(n instanceof RegExp)t=new RegExp(n),e.set(n,t);else if(Array.isArray(n)){t=new Array(n.length),e.set(n,t);for(let r=0;r<n.length;r++)t[r]=hn(n[r],e)}else if(n instanceof Map){t=new Map,e.set(n,t);for(const[r,i]of n.entries())t.set(r,hn(i,e))}else if(n instanceof Set){t=new Set,e.set(n,t);for(const r of n)t.add(hn(r,e))}else if(n instanceof Object){t={},e.set(n,t);for(const[r,i]of Object.entries(n))t[r]=hn(i,e)}else throw Error(`Unable to clone ${n}`);return t}function e0(n){if(!(n!=null&&n.length))return;const e=[];let t="",r=!1,i=!1;for(let s=0;s<n.length;s++){const o=n[s];if(o==="["&&!i){t&&(e.push(...t.split(".").filter(Boolean)),t=""),r=!0;continue}if(o==="]"&&!i){t&&(/^\d+$/.test(t)?e.push(t):e.push(t.replace(/^"|"$/g,"")),t=""),r=!1;continue}if(o==='"'){i=!i;continue}if(o==="."&&!r&&!i){t&&(e.push(t),t="");continue}t+=o}return t&&e.push(...t.split(".").filter(Boolean)),e}function t0(n,e){const t=e?`${e}.${n.path}`:n.path;return n.errors.map(r=>({message:r,path:e0(t)}))}function vu(n,e){var t;if(!((t=n.inner)!=null&&t.length)&&n.errors.length)return t0(n,e);const r=e?`${e}.${n.path}`:n.path;return n.inner.flatMap(i=>vu(i,r))}class tt{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new Lr,this._blacklist=new Lr,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(_t.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e?.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=hn(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let r=e(this);return this._mutate=t,r}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,r=e.clone();const i=Object.assign({},t.spec,r.spec);return r.spec=i,r.internalTests=Object.assign({},t.internalTests,r.internalTests),r._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),r._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),r.tests=t.tests,r.exclusiveTests=t.exclusiveTests,r.withMutation(s=>{e.tests.forEach(o=>{s.test(o.OPTIONS)})}),r.transforms=[...t.transforms,...r.transforms],r}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let r=t.conditions;t=t.clone(),t.conditions=[],t=r.reduce((i,s)=>s.resolve(i,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,r,i,s;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(r=e.abortEarly)!=null?r:this.spec.abortEarly,recursive:(i=e.recursive)!=null?i:this.spec.recursive,disableStackTrace:(s=e.disableStackTrace)!=null?s:this.spec.disableStackTrace})}cast(e,t={}){let r=this.resolve(Object.assign({},t,{value:e})),i=t.assert==="ignore-optionality",s=r._cast(e,t);if(t.assert!==!1&&!r.isType(s)){if(i&&mt(s))return s;let o=It(e),a=It(s);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${r.type}". 

attempted value: ${o} 
`+(a!==o?`result of cast: ${a}`:""))}return s}_cast(e,t){let r=e===void 0?e:this.transforms.reduce((i,s)=>s.call(this,i,e,this,t),e);return r===void 0&&(r=this.getDefault(t)),r}_validate(e,t={},r,i){let{path:s,originalValue:o=e,strict:a=this.spec.strict}=t,d=e;a||(d=this._cast(d,Object.assign({assert:!1},t)));let u=[];for(let m of Object.values(this.internalTests))m&&u.push(m);this.runTests({path:s,value:d,originalValue:o,options:t,tests:u},r,m=>{if(m.length)return i(m,d);this.runTests({path:s,value:d,originalValue:o,options:t,tests:this.tests},r,i)})}runTests(e,t,r){let i=!1,{tests:s,value:o,originalValue:a,path:d,options:u}=e,m=_=>{i||(i=!0,t(_,o))},p=_=>{i||(i=!0,r(_,o))},h=s.length,y=[];if(!h)return p([]);let v={value:o,originalValue:a,path:d,options:u,schema:this};for(let _=0;_<s.length;_++){const x=s[_];x(v,m,function(w){w&&(Array.isArray(w)?y.push(...w):y.push(w)),--h<=0&&p(y)})}}asNestedTest({key:e,index:t,parent:r,parentPath:i,originalParent:s,options:o}){const a=e??t;if(a==null)throw TypeError("Must include `key` or `index` for nested validations");const d=typeof a=="number";let u=r[a];const m=Object.assign({},o,{strict:!0,parent:r,value:u,originalValue:s[a],key:void 0,[d?"index":"key"]:a,path:d||a.includes(".")?`${i||""}[${d?a:`"${a}"`}]`:(i?`${i}.`:"")+e});return(p,h,y)=>this.resolve(m)._validate(u,m,h,y)}validate(e,t){var r;let i=this.resolve(Object.assign({},t,{value:e})),s=(r=t?.disableStackTrace)!=null?r:i.spec.disableStackTrace;return new Promise((o,a)=>i._validate(e,t,(d,u)=>{ze.isError(d)&&(d.value=u),a(d)},(d,u)=>{d.length?a(new ze(d,u,void 0,void 0,s)):o(u)}))}validateSync(e,t){var r;let i=this.resolve(Object.assign({},t,{value:e})),s,o=(r=t?.disableStackTrace)!=null?r:i.spec.disableStackTrace;return i._validate(e,Object.assign({},t,{sync:!0}),(a,d)=>{throw ze.isError(a)&&(a.value=d),a},(a,d)=>{if(a.length)throw new ze(a,e,void 0,void 0,o);s=d}),s}isValid(e,t){return this.validate(e,t).then(()=>!0,r=>{if(ze.isError(r))return!1;throw r})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(r){if(ze.isError(r))return!1;throw r}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):hn(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const r=this.clone({nullable:e});return r.internalTests.nullable=cn({message:t,name:"nullable",test(i){return i===null?this.schema.spec.nullable:!0}}),r}optionality(e,t){const r=this.clone({optional:e});return r.internalTests.optionality=cn({message:t,name:"optionality",test(i){return i===void 0?this.schema.spec.optional:!0}}),r}optional(){return this.optionality(!0)}defined(e=_t.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=_t.notNull){return this.nullability(!1,e)}required(e=_t.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=_t.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let r=this.clone(),i=cn(t),s=t.exclusive||t.name&&r.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(r.exclusiveTests[t.name]=!!t.exclusive),r.tests=r.tests.filter(o=>!(o.OPTIONS.name===t.name&&(s||o.OPTIONS.test===i.OPTIONS.test))),r.tests.push(i),r}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let r=this.clone(),i=mu(e).map(s=>new Bt(s));return i.forEach(s=>{s.isSibling&&r.deps.push(s.key)}),r.conditions.push(typeof t=="function"?new Mr(i,t):Mr.fromOptions(i,t)),r}typeError(e){let t=this.clone();return t.internalTests.typeError=cn({message:e,name:"typeError",skipAbsent:!0,test(r){return this.schema._typeCheck(r)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=_t.oneOf){let r=this.clone();return e.forEach(i=>{r._whitelist.add(i),r._blacklist.delete(i)}),r.internalTests.whiteList=cn({message:t,name:"oneOf",skipAbsent:!0,test(i){let s=this.schema._whitelist,o=s.resolveAll(this.resolve);return o.includes(i)?!0:this.createError({params:{values:Array.from(s).join(", "),resolved:o}})}}),r}notOneOf(e,t=_t.notOneOf){let r=this.clone();return e.forEach(i=>{r._blacklist.add(i),r._whitelist.delete(i)}),r.internalTests.blacklist=cn({message:t,name:"notOneOf",test(i){let s=this.schema._blacklist,o=s.resolveAll(this.resolve);return o.includes(i)?this.createError({params:{values:Array.from(s).join(", "),resolved:o}}):!0}}),r}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:r,meta:i,optional:s,nullable:o}=t.spec;return{meta:i,label:r,optional:s,nullable:o,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.filter((d,u,m)=>m.findIndex(p=>p.OPTIONS.name===d.OPTIONS.name)===u).map(d=>{const u=d.OPTIONS.params&&e?yu(Object.assign({},d.OPTIONS.params),e):d.OPTIONS.params;return{name:d.OPTIONS.name,params:u}})}}get"~standard"(){const e=this;return{version:1,vendor:"yup",async validate(r){try{return{value:await e.validate(r,{abortEarly:!1})}}catch(i){if(i instanceof ze)return{issues:vu(i)};throw i}}}}}tt.prototype.__isYupSchema__=!0;for(const n of["validate","validateSync"])tt.prototype[`${n}At`]=function(e,t,r={}){const{parent:i,parentPath:s,schema:o}=Qx(this,e,t,r.context);return o[n](i&&i[s],Object.assign({},r,{parent:i,path:e}))};for(const n of["equals","is"])tt.prototype[n]=tt.prototype.oneOf;for(const n of["not","nope"])tt.prototype[n]=tt.prototype.notOneOf;const n0=()=>!0;function r0(n){return new wu(n)}class wu extends tt{constructor(e){super(typeof e=="function"?{type:"mixed",check:e}:Object.assign({type:"mixed",check:n0},e))}}r0.prototype=wu.prototype;function xu(){return new bu}class bu extends tt{constructor(){super({type:"boolean",check(e){return e instanceof Boolean&&(e=e.valueOf()),typeof e=="boolean"}}),this.withMutation(()=>{this.transform((e,t)=>{if(this.spec.coerce&&!this.isType(e)){if(/^(true|1)$/i.test(String(e)))return!0;if(/^(false|0)$/i.test(String(e)))return!1}return e})})}isTrue(e=As.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"true"},test(t){return mt(t)||t===!0}})}isFalse(e=As.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"false"},test(t){return mt(t)||t===!1}})}default(e){return super.default(e)}defined(e){return super.defined(e)}optional(){return super.optional()}required(e){return super.required(e)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(e){return super.nonNullable(e)}strip(e){return super.strip(e)}}xu.prototype=bu.prototype;const i0=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function s0(n){const e=ks(n);if(!e)return Date.parse?Date.parse(n):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let t=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(t=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(t=0-t)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+t,e.second,e.millisecond)}function ks(n){var e,t;const r=i0.exec(n);return r?{year:Tt(r[1]),month:Tt(r[2],1)-1,day:Tt(r[3],1),hour:Tt(r[4]),minute:Tt(r[5]),second:Tt(r[6]),millisecond:r[7]?Tt(r[7].substring(0,3)):0,precision:(e=(t=r[7])==null?void 0:t.length)!=null?e:void 0,z:r[8]||void 0,plusMinus:r[9]||void 0,hourOffset:Tt(r[10]),minuteOffset:Tt(r[11])}:null}function Tt(n,e=0){return Number(n)||e}let o0=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,a0=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,l0=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,c0="^\\d{4}-\\d{2}-\\d{2}",u0="\\d{2}:\\d{2}:\\d{2}",d0="(([+-]\\d{2}(:?\\d{2})?)|Z)",f0=new RegExp(`${c0}T${u0}(\\.\\d+)?${d0}$`),m0=n=>mt(n)||n===n.trim(),p0={}.toString();function Is(){return new Cu}class Cu extends tt{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce||this.isType(e)||Array.isArray(e))return e;const r=e!=null&&e.toString?e.toString():e;return r===p0?e:r})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||_t.required,name:"required",skipAbsent:!0,test:r=>!!r.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=Ye.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t=Ye.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t=Ye.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}matches(e,t){let r=!1,i,s;return t&&(typeof t=="object"?{excludeEmptyString:r=!1,message:i,name:s}=t:i=t),this.test({name:s||"matches",message:i||Ye.matches,params:{regex:e},skipAbsent:!0,test:o=>o===""&&r||o.search(e)!==-1})}email(e=Ye.email){return this.matches(o0,{name:"email",message:e,excludeEmptyString:!0})}url(e=Ye.url){return this.matches(a0,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=Ye.uuid){return this.matches(l0,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let t="",r,i;return e&&(typeof e=="object"?{message:t="",allowOffset:r=!1,precision:i=void 0}=e:t=e),this.matches(f0,{name:"datetime",message:t||Ye.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||Ye.datetime_offset,params:{allowOffset:r},skipAbsent:!0,test:s=>{if(!s||r)return!0;const o=ks(s);return o?!!o.z:!1}}).test({name:"datetime_precision",message:t||Ye.datetime_precision,params:{precision:i},skipAbsent:!0,test:s=>{if(!s||i==null)return!0;const o=ks(s);return o?o.precision===i:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=Ye.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:m0})}lowercase(e=Ye.lowercase){return this.transform(t=>mt(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>mt(t)||t===t.toLowerCase()})}uppercase(e=Ye.uppercase){return this.transform(t=>mt(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>mt(t)||t===t.toUpperCase()})}}Is.prototype=Cu.prototype;let h0=n=>n!=+n;function g0(){return new Tu}class Tu extends tt{constructor(){super({type:"number",check(e){return e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&!h0(e)}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce)return e;let r=e;if(typeof r=="string"){if(r=r.replace(/\s/g,""),r==="")return NaN;r=+r}return this.isType(r)||r===null?r:parseFloat(r)})})}min(e,t=$t.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r>=this.resolve(e)}})}max(e,t=$t.max){return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r<=this.resolve(e)}})}lessThan(e,t=$t.lessThan){return this.test({message:t,name:"max",exclusive:!0,params:{less:e},skipAbsent:!0,test(r){return r<this.resolve(e)}})}moreThan(e,t=$t.moreThan){return this.test({message:t,name:"min",exclusive:!0,params:{more:e},skipAbsent:!0,test(r){return r>this.resolve(e)}})}positive(e=$t.positive){return this.moreThan(0,e)}negative(e=$t.negative){return this.lessThan(0,e)}integer(e=$t.integer){return this.test({name:"integer",message:e,skipAbsent:!0,test:t=>Number.isInteger(t)})}truncate(){return this.transform(e=>mt(e)?e:e|0)}round(e){var t;let r=["ceil","floor","round","trunc"];if(e=((t=e)==null?void 0:t.toLowerCase())||"round",e==="trunc")return this.truncate();if(r.indexOf(e.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+r.join(", "));return this.transform(i=>mt(i)?i:Math[e](i))}}g0.prototype=Tu.prototype;let y0=new Date(""),_0=n=>Object.prototype.toString.call(n)==="[object Date]";class Ks extends tt{constructor(){super({type:"date",check(e){return _0(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t)=>!this.spec.coerce||this.isType(e)||e===null?e:(e=s0(e),isNaN(e)?Ks.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let r;if(Bt.isRef(e))r=e;else{let i=this.cast(e);if(!this._typeCheck(i))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);r=i}return r}min(e,t=Es.min){let r=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(i){return i>=this.resolve(r)}})}max(e,t=Es.max){let r=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(i){return i<=this.resolve(r)}})}}Ks.INVALID_DATE=y0;function v0(n,e=[]){let t=[],r=new Set,i=new Set(e.map(([o,a])=>`${o}-${a}`));function s(o,a){let d=Yt.split(o)[0];r.add(d),i.has(`${a}-${d}`)||t.push([a,d])}for(const o of Object.keys(n)){let a=n[o];r.add(o),Bt.isRef(a)&&a.isSibling?s(a.path,o):Kr(a)&&"deps"in a&&a.deps.forEach(d=>s(d,o))}return Gx.array(Array.from(r),t).reverse()}function $l(n,e){let t=1/0;return n.some((r,i)=>{var s;if((s=e.path)!=null&&s.includes(r))return t=i,!0}),t}function Su(n){return(e,t)=>$l(n,e)-$l(n,t)}const Eu=(n,e,t)=>{if(typeof n!="string")return n;let r=n;try{r=JSON.parse(n)}catch{}return t.isType(r)?r:n};function gr(n){if("fields"in n){const e={};for(const[t,r]of Object.entries(n.fields))e[t]=gr(r);return n.setFields(e)}if(n.type==="array"){const e=n.optional();return e.innerType&&(e.innerType=gr(e.innerType)),e}return n.type==="tuple"?n.optional().clone({types:n.spec.types.map(gr)}):"optional"in n?n.optional():n}const w0=(n,e)=>{const t=[...Yt.normalizePath(e)];if(t.length===1)return t[0]in n;let r=t.pop(),i=Yt.getter(Yt.join(t),!0)(n);return!!(i&&r in i)};let Fl=n=>Object.prototype.toString.call(n)==="[object Object]";function Ol(n,e){let t=Object.keys(n.fields);return Object.keys(e).filter(r=>t.indexOf(r)===-1)}const x0=Su([]);function Au(n){return new ku(n)}class ku extends tt{constructor(e){super({type:"object",check(t){return Fl(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=x0,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var r;let i=super._cast(e,t);if(i===void 0)return this.getDefault(t);if(!this._typeCheck(i))return i;let s=this.fields,o=(r=t.stripUnknown)!=null?r:this.spec.noUnknown,a=[].concat(this._nodes,Object.keys(i).filter(p=>!this._nodes.includes(p))),d={},u=Object.assign({},t,{parent:d,__validating:t.__validating||!1}),m=!1;for(const p of a){let h=s[p],y=p in i,v=i[p];if(h){let _;u.path=(t.path?`${t.path}.`:"")+p,h=h.resolve({value:v,context:t.context,parent:d});let x=h instanceof tt?h.spec:void 0,b=x?.strict;if(x!=null&&x.strip){m=m||p in i;continue}_=!t.__validating||!b?h.cast(v,u):v,_!==void 0&&(d[p]=_)}else y&&!o&&(d[p]=v);(y!==p in d||d[p]!==v)&&(m=!0)}return m?d:i}_validate(e,t={},r,i){let{from:s=[],originalValue:o=e,recursive:a=this.spec.recursive}=t;t.from=[{schema:this,value:o},...s],t.__validating=!0,t.originalValue=o,super._validate(e,t,r,(d,u)=>{if(!a||!Fl(u)){i(d,u);return}o=o||u;let m=[];for(let p of this._nodes){let h=this.fields[p];!h||Bt.isRef(h)||m.push(h.asNestedTest({options:t,key:p,parent:u,parentPath:t.path,originalParent:o}))}this.runTests({tests:m,value:u,originalValue:o,options:t},r,p=>{i(p.sort(this._sortErrors).concat(d),u)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),r=t.fields;for(let[i,s]of Object.entries(this.fields)){const o=r[i];r[i]=o===void 0?s:o}return t.withMutation(i=>i.setFields(r,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(r=>{var i;const s=this.fields[r];let o=e;(i=o)!=null&&i.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[r]})),t[r]=s&&"getDefault"in s?s.getDefault(o):void 0}),t}setFields(e,t){let r=this.clone();return r.fields=e,r._nodes=v0(e,t),r._sortErrors=Su(Object.keys(e)),t&&(r._excludedEdges=t),r}shape(e,t=[]){return this.clone().withMutation(r=>{let i=r._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),i=[...r._excludedEdges,...t]),r.setFields(Object.assign(r.fields,e),i)})}partial(){const e={};for(const[t,r]of Object.entries(this.fields))e[t]="optional"in r&&r.optional instanceof Function?r.optional():r;return this.setFields(e)}deepPartial(){return gr(this)}pick(e){const t={};for(const r of e)this.fields[r]&&(t[r]=this.fields[r]);return this.setFields(t,this._excludedEdges.filter(([r,i])=>e.includes(r)&&e.includes(i)))}omit(e){const t=[];for(const r of Object.keys(this.fields))e.includes(r)||t.push(r);return this.pick(t)}from(e,t,r){let i=Yt.getter(e,!0);return this.transform(s=>{if(!s)return s;let o=s;return w0(s,e)&&(o=Object.assign({},s),r||delete o[e],o[t]=i(s)),o})}json(){return this.transform(Eu)}exact(e){return this.test({name:"exact",exclusive:!0,message:e||pr.exact,test(t){if(t==null)return!0;const r=Ol(this.schema,t);return r.length===0||this.createError({params:{properties:r.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(e=!0,t=pr.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let r=this.test({name:"noUnknown",exclusive:!0,message:t,test(i){if(i==null)return!0;const s=Ol(this.schema,i);return!e||s.length===0||this.createError({params:{unknown:s.join(", ")}})}});return r.spec.noUnknown=e,r}unknown(e=!0,t=pr.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const r={};for(const i of Object.keys(t))r[e(i)]=t[i];return r})}camelCase(){return this.transformKeys(qi.camelCase)}snakeCase(){return this.transformKeys(qi.snakeCase)}constantCase(){return this.transformKeys(e=>qi.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);r.fields={};for(const[s,o]of Object.entries(t.fields)){var i;let a=e;(i=a)!=null&&i.value&&(a=Object.assign({},a,{parent:a.value,value:a.value[s]})),r.fields[s]=o.describe(a)}return r}}Au.prototype=ku.prototype;function b0(n){return new Iu(n)}class Iu extends tt{constructor(e){super({type:"array",spec:{types:e},check(t){return Array.isArray(t)}}),this.innerType=void 0,this.innerType=e}_cast(e,t){const r=super._cast(e,t);if(!this._typeCheck(r)||!this.innerType)return r;let i=!1;const s=r.map((o,a)=>{const d=this.innerType.cast(o,Object.assign({},t,{path:`${t.path||""}[${a}]`,parent:r,originalValue:o,value:o,index:a}));return d!==o&&(i=!0),d});return i?s:r}_validate(e,t={},r,i){var s;let o=this.innerType,a=(s=t.recursive)!=null?s:this.spec.recursive;t.originalValue!=null&&t.originalValue,super._validate(e,t,r,(d,u)=>{var m;if(!a||!o||!this._typeCheck(u)){i(d,u);return}let p=new Array(u.length);for(let y=0;y<u.length;y++){var h;p[y]=o.asNestedTest({options:t,index:y,parent:u,parentPath:t.path,originalParent:(h=t.originalValue)!=null?h:e})}this.runTests({value:u,tests:p,originalValue:(m=t.originalValue)!=null?m:e,options:t},r,y=>i(y.concat(d),u))})}clone(e){const t=super.clone(e);return t.innerType=this.innerType,t}json(){return this.transform(Eu)}concat(e){let t=super.concat(e);return t.innerType=this.innerType,e.innerType&&(t.innerType=t.innerType?t.innerType.concat(e.innerType):e.innerType),t}of(e){let t=this.clone();if(!Kr(e))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+It(e));return t.innerType=e,t.spec=Object.assign({},t.spec,{types:e}),t}length(e,t=hr.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t){return t=t||hr.min,this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t){return t=t||hr.max,this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}ensure(){return this.default(()=>[]).transform((e,t)=>this._typeCheck(e)?e:t==null?[]:[].concat(t))}compact(e){let t=e?(r,i,s)=>!e(r,i,s):r=>!!r;return this.transform(r=>r!=null?r.filter(t):r)}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);if(t.innerType){var i;let s=e;(i=s)!=null&&i.value&&(s=Object.assign({},s,{parent:s.value,value:s.value[0]})),r.innerType=t.innerType.describe(s)}return r}}b0.prototype=Iu.prototype;const Ns=Z.forwardRef(({label:n,labelClassName:e,id:t,error:r,description:i,registration:s,icon:o,autoCapitalizeCustom:a=!0,...d},u)=>{const m=U.useId(),p=t||m,{className:h,...y}=d,x=`form-input ${r?"form-input--error":""} ${o?"!pl-16":""} ${h||""}`,b=f.jsxs("div",{className:"relative",children:[o&&f.jsx("div",{className:"absolute left-5 top-1/2 -translate-y-1/2 text-muted pointer-events-none",children:o}),f.jsx("input",{ref:u,id:p,name:d.name||s?.name||p,className:x,style:o?{paddingLeft:"3.5rem"}:void 0,"aria-invalid":!!r,"aria-label":d["aria-label"]||n,autoCapitalize:a?"words":void 0,...s,...y,onChange:w=>{const A=!d.type||d.type==="text";if(a&&A){const S=w.target.value,C=S.replace(/\b\w/g,N=>N.toUpperCase());S!==C&&(w.target.value=C)}s?.onChange&&s.onChange(w),d.onChange&&d.onChange(w)}})]});return f.jsxs("div",{children:[n&&f.jsx("label",{htmlFor:p,className:e||"block text-sm font-medium text-muted",children:n}),i&&f.jsx("p",{className:"text-xs text-muted mb-1",children:i}),f.jsx("div",{className:n?"mt-1":"",children:b}),r&&f.jsx("p",{className:"mt-1 text-xs text-red-600",children:r})]})});Ns.displayName="Input";const Nu=U.forwardRef(({id:n,label:e,description:t,className:r,labelClassName:i,inputClassName:s,descriptionClassName:o,...a},d)=>{const u=U.useId(),m=n||a.name||u;return f.jsxs("div",{className:`relative flex items-start ${r||""}`,children:[f.jsx("div",{className:"flex h-6 items-center",children:f.jsx("input",{id:m,name:a.name||m,"aria-describedby":t?`${m}-description`:void 0,type:"checkbox",ref:d,className:`h-4 w-4 rounded border-gray-300 text-accent focus:ring-accent cursor-pointer ${s||""}`,...a})}),f.jsxs("div",{className:"ml-3 text-sm leading-6",children:[f.jsx("label",{htmlFor:m,className:`font-medium text-primary-text cursor-pointer ${i||""}`,children:e}),t&&f.jsx("p",{id:`${m}-description`,className:`text-muted ${o||""}`,children:t})]})]})});Nu.displayName="Checkbox";function C0(){const[n,e]=U.useState(null),[t,r]=U.useState(!1),[i,s]=U.useState(null);return U.useEffect(()=>{const a=(()=>{const p=navigator.userAgent,h=`${window.screen.width}x${window.screen.height}`,y=Intl.DateTimeFormat().resolvedOptions().timeZone,v=navigator.language,_=navigator.platform,x=navigator.hardwareConcurrency||0,b=`${p}|${h}|${y}|${v}|${_}|${x}`;let w=0;for(let N=0;N<b.length;N++){const D=b.charCodeAt(N);w=(w<<5)-w+D,w=w&w}const A="dev_"+Math.abs(w).toString(36),S=()=>p.indexOf("Chrome")>-1?"Chrome":p.indexOf("Firefox")>-1?"Firefox":p.indexOf("Safari")>-1?"Safari":p.indexOf("Edge")>-1?"Edge":"Unknown",C=()=>p.indexOf("Win")>-1?"Windows":p.indexOf("Mac")>-1?"MacOS":p.indexOf("Linux")>-1?"Linux":p.indexOf("Android")>-1?"Android":p.indexOf("iOS")>-1?"iOS":"Unknown";return{deviceId:A,deviceName:`${C()} - ${S()}`,browser:S(),os:C(),timestamp:new Date().toISOString()}})();e(a);const d=localStorage.getItem("device_id"),u=localStorage.getItem("device_name"),m=localStorage.getItem("device_timestamp");d&&d!==a.deviceId&&(r(!0),s({deviceId:d,deviceName:u||"Unknown Device",browser:"",os:"",timestamp:m||new Date().toISOString()})),localStorage.setItem("device_id",a.deviceId),localStorage.setItem("device_name",a.deviceName),localStorage.setItem("device_timestamp",a.timestamp)},[]),{deviceInfo:n,isNewDevice:t,previousDevice:i}}const T0=Au({email:Is().email("Must be a valid email").required("Email is required"),password:Is().required("Password is required"),rememberMe:xu().optional()}).defined(),S0=n=>n.role==="unverified"?"/pending-approval":"/profile",E0=()=>{const{user:n,loginWithEmail:e,loginWithGoogle:t,error:r,setError:i,loading:s,setLoginAnimationPending:o,isLoginAnimationPending:a}=De(),d=Jn(),u=Ut(),{deviceInfo:m,isNewDevice:p,previousDevice:h}=C0(),[y,v]=U.useState(!1),[_,x]=U.useState(!1);U.useEffect(()=>{i(null);const V=new URLSearchParams(u.hash.substring(1)),O=V.get("error_code"),W=V.get("error_description");O==="otp_expired"&&W&&(i("Email confirmation link has expired or is invalid. Please try signing up again or request a new confirmation email."),d("/auth/login",{replace:!0}))},[i,u,d]),U.useEffect(()=>{n&&p&&h&&!y&&(B.sendDeviceChangeAlert(n.id,n.name,h.deviceName,m?.deviceName||"Unknown Device").catch(V=>console.error("Failed to send device change alert:",V)),v(!0))},[n,p,h,y,m]),U.useEffect(()=>{n&&!a&&d(S0(n),{replace:!0})},[n,d,a]);const{register:b,handleSubmit:w,setValue:A,formState:{errors:S}}=$x({resolver:Vx(T0)});U.useEffect(()=>{(async()=>{const{value:W}=await Ve.get({key:"rememberedEmail"});W&&(A("email",W),A("rememberMe",!0))})(),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&A("rememberMe",!0)},[A]);const C=async V=>{o(!0);const W=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:V.rememberMe||!1;(await e(V.email,V.password,W)).error?o(!1):(x(!0),setTimeout(()=>{o(!1)},1500))},N=async()=>{await t()},D=s||_;return f.jsxs(f.Fragment,{children:[f.jsxs("form",{onSubmit:w(C),className:"space-y-3",children:[f.jsxs("fieldset",{disabled:D,className:"space-y-3",children:[f.jsxs("div",{className:"relative group",children:[f.jsx(Rd,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none"}),f.jsx(Ns,{id:"email",type:"email",autoComplete:"email",placeholder:"Email","aria-label":"Email address",registration:b("email"),error:S.email?.message,className:"!pl-12 !bg-black/60 !text-white !border-white/10 focus:!border-[#22c55e] placeholder:!text-gray-500 !py-3 !rounded-xl transition-all"})]}),f.jsxs("div",{className:"relative group",children:[f.jsx(Dd,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none"}),f.jsx(Ns,{id:"password",type:"password",autoComplete:"current-password",placeholder:"Password","aria-label":"Password",registration:b("password"),error:S.password?.message,className:"!pl-12 !bg-black/60 !text-white !border-white/10 focus:!border-[#22c55e] placeholder:!text-gray-500 !py-3 !rounded-xl transition-all"})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-center justify-between gap-3",children:[f.jsx("div",{className:"flex-shrink-0",children:f.jsx(Nu,{id:"rememberMe",label:"Remember me",labelClassName:"text-white font-medium",...b("rememberMe"),inputClassName:"text-[#22c55e] border-white/20 rounded bg-black/40 focus:ring-[#22c55e]"})}),f.jsx(xr,{to:"/auth/forgot-password",className:`text-sm font-medium !text-white hover:text-gray-200 transition-colors auth-link ${D?"pointer-events-none opacity-50":""}`,"aria-disabled":D,onClick:V=>{D&&V.preventDefault()},children:"Forgot your password?"})]})]}),f.jsx("div",{className:"min-h-[24px] flex items-center justify-center",children:r&&f.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-400 text-center p-2 bg-red-500/10 rounded-lg border border-red-500/20",children:[f.jsx(Ze,{className:"h-4 w-4 flex-shrink-0"}),f.jsx("span",{children:r})]})}),f.jsx($e,{type:"submit",className:`w-full !font-bold !py-3 !rounded-full shadow-lg transition-all transform hover:scale-[1.02] signin-btn ${_?"!bg-[#22c55e] !border-[#22c55e] !text-white hover:!bg-[#22c55e]":"!bg-transparent border border-[#22c55e] !text-[#22c55e] hover:!bg-[#22c55e] hover:!text-white shadow-green-500/20"}`,isLoading:s&&!_,size:"lg",disabled:D&&!_,children:_?f.jsx(Hi,{className:"w-6 h-6 animate-bounce"}):"Sign In"}),f.jsx("div",{className:"pt-2",children:f.jsx($e,{type:"button",onClick:()=>d("/public/forms"),className:"w-full !font-bold !py-3 !rounded-full shadow-lg transition-all transform hover:scale-[1.02] bg-white/10 border border-white/20 text-white hover:bg-white/20",size:"lg",disabled:D,children:"Forms"})})]}),f.jsxs("div",{className:"md:-translate-y-[20%] -translate-y-[30%]",children:[f.jsxs("div",{className:"flex items-center my-6",children:[f.jsx("div",{className:"flex-1 border-t border-white/10"}),f.jsx("span",{className:"px-4 text-sm text-gray-400 font-medium",children:"OR"}),f.jsx("div",{className:"flex-1 border-t border-white/10"})]}),f.jsxs("button",{type:"button",onClick:N,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-900 hover:bg-gray-100 font-bold py-3 rounded-full transition-all transform hover:scale-[1.02] shadow-lg google-btn",disabled:D,children:[f.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 48 48",children:[f.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),f.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),f.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.222,0-9.519-3.487-11.181-8.264l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),f.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.574l6.19,5.238C39.99,35.508,44,30.021,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),"Sign in with Google"]}),f.jsx("div",{className:"text-center mt-4",children:f.jsxs("p",{className:"text-sm text-gray-300",children:["Don't have an account?"," ",f.jsx(xr,{to:"/auth/signup",className:"font-medium !text-white hover:text-gray-200 auth-link",children:"Sign Up"})]})})]})]})},Ce=({requiredPermission:n,children:e})=>{const{user:t,isInitialized:r}=De(),{permissions:i}=En();if(!r)return null;if(!t)return f.jsx(kt,{to:"/auth/login",replace:!0});const o=(()=>{if(!t||!i)return[];const m=t.roleId?.toLowerCase()||"",p=t.role?.toLowerCase()||"",h=p.replace(/\s+/g,"_"),y=i[m]||i[p]||i[h]||i[t.role]||[];return y.length===0&&t.id&&t.role!=="unverified"?["view_profile","view_own_attendance","view_mobile_nav_home","view_mobile_nav_profile"]:y})(),a=n==="view_profile"||n==="view_own_attendance";return Bs(t.role)||o.includes(n)||a&&t.role!=="unverified"?e?f.jsx(f.Fragment,{children:e}):f.jsx(Or,{}):(console.warn(`[ProtectedRoute] Access Denied: 
      User: ${t.email} (${t.id})
      Role: ${t.role} (ID: ${t.roleId})
      Required: ${n}
      UserPerms: ${JSON.stringify(o)}
    `),f.jsx(kt,{to:"/forbidden",replace:!0}))},A0=({onIdle:n,idleTimeout:e,promptTimeout:t,disabled:r=!1})=>{const[i,s]=U.useState(!1),[o,a]=U.useState(t),d=U.useRef(null),u=U.useRef(null),m=U.useRef(null),p=["mousemove","keydown","mousedown","scroll","touchstart"],h=U.useCallback(()=>{r||(s(!1),a(t),d.current&&clearTimeout(d.current),u.current&&clearTimeout(u.current),m.current&&clearInterval(m.current),d.current=window.setTimeout(()=>{s(!0)},e))},[e,t,r]);return U.useEffect(()=>{if(!r)return i&&(u.current=window.setTimeout(n,t),m.current=window.setInterval(()=>{a(y=>Math.max(0,y-1e3))},1e3)),()=>{u.current&&clearTimeout(u.current),m.current&&clearInterval(m.current)}},[i,n,t,r]),U.useEffect(()=>{if(r)return;const y=()=>h();return p.forEach(v=>{window.addEventListener(v,y)}),h(),()=>{p.forEach(v=>{window.removeEventListener(v,y)}),d.current&&clearTimeout(d.current),u.current&&clearTimeout(u.current),m.current&&clearInterval(m.current)}},[h,r]),{isIdle:i,countdown:o,reset:h}},k0=1800*1e3,I0=120*1e3,N0=()=>{const{logout:n}=De(),e=Jn(),t=()=>{n(),e("/auth/login",{replace:!0})},r=!0,{isIdle:i,countdown:s,reset:o}=A0({onIdle:t,idleTimeout:k0,promptTimeout:I0,disabled:r});return i?f.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-70 backdrop-blur-sm","aria-modal":"true",role:"dialog",children:f.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 text-center animate-fade-in-scale",children:[f.jsx(Pd,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),f.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Are you still there?"}),f.jsx("p",{className:"mt-2 text-muted",children:"For your security, you will be logged out due to inactivity."}),f.jsx("div",{className:"my-6 text-4xl font-bold text-accent",children:Math.ceil(s/1e3)}),f.jsx("p",{className:"text-sm text-muted mb-6",children:"Click the button below to stay logged in."}),f.jsx("div",{className:"flex justify-center gap-4",children:f.jsx($e,{onClick:o,variant:"primary",size:"lg",children:"Stay Logged In"})})]})}):null},R0=()=>{const{pathname:n}=Ut();return U.useEffect(()=>{window.scrollTo(0,0);const e=document.querySelector("main");e&&e.scrollTo(0,0);const t=document.getElementById("root");t&&t.scrollTo(0,0)},[n]),null},D0=j(()=>F(()=>import("./MobileHome-DvMZzb9m.js"),__vite__mapDeps([8,1,9,2,4,10,11]))),P0=j(()=>F(()=>import("./SignUp-CgZH6UIl.js"),__vite__mapDeps([12,1,9,2,4,10,11]))),M0=j(()=>F(()=>import("./ForgotPassword-Be8dX0RA.js"),__vite__mapDeps([13,1,9,2,4,10,11]))),L0=j(()=>F(()=>import("./UpdatePassword-Dk-UEwrl.js"),__vite__mapDeps([14,1,9,2,4,10,11]))),$0=j(()=>F(()=>import("./LogoutPage-BL3YsEgz.js"),__vite__mapDeps([15,1,9,2,4,10,11]))),F0=j(()=>F(()=>import("./PendingApproval-BVzQNmOI.js"),__vite__mapDeps([16,1,9,2,4,10,11]))),O0=j(()=>F(()=>import("./Forbidden-CqfDhHrT.js"),__vite__mapDeps([17,1,9,2,4,10,11]))),V0=j(()=>F(()=>import("./OnboardingHome-7uXPC3j8.js"),__vite__mapDeps([18,1,9,2,4,10,11]))),U0=j(()=>F(()=>import("./SelectOrganization-BS1Rh8HL.js"),__vite__mapDeps([19,1,20,9,10,2,4,11]))),q0=j(()=>F(()=>import("./AddEmployee-v9HI4aFl.js"),__vite__mapDeps([21,1,9,22,2,4,10,11]))),j0=j(()=>F(()=>import("./VerificationDashboard-CgoPTSYF.js"),__vite__mapDeps([23,1,24,25,26,9,2,4,10,11]))),B0=j(()=>F(()=>import("./UserManagement-B9oVnu4b.js"),__vite__mapDeps([27,1,22,28,25,26,20,9,29,2,4,10,11]))),G0=j(()=>F(()=>import("./BulkEarnedLeavePage-CcmILS5W.js"),__vite__mapDeps([30,1,31,10,28,9,2,4,11]))),H0=j(()=>F(()=>import("./OrganizationManagement-DMlLuMJl.js"),__vite__mapDeps([32,1,22,33,20,34,35,4,2,11,9,36,10,25,26,29])).then(n=>({default:n.SiteManagement}))),z0=j(()=>F(()=>import("./RoleManagement-BD-VJiFD.js"),__vite__mapDeps([37,1,28,22,25,26,9,2,4,10,11]))),W0=j(()=>F(()=>import("./ModuleManagement-DeA2MKCR.js"),__vite__mapDeps([38,1,28,22,37,25,26,9,2,4,10,11]))),J0=j(()=>F(()=>import("./ManageDevices-BlLwMg2X.js"),__vite__mapDeps([39,1,22,20,9,2,4,10,11]))),Y0=j(()=>F(()=>import("./DeviceApprovals-DVSyEptN.js"),__vite__mapDeps([40,1,29,9,28,41,2,4,10,11]))),K0=j(()=>F(()=>import("./ApiSettings-CCwevO3t.js"),__vite__mapDeps([42,1,34,35,4,2,11,9,10])).then(n=>({default:n.ApiSettings}))),Z0=j(()=>F(()=>import("./OperationsDashboard-CurlJHLt.js"),__vite__mapDeps([43,1,44,9,20,45,36,10,46,2,4,11]))),X0=j(()=>F(()=>import("./TeamActivity-BciyKPV0.js"),__vite__mapDeps([47,1,29,9,10,2,4,11]))),Q0=j(()=>F(()=>import("./OrganizationDashboard-CRIPAPIE.js"),__vite__mapDeps([48,1,24,20,9,2,4,10,11]))),eb=j(()=>F(()=>import("./ProfilePage-B-Pi3AuQ.js"),__vite__mapDeps([49,1,50,35,4,2,11,9,10]))),tb=j(()=>F(()=>import("./AttendanceDashboard-Bj6RrjXr.js"),__vite__mapDeps([51,1,9,10,44,52,31,53,2,4,11]))),nb=j(()=>F(()=>import("./DeviceManagement-hfP4nsSC.js"),__vite__mapDeps([54,1,55,2,22,41,9,4,10,11]))),rb=j(()=>F(()=>import("./MyLocations-CspCVhgi.js"),__vite__mapDeps([56,1,29,9,2,4,10,11]))),ar=j(()=>F(()=>import("./AttendanceActionPage-CjB9cwAb.js"),__vite__mapDeps([57,1,35,4,2,11,9,10]))),ib=j(()=>F(()=>import("./RequestUnlockPage-BF6CIrww.js"),__vite__mapDeps([58,1,9,2,4,10,11]))),sb=j(()=>F(()=>import("./AttendanceSettings-Bs2zYb92.js"),__vite__mapDeps([59,1,36,10,9,20,28,2,4,11]))),ob=j(()=>F(()=>import("./NotificationsControl-sGER1UlW.js"),__vite__mapDeps([60,1,28,20,9,2,4,10,11]))),ab=j(()=>F(()=>import("./LeaveDashboard-B5vHLFAq.js"),__vite__mapDeps([61,1,9,10,62,2,4,11]))),lb=j(()=>F(()=>import("./ApplyLeave-DUTIsD7c.js"),__vite__mapDeps([63,1,20,36,10,9,34,35,4,2,11]))),cb=j(()=>F(()=>import("./HolidaySelectionPage-DkqSM-fR.js"),__vite__mapDeps([64,1,62,9,10,2,4,11]))),ub=j(()=>F(()=>import("./LeaveManagement-D5qxd_s6.js"),__vite__mapDeps([65,1,22,53,9,52,31,10,2,4,11]))),db=j(()=>F(()=>import("./ApprovalWorkflow-CJN5HKc6.js"),__vite__mapDeps([66,1,20,28,67,9,29,2,4,10,11]))),fb=j(()=>F(()=>import("./WorkflowChartFullScreen-Dxhr9eRO.js"),__vite__mapDeps([68,1,67,9,2,4,10,11])));j(()=>F(()=>import("./TaskManagement-fopUK55R.js"),__vite__mapDeps([69,1,70,10,22,34,35,4,2,11,9,29,53])));const mb=j(()=>F(()=>import("./EntityManagement-twwj_kLn.js"),__vite__mapDeps([71,1,20,36,10,9,33,34,35,4,2,11,22]))),pb=j(()=>F(()=>import("./PoliciesAndInsurance-BBqny82A.js"),__vite__mapDeps([72,1,28,22,9,20,36,10,52,31,0,2,4,11]))),hb=j(()=>F(()=>import("./EnrollmentRules-DixbhbPk.js"),__vite__mapDeps([73,1,28,20,9,2,4,10,11]))),gb=j(()=>F(()=>import("./OnboardingPdfOutput-QeAiDRWP.js"),__vite__mapDeps([74,1,9,2,4,10,11]))),yb=j(()=>F(()=>import("./UniformDashboard-CZQ6-A8T.js"),__vite__mapDeps([75,1,28,22,9,10,2,4,11]))),_b=j(()=>F(()=>import("./CostAnalysis-CodL2GGe.js"),__vite__mapDeps([76,1,28,44,9,46,10,2,4,11]))),vb=j(()=>F(()=>import("./InvoiceSummary-D7o1zjDl.js"),__vite__mapDeps([77,1,28,29,9,10,2,4,11])));j(()=>F(()=>import("./SiteAttendanceTracker-D2v0HNBb.js"),__vite__mapDeps([78,1,31,10,9,2,4,11])));const Vl=j(()=>F(()=>import("./AddSiteAttendanceRecord-B1gUyW9-.js"),__vite__mapDeps([79,1,80,9,10,2,4,11])));j(()=>F(()=>import("./SiteFinanceTracker-Be5marYg.js"),__vite__mapDeps([81,1,31,10,9,2,4,11])));const wb=j(()=>F(()=>import("./FinanceModule-xtG_O6lL.js"),__vite__mapDeps([82,1,28,78,31,10,9,2,4,11,81]))),Ul=j(()=>F(()=>import("./AddSiteFinanceRecord-C0MWam4O.js"),__vite__mapDeps([83,1,80,9,10,2,4,11]))),xb=j(()=>F(()=>import("./FieldStaffTracking-zNqcmJK2.js"),__vite__mapDeps([84,1,36,10,9,20,85,29,2,4,11]))),bb=j(()=>F(()=>import("./LocationManagement-C9g1JbVw.js"),__vite__mapDeps([86,1,28,20,29,9,53,2,4,10,11]))),Cb=j(()=>F(()=>import("./PreUpload-BzKNvmw4.js"),__vite__mapDeps([87,1,45,34,35,4,2,11,9,20,88,10]))),Tb=j(()=>F(()=>import("./MySubmissions-dL_yM6oK.js"),__vite__mapDeps([89,1,24,26,9,2,4,10,11]))),Sb=j(()=>F(()=>import("./MyTasks-CK8lZgvn.js"),__vite__mapDeps([90,1,9,10,2,4,11]))),Eb=j(()=>F(()=>import("./UniformRequests-BweRbW5G.js"),__vite__mapDeps([91,1,20,22,9,10,2,4,11]))),Ab=j(()=>F(()=>import("./SupportDashboard-CW28u1zL.js"),__vite__mapDeps([92,1,20,22,9,10,2,4,11]))),kb=j(()=>F(()=>import("./TicketDetail-CzeobhCo.js"),__vite__mapDeps([93,1,9,10,2,4,11]))),Ib=j(()=>F(()=>import("./MyTeamPage-arFBvHCj.js"),__vite__mapDeps([94,1,85,4,2,29,9,10,11,95]))),Nb=j(()=>F(()=>import("./FieldReports-BXojswj4.js"),__vite__mapDeps([96,2,1,22,29,9,20,10,4,11]))),Rb=j(()=>F(()=>import("./TaskManagement-fopUK55R.js"),__vite__mapDeps([69,1,70,10,22,34,35,4,2,11,9,29,53]))),Db=j(()=>F(()=>import("./TeamMemberProfile-CC25EFSV.js"),__vite__mapDeps([97,1,9,10,55,2,22,41,4,11]))),Pb=j(()=>F(()=>import("./ReportingStructure-BbvgHUg2.js"),__vite__mapDeps([98,1,22,9,2,4,10,11]))),ql=j(()=>F(()=>import("./AddUserPage-DCRe4cSu.js"),__vite__mapDeps([99,1,20,9,2,4,10,11]))),Mb=j(()=>F(()=>import("./AddPolicyPage-BSAbM96I.js"),__vite__mapDeps([100,1,9,2,4,10,11]))),Lb=j(()=>F(()=>import("./NewTicketPage-CVmiwMz5.js"),__vite__mapDeps([101,1,20,34,35,4,2,11,9,10]))),$b=j(()=>F(()=>import("./AddGroupPage-CLDvj6Iz.js"),__vite__mapDeps([102,1,9,2,4,10,11]))),Fb=j(()=>F(()=>import("./GrantCompOffPage-DSpZ1gTz.js"),__vite__mapDeps([103,1,20,9,2,4,10,11]))),Ob=j(()=>F(()=>import("./AddModulePage-bJW2qdhb.js"),__vite__mapDeps([104,1,9,2,4,10,11]))),jl=j(()=>F(()=>import("./AddRolePage-xA2ED8-S.js"),__vite__mapDeps([105,1,37,28,22,25,26,9,2,4,10,11]))),Vb=j(()=>F(()=>import("./AddSitePage-CPwpV3FU.js"),__vite__mapDeps([106,1,20,9,2,4,10,11]))),Ub=j(()=>F(()=>import("./QuickAddSitePage-DIgOF2vC.js"),__vite__mapDeps([107,1,9,2,4,10,11]))),Bl=j(()=>F(()=>import("./AddTaskPage-DxPDH2Ew.js"),__vite__mapDeps([108,1,70,10,20,36,9,2,4,11]))),Gl=j(()=>F(()=>import("./NewUniformRequestPage-7SibdCEL.js"),__vite__mapDeps([109,1,20,9,2,4,10,11]))),qb=j(()=>F(()=>import("./PersonalDetails-My488iGb.js"),__vite__mapDeps([110,1,20,50,35,4,2,11,9,45,36,10,111]))),jb=j(()=>F(()=>import("./AddressDetails-CWAeTC7o.js"),__vite__mapDeps([112,1,45,111,9,2,4,10,11]))),Bb=j(()=>F(()=>import("./OrganizationDetails-D47g8yzb.js"),__vite__mapDeps([113,1,20,45,36,10,9,2,4,11]))),Gb=j(()=>F(()=>import("./FamilyDetails-CG10O0Xj.js"),__vite__mapDeps([114,1,20,22,45,34,35,4,2,11,9,36,10]))),Hb=j(()=>F(()=>import("./EducationDetails-UeehPtzR.js"),__vite__mapDeps([115,1,22,45,34,35,4,2,11,9,10]))),zb=j(()=>F(()=>import("./BankDetails-BEKWiAzN.js"),__vite__mapDeps([116,1,45,34,35,4,2,11,9,111,10]))),Wb=j(()=>F(()=>import("./UanDetails-CpGMyNjz.js"),__vite__mapDeps([117,1,45,34,35,4,2,11,9,111,10]))),Jb=j(()=>F(()=>import("./EsiDetails-CjnKa-pi.js"),__vite__mapDeps([118,1,45,36,10,9,34,35,4,2,11,111]))),Yb=j(()=>F(()=>import("./GmcDetails-Ce2DN5Xf.js"),__vite__mapDeps([119,1,45,34,35,4,2,11,9,10]))),Kb=j(()=>F(()=>import("./UniformDetails-BfCB4dDu.js"),__vite__mapDeps([120,1,45,20,9,2,4,10,11]))),Zb=j(()=>F(()=>import("./Documents-DmeepZV1.js"),__vite__mapDeps([121,45,34,1,35,4,2,11,9,10]))),Xb=j(()=>F(()=>import("./Biometrics-CaS5H3_H.js"),__vite__mapDeps([122,1,45,34,35,4,2,11,9,10]))),Qb=j(()=>F(()=>import("./Review-BNHq7uaU.js"),__vite__mapDeps([123,1,45,9,2,4,10,11]))),eC=j(()=>F(()=>import("./AadhaarScannerPage-DcTHK4SC.js"),__vite__mapDeps([124,1,88,10,9,2,4,11]))),tC=j(()=>F(()=>import("./FormsSelection-Cadw7Ejp.js"),__vite__mapDeps([125,1,9,2,4,10,11]))),nC=j(()=>F(()=>import("./GMCForm-CpJXaeqk.js"),__vite__mapDeps([126,1,20,0,2,9,10,4,11]))),rC=j(()=>F(()=>import("./ImageViewerPage-DtbzNHK6.js"),__vite__mapDeps([127,1,9,2,4,10,11]))),iC=()=>{const{theme:n,isAutomatic:e,_setThemeInternal:t}=Sw(),{isMobile:r}=Gr();return U.useEffect(()=>{const i=document.body;let s="light";e?s=r?"dark":"light":s=n,t(s),s==="dark"?i.classList.add("pro-dark-theme"):i.classList.remove("pro-dark-theme")},[n,e,r,t]),null};class sC extends Z.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){console.error("[GlobalErrorBoundary] Caught error:",e,t)}render(){return this.state.hasError?f.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 p-6 text-center",children:f.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-xl border border-red-100 max-w-md",children:[f.jsx("div",{className:"bg-red-50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6",children:f.jsx(Ze,{className:"h-8 w-8 text-red-600"})}),f.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Something went wrong"}),f.jsx("p",{className:"text-gray-600 mb-8",children:"The application encountered an unexpected error. This often happens if your session has expired."}),f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 rounded-xl transition-colors",children:"Reload Application"}),f.jsx("button",{onClick:()=>{localStorage.clear(),Ve.clear(),window.location.href="/auth/login"},className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold py-3 rounded-xl transition-colors",children:"Go to Login"})]})]})}):this.props.children}}const On="app:lastPath",oC=["/auth","/splash","/pending-approval","/forbidden"],Rs=n=>n==="/"||n==="/#"||n==="/index.html"?!1:!oC.some(e=>n.startsWith(e)),aC=()=>{const{user:n,isInitialized:e}=De(),t=Ut(),{isMobile:r}=Gr();return e?n?n.role==="unverified"?f.jsx(kt,{to:"/pending-approval",replace:!0}):r?f.jsx(Hw,{}):f.jsx(Bw,{}):(Rs(t.pathname+t.search)&&localStorage.setItem(On,t.pathname+t.search),f.jsx(kt,{to:"/auth/login",replace:!0})):null},lC=()=>{const{user:n,isInitialized:e,setUser:t,setInitialized:r,resetAttendance:i,setLoading:s,isLoginAnimationPending:o}=De(),{init:a}=Aw(),{initRoles:d}=En(),{initSettings:u}=Dw(),m=Jn(),p=Ut(),{setDeferredPrompt:h}=Vc();U.useEffect(()=>{window.api=B},[]),U.useEffect(()=>{const v=_=>{_.preventDefault(),console.log("Capture beforeinstallprompt event"),h(_)};return window.addEventListener("beforeinstallprompt",v),F(async()=>{const{requestNotificationPermissions:_}=await Promise.resolve().then(()=>ww);return{requestNotificationPermissions:_}},void 0).then(({requestNotificationPermissions:_})=>{_()}),()=>{window.removeEventListener("beforeinstallprompt",v)}},[h]),U.useEffect(()=>{n&&Rs(p.pathname+p.search)&&localStorage.setItem(On,p.pathname+p.search)},[n,p.pathname,p.search]),U.useEffect(()=>{if(n){const v=De.getState().subscribeToAttendance();return De.getState().fetchGeofencingSettings(),()=>{typeof v=="function"&&v()}}},[n]);const y=Cn(v=>v.unreadCount);return U.useEffect(()=>{window.Android?.updateNotificationCount&&window.Android.updateNotificationCount(y)},[y]),U.useEffect(()=>{let v=!0;const _=setTimeout(()=>{v&&(console.warn("App initialization is taking too long. Proceeding without a session."),s(!1),r(!0))},1e4);(async()=>{s(!0);try{let{data:{session:A},error:S}=await g.auth.getSession();if(S&&console.error("Error fetching initial session:",S.message),!A){const{value:C}=await Ve.get({key:"supabase.auth.rememberMe"});if(C){console.log("Attempting to restore session from long-term token...");try{const{data:N,error:D}=await gs(g.auth.setSession({refresh_token:C}),1e4,"Session restoration timed out").catch(V=>({data:{session:null},error:{message:V.message}}));D?(console.error("Failed to restore session from long-term token:",D.message),(D.message?.includes("400")||D.message?.includes("invalid refresh token"))&&(console.warn("Invalid refresh token detected. Clearing persistent storage."),await Ve.remove({key:"supabase.auth.rememberMe"}))):A=N.session}catch(N){console.error("Exception while restoring session from long-term token:",N)}}}if(A)try{const C=await lt.getAppUserProfile(A.user);v&&t(C)}catch(C){console.error("Failed to fetch user profile during initialization:",C),v&&(t(null),i())}else v&&(t(null),i())}catch(A){console.error("Error during app initialization:",A),v&&(t(null),i())}finally{clearTimeout(_),v&&(s(!1),r(!0))}})();const{data:{subscription:b}}=g.auth.onAuthStateChange(async(A,S)=>{if(A==="PASSWORD_RECOVERY"){m("/auth/update-password",{replace:!0});return}if((A==="SIGNED_IN"||A==="TOKEN_REFRESHED")&&S)try{await Ve.set({key:"supabase.auth.rememberMe",value:S.refresh_token}),S.user.email&&await Ve.set({key:"rememberedEmail",value:S.user.email})}catch(C){console.error("Error synchronizing auth token:",C)}S?.user&&(setTimeout(async()=>{try{const C=await gs(lt.getAppUserProfile(S.user),15e3,"Profile fetch timed out").catch(N=>(console.warn("Transient error fetching profile:",N.message),n));if(v&&C){t(C);try{const N=`greetingSent_${C.id}`;localStorage.getItem(N)||(await B.createNotification({userId:C.id,message:`Good morning, ${C.name||"there"}! Welcome to Paradigm Services.`,type:"greeting"}),localStorage.setItem(N,"1"))}catch(N){console.error("Failed to send login greeting notification",N)}}}catch(C){console.error("Failed to fetch user profile after auth change:",C)}},0),v&&(t(null),i(),Pw.getState().reset()))}),w=A=>{const S=A.detail;De.getState().forceLogout(S?.message?.includes("expired")?"Your session has expired. Please log in again.":"Authentication error. Please log in again.")};return window.addEventListener("supabase-auth-failure",w),()=>{v=!1,b?.unsubscribe(),window.removeEventListener("supabase-auth-failure",w),clearTimeout(_)}},[t,r,i,s]),U.useEffect(()=>{n&&e&&((async()=>{try{const{settings:_,roles:x,holidays:b}=await B.getInitialAppData(),w=await B.getRecurringHolidays();_.enrollmentRules&&a(_.enrollmentRules),x&&d(x),_.attendanceSettings&&b&&u({holidays:b,attendanceSettings:_.attendanceSettings,recurringHolidays:w||[],apiSettings:_.apiSettings,addressSettings:_.addressSettings,geminiApiSettings:_.geminiApiSettings,offlineOcrSettings:_.offlineOcrSettings,perfiosApiSettings:_.perfiosApiSettings,otpSettings:_.otpSettings,siteManagementSettings:_.siteManagementSettings,notificationSettings:_.notificationSettings})}catch(_){console.error("Failed to load initial application data:",_)}})(),De.getState().checkAttendanceStatus(),(n.role==="admin"||n.role==="hr"||n.role==="super_admin"||n.role==="developer")&&B.autoBackupCheck())},[n,e,a,d,u]),U.useEffect(()=>{if(e&&p.pathname!=="/auth/update-password"&&n&&!o&&(p.pathname.startsWith("/auth")&&p.pathname!=="/auth/logout"||p.pathname==="/"||p.pathname==="/splash")){const v=localStorage.getItem(On),_=v&&(v.startsWith("/admin")||v.startsWith("/hr")||v.startsWith("/developer")||v.startsWith("/billing")),x=["admin","hr","super_admin","developer","management","hr_ops"].includes(n.role);v&&Rs(v)&&v!=="/"&&v!=="/#"?_&&!x?(console.warn("[App] Guarding against unauthorized lastPath redirect:",v),localStorage.removeItem(On),m("/profile",{replace:!0})):(localStorage.removeItem(On),m(v,{replace:!0})):n.role==="unverified"?m("/pending-approval",{replace:!0}):m("/profile",{replace:!0})}},[e,n,p.pathname,m,o]),e?f.jsxs(f.Fragment,{children:[f.jsx(R0,{}),f.jsx(iC,{}),n&&f.jsx(N0,{}),f.jsx(U.Suspense,{fallback:f.jsx("div",{className:"flex items-center justify-center min-h-screen",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"})}),children:f.jsxs(Ld,{children:[f.jsxs(R,{path:"/auth",element:f.jsx(Jw,{}),children:[f.jsx(R,{index:!0,element:f.jsx(kt,{to:"login",replace:!0})}),f.jsx(R,{path:"login",element:f.jsx(E0,{})}),f.jsx(R,{path:"signup",element:f.jsx(P0,{})}),f.jsx(R,{path:"forgot-password",element:f.jsx(M0,{})}),f.jsx(R,{path:"update-password",element:f.jsx(L0,{})}),f.jsx(R,{path:"logout",element:f.jsx($0,{})})]}),f.jsx(R,{path:"/public/forms",element:f.jsx(tC,{})}),f.jsx(R,{path:"/public/forms/gmc",element:f.jsx(nC,{})}),f.jsx(R,{path:"/image-viewer",element:f.jsx(rC,{})}),f.jsx(R,{path:"/pending-approval",element:n&&n.role==="unverified"?f.jsx(F0,{}):f.jsx(kt,{to:"/auth/login",replace:!0})}),f.jsx(R,{path:"/forbidden",element:f.jsx(O0,{})}),f.jsxs(R,{path:"/",element:f.jsx(px,{children:f.jsx(sC,{children:f.jsx(aC,{})})}),children:[f.jsx(R,{index:!0,element:f.jsx(kt,{to:"/profile",replace:!0})}),f.jsx(R,{element:f.jsx(Ce,{requiredPermission:"view_profile"}),children:f.jsx(R,{path:"profile",element:f.jsx(eb,{})})}),f.jsx(R,{path:"mobile-home",element:f.jsx(D0,{})}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"create_enrollment"}),children:[f.jsx(R,{path:"onboarding",element:f.jsx(V0,{})}),f.jsx(R,{path:"onboarding/select-organization",element:f.jsx(U0,{})}),f.jsx(R,{path:"onboarding/pre-upload",element:f.jsx(Cb,{})}),f.jsx(R,{path:"onboarding/submissions",element:f.jsx(Tb,{})}),f.jsx(R,{path:"onboarding/aadhaar-scan",element:f.jsx(eC,{})}),f.jsx(R,{path:"onboarding/tasks",element:f.jsx(Sb,{})}),f.jsx(R,{path:"onboarding/uniforms",element:f.jsx(Eb,{})}),f.jsxs(R,{path:"onboarding/add",element:f.jsx(q0,{}),children:[f.jsx(R,{path:"personal",element:f.jsx(qb,{})}),f.jsx(R,{path:"address",element:f.jsx(jb,{})}),f.jsx(R,{path:"organization",element:f.jsx(Bb,{})}),f.jsx(R,{path:"family",element:f.jsx(Gb,{})}),f.jsx(R,{path:"education",element:f.jsx(Hb,{})}),f.jsx(R,{path:"bank",element:f.jsx(zb,{})}),f.jsx(R,{path:"uan",element:f.jsx(Wb,{})}),f.jsx(R,{path:"esi",element:f.jsx(Jb,{})}),f.jsx(R,{path:"gmc",element:f.jsx(Yb,{})}),f.jsx(R,{path:"uniform",element:f.jsx(Kb,{})}),f.jsx(R,{path:"documents",element:f.jsx(Zb,{})}),f.jsx(R,{path:"biometrics",element:f.jsx(Xb,{})}),f.jsx(R,{path:"review",element:f.jsx(Qb,{})})]}),f.jsx(R,{path:"onboarding/pdf/:id",element:f.jsx(gb,{})})]}),f.jsx(R,{element:f.jsx(Ce,{requiredPermission:"view_all_submissions"}),children:f.jsx(R,{path:"verification/dashboard",element:f.jsx(j0,{})})}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"manage_users"}),children:[f.jsx(R,{path:"admin/users",element:f.jsx(B0,{})}),f.jsx(R,{path:"admin/users/add",element:f.jsx(ql,{})}),f.jsx(R,{path:"admin/users/edit/:id",element:f.jsx(ql,{})}),f.jsx(R,{path:"admin/users/bulk-update-leaves",element:f.jsx(G0,{})})]}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"manage_biometric_devices"}),children:[f.jsx(R,{path:"admin/devices",element:f.jsx(J0,{})}),f.jsx(R,{path:"admin/device-approvals",element:f.jsx(Y0,{})})]}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"manage_sites"}),children:[f.jsx(R,{path:"admin/sites",element:f.jsx(H0,{})}),f.jsx(R,{path:"admin/sites/add",element:f.jsx(Vb,{})}),f.jsx(R,{path:"admin/sites/quick-add",element:f.jsx(Ub,{})})]}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"manage_roles_and_permissions"}),children:[f.jsx(R,{path:"admin/roles",element:f.jsx(z0,{})}),f.jsx(R,{path:"admin/roles/add",element:f.jsx(jl,{})}),f.jsx(R,{path:"admin/roles/edit/:id",element:f.jsx(jl,{})})]}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"manage_modules"}),children:[f.jsx(R,{path:"admin/modules",element:f.jsx(W0,{})}),f.jsx(R,{path:"admin/modules/add",element:f.jsx(Ob,{})})]}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"manage_approval_workflow"}),children:[f.jsx(R,{path:"admin/approval-workflow",element:f.jsx(db,{})}),f.jsx(R,{path:"admin/approval-workflow/chart",element:f.jsx(fb,{})})]}),f.jsx(R,{element:f.jsx(Ce,{requiredPermission:"view_developer_settings"}),children:f.jsx(R,{path:"developer/api",element:f.jsx(K0,{})})}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"view_operations_dashboard"}),children:[f.jsx(R,{path:"operations/dashboard",element:f.jsx(Z0,{})}),f.jsx(R,{path:"operations/team-activity",element:f.jsx(X0,{})})]}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"view_my_team"}),children:[f.jsx(R,{path:"my-team",element:f.jsx(Ib,{})}),f.jsx(R,{path:"my-team/reporting",element:f.jsx(Pb,{})}),f.jsx(R,{path:"my-team/:id",element:f.jsx(Db,{})})]}),f.jsx(R,{element:f.jsx(Ce,{requiredPermission:"view_field_reports"}),children:f.jsx(R,{path:"my-team/field-reports",element:f.jsx(Nb,{})})}),f.jsx(R,{element:f.jsx(Ce,{requiredPermission:"view_site_dashboard"}),children:f.jsx(R,{path:"site/dashboard",element:f.jsx(Q0,{})})}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"view_own_attendance"}),children:[f.jsx(R,{path:"attendance/dashboard",element:f.jsx(tb,{})}),f.jsx(R,{path:"attendance/check-in",element:f.jsx(ar,{})}),f.jsx(R,{path:"attendance/check-out",element:f.jsx(ar,{})}),f.jsx(R,{path:"attendance/break-in",element:f.jsx(ar,{})}),f.jsx(R,{path:"attendance/break-out",element:f.jsx(ar,{})}),f.jsx(R,{path:"attendance/request-unlock",element:f.jsx(ib,{})})]}),f.jsx(R,{element:f.jsx(Ce,{requiredPermission:"view_my_locations"}),children:f.jsx(R,{path:"attendance/locations",element:f.jsx(rb,{})})}),f.jsx(R,{path:"settings/devices",element:f.jsx(nb,{})}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"apply_for_leave"}),children:[f.jsx(R,{path:"leaves/dashboard",element:f.jsx(ab,{})}),f.jsx(R,{path:"leaves/apply",element:f.jsx(lb,{})}),f.jsx(R,{path:"leaves/holiday-selection",element:f.jsx(cb,{})})]}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"manage_attendance_rules"}),children:[f.jsx(R,{path:"hr/attendance-settings",element:f.jsx(sb,{})}),f.jsx(R,{path:"hr/notification-management",element:f.jsx(ob,{})})]}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"manage_leave_requests"}),children:[f.jsx(R,{path:"hr/leave-management",element:f.jsx(ub,{})}),f.jsx(R,{path:"hr/leave-management/grant-comp-off",element:f.jsx(Fb,{})})]}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"view_entity_management"}),children:[f.jsx(R,{path:"hr/entity-management",element:f.jsx(mb,{})}),f.jsx(R,{path:"hr/entity-management/add-group",element:f.jsx($b,{})})]}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"manage_policies"}),children:[f.jsx(R,{path:"hr/policies-and-insurance",element:f.jsx(pb,{})}),f.jsx(R,{path:"hr/policies/add",element:f.jsx(Mb,{})})]}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"manage_enrollment_rules"}),children:[f.jsx(R,{path:"hr/enrollment-rules",element:f.jsx(hb,{})}),f.jsx(R,{path:"hr/field-staff-tracking",element:f.jsx(Ce,{requiredPermission:"view_field_staff_tracking",children:f.jsx(xb,{})})})]}),f.jsx(R,{element:f.jsx(Ce,{requiredPermission:"manage_geo_locations"}),children:f.jsx(R,{path:"hr/locations",element:f.jsx(bb,{})})}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"manage_uniforms"}),children:[f.jsx(R,{path:"uniforms",element:f.jsx(yb,{})}),f.jsx(R,{path:"uniforms/request/new",element:f.jsx(Gl,{})}),f.jsx(R,{path:"uniforms/request/edit/:id",element:f.jsx(Gl,{})})]}),f.jsx(R,{element:f.jsx(Ce,{requiredPermission:"view_verification_costing"}),children:f.jsx(R,{path:"billing/cost-analysis",element:f.jsx(_b,{})})}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"view_attendance_tracker"}),children:[f.jsx(R,{path:"finance",element:f.jsx(wb,{})}),f.jsx(R,{path:"finance/attendance/add",element:f.jsx(Vl,{})}),f.jsx(R,{path:"finance/attendance/edit/:id",element:f.jsx(Vl,{})}),f.jsx(R,{path:"finance/site-tracker/add",element:f.jsx(Ul,{})}),f.jsx(R,{path:"finance/site-tracker/edit/:id",element:f.jsx(Ul,{})})]}),f.jsx(R,{element:f.jsx(Ce,{requiredPermission:"view_invoice_summary"}),children:f.jsx(R,{path:"billing/summary",element:f.jsx(vb,{})})}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"manage_tasks"}),children:[f.jsx(R,{path:"tasks",element:f.jsx(Rb,{})}),f.jsx(R,{path:"tasks/add",element:f.jsx(Bl,{})}),f.jsx(R,{path:"tasks/edit/:id",element:f.jsx(Bl,{})})]}),f.jsxs(R,{element:f.jsx(Ce,{requiredPermission:"access_support_desk"}),children:[f.jsx(R,{path:"support",element:f.jsx(Ab,{})}),f.jsx(R,{path:"support/ticket/new",element:f.jsx(Lb,{})}),f.jsx(R,{path:"support/ticket/:id",element:f.jsx(kb,{})})]})]}),f.jsx(R,{path:"*",element:f.jsx(kt,{to:"/",replace:!0})})]})})]}):f.jsx(gx,{})};var Hl={},cC="@vercel/speed-insights",uC="1.3.1",dC=()=>{window.si||(window.si=function(...e){(window.siq=window.siq||[]).push(e)})};function fC(){return typeof window<"u"}function mC(){try{const n="production"}catch{}return"production"}function Ru(){return mC()==="development"}function pC(n){return n.scriptSrc?n.scriptSrc:Ru()?"https://va.vercel-scripts.com/v1/speed-insights/script.debug.js":n.dsn?"https://va.vercel-scripts.com/v1/speed-insights/script.js":n.basePath?`${n.basePath}/speed-insights/script.js`:"/_vercel/speed-insights/script.js"}function hC(n={}){var e;if(!fC()||n.route===null)return null;dC();const t=pC(n);if(document.head.querySelector(`script[src*="${t}"]`))return null;n.beforeSend&&((e=window.si)==null||e.call(window,"beforeSend",n.beforeSend));const r=document.createElement("script");return r.src=t,r.defer=!0,r.dataset.sdkn=cC+(n.framework?`/${n.framework}`:""),r.dataset.sdkv=uC,n.sampleRate&&(r.dataset.sampleRate=n.sampleRate.toString()),n.route&&(r.dataset.route=n.route),n.endpoint?r.dataset.endpoint=n.endpoint:n.basePath&&(r.dataset.endpoint=`${n.basePath}/speed-insights/vitals`),n.dsn&&(r.dataset.dsn=n.dsn),Ru()&&n.debug===!1&&(r.dataset.debug="false"),r.onerror=()=>{console.log(`[Vercel Speed Insights] Failed to load script from ${t}. Please check if any content blockers are enabled and try again.`)},document.head.appendChild(r),{setRoute:i=>{r.dataset.route=i??void 0}}}function gC(){if(!(typeof process>"u"||typeof Hl>"u"))return Hl.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}function yC(n){U.useEffect(()=>{var t;n.beforeSend&&((t=window.si)==null||t.call(window,"beforeSend",n.beforeSend))},[n.beforeSend]);const e=U.useRef(null);return U.useEffect(()=>{if(e.current)n.route&&e.current(n.route);else{const t=hC({framework:n.framework??"react",basePath:n.basePath??gC(),...n});t&&(e.current=t.setRoute)}},[n.route]),null}var _C=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),Du=function(n,e,t,r){function i(s){return s instanceof t?s:new t((function(o){o(s)}))}return new(t||(t=Promise))((function(s,o){function a(m){try{u(r.next(m))}catch(p){o(p)}}function d(m){try{u(r.throw(m))}catch(p){o(p)}}function u(m){m.done?s(m.value):i(m.value).then(a,d)}u((r=r.apply(n,e||[])).next())}))},Pu=function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(m){return d([u,m])}}function d(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(t=0)),t;)try{if(r=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(m){u=[6,m],i=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},zl=function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))},vC="ionicpwaelements",yr,Mu,nt=!1,Ds=!1,Rt=function(n,e){return function(){}},wC=function(n,e){return function(){}},xC="{visibility:hidden}.hydrated{visibility:inherit}",Wl={},bC="http://www.w3.org/2000/svg",CC="http://www.w3.org/1999/xhtml",TC=function(n){return n!=null},Zs=function(n){return n=typeof n,n==="object"||n==="function"};function Lu(n){var e,t,r;return(r=(t=(e=n.head)===null||e===void 0?void 0:e.querySelector('meta[name="csp-nonce"]'))===null||t===void 0?void 0:t.getAttribute("content"))!==null&&r!==void 0?r:void 0}var SC=function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=null,s=!1,o=!1,a=[],d=function(p){for(var h=0;h<p.length;h++)i=p[h],Array.isArray(i)?d(i):i!=null&&typeof i!="boolean"&&((s=typeof n!="function"&&!Zs(i))&&(i=String(i)),s&&o?a[a.length-1].$text$+=i:a.push(s?Ps(null,i):i),o=s)};if(d(t),e){var u=e.className||e.class;u&&(e.class=typeof u!="object"?u:Object.keys(u).filter((function(p){return u[p]})).join(" "))}var m=Ps(n,null);return m.$attrs$=e,a.length>0&&(m.$children$=a),m},Ps=function(n,e){var t={$flags$:0,$tag$:n,$text$:e,$elm$:null,$children$:null};return t.$attrs$=null,t},EC={},AC=function(n){return n&&n.$tag$===EC},kC=function(n,e){return n!=null&&!Zs(n)?e&4?n==="false"?!1:n===""||!!n:e&2?parseFloat(n):e&1?String(n):n:n},IC=function(n){return Gt(n).$hostElement$},yT=function(n,e,t){var r=IC(n);return{emit:function(i){return $u(r,e,{bubbles:!0,composed:!0,cancelable:!0,detail:i})}}},$u=function(n,e,t){var r=Ue.ce(e,t);return n.dispatchEvent(r),r},Jl=new WeakMap,NC=function(n,e,t){var r=$r.get(n);QC&&t?(r=r||new CSSStyleSheet,typeof r=="string"?r=e:r.replaceSync(e)):r=e,$r.set(n,r)},RC=function(n,e,t,r){var i,s=Fu(e),o=$r.get(s);if(n=n.nodeType===11?n:pt,o)if(typeof o=="string"){n=n.head||n;var a=Jl.get(n),d=void 0;if(a||Jl.set(n,a=new Set),!a.has(s)){{d=pt.createElement("style"),d.innerHTML=o;var u=(i=Ue.$nonce$)!==null&&i!==void 0?i:Lu(pt);u!=null&&d.setAttribute("nonce",u),n.insertBefore(d,n.querySelector("link"))}a&&a.add(s)}}else n.adoptedStyleSheets.includes(o)||(n.adoptedStyleSheets=zl(zl([],n.adoptedStyleSheets,!0),[o],!1));return s},DC=function(n){var e=n.$cmpMeta$,t=n.$hostElement$,r=e.$flags$,i=Rt("attachStyles",e.$tagName$),s=RC(t.shadowRoot?t.shadowRoot:t.getRootNode(),e);r&10&&(t["s-sc"]=s,t.classList.add(s+"-h")),i()},Fu=function(n,e){return"sc-"+n.$tagName$},Yl=function(n,e,t,r,i,s){if(t!==r){var o=Zl(n,e),a=e.toLowerCase();if(e==="class"){var d=n.classList,u=Kl(t),m=Kl(r);d.remove.apply(d,u.filter((function(v){return v&&!m.includes(v)}))),d.add.apply(d,m.filter((function(v){return v&&!u.includes(v)})))}else if(e==="style"){for(var p in t)(!r||r[p]==null)&&(p.includes("-")?n.style.removeProperty(p):n.style[p]="");for(var p in r)(!t||r[p]!==t[p])&&(p.includes("-")?n.style.setProperty(p,r[p]):n.style[p]=r[p])}else if(e==="ref")r&&r(n);else if(!o&&e[0]==="o"&&e[1]==="n")e[2]==="-"?e=e.slice(3):Zl(Xr,a)?e=a.slice(2):e=a[2]+e.slice(3),t&&Ue.rel(n,e,t,!1),r&&Ue.ael(n,e,r,!1);else{var h=Zs(r);if((o||h&&r!==null)&&!i)try{if(n.tagName.includes("-"))n[e]=r;else{var y=r??"";e==="list"?o=!1:(t==null||n[e]!=y)&&(n[e]=y)}}catch{}r==null||r===!1?(r!==!1||n.getAttribute(e)==="")&&n.removeAttribute(e):(!o||s&4||i)&&!h&&(r=r===!0?"":r,n.setAttribute(e,r))}}},PC=/\s/,Kl=function(n){return n?n.split(PC):[]},Ou=function(n,e,t,r){var i=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,s=n&&n.$attrs$||Wl,o=e.$attrs$||Wl;for(r in s)r in o||Yl(i,r,s[r],void 0,t,e.$flags$);for(r in o)Yl(i,r,s[r],o[r],t,e.$flags$)},Xs=function(n,e,t,r){var i=e.$children$[t],s=0,o,a;if(i.$text$!==null)o=i.$elm$=pt.createTextNode(i.$text$);else{if(nt||(nt=i.$tag$==="svg"),o=i.$elm$=pt.createElementNS(nt?bC:CC,i.$tag$),nt&&i.$tag$==="foreignObject"&&(nt=!1),Ou(null,i,nt),TC(yr)&&o["s-si"]!==yr&&o.classList.add(o["s-si"]=yr),i.$children$)for(s=0;s<i.$children$.length;++s)a=Xs(n,i,s),a&&o.appendChild(a);i.$tag$==="svg"?nt=!1:o.tagName==="foreignObject"&&(nt=!0)}return o},Vu=function(n,e,t,r,i,s){var o=n,a;for(o.shadowRoot&&o.tagName===Mu&&(o=o.shadowRoot);i<=s;++i)r[i]&&(a=Xs(null,t,i),a&&(r[i].$elm$=a,o.insertBefore(a,e)))},Uu=function(n,e,t){for(var r=e;r<=t;++r){var i=n[r];if(i){var s=i.$elm$;qu(i),s&&s.remove()}}},MC=function(n,e,t,r){for(var i=0,s=0,o=e.length-1,a=e[0],d=e[o],u=r.length-1,m=r[0],p=r[u],h;i<=o&&s<=u;)a==null?a=e[++i]:d==null?d=e[--o]:m==null?m=r[++s]:p==null?p=r[--u]:lr(a,m)?(Vn(a,m),a=e[++i],m=r[++s]):lr(d,p)?(Vn(d,p),d=e[--o],p=r[--u]):lr(a,p)?(Vn(a,p),n.insertBefore(a.$elm$,d.$elm$.nextSibling),a=e[++i],p=r[--u]):lr(d,m)?(Vn(d,m),n.insertBefore(d.$elm$,a.$elm$),d=e[--o],m=r[++s]):(h=Xs(e&&e[s],t,s),m=r[++s],h&&a.$elm$.parentNode.insertBefore(h,a.$elm$));i>o?Vu(n,r[u+1]==null?null:r[u+1].$elm$,t,r,s,u):s>u&&Uu(e,i,o)},lr=function(n,e){return n.$tag$===e.$tag$},Vn=function(n,e){var t=e.$elm$=n.$elm$,r=n.$children$,i=e.$children$,s=e.$tag$,o=e.$text$;o===null?(nt=s==="svg"?!0:s==="foreignObject"?!1:nt,Ou(n,e,nt),r!==null&&i!==null?MC(t,r,e,i):i!==null?(n.$text$!==null&&(t.textContent=""),Vu(t,null,e,i,0,i.length-1)):r!==null&&Uu(r,0,r.length-1),nt&&s==="svg"&&(nt=!1)):n.$text$!==o&&(t.data=o)},qu=function(n){n.$attrs$&&n.$attrs$.ref&&n.$attrs$.ref(null),n.$children$&&n.$children$.map(qu)},LC=function(n,e){var t=n.$hostElement$,r=n.$vnode$||Ps(null,null),i=AC(e)?e:SC(null,null,e);Mu=t.tagName,i.$tag$=null,i.$flags$|=4,n.$vnode$=i,i.$elm$=r.$elm$=t.shadowRoot||t,yr=t["s-sc"],Vn(r,i)},ju=function(n,e){e&&!n.$onRenderResolve$&&e["s-p"]&&e["s-p"].push(new Promise((function(t){return n.$onRenderResolve$=t})))},Zr=function(n,e){if(n.$flags$|=16,n.$flags$&4){n.$flags$|=512;return}ju(n,n.$ancestorComponent$);var t=function(){return $C(n,e)};return tT(t)},$C=function(n,e){var t=Rt("scheduleUpdate",n.$cmpMeta$.$tagName$),r=n.$lazyInstance$,i;return e&&(n.$flags$|=256,n.$queuedListeners$&&(n.$queuedListeners$.map((function(s){var o=s[0],a=s[1];return Qs(r,o,a)})),n.$queuedListeners$=void 0)),t(),FC(i,(function(){return VC(n,r,e)}))},FC=function(n,e){return OC(n)?n.then(e):e()},OC=function(n){return n instanceof Promise||n&&n.then&&typeof n.then=="function"},VC=function(n,e,t){return Du(void 0,void 0,void 0,(function(){var r,i,s,o,a,d,u;return Pu(this,(function(m){return i=n.$hostElement$,s=Rt("update",n.$cmpMeta$.$tagName$),o=i["s-rc"],t&&DC(n),a=Rt("render",n.$cmpMeta$.$tagName$),UC(n,e),o&&(o.map((function(p){return p()})),i["s-rc"]=void 0),a(),s(),d=(r=i["s-p"])!==null&&r!==void 0?r:[],u=function(){return qC(n)},d.length===0?u():(Promise.all(d).then(u),n.$flags$|=4,d.length=0),[2]}))}))},UC=function(n,e,t){try{e=e.render(),n.$flags$&=-17,n.$flags$|=2,LC(n,e)}catch(r){ct(r,n.$hostElement$)}return null},qC=function(n){n.$cmpMeta$.$tagName$;var e=n.$hostElement$,t=Rt(),r=n.$lazyInstance$,i=n.$ancestorComponent$;n.$flags$&64?t():(n.$flags$|=64,Gu(e),Qs(r,"componentDidLoad"),t(),n.$onReadyResolve$(e),i||Bu()),n.$onInstanceResolve$(e),n.$onRenderResolve$&&(n.$onRenderResolve$(),n.$onRenderResolve$=void 0),n.$flags$&512&&to((function(){return Zr(n,!1)})),n.$flags$&=-517},_T=function(n){{var e=Gt(n),t=e.$hostElement$.isConnected;return t&&(e.$flags$&18)===2&&Zr(e,!1),t}},Bu=function(n){Gu(pt.documentElement),to((function(){return $u(Xr,"appload",{detail:{namespace:vC}})}))},Qs=function(n,e,t){if(n&&n[e])try{return n[e](t)}catch(r){ct(r)}},Gu=function(n){return n.classList.add("hydrated")},jC=function(n,e){return Gt(n).$instanceValues$.get(e)},BC=function(n,e,t,r){var i=Gt(n),s=i.$instanceValues$.get(e),o=i.$flags$,a=i.$lazyInstance$;t=kC(t,r.$members$[e][0]);var d=Number.isNaN(s)&&Number.isNaN(t),u=t!==s&&!d;(!(o&8)||s===void 0)&&u&&(i.$instanceValues$.set(e,t),a&&(o&18)===2&&Zr(i,!1))},Hu=function(n,e,t){if(e.$members$){var r=Object.entries(e.$members$),i=n.prototype;if(r.map((function(o){var a=o[0],d=o[1][0];d&31||t&2&&d&32?Object.defineProperty(i,a,{get:function(){return jC(this,a)},set:function(u){BC(this,a,u,e)},configurable:!0,enumerable:!0}):t&1&&d&64&&Object.defineProperty(i,a,{value:function(){for(var u=[],m=0;m<arguments.length;m++)u[m]=arguments[m];var p=Gt(this);return p.$onInstancePromise$.then((function(){var h;return(h=p.$lazyInstance$)[a].apply(h,u)}))}})})),t&1){var s=new Map;i.attributeChangedCallback=function(o,a,d){var u=this;Ue.jmp((function(){var m=s.get(o);if(u.hasOwnProperty(m))d=u[m],delete u[m];else if(i.hasOwnProperty(m)&&typeof u[m]=="number"&&u[m]==d)return;u[m]=d===null&&typeof u[m]=="boolean"?!1:d}))},n.observedAttributes=r.filter((function(o){o[0];var a=o[1];return a[0]&15})).map((function(o){var a=o[0],d=o[1],u=d[1]||a;return s.set(u,a),u}))}}return n},GC=function(n,e,t,r,i){return Du(void 0,void 0,void 0,(function(){var s,o,a,d,u,m,p;return Pu(this,(function(h){switch(h.label){case 0:return(e.$flags$&32)!==0?[3,3]:(e.$flags$|=32,i=XC(t),i.then?(s=wC(),[4,i]):[3,2]);case 1:i=h.sent(),s(),h.label=2;case 2:i.isProxied||(Hu(i,t,2),i.isProxied=!0),o=Rt("createInstance",t.$tagName$),e.$flags$|=8;try{new i(e)}catch(y){ct(y)}e.$flags$&=-9,o(),i.style&&(a=i.style,d=Fu(t),$r.has(d)||(u=Rt("registerStyles",t.$tagName$),NC(d,a,!!(t.$flags$&1)),u())),h.label=3;case 3:return m=e.$ancestorComponent$,p=function(){return Zr(e,!0)},m&&m["s-rc"]?m["s-rc"].push(p):p(),[2]}}))}))},HC=function(n){if((Ue.$flags$&1)===0){var e=Gt(n),t=e.$cmpMeta$,r=Rt("connectedCallback",t.$tagName$);if(e.$flags$&1)zu(n,e,t.$listeners$);else{e.$flags$|=1;for(var i=n;i=i.parentNode||i.host;)if(i["s-p"]){ju(e,e.$ancestorComponent$=i);break}t.$members$&&Object.entries(t.$members$).map((function(s){var o=s[0],a=s[1][0];if(a&31&&n.hasOwnProperty(o)){var d=n[o];delete n[o],n[o]=d}})),GC(n,e,t)}r()}},zC=function(n){if((Ue.$flags$&1)===0){var e=Gt(n),t=e.$lazyInstance$;e.$rmListeners$&&(e.$rmListeners$.map((function(r){return r()})),e.$rmListeners$=void 0),Qs(t,"disconnectedCallback")}},WC=function(n,e){e===void 0&&(e={});var t,r=Rt(),i=[],s=e.exclude||[],o=Xr.customElements,a=pt.head,d=a.querySelector("meta[charset]"),u=pt.createElement("style"),m=[],p,h=!0;Object.assign(Ue,e),Ue.$resourcesUrl$=new URL(e.resourcesUrl||"./",pt.baseURI).href,n.map((function(v){v[1].map((function(_){var x={$flags$:_[0],$tagName$:_[1],$members$:_[2],$listeners$:_[3]};x.$members$=_[2],x.$listeners$=_[3];var b=x.$tagName$,w=(function(A){_C(S,A);function S(C){var N=A.call(this,C)||this;return C=N,ZC(C,x),x.$flags$&1&&C.attachShadow({mode:"open"}),N}return S.prototype.connectedCallback=function(){var C=this;p&&(clearTimeout(p),p=null),h?m.push(this):Ue.jmp((function(){return HC(C)}))},S.prototype.disconnectedCallback=function(){var C=this;Ue.jmp((function(){return zC(C)}))},S.prototype.componentOnReady=function(){return Gt(this).$onReadyPromise$},S})(HTMLElement);x.$lazyBundleId$=v[0],!s.includes(b)&&!o.get(b)&&(i.push(b),o.define(b,Hu(w,x,1)))}))}));{u.innerHTML=i+xC,u.setAttribute("data-styles","");var y=(t=Ue.$nonce$)!==null&&t!==void 0?t:Lu(pt);y!=null&&u.setAttribute("nonce",y),a.insertBefore(u,d?d.nextSibling:a.firstChild)}h=!1,m.length?m.map((function(v){return v.connectedCallback()})):Ue.jmp((function(){return p=setTimeout(Bu,30)})),r()},zu=function(n,e,t,r){t&&t.map((function(i){var s=i[0],o=i[1],a=i[2],d=YC(n,s),u=JC(e,a),m=KC(s);Ue.ael(d,o,u,m),(e.$rmListeners$=e.$rmListeners$||[]).push((function(){return Ue.rel(d,o,u,m)}))}))},JC=function(n,e){return function(t){try{n.$flags$&256?n.$lazyInstance$[e](t):(n.$queuedListeners$=n.$queuedListeners$||[]).push([e,t])}catch(r){ct(r)}}},YC=function(n,e){return e&16?pt.body:n},KC=function(n){return(n&2)!==0},eo=new WeakMap,Gt=function(n){return eo.get(n)},vT=function(n,e){return eo.set(e.$lazyInstance$=n,e)},ZC=function(n,e){var t={$flags$:0,$hostElement$:n,$cmpMeta$:e,$instanceValues$:new Map};return t.$onInstancePromise$=new Promise((function(r){return t.$onInstanceResolve$=r})),t.$onReadyPromise$=new Promise((function(r){return t.$onReadyResolve$=r})),n["s-p"]=[],n["s-rc"]=[],zu(n,t,e.$listeners$),eo.set(n,t)},Zl=function(n,e){return e in n},ct=function(n,e){return(0,console.error)(n,e)},ji=new Map,XC=function(n,e,t){var r=n.$tagName$.replace(/-/g,"_"),i=n.$lazyBundleId$,s=ji.get(i);if(s)return s[r];{var o=function(a){return ji.set(i,a),a[r]};switch(i){case"pwa-action-sheet":return F(()=>import("./pwa-action-sheet.entry-BW90n4zH.js"),__vite__mapDeps([128,9,1,2,4,10,11])).then(o,ct);case"pwa-camera-modal":return F(()=>import("./pwa-camera-modal.entry-DhCuPX6t.js"),__vite__mapDeps([129,9,1,2,4,10,11])).then(o,ct);case"pwa-toast":return F(()=>import("./pwa-toast.entry-BRAaddZT.js"),__vite__mapDeps([130,9,1,2,4,10,11])).then(o,ct);case"pwa-camera-modal-instance":return F(()=>import("./pwa-camera-modal-instance.entry-D7XwVe-F.js"),__vite__mapDeps([131,9,1,2,4,10,11])).then(o,ct);case"pwa-camera":return F(()=>import("./pwa-camera.entry-fK-_DVFp.js"),__vite__mapDeps([132,9,1,2,4,10,11])).then(o,ct)}}return F(()=>import("./".concat(i,".entry.js").concat("")),[]).then((function(a){return ji.set(i,a),a[r]}),ct)},$r=new Map,Xr=typeof window<"u"?window:{},pt=Xr.document||{head:{}},Ue={$flags$:0,$resourcesUrl$:"",jmp:function(n){return n()},raf:function(n){return requestAnimationFrame(n)},ael:function(n,e,t,r){return n.addEventListener(e,t,r)},rel:function(n,e,t,r){return n.removeEventListener(e,t,r)},ce:function(n,e){return new CustomEvent(n,e)}},Wu=function(n){return Promise.resolve(n)},QC=(function(){try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),Xl=[],Ju=[],eT=function(n,e){return function(t){n.push(t),Ds||(Ds=!0,Ue.$flags$&4?to(Ms):Ue.raf(Ms))}},Ql=function(n){for(var e=0;e<n.length;e++)try{n[e](performance.now())}catch(t){ct(t)}n.length=0},Ms=function(){Ql(Xl),Ql(Ju),(Ds=Xl.length>0)&&Ue.raf(Ms)},to=function(n){return Wu().then(n)},tT=eT(Ju),nT=function(){return Wu()},rT=function(n,e){return typeof window>"u"?Promise.resolve():nT().then((function(){return WC([["pwa-camera-modal",[[1,"pwa-camera-modal",{facingMode:[1,"facing-mode"],hidePicker:[4,"hide-picker"],present:[64],dismiss:[64]}]]],["pwa-action-sheet",[[1,"pwa-action-sheet",{header:[1],cancelable:[4],options:[16],open:[32]}]]],["pwa-toast",[[1,"pwa-toast",{message:[1],duration:[2],closing:[32]}]]],["pwa-camera",[[1,"pwa-camera",{facingMode:[1,"facing-mode"],handlePhoto:[16],hidePicker:[4,"hide-picker"],handleNoDeviceError:[16],noDevicesText:[1,"no-devices-text"],noDevicesButtonText:[1,"no-devices-button-text"],photo:[32],photoSrc:[32],showShutterOverlay:[32],flashIndex:[32],hasCamera:[32],rotation:[32],deviceError:[32]}]]],["pwa-camera-modal-instance",[[1,"pwa-camera-modal-instance",{facingMode:[1,"facing-mode"],hidePicker:[4,"hide-picker"],noDevicesText:[1,"no-devices-text"],noDevicesButtonText:[1,"no-devices-button-text"]},[[16,"keyup","handleBackdropKeyUp"]]]]]],e)}))};(function(){if(typeof window<"u"&&window.Reflect!==void 0&&window.customElements!==void 0){var n=HTMLElement;window.HTMLElement=function(){return Reflect.construct(n,[],this.constructor)},HTMLElement.prototype=n.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,n)}})();const Yu=document.getElementById("root");if(!Yu)throw new Error("Could not find root element to mount to");rT();const iT=Hd.createRoot(Yu);iT.render(f.jsx(Z.StrictMode,{children:f.jsxs($d,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[f.jsx(lC,{}),f.jsx(yC,{})]})}));export{zd as $,fT as A,$e as B,pT as C,_w as D,ws as E,dT as F,Yc as G,$c as H,Ns as I,_s as J,Be as K,Qt as L,ki as M,Jv as N,hT as O,Uc as P,g0 as Q,xu as R,r0 as S,Vw as T,Sw as U,Wc as V,lx as W,Zc as X,Cn as Y,wx as Z,He as _,En as a,Wd as a0,ys as a1,SC as a2,IC as a3,vT as a4,yT as a5,EC as a6,_T as a7,mT as a8,qw as b,$x as c,Au as d,Is as e,gT as f,lt as g,Pw as h,Bs as i,f as j,rr as k,Aw as l,B as m,Dw as n,Vx as o,Nu as p,b0 as q,sx as r,g as s,ox as t,De as u,ax as v,Mw as w,vl as x,Lw as y,Gr as z};
