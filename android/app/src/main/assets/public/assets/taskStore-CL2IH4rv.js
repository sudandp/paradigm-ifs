import{j as c}from"./utils-vendor-DmorxLnX.js";import{m as o,Y as n}from"./index-D5q3SS3D.js";const k=c(s=>({tasks:[],isLoading:!1,error:null,fetchTasks:async()=>{s({isLoading:!0,error:null});try{const a=await o.getTasks();s({tasks:a,isLoading:!1})}catch{s({error:"Failed to fetch tasks.",isLoading:!1})}},createTask:async a=>{try{const t=await o.createTask(a);s(e=>({tasks:[t,...e.tasks]}))}catch(t){throw console.error("Failed to create task",t),new Error("Failed to create task.")}},updateTask:async(a,t)=>{try{const e=await o.updateTask(a,t);s(r=>({tasks:r.tasks.map(i=>i.id===a?e:i)}))}catch(e){throw console.error("Failed to update task",e),new Error("Failed to update task.")}},deleteTask:async a=>{try{await o.deleteTask(a),s(t=>({tasks:t.tasks.filter(e=>e.id!==a)}))}catch(t){throw console.error("Failed to delete task",t),new Error("Failed to delete task.")}},runAutomaticEscalations:async()=>{try{const{updatedTasks:a,newNotifications:t}=await o.runAutomaticEscalations();if(a.length>0&&s(e=>({tasks:e.tasks.map(r=>a.find(i=>i.id===r.id)||r)})),t.length>0){const e=t.map(r=>o.createNotification(r));await Promise.all(e),n.getState().fetchNotifications()}}catch(a){console.error("Failed to run automatic escalations",a)}}}));export{k as u};
