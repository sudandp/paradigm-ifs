import{u as c,j as e,T as h,B as u,m as p,K as b}from"./index-D5q3SS3D.js";import{u as y,b as d}from"./react-vendor-BUaIliXj.js";import{b3 as f,T as w,b as v}from"./ui-vendor-B8EvWqdc.js";import"./pdf-vendor-CB_F1AVu.js";import"./capacitor-vendor-CqiIOUn1.js";import"./utils-vendor-DmorxLnX.js";import"./supabase-7WG3J4rU.js";const C=()=>{const n=y(),{user:t}=c(),[s,x]=d.useState(""),[m,i]=d.useState(!1),[l,o]=d.useState(null),a=c(r=>r.dailyUnlockRequestCount)>=1,g=async()=>{if(!s.trim()){o({message:"Please enter a reason for the request.",type:"error"});return}i(!0);try{await p.requestAttendanceUnlock(s),t&&await b("punch_unlock_request",{actorName:t.name,actionText:a?"has requested an overtime (OT) punch unlock":"has requested an emergency punch unlock",locString:"",title:a?"OT Punch Request":"Emergency Punch Request",link:"/my-team",actor:{id:t.id,name:t.name,reportingManagerId:t.reportingManagerId,role:t.role}}),o({message:a?"OT punch request submitted. Awaiting manager approval.":"Unlock request submitted successfully.",type:"success"}),setTimeout(()=>{n("/profile",{replace:!0})},1500)}catch(r){console.error(r),o({message:"Failed to submit request.",type:"error"}),i(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto md:pt-8 animate-in fade-in duration-500",children:[l&&e.jsx(h,{message:l.message,type:l.type,onDismiss:()=>o(null)}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6 md:mb-8 md:bg-white md:p-4 md:rounded-2xl md:shadow-sm",children:[e.jsx("button",{onClick:()=>n("/profile"),className:"w-10 h-10 flex items-center justify-center rounded-xl bg-transparent text-emerald-500 hover:bg-emerald-50 active:scale-95 transition-all",children:e.jsx(f,{className:"h-8 w-8"})}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white md:text-gray-900",children:a?"Overtime Punch Request":"Emergency Punch"})]}),e.jsx("div",{className:"md:bg-white md:p-8 md:rounded-[2rem] md:shadow-xl md:border md:border-gray-100",children:e.jsxs("div",{className:"max-w-3xl mx-auto space-y-6 md:space-y-8",children:[e.jsxs("div",{className:`p-6 rounded-2xl border shadow-sm ${a?"bg-[#2c1a0d] md:bg-orange-50/50 border-orange-500/20 md:border-orange-100":"bg-[#0d2c18] md:bg-emerald-50/50 border-amber-500/20 md:border-emerald-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(w,{className:`h-6 w-6 ${a?"text-orange-500 md:text-orange-600":"text-amber-500 md:text-emerald-600"}`}),e.jsx("h2",{className:`font-bold text-lg mb-0 ${a?"text-orange-500 md:text-orange-900":"text-amber-500 md:text-emerald-900"}`,children:a?"Overtime Policy":"Usage Policy"})]}),e.jsx("p",{className:`text-sm md:text-base leading-relaxed font-medium ${a?"text-white/80 md:text-orange-800/90":"text-white/80 md:text-emerald-800/90"}`,children:a?"This is your 2nd punch request today and will be recorded as overtime (OT). The extra hours worked will appear in your OT calendar. Manager approval is required.":"Emergency punches should only be used in exceptional circumstances. Your manager must approve this request before you can punch in again."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-bold text-white/80 md:text-gray-600 ml-1 uppercase tracking-wider",children:a?"Reason for Overtime Punch":"Reason for Emergency Punch"}),e.jsx("textarea",{value:s,onChange:r=>x(r.target.value),placeholder:a?"e.g., Extended shift for urgent project delivery...":"e.g., Forgot to punch in earlier, Network issues...",className:"w-full rounded-2xl bg-[#0d2c18] md:bg-gray-50 border border-emerald-500/20 md:border-gray-200 focus:border-emerald-500 focus:ring-emerald-500 min-h-[180px] p-5 text-white md:text-gray-900 placeholder:text-white/30 md:placeholder:text-gray-400 transition-all resize-none shadow-inner"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 pt-4",children:[e.jsxs(u,{variant:"primary",onClick:g,isLoading:m,disabled:!s.trim(),className:`w-full md:flex-1 !py-4 !rounded-2xl !text-lg shadow-lg transition-all active:scale-[0.98] ${a?"bg-orange-600 hover:bg-orange-700 shadow-orange-500/20":"bg-emerald-600 hover:bg-emerald-700 shadow-emerald-500/20"}`,children:[e.jsx(v,{className:"mr-2 h-5 w-5"}),a?"Submit OT Request":"Submit Request"]}),e.jsx(u,{variant:"secondary",onClick:()=>n("/profile"),disabled:m,className:"w-full md:w-48 !py-4 !rounded-2xl border-2 border-emerald-500/30 md:border-gray-200 bg-transparent md:bg-gray-50 text-emerald-500 md:text-gray-600 hover:bg-emerald-500/10 md:hover:bg-gray-100 transition-all",children:"Cancel"})]})]})})]})]})};export{C as default};
