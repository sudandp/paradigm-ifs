import{k,j as e,I as f,T as j,B as N,m as v}from"./index-D5q3SS3D.js";import{u as C,b as d}from"./react-vendor-BUaIliXj.js";import{ax as y}from"./ui-vendor-B8EvWqdc.js";import"./pdf-vendor-CB_F1AVu.js";import"./capacitor-vendor-CqiIOUn1.js";import"./utils-vendor-DmorxLnX.js";import"./supabase-7WG3J4rU.js";const A=()=>{const n=C(),M=k("(max-width: 767px)"),[t,p]=d.useState(""),[l,h]=d.useState(""),[m,b]=d.useState(""),[a,o]=d.useState(!1),[i,r]=d.useState(null),c=async s=>{if(s.preventDefault(),!(!t.trim()||!l.trim())){o(!0);try{const u={id:t.toLowerCase().replace(/\s+/g,"_"),name:t.trim(),description:l.trim(),permissions:m.split(",").map(x=>x.trim()).filter(Boolean)},g=await v.getModules();if(g.some(x=>x.id===u.id)){r({message:"Module with this ID already exists.",type:"error"}),o(!1);return}const w=[...g,u];await v.saveModules(w),r({message:"Module created successfully!",type:"success"}),setTimeout(()=>n("/admin/modules"),1500)}catch{r({message:"Failed to create module. Please try again.",type:"error"})}finally{o(!1)}}};return M?e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:e.jsx("h1",{children:"Add Module"})}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:e.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:e.jsx(y,{className:"h-8 w-8 text-accent-dark"})}),e.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Module"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Create a new system module."})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsx(f,{label:"Module Name",id:"name",value:t,onChange:s=>p(s.target.value),placeholder:"e.g. HR Tasks & Management",required:!0,disabled:a,error:!t.trim()&&t!==""?"Module name is required":""}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:["Description ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"description",value:l,onChange:s=>h(s.target.value),placeholder:"Manage leaves, policies, insurance, uniforms, and tasks.",className:"form-input",rows:4,required:!0,disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"permissions",className:"block text-sm font-medium text-muted mb-1",children:"Permissions (comma-separated)"}),e.jsx("input",{id:"permissions",value:m,onChange:s=>b(s.target.value),placeholder:"e.g. view_module, manage_module",className:"form-input",disabled:a})]})]})]})}),e.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[e.jsx("button",{type:"button",onClick:()=>n("/admin/modules"),disabled:a,className:"fo-btn-secondary px-6",children:"Cancel"}),e.jsx("button",{type:"submit",onClick:c,disabled:a||!t.trim()||!l.trim(),className:"fo-btn-primary flex-1",children:a?"Creating...":"Create Module"})]}),i&&e.jsx(j,{message:i.message,type:i.type,onDismiss:()=>r(null)})]}):e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:e.jsx(y,{className:"h-8 w-8 text-accent-dark"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Module"}),e.jsx("p",{className:"text-muted",children:"Create a new system module."})]})]}),e.jsxs("form",{onSubmit:c,className:"space-y-6",children:[e.jsx(f,{label:"Module Name",id:"name",value:t,onChange:s=>p(s.target.value),placeholder:"e.g. HR Tasks & Management",required:!0,disabled:a}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:["Description ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"description",value:l,onChange:s=>h(s.target.value),placeholder:"Manage leaves, policies, insurance, uniforms, and tasks.",className:"form-input",rows:4,required:!0,disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"permissions",className:"block text-sm font-medium text-muted mb-1",children:"Permissions (comma-separated)"}),e.jsx("input",{id:"permissions",value:m,onChange:s=>b(s.target.value),placeholder:"e.g. view_module, manage_module",className:"form-input",disabled:a})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[e.jsx(N,{type:"button",onClick:()=>n("/admin/modules"),variant:"secondary",disabled:a,children:"Cancel"}),e.jsx(N,{type:"submit",isLoading:a,disabled:!t.trim()||!l.trim(),children:"Create Module"})]})]})]}),i&&e.jsx(j,{message:i.message,type:i.type,onDismiss:()=>r(null)})]})};export{A as default};
