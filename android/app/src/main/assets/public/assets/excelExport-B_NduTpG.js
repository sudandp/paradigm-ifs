import{E as M,F as x}from"./FileSaver.min-C7cHFFkD.js";import{f as d}from"./utils-vendor-DmorxLnX.js";const W=async(a,h,u,C,w,l,b)=>{const m=new M.Workbook,r=m.addWorksheet(u);if(l&&l.startsWith("data:image"))try{const o=l.split(",")[1],p=m.addImage({base64:o,extension:"png"});r.addImage(p,{tl:{col:0,row:0},ext:{width:180,height:45}})}catch(o){console.error("Failed to add logo to Excel:",o)}const i=String.fromCharCode(65+Math.max(h.length-1,5));r.getRow(1).height=35,r.mergeCells(`A1:${i}1`);const n=r.getCell("A1");n.value=u,n.font={size:16,bold:!0,color:{argb:"FF000000"}},n.alignment={horizontal:"right",vertical:"middle"},r.getRow(2).height=20,r.mergeCells(`A2:${i}2`);const c=r.getCell("A2");c.value=`${d(C.startDate,"dd MMM yyyy")} to ${d(C.endDate,"dd MMM yyyy")}`,c.font={size:11,color:{argb:"FF444444"},italic:!0},c.alignment={horizontal:"right",vertical:"middle"},r.getRow(3).height=15,r.mergeCells(`A3:${i}3`);const g=r.getCell("A3");g.value=`Generated: ${d(new Date,"dd MMM yyyy HH:mm")}`,g.font={size:10,color:{argb:"FF666666"}},g.alignment={horizontal:"right",vertical:"middle"};let f=5;if(b){r.getRow(4).height=15,r.mergeCells(`A4:${i}4`);const o=r.getCell("A4");o.value=`Generated by: ${b}`,o.font={size:10,color:{argb:"FF666666"}},o.alignment={horizontal:"right",vertical:"middle"},f=6}const s=r.getRow(f);s.values=h.map(o=>o.header),s.font={bold:!0},s.alignment={horizontal:"center",vertical:"middle"},s.height=20,s.eachCell(o=>{o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE0E0E0"}},o.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),h.forEach((o,p)=>{r.getColumn(p+1).width=o.width}),f++,a.forEach(o=>{const p=h.map(F=>o[F.key]),v=r.getRow(f);v.values=p,v.eachCell(F=>{F.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},F.alignment={wrapText:!0,vertical:"middle"}}),f++});const A=await m.xlsx.writeBuffer(),D=`${w}_${d(C.startDate,"MMM_yyyy")}.xlsx`;x.saveAs(new Blob([A]),D)},I=async(a,h,u,C)=>{const w=new M.Workbook,l=w.addWorksheet("Monthly Attendance Report");if(u&&u.startsWith("data:image"))try{const e=u.split(",")[1],t=w.addImage({base64:e,extension:"png"});l.addImage(t,{tl:{col:0,row:0},ext:{width:180,height:45}})}catch(e){console.error("Failed to add logo to Excel:",e)}l.getRow(1).height=35,l.mergeCells("A1:AJ1");const b=l.getCell("A1");b.value="Monthly Attendance Report",b.font={size:20,bold:!0,color:{argb:"FF000000"}},b.alignment={horizontal:"right",vertical:"middle"},l.getRow(2).height=20,l.mergeCells("A2:AJ2");const m=l.getCell("A2");m.value=`${d(h.startDate,"dd MMM yyyy")} to ${d(h.endDate,"dd MMM yyyy")}`,m.font={size:12,color:{argb:"FF444444"},italic:!0},m.alignment={horizontal:"right",vertical:"middle"},l.getRow(3).height=15,l.mergeCells("A3:AJ3");const r=l.getCell("A3");r.value=`Generated: ${d(new Date,"dd MMM yyyy HH:mm")}`,r.font={size:10,color:{argb:"FF666666"}},r.alignment={horizontal:"right",vertical:"middle"};{l.getRow(4).height=15,l.mergeCells("A4:AJ4");const e=l.getCell("A4");e.value=`Generated by: ${C}`,e.font={size:10,color:{argb:"FF666666"}},e.alignment={horizontal:"right",vertical:"middle"}}let i=6;const n=[];let c=new Date(h.startDate);for(;c<=h.endDate;)n.push(new Date(c)),c.setDate(c.getDate()+1);const g=l.getRow(i),f=["",...n.map(e=>d(e,"d")),...new Array(12).fill("")];g.values=f,g.height=20,g.font={bold:!0,size:10},g.alignment={horizontal:"center",vertical:"middle"},g.eachCell({includeEmpty:!1},(e,t)=>{t>1&&t<=n.length+1&&(e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF5F5F5"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}})}),i++;const s=l.getRow(i),A=["Employee Name",...n.map(e=>d(e,"EEE")),"P","1/2P","W/H","A","WO","H","WOP","HP","S/L","E/L","F/H","C/O","Total"];s.values=A,s.height=25,s.font={bold:!0,color:{argb:"FF000000"}},s.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE0E0E0"}},s.alignment={vertical:"middle",horizontal:"center"},l.getColumn(1).width=28;for(let e=2;e<=n.length+1;e++)l.getColumn(e).width=5;const D=n.length+15;for(let e=n.length+2;e<=D;e++)l.getColumn(e).width=7;s.eachCell({includeEmpty:!0},e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),i++,a.forEach(e=>{const t=[e.userName,...e.statuses,e.presentDays,e.halfDays,e.workFromHomeDays,e.absentDays,e.weekOffs,e.holidays,e.weekendPresents,e.holidayPresents,e.sickLeaves,e.earnedLeaves,e.floatingHolidays,e.compOffs,e.totalPayableDays],y=l.getRow(i);y.values=t,y.height=22;const z=n.length+11,k=n.length+12,R=n.length+13,$=n.length+14,H=n.length+15;y.getCell(z).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE8F5E9"}},y.getCell(k).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE3F2FD"}},y.getCell(R).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFF9C4"}},y.getCell($).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF3E5F5"}},y.getCell(H).font={bold:!0},y.eachCell({includeEmpty:!0},E=>{E.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},Number(E.col)>1?E.alignment={horizontal:"center",vertical:"middle"}:E.alignment={vertical:"middle",indent:1}}),i++});const o=l.getRow(i),p=["Total",...new Array(n.length).fill(""),a.reduce((e,t)=>e+t.presentDays,0),a.reduce((e,t)=>e+t.halfDays,0),a.reduce((e,t)=>e+t.workFromHomeDays,0),a.reduce((e,t)=>e+t.absentDays,0),a.reduce((e,t)=>e+t.weekOffs,0),a.reduce((e,t)=>e+t.holidays,0),a.reduce((e,t)=>e+t.weekendPresents,0),a.reduce((e,t)=>e+t.holidayPresents,0),a.reduce((e,t)=>e+t.sickLeaves,0),a.reduce((e,t)=>e+t.earnedLeaves,0),a.reduce((e,t)=>e+t.floatingHolidays,0),a.reduce((e,t)=>e+t.compOffs,0),a.reduce((e,t)=>e+t.totalPayableDays,0)];o.values=p,o.height=25,o.font={bold:!0},o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF5F5F5"}},o.eachCell({includeEmpty:!0},e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},Number(e.col)>1&&(e.alignment={horizontal:"center",vertical:"middle"})});const v=await w.xlsx.writeBuffer(),F=`Monthly_Attendance_Report_${d(h.startDate,"MMM_yyyy")}.xlsx`;x.saveAs(new Blob([v]),F)};export{W as a,I as e};
